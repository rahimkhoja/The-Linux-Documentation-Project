<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">

<html>

<head>

<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">

<title>Securing Debian Manual - Before the compromise</title>

<link href="index.en.html" rel="start">
<link href="ch9.en.html" rel="prev">
<link href="ch-after-compromise.en.html" rel="next">
<link href="index.en.html#contents" rel="contents">
<link href="index.en.html#copyright" rel="copyright">
<link href="ch1.en.html" rel="chapter" title="1 Introduction">
<link href="ch2.en.html" rel="chapter" title="2 Before you begin">
<link href="ch3.en.html" rel="chapter" title="3 Before and during the installation">
<link href="ch4.en.html" rel="chapter" title="4 After installation">
<link href="ch-sec-services.en.html" rel="chapter" title="5 Securing services running on your system">
<link href="ch-automatic-harden.en.html" rel="chapter" title="6 Automatic hardening of Debian systems">
<link href="ch7.en.html" rel="chapter" title="7 Debian Security Infrastructure">
<link href="ch-sec-tools.en.html" rel="chapter" title="8 Security tools in Debian">
<link href="ch9.en.html" rel="chapter" title="9 Developer's Best Practices for OS Security">
<link href="ch10.en.html" rel="chapter" title="10 Before the compromise">
<link href="ch-after-compromise.en.html" rel="chapter" title="11 After the compromise (incident response)">
<link href="ch12.en.html" rel="chapter" title="12 Frequently asked Questions (FAQ)">
<link href="ap-harden-step.en.html" rel="appendix" title="A The hardening process step by step">
<link href="ap-checklist.en.html" rel="appendix" title="B Configuration checklist">
<link href="ap-snort-box.en.html" rel="appendix" title="C Setting up a stand-alone IDS">
<link href="ap-bridge-fw.en.html" rel="appendix" title="D Setting up a bridge firewall">
<link href="ap-bind-chuser.en.html" rel="appendix" title="E Sample script to change the default Bind installation.">
<link href="ap-fw-security-update.en.html" rel="appendix" title="F Security update protected by a firewall">
<link href="ap-chroot-ssh-env.en.html" rel="appendix" title="G <code>Chroot</code> environment for <code>SSH</code>">
<link href="ap-chroot-apache-env.en.html" rel="appendix" title="H <code>Chroot</code> environment for <code>Apache</code>">
<link href="ch1.en.html#s-authors" rel="section" title="1.1 Authors">
<link href="ch1.en.html#s1.2" rel="section" title="1.2 Where to get the manual (and available formats)">
<link href="ch1.en.html#s1.3" rel="section" title="1.3 Organizational notes/feedback">
<link href="ch1.en.html#s1.4" rel="section" title="1.4 Prior knowledge">
<link href="ch1.en.html#s1.5" rel="section" title="1.5 Things that need to be written (FIXME/TODO)">
<link href="ch1.en.html#s-changelog" rel="section" title="1.6 Changelog/History">
<link href="ch1.en.html#s-credits" rel="section" title="1.7 Credits and thanks!">
<link href="ch2.en.html#s2.1" rel="section" title="2.1 What do you want this system for?">
<link href="ch2.en.html#s-references" rel="section" title="2.2 Be aware of general security problems">
<link href="ch2.en.html#s2.3" rel="section" title="2.3 How does Debian handle security?">
<link href="ch3.en.html#s-bios-passwd" rel="section" title="3.1 Choose a BIOS password">
<link href="ch3.en.html#s3.2" rel="section" title="3.2 Partitioning the system">
<link href="ch3.en.html#s3.3" rel="section" title="3.3 Do not plug to the Internet until ready">
<link href="ch3.en.html#s3.4" rel="section" title="3.4 Set a root password">
<link href="ch3.en.html#s3.5" rel="section" title="3.5 Activate shadow passwords and MD5 passwords">
<link href="ch3.en.html#s3.6" rel="section" title="3.6 Run the minimum number of services required">
<link href="ch3.en.html#s3.7" rel="section" title="3.7 Install the minimum amount of software required">
<link href="ch3.en.html#s3.8" rel="section" title="3.8 Read the Debian security mailing lists">
<link href="ch4.en.html#s-debian-sec-announce" rel="section" title="4.1 Subscribe to the Debian Security Announce mailing list">
<link href="ch4.en.html#s-security-update" rel="section" title="4.2 Execute a security update">
<link href="ch4.en.html#s-bios-boot" rel="section" title="4.3 Change the BIOS (again)">
<link href="ch4.en.html#s-lilo-passwd" rel="section" title="4.4 Set a LILO or GRUB password">
<link href="ch4.en.html#s-kernel-initramfs-prompt" rel="section" title="4.5 Disable root prompt on the initramfs">
<link href="ch4.en.html#s-kernel-root-prompt" rel="section" title="4.6 Remove root prompt on the kernel">
<link href="ch4.en.html#s-restrict-console-login" rel="section" title="4.7 Restricting console login access">
<link href="ch4.en.html#s-restrict-reboots" rel="section" title="4.8 Restricting system reboots through the console">
<link href="ch4.en.html#s4.9" rel="section" title="4.9 Mounting partitions the right way">
<link href="ch4.en.html#s4.10" rel="section" title="4.10 Providing secure user access">
<link href="ch4.en.html#s-tcpwrappers" rel="section" title="4.11 Using tcpwrappers">
<link href="ch4.en.html#s-log-alerts" rel="section" title="4.12 The importance of logs and alerts">
<link href="ch4.en.html#s-kernel-patches" rel="section" title="4.13 Adding kernel patches">
<link href="ch4.en.html#s4.14" rel="section" title="4.14 Protecting against buffer overflows">
<link href="ch4.en.html#s4.15" rel="section" title="4.15 Secure file transfers">
<link href="ch4.en.html#s4.16" rel="section" title="4.16 File system limits and control">
<link href="ch4.en.html#s-network-secure" rel="section" title="4.17 Securing network access">
<link href="ch4.en.html#s-snapshot" rel="section" title="4.18 Taking a snapshot of the system">
<link href="ch4.en.html#s4.19" rel="section" title="4.19 Other recommendations">
<link href="ch-sec-services.en.html#s5.1" rel="section" title="5.1 Securing ssh">
<link href="ch-sec-services.en.html#s5.2" rel="section" title="5.2 Securing Squid">
<link href="ch-sec-services.en.html#s-ftp-secure" rel="section" title="5.3 Securing FTP">
<link href="ch-sec-services.en.html#s5.4" rel="section" title="5.4 Securing access to the X Window System">
<link href="ch-sec-services.en.html#s5.5" rel="section" title="5.5 Securing printing access (the lpd and lprng issue)">
<link href="ch-sec-services.en.html#s5.6" rel="section" title="5.6 Securing the mail service">
<link href="ch-sec-services.en.html#s-sec-bind" rel="section" title="5.7 Securing BIND">
<link href="ch-sec-services.en.html#s5.8" rel="section" title="5.8 Securing Apache">
<link href="ch-sec-services.en.html#s5.9" rel="section" title="5.9 Securing finger">
<link href="ch-sec-services.en.html#s-chroot" rel="section" title="5.10 General chroot and suid paranoia">
<link href="ch-sec-services.en.html#s5.11" rel="section" title="5.11 General cleartext password paranoia">
<link href="ch-sec-services.en.html#s5.12" rel="section" title="5.12 Disabling NIS">
<link href="ch-sec-services.en.html#s-rpc" rel="section" title="5.13 Securing RPC services">
<link href="ch-sec-services.en.html#s-firewall-setup" rel="section" title="5.14 Adding firewall capabilities">
<link href="ch-automatic-harden.en.html#s6.1" rel="section" title="6.1 Harden">
<link href="ch-automatic-harden.en.html#s6.2" rel="section" title="6.2 Bastille Linux">
<link href="ch7.en.html#s-debian-sec-team" rel="section" title="7.1 The Debian Security Team">
<link href="ch7.en.html#s-dsa" rel="section" title="7.2 Debian Security Advisories">
<link href="ch7.en.html#s7.3" rel="section" title="7.3 Security Tracker">
<link href="ch7.en.html#s7.4" rel="section" title="7.4 Debian Security Build Infrastructure">
<link href="ch7.en.html#s-deb-pack-sign" rel="section" title="7.5 Package signing in Debian">
<link href="ch-sec-tools.en.html#s-vuln-asses" rel="section" title="8.1 Remote vulnerability assessment tools">
<link href="ch-sec-tools.en.html#s8.2" rel="section" title="8.2 Network scanner tools">
<link href="ch-sec-tools.en.html#s8.3" rel="section" title="8.3 Internal audits">
<link href="ch-sec-tools.en.html#s8.4" rel="section" title="8.4 Auditing source code">
<link href="ch-sec-tools.en.html#s-vpn" rel="section" title="8.5 Virtual Private Networks">
<link href="ch-sec-tools.en.html#s8.6" rel="section" title="8.6 Public Key Infrastructure (PKI)">
<link href="ch-sec-tools.en.html#s8.7" rel="section" title="8.7 SSL Infrastructure">
<link href="ch-sec-tools.en.html#s8.8" rel="section" title="8.8 Antivirus tools">
<link href="ch-sec-tools.en.html#s-gpg-agent" rel="section" title="8.9 GPG agent">
<link href="ch9.en.html#s-bpp-devel-design" rel="section" title="9.1 Best practices for security review and design">
<link href="ch9.en.html#s-bpp-lower-privs" rel="section" title="9.2 Creating users and groups for software daemons">
<link href="ch10.en.html#s-keep-secure" rel="section" title="10.1 Keep your system secure">
<link href="ch10.en.html#s-periodic-integrity" rel="section" title="10.2 Do periodic integrity checks">
<link href="ch10.en.html#s-intrusion-detect" rel="section" title="10.3 Set up Intrusion Detection">
<link href="ch10.en.html#s10.4" rel="section" title="10.4 Avoiding root-kits">
<link href="ch10.en.html#s10.5" rel="section" title="10.5 Genius/Paranoia Ideas &mdash; what you could do">
<link href="ch-after-compromise.en.html#s11.1" rel="section" title="11.1 General behavior">
<link href="ch-after-compromise.en.html#s11.2" rel="section" title="11.2 Backing up the system">
<link href="ch-after-compromise.en.html#s11.3" rel="section" title="11.3 Contact your local CERT">
<link href="ch-after-compromise.en.html#s11.4" rel="section" title="11.4 Forensic analysis">
<link href="ch12.en.html#s12.1" rel="section" title="12.1 Security in the Debian operating system">
<link href="ch12.en.html#s-vulnerable-system" rel="section" title="12.2 My system is vulnerable! (Are you sure?)">
<link href="ch12.en.html#s-debian-sec-team-faq" rel="section" title="12.3 Questions regarding the Debian security team">
<link href="ap-bridge-fw.en.html#sD.1" rel="section" title="D.1 A bridge providing NAT and firewall capabilities">
<link href="ap-bridge-fw.en.html#sD.2" rel="section" title="D.2 A bridge providing firewall capabilities">
<link href="ap-bridge-fw.en.html#sD.3" rel="section" title="D.3 Basic IPtables rules">
<link href="ap-chroot-ssh-env.en.html#sG.1" rel="section" title="G.1 Chrooting the ssh users">
<link href="ap-chroot-ssh-env.en.html#sG.2" rel="section" title="G.2 Chrooting the ssh server">
<link href="ap-chroot-apache-env.en.html#sH.1" rel="section" title="H.1 Introduction">
<link href="ap-chroot-apache-env.en.html#sH.2" rel="section" title="H.2 Installing the server">
<link href="ap-chroot-apache-env.en.html#sH.3" rel="section" title="H.3 See also">
<link href="ch1.en.html#s1.6.1" rel="subsection" title="1.6.1 Version 3.16 (March 2011)">
<link href="ch1.en.html#s1.6.2" rel="subsection" title="1.6.2 Version 3.15 (December 2010)">
<link href="ch1.en.html#s1.6.3" rel="subsection" title="1.6.3 Version 3.14 (March 2009)">
<link href="ch1.en.html#s1.6.4" rel="subsection" title="1.6.4 Version 3.13 (Februrary 2008)">
<link href="ch1.en.html#s1.6.5" rel="subsection" title="1.6.5 Version 3.12 (August 2007)">
<link href="ch1.en.html#s1.6.6" rel="subsection" title="1.6.6 Version 3.11 (January 2007)">
<link href="ch1.en.html#s1.6.7" rel="subsection" title="1.6.7 Version 3.10 (November 2006)">
<link href="ch1.en.html#s1.6.8" rel="subsection" title="1.6.8 Version 3.9 (October 2006)">
<link href="ch1.en.html#s1.6.9" rel="subsection" title="1.6.9 Version 3.8 (July 2006)">
<link href="ch1.en.html#s1.6.10" rel="subsection" title="1.6.10 Version 3.7 (April 2006)">
<link href="ch1.en.html#s1.6.11" rel="subsection" title="1.6.11 Version 3.6 (March 2006)">
<link href="ch1.en.html#s1.6.12" rel="subsection" title="1.6.12 Version 3.5 (November 2005)">
<link href="ch1.en.html#s1.6.13" rel="subsection" title="1.6.13 Version 3.4 (August-September 2005)">
<link href="ch1.en.html#s1.6.14" rel="subsection" title="1.6.14 Version 3.3 (June 2005)">
<link href="ch1.en.html#s1.6.15" rel="subsection" title="1.6.15 Version 3.2 (March 2005)">
<link href="ch1.en.html#s1.6.16" rel="subsection" title="1.6.16 Version 3.1 (January 2005)">
<link href="ch1.en.html#s1.6.17" rel="subsection" title="1.6.17 Version 3.0 (December 2004)">
<link href="ch1.en.html#s1.6.18" rel="subsection" title="1.6.18 Version 2.99 (March 2004)">
<link href="ch1.en.html#s1.6.19" rel="subsection" title="1.6.19 Version 2.98 (December 2003)">
<link href="ch1.en.html#s1.6.20" rel="subsection" title="1.6.20 Version 2.97 (September 2003)">
<link href="ch1.en.html#s1.6.21" rel="subsection" title="1.6.21 Version 2.96 (August 2003)">
<link href="ch1.en.html#s1.6.22" rel="subsection" title="1.6.22 Version 2.95 (June 2003)">
<link href="ch1.en.html#s1.6.23" rel="subsection" title="1.6.23 Version 2.94 (April 2003)">
<link href="ch1.en.html#s1.6.24" rel="subsection" title="1.6.24 Version 2.93 (March 2003)">
<link href="ch1.en.html#s1.6.25" rel="subsection" title="1.6.25 Version 2.92 (February 2003)">
<link href="ch1.en.html#s1.6.26" rel="subsection" title="1.6.26 Version 2.91 (January/February 2003)">
<link href="ch1.en.html#s1.6.27" rel="subsection" title="1.6.27 Version 2.9 (December 2002)">
<link href="ch1.en.html#s1.6.28" rel="subsection" title="1.6.28 Version 2.8 (November 2002)">
<link href="ch1.en.html#s1.6.29" rel="subsection" title="1.6.29 Version 2.7 (October 2002)">
<link href="ch1.en.html#s1.6.30" rel="subsection" title="1.6.30 Version 2.6 (September 2002)">
<link href="ch1.en.html#s1.6.31" rel="subsection" title="1.6.31 Version 2.5 (September 2002)">
<link href="ch1.en.html#s1.6.32" rel="subsection" title="1.6.32 Version 2.5 (August 2002)">
<link href="ch1.en.html#s1.6.33" rel="subsection" title="1.6.33 Version 2.4">
<link href="ch1.en.html#s1.6.34" rel="subsection" title="1.6.34 Version 2.3">
<link href="ch1.en.html#s1.6.35" rel="subsection" title="1.6.35 Version 2.3">
<link href="ch1.en.html#s1.6.36" rel="subsection" title="1.6.36 Version 2.2">
<link href="ch1.en.html#s1.6.37" rel="subsection" title="1.6.37 Version 2.1">
<link href="ch1.en.html#s1.6.38" rel="subsection" title="1.6.38 Version 2.0">
<link href="ch1.en.html#s1.6.39" rel="subsection" title="1.6.39 Version 1.99">
<link href="ch1.en.html#s1.6.40" rel="subsection" title="1.6.40 Version 1.98">
<link href="ch1.en.html#s1.6.41" rel="subsection" title="1.6.41 Version 1.97">
<link href="ch1.en.html#s1.6.42" rel="subsection" title="1.6.42 Version 1.96">
<link href="ch1.en.html#s1.6.43" rel="subsection" title="1.6.43 Version 1.95">
<link href="ch1.en.html#s1.6.44" rel="subsection" title="1.6.44 Version 1.94">
<link href="ch1.en.html#s1.6.45" rel="subsection" title="1.6.45 Version 1.93">
<link href="ch1.en.html#s1.6.46" rel="subsection" title="1.6.46 Version 1.92">
<link href="ch1.en.html#s1.6.47" rel="subsection" title="1.6.47 Version 1.91">
<link href="ch1.en.html#s1.6.48" rel="subsection" title="1.6.48 Version 1.9">
<link href="ch1.en.html#s1.6.49" rel="subsection" title="1.6.49 Version 1.8">
<link href="ch1.en.html#s1.6.50" rel="subsection" title="1.6.50 Version 1.7">
<link href="ch1.en.html#s1.6.51" rel="subsection" title="1.6.51 Version 1.6">
<link href="ch1.en.html#s1.6.52" rel="subsection" title="1.6.52 Version 1.5">
<link href="ch1.en.html#s1.6.53" rel="subsection" title="1.6.53 Version 1.4">
<link href="ch1.en.html#s1.6.54" rel="subsection" title="1.6.54 Version 1.3">
<link href="ch1.en.html#s1.6.55" rel="subsection" title="1.6.55 Version 1.2">
<link href="ch1.en.html#s1.6.56" rel="subsection" title="1.6.56 Version 1.1">
<link href="ch1.en.html#s1.6.57" rel="subsection" title="1.6.57 Version 1.0">
<link href="ch3.en.html#s3.2.1" rel="subsection" title="3.2.1 Choose an intelligent partition scheme">
<link href="ch3.en.html#s3.2.1.1" rel="subsection" title="3.2.1.1 Selecting the appropriate file systems">
<link href="ch3.en.html#s-disableserv" rel="subsection" title="3.6.1 Disabling daemon services">
<link href="ch3.en.html#s-inetd" rel="subsection" title="3.6.2 Disabling <code>inetd</code> or its services">
<link href="ch3.en.html#s3.7.1" rel="subsection" title="3.7.1 Removing Perl">
<link href="ch4.en.html#s-lib-security-update" rel="subsection" title="4.2.1 Security update of libraries">
<link href="ch4.en.html#s-kernel-security-update" rel="subsection" title="4.2.2 Security update of the kernel">
<link href="ch4.en.html#s4.9.1" rel="subsection" title="4.9.1 Setting <code>/tmp</code> noexec">
<link href="ch4.en.html#s4.9.2" rel="subsection" title="4.9.2 Setting /usr read-only">
<link href="ch4.en.html#s-auth-pam" rel="subsection" title="4.10.1 User authentication: PAM">
<link href="ch4.en.html#s-user-limits" rel="subsection" title="4.10.2 Limiting resource usage: the <code>limits.conf</code> file">
<link href="ch4.en.html#s4.10.3" rel="subsection" title="4.10.3 User login actions: edit <code>/etc/login.defs</code>">
<link href="ch4.en.html#s4.10.4" rel="subsection" title="4.10.4 Restricting ftp: editing <code>/etc/ftpusers</code>">
<link href="ch4.en.html#s4.10.5" rel="subsection" title="4.10.5 Using su">
<link href="ch4.en.html#s4.10.6" rel="subsection" title="4.10.6 Using sudo">
<link href="ch4.en.html#s4.10.7" rel="subsection" title="4.10.7 Disallow remote administrative access">
<link href="ch4.en.html#s-user-restrict" rel="subsection" title="4.10.8 Restricting users's access">
<link href="ch4.en.html#s4.10.9" rel="subsection" title="4.10.9 User auditing">
<link href="ch4.en.html#s4.10.9.1" rel="subsection" title="4.10.9.1 Input and output audit with script">
<link href="ch4.en.html#s4.10.9.2" rel="subsection" title="4.10.9.2 Using the shell history file">
<link href="ch4.en.html#s4.10.9.3" rel="subsection" title="4.10.9.3 Complete user audit with accounting utilities">
<link href="ch4.en.html#s4.10.9.4" rel="subsection" title="4.10.9.4 Other user auditing methods">
<link href="ch4.en.html#s4.10.10" rel="subsection" title="4.10.10 Reviewing user profiles">
<link href="ch4.en.html#s4.10.11" rel="subsection" title="4.10.11 Setting users umasks">
<link href="ch4.en.html#s4.10.12" rel="subsection" title="4.10.12 Limiting what users can see/access">
<link href="ch4.en.html#s-limit-user-perm" rel="subsection" title="4.10.12.1 Limiting access to other user's information">
<link href="ch4.en.html#s-user-pwgen" rel="subsection" title="4.10.13 Generating user passwords">
<link href="ch4.en.html#s4.10.14" rel="subsection" title="4.10.14 Checking user passwords">
<link href="ch4.en.html#s-idle-logoff" rel="subsection" title="4.10.15 Logging off idle users">
<link href="ch4.en.html#s-custom-logcheck" rel="subsection" title="4.12.1 Using and customizing <code>logcheck</code>">
<link href="ch4.en.html#s4.12.2" rel="subsection" title="4.12.2 Configuring where alerts are sent">
<link href="ch4.en.html#s4.12.3" rel="subsection" title="4.12.3 Using a loghost">
<link href="ch4.en.html#s4.12.4" rel="subsection" title="4.12.4 Log file permissions">
<link href="ch4.en.html#s4.14.1" rel="subsection" title="4.14.1 Kernel patch protection for buffer overflows">
<link href="ch4.en.html#s4.14.2" rel="subsection" title="4.14.2 Testing programs for overflows">
<link href="ch4.en.html#s4.16.1" rel="subsection" title="4.16.1 Using quotas">
<link href="ch4.en.html#s-ext2attr" rel="subsection" title="4.16.2 The ext2 filesystem specific attributes (chattr/lsattr)">
<link href="ch4.en.html#s-check-integ" rel="subsection" title="4.16.3 Checking file system integrity">
<link href="ch4.en.html#s4.16.4" rel="subsection" title="4.16.4 Setting up setuid check">
<link href="ch4.en.html#s-kernel-conf" rel="subsection" title="4.17.1 Configuring kernel network features">
<link href="ch4.en.html#s-tcp-syncookies" rel="subsection" title="4.17.2 Configuring syncookies">
<link href="ch4.en.html#s-net-harden" rel="subsection" title="4.17.3 Securing the network on boot-time">
<link href="ch4.en.html#s-kernel-fw" rel="subsection" title="4.17.4 Configuring firewall features">
<link href="ch4.en.html#s-limit-bindaddr" rel="subsection" title="4.17.5 Disabling weak-end hosts issues">
<link href="ch4.en.html#s4.17.6" rel="subsection" title="4.17.6 Protecting against ARP attacks">
<link href="ch4.en.html#s4.19.1" rel="subsection" title="4.19.1 Do not use software depending on svgalib">
<link href="ch-sec-services.en.html#s-ssh-chroot" rel="subsection" title="5.1.1 Chrooting ssh">
<link href="ch-sec-services.en.html#s5.1.2" rel="subsection" title="5.1.2 Ssh clients">
<link href="ch-sec-services.en.html#s5.1.3" rel="subsection" title="5.1.3 Disallowing file transfers">
<link href="ch-sec-services.en.html#s-ssh-only-file" rel="subsection" title="5.1.4 Restricing access to file transfer only">
<link href="ch-sec-services.en.html#s5.4.1" rel="subsection" title="5.4.1 Check your display manager">
<link href="ch-sec-services.en.html#s5.6.1" rel="subsection" title="5.6.1 Configuring a Nullmailer">
<link href="ch-sec-services.en.html#s5.6.2" rel="subsection" title="5.6.2 Providing secure access to mailboxes">
<link href="ch-sec-services.en.html#s5.6.3" rel="subsection" title="5.6.3 Receiving mail securely">
<link href="ch-sec-services.en.html#s-configure-bind" rel="subsection" title="5.7.1 Bind configuration to avoid misuse">
<link href="ch-sec-services.en.html#s-user-bind" rel="subsection" title="5.7.2 Changing BIND's user">
<link href="ch-sec-services.en.html#s-chroot-bind" rel="subsection" title="5.7.3 Chrooting the name server">
<link href="ch-sec-services.en.html#s5.8.1" rel="subsection" title="5.8.1 Disabling users from publishing web contents">
<link href="ch-sec-services.en.html#s5.8.2" rel="subsection" title="5.8.2 Logfiles permissions">
<link href="ch-sec-services.en.html#s5.8.3" rel="subsection" title="5.8.3 Published web files">
<link href="ch-sec-services.en.html#s-auto-chroot" rel="subsection" title="5.10.1 Making chrooted environments automatically">
<link href="ch-sec-services.en.html#s5.13.1" rel="subsection" title="5.13.1 Disabling RPC services completely">
<link href="ch-sec-services.en.html#s5.13.2" rel="subsection" title="5.13.2 Limiting access to RPC services">
<link href="ch-sec-services.en.html#s5.14.1" rel="subsection" title="5.14.1 Firewalling the local system">
<link href="ch-sec-services.en.html#s5.14.2" rel="subsection" title="5.14.2 Using a firewall to protect other systems">
<link href="ch-sec-services.en.html#s5.14.3" rel="subsection" title="5.14.3 Setting up a firewall">
<link href="ch-sec-services.en.html#s-firewall-pack" rel="subsection" title="5.14.3.1 Using firewall packages">
<link href="ch-sec-services.en.html#s5.14.3.2" rel="subsection" title="5.14.3.2 Manual init.d configuration">
<link href="ch-sec-services.en.html#s5.14.3.3" rel="subsection" title="5.14.3.3 Configuring firewall rules through <code>ifup</code>">
<link href="ch-sec-services.en.html#s5.14.3.4" rel="subsection" title="5.14.3.4 Testing your firewall configuration">
<link href="ch7.en.html#s-crossreference" rel="subsection" title="7.2.1 Vulnerability cross references">
<link href="ch7.en.html#s-cve-compatible" rel="subsection" title="7.2.2 CVE compatibility">
<link href="ch7.en.html#s7.4.1" rel="subsection" title="7.4.1 Developer's guide to security updates">
<link href="ch7.en.html#s7.5.1" rel="subsection" title="7.5.1 The current scheme for package signature checks">
<link href="ch7.en.html#s-apt-0.6" rel="subsection" title="7.5.2 Secure apt">
<link href="ch7.en.html#s-check-releases" rel="subsection" title="7.5.3 Per distribution release check">
<link href="ch7.en.html#s7.5.3.1" rel="subsection" title="7.5.3.1 Basic concepts">
<link href="ch7.en.html#s7.5.3.2" rel="subsection" title="7.5.3.2 <code>Release</code> checksums">
<link href="ch7.en.html#s7.5.3.3" rel="subsection" title="7.5.3.3 Verification of the <code>Release</code> file">
<link href="ch7.en.html#s7.5.3.4" rel="subsection" title="7.5.3.4 Check of <code>Release.gpg</code> by <code>apt</code>">
<link href="ch7.en.html#s7.5.3.5" rel="subsection" title="7.5.3.5 How to tell apt what to trust">
<link href="ch7.en.html#s7.5.3.6" rel="subsection" title="7.5.3.6 Finding the key for a repository">
<link href="ch7.en.html#s-secure-apt-add-key" rel="subsection" title="7.5.3.7 Safely adding a key">
<link href="ch7.en.html#s7.5.3.8" rel="subsection" title="7.5.3.8 Verifying key integrity">
<link href="ch7.en.html#s7.5.3.9" rel="subsection" title="7.5.3.9 Debian archive key yearly rotation">
<link href="ch7.en.html#s7.5.3.10" rel="subsection" title="7.5.3.10 Known release checking problems">
<link href="ch7.en.html#s-manual-check-releases" rel="subsection" title="7.5.3.11 Manual per distribution release check">
<link href="ch7.en.html#s-check-non-debian-releases" rel="subsection" title="7.5.4 Release check of non Debian sources">
<link href="ch7.en.html#s-check-pkg-sign" rel="subsection" title="7.5.5 Alternative per-package signing scheme">
<link href="ch-sec-tools.en.html#s8.5.1" rel="subsection" title="8.5.1 Point to Point tunneling">
<link href="ch10.en.html#s-track-vulns" rel="subsection" title="10.1.1 Tracking security vulnerabilities">
<link href="ch10.en.html#s-keep-up-to-date" rel="subsection" title="10.1.2 Continuously update the system">
<link href="ch10.en.html#s10.1.2.1" rel="subsection" title="10.1.2.1 Manually checking which security updates are available">
<link href="ch10.en.html#s-update-desktop" rel="subsection" title="10.1.2.2 Checking for updates at the Desktop">
<link href="ch10.en.html#s-cron-apt" rel="subsection" title="10.1.2.3 Automatically checking for updates with cron-apt">
<link href="ch10.en.html#s-debsecan" rel="subsection" title="10.1.2.4 Automatically checking for security issues with debsecan">
<link href="ch10.en.html#s10.1.2.5" rel="subsection" title="10.1.2.5 Other methods for security updates">
<link href="ch10.en.html#s10.1.3" rel="subsection" title="10.1.3 Avoid using the unstable branch">
<link href="ch10.en.html#s-security-support-testing" rel="subsection" title="10.1.4 Security support for the testing branch">
<link href="ch10.en.html#s10.1.5" rel="subsection" title="10.1.5 Automatic updates in a Debian GNU/Linux system">
<link href="ch10.en.html#s10.3.1" rel="subsection" title="10.3.1 Network based intrusion detection">
<link href="ch10.en.html#s10.3.2" rel="subsection" title="10.3.2 Host based intrusion detection">
<link href="ch10.en.html#s-LKM" rel="subsection" title="10.4.1 Loadable Kernel Modules (LKM)">
<link href="ch10.en.html#s10.4.2" rel="subsection" title="10.4.2 Detecting root-kits">
<link href="ch10.en.html#s-proactive" rel="subsection" title="10.4.2.1 Proactive defense">
<link href="ch10.en.html#s10.4.2.2" rel="subsection" title="10.4.2.2 Reactive defense">
<link href="ch10.en.html#s10.5.1" rel="subsection" title="10.5.1 Building a honeypot">
<link href="ch-after-compromise.en.html#s11.4.1" rel="subsection" title="11.4.1 Analysis of malware">
<link href="ch12.en.html#s12.1.1" rel="subsection" title="12.1.1 Is Debian more secure than X?">
<link href="ch12.en.html#s12.1.1.1" rel="subsection" title="12.1.1.1 Is Debian more secure than other Linux distributions (such as Red Hat, SuSE...)?">
<link href="ch12.en.html#s12.1.2" rel="subsection" title="12.1.2 There are many Debian bugs in Bugtraq. Does this mean that it is very vulnerable?">
<link href="ch12.en.html#s12.1.3" rel="subsection" title="12.1.3 Does Debian have any certification related to security?">
<link href="ch12.en.html#s12.1.4" rel="subsection" title="12.1.4 Are there any hardening programs for Debian?">
<link href="ch12.en.html#s12.1.5" rel="subsection" title="12.1.5 I want to run XYZ service, which one should I choose?">
<link href="ch12.en.html#s12.1.6" rel="subsection" title="12.1.6 How can I make service XYZ more secure in Debian?">
<link href="ch12.en.html#s12.1.7" rel="subsection" title="12.1.7 How can I remove all the banners for services?">
<link href="ch12.en.html#s12.1.8" rel="subsection" title="12.1.8 Are all Debian packages safe?">
<link href="ch12.en.html#s12.1.9" rel="subsection" title="12.1.9 Why are some log files/configuration files world-readable, isn't this insecure?">
<link href="ch12.en.html#s12.1.10" rel="subsection" title="12.1.10 Why does /root/ (or UserX) have 755 permissions?">
<link href="ch12.en.html#s12.1.11" rel="subsection" title="12.1.11 After installing a grsec/firewall, I started receiving many console messages! How do I remove them?">
<link href="ch12.en.html#s-faq-os-users" rel="subsection" title="12.1.12 Operating system users and groups">
<link href="ch12.en.html#s12.1.12.1" rel="subsection" title="12.1.12.1 Are all system users necessary?">
<link href="ch12.en.html#s12.1.12.2" rel="subsection" title="12.1.12.2 I removed a system user! How can I recover?">
<link href="ch12.en.html#s12.1.12.3" rel="subsection" title="12.1.12.3 What is the difference between the adm and the staff group?">
<link href="ch12.en.html#s12.1.13" rel="subsection" title="12.1.13 Why is there a new group when I add a new user? (or Why does Debian give each user one group?)">
<link href="ch12.en.html#s12.1.14" rel="subsection" title="12.1.14 Questions regarding services and open ports">
<link href="ch12.en.html#s12.1.14.1" rel="subsection" title="12.1.14.1 Why are all services activated upon installation?">
<link href="ch12.en.html#s12.1.14.2" rel="subsection" title="12.1.14.2 Can I remove <code>inetd</code>?">
<link href="ch12.en.html#s12.1.14.3" rel="subsection" title="12.1.14.3 Why do I have port 111 open?">
<link href="ch12.en.html#s12.1.14.4" rel="subsection" title="12.1.14.4 What use is <code>identd</code> (port 113) for?">
<link href="ch12.en.html#s12.1.14.5" rel="subsection" title="12.1.14.5 I have services using port 1 and 6, what are they and how can I remove them?">
<link href="ch12.en.html#s12.1.14.6" rel="subsection" title="12.1.14.6 I found the port XYZ open, can I close it?">
<link href="ch12.en.html#s12.1.14.7" rel="subsection" title="12.1.14.7 Will removing services from <code>/etc/services</code> help secure my box?">
<link href="ch12.en.html#s12.1.15" rel="subsection" title="12.1.15 Common security issues">
<link href="ch12.en.html#s12.1.15.1" rel="subsection" title="12.1.15.1 I have lost my password and cannot access the system!">
<link href="ch12.en.html#s12.1.16" rel="subsection" title="12.1.16 How do I accomplish setting up a service for my users without giving out shell accounts?">
<link href="ch12.en.html#s-vulnasses-false-positive" rel="subsection" title="12.2.1 Vulnerability assessment scanner X says my Debian system is vulnerable!">
<link href="ch12.en.html#s12.2.2" rel="subsection" title="12.2.2 I've seen an attack in my system's logs. Is my system compromised?">
<link href="ch12.en.html#s12.2.3" rel="subsection" title="12.2.3 I have found strange 'MARK' lines in my logs: Am I compromised?">
<link href="ch12.en.html#s12.2.4" rel="subsection" title="12.2.4 I found users using 'su' in my logs: Am I compromised?">
<link href="ch12.en.html#s12.2.5" rel="subsection" title="12.2.5 I have found 'possible SYN flooding' in my logs: Am I under attack?">
<link href="ch12.en.html#s12.2.6" rel="subsection" title="12.2.6 I have found strange root sessions in my logs: Am I compromised?">
<link href="ch12.en.html#s12.2.7" rel="subsection" title="12.2.7 I have suffered a break-in, what do I do?">
<link href="ch12.en.html#s12.2.8" rel="subsection" title="12.2.8 How can I trace an attack?">
<link href="ch12.en.html#s12.2.9" rel="subsection" title="12.2.9 Program X in Debian is vulnerable, what do I do?">
<link href="ch12.en.html#s-version-backport" rel="subsection" title="12.2.10 The version number for a package indicates that I am still running a vulnerable version!">
<link href="ch12.en.html#s12.2.11" rel="subsection" title="12.2.11 Specific software">
<link href="ch12.en.html#s12.2.11.1" rel="subsection" title="12.2.11.1 <code>proftpd</code> is vulnerable to a Denial of Service attack.">
<link href="ch12.en.html#s12.2.11.2" rel="subsection" title="12.2.11.2 After installing <code>portsentry</code>, there are a lot of ports open.">
<link href="ch12.en.html#s12.3.1" rel="subsection" title="12.3.1 What is a Debian Security Advisory (DSA)?">
<link href="ch12.en.html#s12.3.2" rel="subsection" title="12.3.2 The signature on Debian advisories does not verify correctly!">
<link href="ch12.en.html#s12.3.3" rel="subsection" title="12.3.3 How is security handled in Debian?">
<link href="ch12.en.html#s12.3.4" rel="subsection" title="12.3.4 Why are you fiddling with an old version of that package?">
<link href="ch12.en.html#s12.3.5" rel="subsection" title="12.3.5 What is the policy for a fixed package to appear in security.debian.org?">
<link href="ch12.en.html#s12.3.6" rel="subsection" title="12.3.6 What does &quot;local (remote)&quot; mean?">
<link href="ch12.en.html#s12.3.7" rel="subsection" title="12.3.7 The version number for a package indicates that I am still running a vulnerable version!">
<link href="ch12.en.html#s-sec-unstable" rel="subsection" title="12.3.8 How is security handled for <samp>testing</samp> and <samp>unstable</samp>?">
<link href="ch12.en.html#s-sec-older" rel="subsection" title="12.3.9 I use an older version of Debian, is it supported by the Debian Security Team?">
<link href="ch12.en.html#s12.3.10" rel="subsection" title="12.3.10 How does <em>testing</em> get security updates?">
<link href="ch12.en.html#s12.3.11" rel="subsection" title="12.3.11 How is security handled for contrib and non-free?">
<link href="ch12.en.html#s12.3.12" rel="subsection" title="12.3.12 Why are there no official mirrors for security.debian.org?">
<link href="ch12.en.html#s12.3.13" rel="subsection" title="12.3.13 I've seen DSA 100 and DSA 102, now where is DSA 101?">
<link href="ch12.en.html#s12.3.14" rel="subsection" title="12.3.14 I tried to download a package listed in one of the security advisories, but I got a `file not found' error.">
<link href="ch12.en.html#s12.3.15" rel="subsection" title="12.3.15 How can I reach the security team?">
<link href="ch12.en.html#s12.3.16" rel="subsection" title="12.3.16 What difference is there between security@debian.org and debian-security@lists.debian.org?">
<link href="ch12.en.html#s12.3.17" rel="subsection" title="12.3.17 I guess I found a security problem, what should I do?">
<link href="ch12.en.html#s12.3.18" rel="subsection" title="12.3.18 How can I contribute to the Debian security team?">
<link href="ch12.en.html#s12.3.19" rel="subsection" title="12.3.19 Who is the Security Team composed of?">
<link href="ch12.en.html#s12.3.20" rel="subsection" title="12.3.20 Does the Debian Security team check every new package in Debian?">
<link href="ch12.en.html#s12.3.21" rel="subsection" title="12.3.21 How much time will it take Debian to fix vulnerability XXXX?">
<link href="ch12.en.html#s12.3.22" rel="subsection" title="12.3.22 How long will security updates be provided?">
<link href="ch12.en.html#s12.3.23" rel="subsection" title="12.3.23 How can I check the integrity of packages?">
<link href="ch12.en.html#s12.3.24" rel="subsection" title="12.3.24 What to do if a random package breaks after a security update?">
<link href="ap-chroot-ssh-env.en.html#sG.1.1" rel="subsection" title="G.1.1 Using <code>libpam-chroot</code>">
<link href="ap-chroot-ssh-env.en.html#sG.1.2" rel="subsection" title="G.1.2 Patching the <code>ssh</code> server">
<link href="ap-chroot-ssh-env.en.html#sG.2.1" rel="subsection" title="G.2.1 Setup a minimal system (the really easy way)">
<link href="ap-chroot-ssh-env.en.html#sG.2.2" rel="subsection" title="G.2.2 Automatically making the environment (the easy way)">
<link href="ap-chroot-ssh-env.en.html#sG.2.3" rel="subsection" title="G.2.3 Manually creating the environment (the hard way)">
<link href="ap-chroot-apache-env.en.html#sH.1.1" rel="subsection" title="H.1.1 Licensing">

</head>

<body>

<p><a name="ch10"></a></p>
<hr>

<p>
[ <a href="ch9.en.html">previous</a> ]
[ <a href="index.en.html#contents">Contents</a> ]
[ <a href="ch1.en.html">1</a> ]
[ <a href="ch2.en.html">2</a> ]
[ <a href="ch3.en.html">3</a> ]
[ <a href="ch4.en.html">4</a> ]
[ <a href="ch-sec-services.en.html">5</a> ]
[ <a href="ch-automatic-harden.en.html">6</a> ]
[ <a href="ch7.en.html">7</a> ]
[ <a href="ch-sec-tools.en.html">8</a> ]
[ <a href="ch9.en.html">9</a> ]
[ 10 ]
[ <a href="ch-after-compromise.en.html">11</a> ]
[ <a href="ch12.en.html">12</a> ]
[ <a href="ap-harden-step.en.html">A</a> ]
[ <a href="ap-checklist.en.html">B</a> ]
[ <a href="ap-snort-box.en.html">C</a> ]
[ <a href="ap-bridge-fw.en.html">D</a> ]
[ <a href="ap-bind-chuser.en.html">E</a> ]
[ <a href="ap-fw-security-update.en.html">F</a> ]
[ <a href="ap-chroot-ssh-env.en.html">G</a> ]
[ <a href="ap-chroot-apache-env.en.html">H</a> ]
[ <a href="ch-after-compromise.en.html">next</a> ]
</p>

<hr>

<h1>
Securing Debian Manual
<br>Chapter 10 - Before the compromise
</h1>

<hr>

<h2><a name="s-keep-secure"></a>10.1 Keep your system secure</h2>

<p>
You should strive to keep your system secure by monitoring its usage and also
the vulnerabilities that might affect it, patching them as soon as patches are
available.  Even though you might have installed a really secure system
initially you have to remember that security in a system degrades with time,
security vulnerabilities might be found for exposed system services and users
might expose the system security either because of lack of understanding (e.g.
accessing a system remotely with a clear-text protocol or using easy to guess
passwords) or because they are actively trying to subvert the system's security
(e.g.  install additional services locally on their accounts).
</p>

<hr>

<h3><a name="s-track-vulns"></a>10.1.1 Tracking security vulnerabilities</h3>

<p>
Although most administrators are aware of security vulnerabilities affecting
their systems when they see a patch that is made available you can strive to
keep ahead of attacks and introduce temporary countermeasures for security
vulnerabilities by detecting when your system is vulnerable.  This is specially
true when running an exposed system (i.e.  connected to the Internet) and
providing a service.  In such case the system's administrators should take care
to monitor known information sources to be the first to know when a
vulnerability is detected that might affect a critical service.
</p>

<p>
This typically includes subscribing to the announcement mailing lists, project
websites or bug tracking systems provided by the software developers for a
specific piece of code.  For example, Apache users should regularly review
Apache's <code><a href="http://httpd.apache.org/security_report.html">lists of
security vulnerabilities</a></code> and subscribe to the <code><a
href="http://httpd.apache.org/lists.html#http-announce">Apache Server
Announcements</a></code> mailing list.
</p>

<p>
In order to track known vulnerabilities affecting the Debian distribution, the
Debian Testing Security Team provides a <code><a
href="http://security-tracker.debian.net/">security tracker</a></code> that
lists all the known vulnerabilities which have not been yet fixed in Debian
packages.  The information in that tracker is obtained through different public
channels and includes known vulnerabilities which are available either through
security vulnerability databases or <code><a
href="http://www.debian.org/Bugs/">Debian's Bug Tracking system</a></code>.
Administrators can search for the known security issues being tracked for
<code><a
href="http://security-tracker.debian.net/tracker/status/release/stable">stable</a></code>,
<code><a
href="http://security-tracker.debian.net/tracker/status/release/oldstable">oldstable</a></code>,
<code><a
href="http://security-tracker.debian.net/tracker/status/release/testing">testing</a></code>,
or <code><a
href="http://security-tracker.debian.net/tracker/status/release/unstable">unstable</a></code>.
</p>

<p>
The tracker has searchable interfaces (by <code><a
href="http://cve.mitre.org/">CVE</a></code> name and package name) and some
tools (such as <code>debsecan</code>, see <a href="#s-debsecan">Automatically
checking for security issues with debsecan, Section 10.1.2.4</a>) use that
database to provide information of vulnerabilities affecting a given system
which have not yet been addressed (i.e.  those who are pending a fix).
</p>

<p>
Concious administrators can use that information to determine which security
bugs might affect the system they are managing, determine the severity of the
bug and apply (if available) temporary countermeasures before a patch is
available fixing this issue.
</p>

<p>
Security issues tracked for releases supported by the Debian Security Team
should eventually be handled through Debian Security Advisories (DSA) and will
be available for all users (see <a href="#s-keep-up-to-date">Continuously
update the system, Section 10.1.2</a>).  Once security issues are fixed through
an advisory they will not be available in the tracker, but you will be able to
search security vulnerabilities (by CVE name) using the <code><a
href="http://www.debian.org/security/crossreferences">security cross references
table</a></code> available for published DSAs.
</p>

<p>
Notice, however, that the information tracked by the Debian Testing Security
Team only involves disclosed vulnerabilities (i.e.  those already public).  In
some occasions the Debian Security Team might be handling and preparing DSAs
for packages based on undisclosed information provided to them (for example,
through closed vendor mailing lists or by upstream maintainers of software).
So do not be surprised to find security issues that only show up as an advisory
but never get to show up in the security tracker.
</p>

<hr>

<h3><a name="s-keep-up-to-date"></a>10.1.2 Continuously update the system</h3>

<p>
You should conduct security updates frequently.  The vast majority of exploits
result from known vulnerabilities that have not been patched in time, as this
<code><a href="http://www.cs.umd.edu/~waa/vulnerability.html">paper by Bill
Arbaugh</a></code> (presented at the 2001 IEEE Symposium on Security and
Privacy) explains.  Updates are described under <a
href="ch4.en.html#s-security-update">Execute a security update, Section
4.2</a>.
</p>

<hr>

<h4><a name="s10.1.2.1"></a>10.1.2.1 Manually checking which security updates are available</h4>

<p>
Debian does have a specific tool to check if a system needs to be updated but
many users will just want to manually check if any security updates are
available for their system.
</p>

<p>
If you have configured your system as described in <a
href="ch4.en.html#s-security-update">Execute a security update, Section 4.2</a>
you just need to do:
</p>

<pre>
     # apt-get update
     # apt-get upgrade -s
     [ ... review packages to be upgraded ... ]
     # apt-get upgrade 
     # checkrestart
     [ ... restart services that need to be restarted ... ]
</pre>

<p>
And restart those services whose libraries have been updated if any.  Note:
Read <a href="ch4.en.html#s-security-update">Execute a security update, Section
4.2</a> for more information on library (and kernel) upgrades.
</p>

<p>
The first line will download the list of packages available from your
configured package sources.  The <samp>-s</samp> will do a simulation run, that
is, it will <em>not</em> download or install the packages but rather tell you
which ones should be downloaded/installed.  From the output you can derive
which packages have been fixed by Debian and are available as a security
update.  Sample:
</p>

<pre>
     # apt-get upgrade -s
     Reading Package Lists... Done
     Building Dependency Tree... Done
     2 packages upgraded, 0 newly installed, 0 to remove and 0  not upgraded.
     Inst cvs (1.11.1p1debian-8.1 Debian-Security:3.0/stable)
     Inst libcupsys2 (1.1.14-4.4 Debian-Security:3.0/stable)
     Conf cvs (1.11.1p1debian-8.1 Debian-Security:3.0/stable)
     Conf libcupsys2 (1.1.14-4.4 Debian-Security:3.0/stable)
</pre>

<p>
In this example, you can see that the system needs to be updated with new
<code>cvs</code> and <code>cupsys</code> packages which are being retrieved
from <em>woody's</em> security update archive.  If you want to understand why
these packages are needed, you should go to <code><a
href="http://security.debian.org">http://security.debian.org</a></code> and
check which recent Debian Security Advisories have been published related to
these packages.  In this case, the related DSAs are <code><a
href="http://www.debian.org/security/2003/dsa-233">DSA-233</a></code> (for
<code>cvs</code>) and <code><a
href="http://www.debian.org/security/2003/dsa-232">DSA-232</a></code> (for
<code>cupsys</code>).
</p>

<p>
Notice that you will need to reboot your system if there has been a kernel
upgrade.
</p>

<hr>

<h4><a name="s-update-desktop"></a>10.1.2.2 Checking for updates at the Desktop</h4>

<p>
Since Debian 4.0 <em>lenny</em> Debian provides and installs in a default
installation <code>update-notifier</code>.  This is a GNOME application that
will startup when you enter your Desktop and can be used to keep track of
updates available for your system and install them.  It uses
<code>update-manager</code> for this.
</p>

<p>
In a stable system updates are only available when a security patch is
available or at point releases.  Consequently, if the system is properly
configured to receive security updates as described in <a
href="ch4.en.html#s-security-update">Execute a security update, Section 4.2</a>
and you have a cron task running to update the package information you will be
notified through an icon in the desktop notifcation area.
</p>

<p>
The notification is not intrusive and users are not forced to install updates.
From the notification icon a desktop user (with the administrator's password)
can access a simple GUI to show available updates and install them.
</p>

<p>
This application works by checking the package database and comparing the
system with its contents.  If the package database is updated periodically
through a <code>cron</code> task then the contents of the database will be
newer than the packages installed in the system and the application will notify
you.
</p>

<p>
<code>Apt</code> installs such a task (<code>/etc/cron.d/apt</code>) which will
run based on Apt's configuration (more specifically <em>APT::Periodic</em>).
In the GNOME environment this configuration value can be adjusted by going to
System &gt; Admin &gt; Software origins &gt; Updates, or running
<code>/usr/bin/software-properties</code>.
</p>

<p>
If the system is set to download the packages list daily but not download the
packages themselves your <code>/etc/apt/apt.conf.d/10periodic</code> should
look like this:
</p>

<pre>
     APT::Periodic::Update-Package-Lists &quot;1&quot;;
     APT::Periodic::Download-Upgradeable-Packages &quot;0&quot;;
</pre>

<p>
You can use a different cron task, such as the one installed by
<code>cron-apt</code> (see <a href="#s-cron-apt">Automatically checking for
updates with cron-apt, Section 10.1.2.3</a>).  You can also just manually check
for upgrades using this application.
</p>

<p>
Users of the KDE desktop environment will probably prefer to install
<code>adept</code> and <code>adept-notifier</code> instead which offers a
similar functionality but is not part of the standard installation.
</p>

<hr>

<h4><a name="s-cron-apt"></a>10.1.2.3 Automatically checking for updates with cron-apt</h4>

<p>
Another method for automatic security updates is the use of
<code>cron-apt</code>.  This package provides a tool to update the system at
regular intervals (using a cron job), and can also be configured to send mails
to the system administrator using the local mail transport agent.  It will just
update the package list and download new packages by default but it can be
configured to automatically install new updates.
</p>

<p>
Notice that you might want to check the distribution release, as described in
<a href="ch7.en.html#s-check-releases">Per distribution release check, Section
7.5.3</a>, if you intend to automatically updated your system (even if only
downloading the packages).  Otherwise, you cannot be sure that the downloaded
packages really come from a trusted source.
</p>

<p>
More information is available at the <code><a
href="http://www.debian-administration.org/articles/162">Debian Administration
site</a></code>.
</p>

<hr>

<h4><a name="s-debsecan"></a>10.1.2.4 Automatically checking for security issues with debsecan</h4>

<p>
The <code>debsecan</code> program evaluates the security status of by reporting
both missing security updates and security vulnerabilities.  Unlike
<code>cron-apt</code>, which only provides information related to security
updates available, but this tool obtains information from the security
vulnerability database maintained by the Debian Security Team which includes
also information on vulnerabilities which are not yet fixed through a security
update.  Consequently, it is more efficient at helping administrators track
security vulnerabilities (as described in <a href="#s-track-vulns">Tracking
security vulnerabilities, Section 10.1.1</a>).
</p>

<p>
Upon installing the Debian package <code>debsecan</code>, and if the
administrator consents to it, it will generate a cron task that will make it
run and send the output to a specific user whenever it finds a vulnerable
package.  It will also download the information from the Internet.  The
location of the security database is also part of the questions ask on
installation and are later defined <code>/etc/default/debsecan</code>, it can
be easily adjusted for systems that do not have Internet access so that they
all pull from a local mirror so that there is a single point that access the
vulnerability database.
</p>

<p>
Notice, however, that the Security Team tracks many vulnerabilities including
low-risk issues which might not be fixed through a security update and some
vulnerabilities initially reported as affecting Debian might, later on, upon
investigation, be dismissed.  <code>Debsecan</code> will report on all the
vulnerabilities, which makes it a quite more verbose than the other tools
described above.
</p>

<p>
More information is available at the <code><a
href="http://www.enyo.de/fw/software/debsecan/">author's siste</a></code>.
</p>

<hr>

<h4><a name="s10.1.2.5"></a>10.1.2.5 Other methods for security updates</h4>

<p>
There is also the <code>apticron</code>, which, similarly to
<code>cron-apt</code> will check for updates and send mails to the
administrator.  More information on apticron is available at the <code><a
href="http://www.debian-administration.org/articles/491">Debian Administration
site</a></code>.
</p>

<p>
You might also want to take a look at <code><a
href="http://clemens.endorphin.org/secpack/">secpack</a></code> which is an
unofficial program to do security updates from security.debian.org with
signature checking written by Fruhwirth Clemens.  Or to the Nagios Plugin
<code><a
href="http://www.unixdaemon.net/nagios_plugins.html#check_debian_packages">check_debian_updates.sh</a></code>
written by Dean Wilson.
</p>

<hr>

<h3><a name="s10.1.3"></a>10.1.3 Avoid using the unstable branch</h3>

<p>
Unless you want to dedicate time to patch packages yourself when a
vulnerability arises, you should <em>not</em> use Debian's unstable branch for
production-level systems.  The main reason for this is that there are no
security updates for <em>unstable</em> (see <a
href="ch12.en.html#s-sec-unstable">How is security handled for
<samp>testing</samp> and <samp>unstable</samp>?, Section 12.3.8</a>).
</p>

<p>
The fact is that some security issues might appear in unstable and <em>not</em>
in the <em>stable</em> distribution.  This is due to new functionality
constantly being added to the applications provided there, as well as new
applications being included which might not yet have been thoroughly tested.
</p>

<p>
In order to do security upgrades in the <em>unstable</em> branch, you might
have to do full upgrades to new versions (which might update much more than
just the affected package).  Although there have been some exceptions, security
patches are usually only back ported into the <em>stable</em> branch.  The main
idea being that between updates, <em>no new code</em> should be added, just
fixes for important issues.
</p>

<p>
Notice, however, that you can use the security tracker (as described in <a
href="#s-track-vulns">Tracking security vulnerabilities, Section 10.1.1</a>) to
track known security vulnerabilities affecting this branch.
</p>

<hr>

<h3><a name="s-security-support-testing"></a>10.1.4 Security support for the testing branch</h3>

<p>
If you are using the <em>testing</em> branch, there are some issues that you
must take into account regarding the availability of security updates:
</p>
<ul>
<li>
<p>
When a security fix is prepared, the Security Team backports the patch to
<em>stable</em> (since stable is usually some minor or major versions behind).
Package maintainers are responsible for preparing packages for the
<em>unstable</em> branch, usually based on a new upstream release.  Sometimes
the changes happen at nearly the same time and sometimes one of the releases
gets the security fix before.  Packages for the <em>stable</em> distribution
are more thoroughly tested than <em>unstable</em>, since the latter will in
most cases provide the latest upstream release (which might include new,
unknown bugs).
</p>
</li>
</ul>
<ul>
<li>
<p>
Security updates are available for the <em>unstable</em> branch usually when
the package maintainer makes a new package and for the <em>stable</em> branch
when the Security Team make a new upload and publish a DSA.  Notice that
neither of these change the <em>testing</em> branch.
</p>
</li>
</ul>
<ul>
<li>
<p>
If no (new) bugs are detected in the <em>unstable</em> version of the package,
it moves to <em>testing</em> after several days.  The time this takes is
usually ten days, although that depends on the upload priority of the change
and whether the package is blocked from entering <em>testing</em> by its
dependency relationships.  Note that if the package is blocked from entering
testing the upload priority will not change the time it takes to enter.
</p>
</li>
</ul>

<p>
This behavior might change based on the release state of the distribution.
When a release is almost imminent, the Security Team or package maintainers
might provide updates directly to testing.
</p>

<p>
Additionally, the <code><a
href="http://secure-testing-master.debian.net">Debian Testing Security
Team</a></code> can issue Debian Testing Security Advisories (DTSAs) for
packages in the <em>testing</em> branch if there is an inmediate need to fix a
security issue in that branch and cannot wait for the normal procedure (or the
normal procedure is being blocked by some other packages).
</p>

<p>
Users willing to take advantage of this support should add the following lines
to their <code>/etc/apt/sources.list</code> (instead of the lines described in
<a href="ch4.en.html#s-security-update">Execute a security update, Section
4.2</a>):
</p>

<pre>
         deb http://security.debian.org testing/updates main contrib non-free
     # This line makes it possible to donwload source packages too
         deb-src  http://security.debian.org testing/updates main contrib non-free
</pre>

<p>
For additional information on this support please read the <code><a
href="http://lists.debian.org/debian-devel-announce/2006/05/msg00006.html">announcement</a></code>.
This support officially started in <code><a
href="http://lists.debian.org/debian-devel-announce/2005/09/msg00006.html">September
2005</a></code> in a separate repository and was later integrated into the main
security archive.
</p>

<hr>

<h3><a name="s10.1.5"></a>10.1.5 Automatic updates in a Debian GNU/Linux system</h3>

<p>
First of all, automatic updates are not fully recommended, since administrators
should review the DSAs and understand the impact of any given security update.
</p>

<p>
If you want to update your system automatically you should:
</p>
<ul>
<li>
<p>
Configure <code>apt</code> so that those packages that you do not want to
update stay at their current version, either with <code>apt</code>'s
<em>pinning</em> feature or marking them as <em>hold</em> with
<code>dpkg</code> or <code>dselect</code>.
</p>

<p>
To pin the packages under a given release, you must edit
<code>/etc/apt/preferences</code> (see <code>apt_preferences(5)</code>) and
add:
</p>

<pre>
       Package: *
       Pin: release a=stable
       Pin-Priority: 100
</pre>

<p>
FIXME: verify if this configuration is OK.
</p>
</li>
</ul>
<ul>
<li>
<p>
Either use <code>cron-apt</code> as described in <a
href="#s-cron-apt">Automatically checking for updates with cron-apt, Section
10.1.2.3</a> and enable it to install downloaded packages or add a
<code>cron</code> entry yourself so that the update is run daily, for example:
</p>

<pre>
       apt-get update &amp;&amp; apt-get -y upgrade
</pre>

<p>
The <samp>-y</samp> option will have <code>apt</code> assume 'yes' for all the
prompts that might arise during the update.  In some cases, you might want to
use the <samp>--trivial-only</samp> option instead of the
<samp>--assume-yes</samp> (equivalent to <samp>-y</samp>).[<a
href="footnotes.en.html#f66" name="fr66">66</a>]
</p>
</li>
</ul>
<ul>
<li>
<p>
Configure <code>debconf</code> so no questions will be asked during upgrades,
so that they can be done non-interactively.  [<a href="footnotes.en.html#f67"
name="fr67">67</a>]
</p>
</li>
</ul>
<ul>
<li>
<p>
Check the results of the <code>cron</code> execution, which will be mailed to
the superuser (unless changed with <samp>MAILTO</samp> environment variable in
the script).
</p>
</li>
</ul>

<p>
A safer alternative might be to use the <samp>-d</samp> (or
<samp>--download-only</samp>) option, which will download but not install the
necessary packages.  Then if the <code>cron</code> execution shows that the
system needs to be updated, it can be done manually.
</p>

<p>
In order to accomplish any of these tasks, the system must be properly
configured to download security updates as discussed in <a
href="ch4.en.html#s-security-update">Execute a security update, Section
4.2</a>.
</p>

<p>
However, this is not recommended for <em>unstable</em> without careful
analysis, since you might bring your system into an unusable state if some
serious bug creeps into an important package and gets installed in your system.
<em>Testing</em> is slightly more <em>secure</em> with regard to this issue,
since serious bugs have a better chance of being detected before the package is
moved into the testing branch (although, you may have <em>no</em> security
updates available whatsoever).
</p>

<p>
If you have a mixed distribution, that is, a <em>stable</em> installation with
some packages updated to <em>testing</em> or <em>unstable</em>, you can fiddle
with the pinning preferences as well as the <samp>--target-release</samp>
option in <code>apt-get</code> to update <em>only</em> those packages that you
have updated.[<a href="footnotes.en.html#f68" name="fr68">68</a>]
</p>

<hr>

<h2><a name="s-periodic-integrity"></a>10.2 Do periodic integrity checks</h2>

<p>
Based on the baseline information you generated after installation (i.e.  the
snapshot described in <a href="ch4.en.html#s-snapshot">Taking a snapshot of the
system, Section 4.18</a>), you should be able to do an integrity check from
time to time.  An integrity check will be able to detect filesystem
modifications made by an intruder or due to a system administrators mistake.
</p>

<p>
Integrity checks should be, if possible, done offline.[<a
href="footnotes.en.html#f69" name="fr69">69</a>] That is, without using the
operating system of the system to review, in order to avoid a false sense of
security (i.e.  false negatives) produced by, for example, installed rootkits.
The integrity database that the system is checked against should also be used
from read-only media.
</p>

<p>
You can consider doing integrity checks online using any of the filesystem
integrity tools available (described in <a
href="ch4.en.html#s-check-integ">Checking file system integrity, Section
4.16.3</a>) if taking offline the system is not an option.  However, precaution
should be taken to use a read-only integrity database and also assure that the
integrity checking tool (and the operating system kernel) has not been tampered
with.
</p>

<p>
Some of the tools mentioned in the integrity tools section, such as
<code>aide</code>, <code>integrit</code> or <code>samhain</code> are already
prepared to do periodic reviews (through the crontab in the first two cases and
through a standalone daemon in <code>samhain</code>) and can warn the
administrator through different channels (usually e-mail, but
<code>samhain</code> can also send pages, SNMP traps or syslog alerts) when the
filesystem changes.
</p>

<p>
Of course, if you execute a security update of the system, the snapshot taken
for the system should be re-taken to accommodate the changes done by the
security update.
</p>

<hr>

<h2><a name="s-intrusion-detect"></a>10.3 Set up Intrusion Detection</h2>

<p>
Debian GNU/Linux includes tools for intrusion detection, which is the practice
of detecting inappropriate or malicious activity on your local system, or other
systems in your private network.  This kind of defense is important if the
system is very critical or you are truly paranoid.  The most common approaches
to intrusion detection are statistical anomaly detection and pattern-matching
detection.
</p>

<p>
Always be aware that in order to really improve the system's security with the
introduction of any of these tools, you need to have an alert+response
mechanism in place.  Intrusion detection is a waste of time if you are not
going to alert anyone.
</p>

<p>
When a particular attack has been detected, most intrusion detection tools will
either log the event with <code>syslogd</code> or send e-mail to the root user
(the mail recipient is usually configurable).  An administrator has to properly
configure the tools so that false positives do not trigger alerts.  Alerts may
also indicate an ongoing attack and might not be useful, say, one day later,
since the attack might have already succeeded.  So be sure that there is a
proper policy on handling alerts and that the technical mechanisms to implement
this policy are in place.
</p>

<p>
An interesting source of information is <code><a
href="http://www.cert.org/tech_tips/intruder_detection_checklist.html">CERT's
Intrusion Detection Checklist</a></code>
</p>

<hr>

<h3><a name="s10.3.1"></a>10.3.1 Network based intrusion detection</h3>

<p>
Network based intrusion detection tools monitor the traffic on a network
segment and use this information as a data source.  Specifically, the packets
on the network are examined, and they are checked to see if they match a
certain signature.
</p>

<p>
<code>snort</code> is a flexible packet sniffer or logger that detects attacks
using an attack signature dictionary.  It detects a variety of attacks and
probes, such as buffer overflows, stealth port scans, CGI attacks, SMB probes,
and much more.  <code>snort</code> also has real-time alerting capability.  You
can use <code>snort</code> for a range of hosts on your network as well as for
your own host.  This is a tool which should be installed on every router to
keep an eye on your network.  Just install it with <samp>apt-get install
snort</samp>, follow the questions, and watch it log.  For a little broader
security framework, see <code><a
href="http://www.prelude-ids.org">Prelude</a></code>.
</p>

<p>
Debian's <code>snort</code> package has many security checks enabled by
default.  However, you should customize the setup to take into account the
particular services you run on your system.  You may also want to seek
additional checks specific to these services.
</p>

<p>
There are other, simpler tools that can be used to detect network attacks.
<code>portsentry</code> is an interesting package that can tip you off to port
scans against your hosts.  Other tools like <code>ippl</code> or
<code>iplogger</code> will also detect some IP (TCP and ICMP) attacks, even if
they do not provide the kind of advanced techniques <code>snort</code> does.
</p>

<p>
You can test any of these tools with the Debian package <code>idswakeup</code>,
a shell script which generates false alarms, and includes many common attack
signatures.
</p>

<hr>

<h3><a name="s10.3.2"></a>10.3.2 Host based intrusion detection</h3>

<p>
Host based intrusion detection involves loading software on the system to be
monitored which uses log files and/or the systems auditing programs as a data
source.  It looks for suspicious processes, monitors host access, and may even
monitor changes to critical system files.
</p>

<p>
<code>tiger</code> is an older intrusion detection tool which has been ported
to Debian since the Woody branch.  <code>tiger</code> provides checks of common
issues related to security break-ins, like password strength, file system
problems, communicating processes, and other ways root might be compromised.
This package includes new Debian-specific security checks including: MD5sums
checks of installed files, locations of files not belonging to packages, and
analysis of local listening processes.  The default installation sets up
<code>tiger</code> to run each day, generating a report that is sent to the
superuser about possible compromises of the system.
</p>

<p>
Log analysis tools, such as <code>logcheck</code> can also be used to detect
intrusion attempts.  See <a href="ch4.en.html#s-custom-logcheck">Using and
customizing <code>logcheck</code>, Section 4.12.1</a>.
</p>

<p>
In addition, packages which monitor file system integrity (see <a
href="ch4.en.html#s-check-integ">Checking file system integrity, Section
4.16.3</a>) can be quite useful in detecting anomalies in a secured
environment.  It is most likely that an effective intrusion will modify some
files in the local file system in order to circumvent local security policy,
install Trojans, or create users.  Such events can be detected with file system
integrity checkers.
</p>

<hr>

<h2><a name="s10.4"></a>10.4 Avoiding root-kits</h2>

<hr>

<h3><a name="s-LKM"></a>10.4.1 Loadable Kernel Modules (LKM)</h3>

<p>
Loadable kernel modules are files containing dynamically loadable kernel
components used to expand the functionality of the kernel.  The main benefit of
using modules is the ability to add additional devices, like an Ethernet or
sound card, without patching the kernel source and recompiling the entire
kernel.  However, crackers are now using LKMs for root-kits (knark and adore),
opening up back doors in GNU/Linux systems.
</p>

<p>
LKM back doors are more sophisticated and less detectable than traditional
root-kits.  They can hide processes, files, directories and even connections
without modifying the source code of binaries.  For example, a malicious LKM
can force the kernel into hiding specific processes from <code>procfs</code>,
so that even a known good copy of the binary <code>ps</code> would not list
accurate information about the current processes on the system.
</p>

<hr>

<h3><a name="s10.4.2"></a>10.4.2 Detecting root-kits</h3>

<p>
There are two approaches to defending your system against LKM root-kits, a
proactive defense and a reactive defense.  The detection work can be simple and
painless, or difficult and tiring, depending on the approach taken.
</p>

<hr>

<h4><a name="s-proactive"></a>10.4.2.1 Proactive defense</h4>

<p>
The advantage of this kind of defense is that it prevents damage to the system
in the first place.  One such strategy is <em>getting there first</em>, that
is, loading an LKM designed to protect the system from other malicious LKMs.  A
second strategy is to remove capabilities from the kernel itself.  For example,
you can remove the capability of loadable kernel modules entirely.  Note,
however, that there are rootkits which might work even in this case, there are
some that tamper with <code>/dev/kmem</code> (kernel memory) directly to make
themselves undetectable.
</p>

<p>
Debian GNU/Linux has a few packages that can be used to mount a proactive
defense:
</p>
<ul>
<li>
<p>
<code>lcap</code> - A user friendly interface to remove <em>capabilities</em>
(kernel-based access control) in the kernel, making the system more secure.
For example, executing <samp>lcap CAP_SYS_MODULE</samp> [<a
href="footnotes.en.html#f70" name="fr70">70</a>] will remove module loading
capabilities (even for the root user).[<a href="footnotes.en.html#f71"
name="fr71">71</a>] There is some (old) information on capabilities at Jon
Corbet's <code><a href="http://lwn.net/1999/1202/kernel.php3">Kernel
development</a></code> section on LWN (dated December 1999).
</p>
</li>
</ul>

<p>
If you don't really need many kernel features on your GNU/Linux system, you may
want to disable loadable modules support during kernel configuration.  To
disable loadable module support, just set CONFIG_MODULES=n during the
configuration stage of building your kernel, or in the <code>.config</code>
file.  This will prevent LKM root-kits, but you lose this powerful feature of
the Linux kernel.  Also, disabling loadable modules can sometimes overload the
kernel, making loadable support necessary.
</p>

<hr>

<h4><a name="s10.4.2.2"></a>10.4.2.2 Reactive defense</h4>

<p>
The advantage of a reactive defense is that it does not overload system
resources.  It works by comparing the system call table with a known clean copy
in a disk file, <code>System.map</code>.  Of course, a reactive defense will
only notify the system administrator after the system has already been
compromised.
</p>

<p>
Detection of some root-kits in Debian can be accomplished with the
<code>chkrootkit</code> package.  The <code><a
href="http://www.chkrootkit.org">Chkrootkit</a></code> program checks for signs
of several known root-kits on the target system, but is not a definitive test.
</p>

<hr>

<h2><a name="s10.5"></a>10.5 Genius/Paranoia Ideas &mdash; what you could do</h2>

<p>
This is probably the most unstable and funny section, since I hope that some of
the &quot;duh, that sounds crazy&quot; ideas might be realized.  The following
are just some ideas for increasing security &mdash; maybe genius, paranoid,
crazy or inspired depending on your point of view.
</p>
<ul>
<li>
<p>
Playing around with Pluggable Authentication Modules (PAM).  As quoted in the
Phrack 56 PAM article, the nice thing about PAM is that &quot;You are limited
only by what you can think of.&quot; It is true.  Imagine root login only being
possible with fingerprint or eye scan or cryptocard (why did I use an OR
conjunction instead of AND?).
</p>
</li>
</ul>
<ul>
<li>
<p>
Fascist Logging.  I would refer to all the previous logging discussion above as
&quot;soft logging&quot;.  If you want to perform real logging, get a printer
with fanfold paper, and send all logs to it.  Sounds funny, but it's reliable
and it cannot be tampered with or removed.
</p>
</li>
</ul>
<ul>
<li>
<p>
CD distribution.  This idea is very easy to realize and offers pretty good
security.  Create a hardened Debian distribution, with proper firewall rules.
Turn it into a boot-able ISO image, and burn it on a CDROM.  Now you have a
read-only distribution, with about 600 MB space for services.  Just make sure
all data that should get written is done over the network.  It is impossible
for intruders to get read/write access on this system, and any changes an
intruder does make can be disabled with a reboot of the system.
</p>
</li>
</ul>
<ul>
<li>
<p>
Switch module capability off.  As discussed earlier, when you disable the usage
of kernel modules at kernel compile time, many kernel based back doors are
impossible to implement because most are based on installing modified kernel
modules.
</p>
</li>
</ul>
<ul>
<li>
<p>
Logging through serial cable (contributed by Gaby Schilders).  As long as
servers still have serial ports, imagine having one dedicated logging system
for a number of servers.  The logging system is disconnected from the network,
and connected to the servers via a serial-port multiplexer (Cyclades or the
like).  Now have all your servers log to their serial ports, write only.  The
log-machine only accepts plain text as input on its serial ports and only
writes to a log file.  Connect a CD/DVD-writer, and transfer the log file to it
when the log file reaches the capacity of the media.  Now if only they would
make CD writers with auto-changers...  Not as hard copy as direct logging to a
printer, but this method can handle larger volumes and CD-ROMs use less storage
space.
</p>
</li>
</ul>
<ul>
<li>
<p>
Change file attributes using <code>chattr</code> (taken from the Tips-HOWTO,
written by Jim Dennis).  After a clean install and initial configuration, use
the <code>chattr</code> program with the <samp>+i</samp> attribute to make
files unmodifiable (the file cannot be deleted, renamed, linked or written to).
Consider setting this attribute on all the files in <code>/bin</code>,
<code>/sbin/</code>, <code>/usr/bin</code>, <code>/usr/sbin</code>,
<code>/usr/lib</code> and the kernel files in root.  You can also make a copy
of all files in <code>/etc/</code>, using <code>tar</code> or the like, and
mark the archive as immutable.
</p>

<p>
This strategy will help limit the damage that you can do when logged in as
root.  You won't overwrite files with a stray redirection operator, and you
won't make the system unusable with a stray space in a <code>rm -fr</code>
command (you might still do plenty of damage to your data &mdash; but your
libraries and binaries will be safer).
</p>

<p>
This strategy also makes a variety of security and denial of service (DoS)
exploits either impossible or more difficult (since many of them rely on
overwriting a file through the actions of some SETUID program that <em>isn't
providing an arbitrary shell command</em>).
</p>

<p>
One inconvenience of this strategy arises during building and installing
various system binaries.  On the other hand, it prevents the <code>make
install</code> from over-writing the files.  When you forget to read the
Makefile and <code>chattr -i</code> the files that are to be overwritten, (and
the directories to which you want to add files) - the make command fails, and
you just use the <code>chattr</code> command and rerun it.  You can also take
that opportunity to move your old bin's and libs out of the way, into a .old/
directory or tar archive for example.
</p>

<p>
Note that this strategy also prevents you from upgrading your system's
packages, since the files updated packages provide cannot be overwritten.  You
might want to have a script or other mechanism to disable the immutable flag on
all binaries right before doing an <code>apt-get update</code>.
</p>
</li>
</ul>
<ul>
<li>
<p>
Play with UTP cabling in a way that you cut 2 or 4 wires and make the cable
one-way traffic only.  Then use UDP packets to send information to the
destination machine which can act as a secure log server or a credit card
storage system.
</p>
</li>
</ul>

<hr>

<h3><a name="s10.5.1"></a>10.5.1 Building a honeypot</h3>

<p>
A honeypot is a system designed to teach system administrators how crackers
probe for and exploit a system.  It is a system setup with the expectation and
goal that the system will be probed, attacked and potentially exploited.  By
learning the tools and methods employed by the cracker, a system administrator
can learn to better protect their own systems and network.
</p>

<p>
Debian GNU/Linux systems can easily be used to setup a honeynet, if you
dedicate the time to implement and monitor it.  You can easily setup the fake
honeypot server as well as the firewall[<a href="footnotes.en.html#f72"
name="fr72">72</a>] that controls the honeynet and some sort of network
intrusion detector, put it on the Internet, and wait.  Do take care that if the
system is exploited, you are alerted in time (see <a
href="ch4.en.html#s-log-alerts">The importance of logs and alerts, Section
4.12</a>) so that you can take appropriate measures and terminate the
compromise when you've seen enough.  Here are some of the packages and issues
to consider when setting up your honeypot:
</p>
<ul>
<li>
<p>
The firewall technology you will use (provided by the Linux kernel).
</p>
</li>
</ul>
<ul>
<li>
<p>
<code>syslog-ng</code>, useful for sending logs from the honeypot to a remote
syslog server.
</p>
</li>
</ul>
<ul>
<li>
<p>
<code>snort</code>, to set up capture of all the incoming network traffic to
the honeypot and detect the attacks.
</p>
</li>
</ul>
<ul>
<li>
<p>
<code>osh</code>, a SETUID root, security enhanced, restricted shell with
logging (see Lance Spitzner's article below).
</p>
</li>
</ul>
<ul>
<li>
<p>
Of course, all the daemons you will be using for your fake server honeypot.
Depending on what type of attacker you want to analyse you will or will
<em>not</em> harden the honeypot and keep it up to date with security patches.
</p>
</li>
</ul>
<ul>
<li>
<p>
Integrity checkers (see <a href="ch4.en.html#s-check-integ">Checking file
system integrity, Section 4.16.3</a>) and The Coroner's Toolkit
(<code>tct</code>) to do post-attack audits.
</p>
</li>
</ul>
<ul>
<li>
<p>
<code>honeyd</code> and <code>farpd</code> to setup a honeypot that will listen
to connections to unused IP addresses and forward them to scripts simulating
live services.  Also check out <code>iisemulator</code>.
</p>
</li>
</ul>
<ul>
<li>
<p>
<code>tinyhoneypot</code> to setup a simple honeypot server with fake services.
</p>
</li>
</ul>

<p>
If you cannot use spare systems to build up the honeypots and the network
systems to protect and control it you can use the virtualisation technology
available in <code>xen</code> or <code>uml</code> (User-Mode-Linux).  If you
take this route you will need to patch your kernel with either
<code>kernel-patch-xen</code> or <code>kernel-patch-uml</code>.
</p>

<p>
You can read more about building honeypots in Lanze Spitzner's excellent
article <code><a
href="http://www.net-security.org/text/articles/spitzner/honeypot.shtml">To
Build a Honeypot</a></code> (from the Know your Enemy series).  Also, the
<code><a href="http://project.honeynet.org/">Honeynet Project</a></code>
provides valuable information about building honeypots and auditing the attacks
made on them.
</p>

<hr>

<p>
[ <a href="ch9.en.html">previous</a> ]
[ <a href="index.en.html#contents">Contents</a> ]
[ <a href="ch1.en.html">1</a> ]
[ <a href="ch2.en.html">2</a> ]
[ <a href="ch3.en.html">3</a> ]
[ <a href="ch4.en.html">4</a> ]
[ <a href="ch-sec-services.en.html">5</a> ]
[ <a href="ch-automatic-harden.en.html">6</a> ]
[ <a href="ch7.en.html">7</a> ]
[ <a href="ch-sec-tools.en.html">8</a> ]
[ <a href="ch9.en.html">9</a> ]
[ 10 ]
[ <a href="ch-after-compromise.en.html">11</a> ]
[ <a href="ch12.en.html">12</a> ]
[ <a href="ap-harden-step.en.html">A</a> ]
[ <a href="ap-checklist.en.html">B</a> ]
[ <a href="ap-snort-box.en.html">C</a> ]
[ <a href="ap-bridge-fw.en.html">D</a> ]
[ <a href="ap-bind-chuser.en.html">E</a> ]
[ <a href="ap-fw-security-update.en.html">F</a> ]
[ <a href="ap-chroot-ssh-env.en.html">G</a> ]
[ <a href="ap-chroot-apache-env.en.html">H</a> ]
[ <a href="ch-after-compromise.en.html">next</a> ]
</p>

<hr>

<p>
Securing Debian Manual
</p>

<address>
Version: 3.13, Sun, 08 Apr 2012 02:48:09 +0000<br>
<br>
Javier Fern&aacute;ndez-Sanguino Pe&ntilde;a <code><a href="mailto:jfs@debian.org">jfs@debian.org</a></code><br>
<a href="ch1.en.html#s-authors">Authors, Section 1.1</a><br>
<br>
</address>
<hr>

</body>

</html>

