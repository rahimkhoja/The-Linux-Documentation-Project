<HTML
><HEAD
><TITLE
>Upgrade Red Hat distribution</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="Remote Serial Console HOWTO"
HREF="index.html"><LINK
REL="UP"
TITLE="Upgrading Red Hat Linux from a
  serial console"
HREF="rhl.html"><LINK
REL="PREVIOUS"
TITLE="Record LILO configuration"
HREF="rhl-liloconfig.html"><LINK
REL="NEXT"
TITLE="Create boot disk for serial console"
HREF="rhbootdisk.html"></HEAD
><BODY
CLASS="SECTION"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Remote Serial Console HOWTO</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="rhl-liloconfig.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Appendix C. Upgrading <SPAN
CLASS="PRODUCTNAME"
>Red Hat Linux</SPAN
> from a
  serial console</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="rhbootdisk.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECTION"
><H1
CLASS="SECTION"
><A
NAME="RHL-UPGRADE"
></A
>C.8. Upgrade Red Hat distribution</H1
><P
>In this section it all comes together.  We will walk through
    an entire serial console upgrade, not that it differs much from a
    standard text mode upgrade.</P
><P
>Configure <SPAN
CLASS="ACRONYM"
>BIOS</SPAN
> to boot from floppy or
    insert the floppy disk. Now reboot the machine.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3887"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
><TT
CLASS="PROMPT"
>bash#</TT
> <B
CLASS="COMMAND"
>shutdown -r now</B
>
<TT
CLASS="COMPUTEROUTPUT"
>SYSLINUX 1.64 1.64-pre2   Copyright (C) 1994-2001 H. Peter Anvin
                Welcome to Red Hat Linux 7.1!
 -  To install or upgrade Red Hat Linux in graphical mode, 
    press the &#60;ENTER&#62; key.
 -  To install or upgrade Red Hat Linux in text mode, type: text &#60;ENTER&#62;.
 -  To enable low resolution mode, type: lowres &#60;ENTER&#62;.  
    Press &#60;F2&#62; for more information about low resolution mode.
 -  To disable framebuffer mode, type: nofb &#60;ENTER&#62;.  
    Press &#60;F2&#62; for more information about disabling framebuffer mode.
 -  To enable expert mode, type: expert &#60;ENTER&#62;.  
    Press &#60;F3&#62; for more information about expert mode.
 -  To enable rescue mode, type: linux rescue &#60;ENTER&#62;.  
    Press &#60;F5&#62; for more information about rescue mode.
 -  If you have a driver disk, type: linux dd &#60;ENTER&#62;.
 -  Use the function keys listed below for more information.
[F1-Main] [F2-General] [F3-Expert] [F4-Kernel] [F5-Rescue]
boot: 
Loading initrd.img..............
Loading vmlinuz............. ready.
Linux version 2.4.2-2BOOT (root@porky.devel.redhat.com) (gcc version 2.96 20000731 (Red Hat Linux 7.1 2.96-79)) #1 Sun Apr 8 18:24:33 EDT 2001</TT
></PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>Because we have booted into expert mode, the menus differ
   slightly from the standard upgrade.  For example, you probably
   don't have a driver disk.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3893"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
> Welcome to Red Hat Linux
+----------+ Devices +-----------+
|                                |
| Do you have a driver disk?     |
|                                |
|    +-----+          +----+     |
|    | Yes |          |[No]|     |
|    +-----+          +----+     |
|                                |
+--------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>The upgrade then continues in the usual fashion.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3896"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+--------+ Choose a Language +---------+
|                                      |
| What language should be used during  |
| the installation process?            |
|                                      |
|            Czech       :             |
|          [ English     : ]           |
|            Danish      :             |
|            French      :             |
|            German      :             |
|            Hungarian   :             |
|            Icelandic   :             |
|            Italian     :             |
|                                      |
|               +----+                 |
|               |[OK]|                 |
|               +----+                 |
|                                      |
+--------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>Select <SPAN
CLASS="GUIMENUITEM"
>HTTP</SPAN
> to upgrade from the
   web server we prepared previously.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3900"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+-----+ Installation Method +------+
|                                  |
| What type of media contains the  |
| packages to be installed?        |
|                                  |
|            NFS image             |
|            FTP                   |
|          [ HTTP ]                |
|                                  |
|     +----+         +------+      |
|     |[OK]|         | Back |      |
|     +----+         +------+      |
|                                  |
+----------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>Here we supply the network details recorded in <A
HREF="rhl-ifconfig.html#RHL-IFCONFIG-IFCONFIG"
>Example C-1</A
>.  If your network supports Dynamic
   Host Configuration Protocol or the Bootstrap Protocol then these
   work fine too.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="RHL-UPGRADE-IPADDR"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+--------------------+ Configure TCP/IP +--------------------+
|                                                            |
| Please enter the IP configuration for this machine. Each   |
| item should be entered as an IP address in dotted-decimal  |
| notation (for example, 1.2.3.4).                           |
|                                                            |
|       [ ] Use dynamic IP configuration (BOOTP/DHCP)        |
|                                                            |
|           IP address:           10.1.2.3________           |
|           Netmask:              255.255.255.0___           |
|           Default gateway (IP): 10.1.2.254______           |
|           Primary nameserver:   10.255.1.1______           |
|                                                            |
|            +----+                      +------+            |
|            |[OK]|                      | Back |            |
|            +----+                      +------+            |
|                                                            |
+------------------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>Provide the name of the pre-prepared web server.  Note that
   the response to <SPAN
CLASS="GUIMENUITEM"
>Red Hat directory</SPAN
> must
   start with a <TT
CLASS="FILENAME"
>/</TT
>.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3909"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+-----------------+ HTTP Setup +-----------------------------------+
|                                                                  |
| Please enter the following information:                          |
|                                                                  |
|     o the name or IP number of your web server                   |
|     o the directory on that server containing                    |
|       Red Hat Linux for your architecure                         |
|                                                                  |
|   Web site name:     www.example.edu.au_______________________   |
|   Red Hat directory: /redhat/linux/7.1-20020202/en/os/i386____   |
|                                                                  |
|         +----+                 +------+                          |
|         |[OK]|                 | Back |                          |
|         +----+                 +------+                          |
|                                                                  |
+------------------------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>The following status messages then fly by before the welcome
   screen appears.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3912"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
><SPAN
CLASS="GUILABEL"
>Retrieving base/netstg1.img...</SPAN
>
<SPAN
CLASS="GUILABEL"
>Loading /mnt/runtime ramdisk...</SPAN
>
<SPAN
CLASS="GUILABEL"
>Retrieving base/netstg2.img...</SPAN
>
<SPAN
CLASS="GUILABEL"
>Loading /mnt/runtime/usr ramdisk...</SPAN
>
<SPAN
CLASS="GUILABEL"
>Running anaconda - please wait...</SPAN
>
<SPAN
CLASS="GUILABEL"
>Graphical installation not available for http installs.  Starting text mode.</SPAN
></PRE
></FONT
></TD
></TR
></TABLE
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+----------------+ Red Hat Linux +-----------------+
|                                                  |
| Welcome to Red Hat Linux!                        |
|                                                  |
| This installation process is outlined in detail  |
| in the Official Red Hat Linux Installation       |
| Guide available from Red Hat Software. If you    |
| have access to this manual, you should read the  |
| installation section before continuing.          |
|                                                  |
| If you have purchased Official Red Hat Linux,    |
| be sure to register your purchase through our    |
| web site, http://www.redhat.com/.                |
|                                                  |
|         +----+                 +------+          |
|         |[OK]|                 | Back |          |
|         +----+                 +------+          |
|                                                  |
+--------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>Select <SPAN
CLASS="GUIMENUITEM"
>Upgrade Existing
   Installation</SPAN
>, although this procedure works fine for
   installations as well.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3923"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+--------------+ Installation Type +--------------+
|                                                 |
| What type of system would you like to install?  |
|                                                 |
|          Workstation                            |
|          Server System                          |
|          Laptop                                 |
|          Custom System                          |
|        [ Upgrade Existing Installation ]        |
|                                                 |
|         +----+                +------+          |
|         | OK |                | Back |          |
|         +----+                +------+          |
|                                                 |
+-------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>The upgrade continues.  When the <SPAN
CLASS="GUIMENU"
>LILO
   Configuration</SPAN
> screen appears insert the kernel parameters
   recorded from <A
HREF="rhl-liloconfig.html#RHL-LILOCONFIG-LILO"
>Example C-2</A
>.  These
   parameters should include
   <TT
CLASS="LITERAL"
>console=ttyS&#8230;</TT
>.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3929"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+---------------------+ LILO Configuration +---------------------+
|                                                                |
| A few systems will need to pass special options to the kernel  |
| at boot time for the system to function properly. If you need  |
| to pass boot options to the kernel, enter them now. If you     |
| don't need any or aren't sure, leave this blank.               |
|                                                                |
|       [ ] Use linear mode (needed for some SCSI drives)        |
|                                                                |
|        console=tty0 console=ttyS0,9600n8_______________        |
|                                                                |
|       +----+              +------+             +------+        |
|       | OK |              | Skip |             | Back |        |
|       +----+              +------+             +------+        |
|                                                                |
+----------------------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3931"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+-------------+ LILO Configuration +--------------+
|                                                 |
|  Where do you want to install the bootloader?   |
|                                                 |
|[/dev/hda         Master Boot Record (MBR)      ]|
| /dev/hda1        First sector of boot partition |
|                                                 |
|         +----+                +------+          |
|         | OK |                | Back |          |
|         +----+                +------+          |
|                                                 |
+-------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3933"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+----------------------+ LILO Configuration +-----------------------+
|                                                                   |
| The boot manager Red Hat uses can boot other operating systems    |
| as well. You need to tell me what partitions you would like to    |
| be able to boot and what label you want to use for each of them.  |
|                                                                   |
| Device      Partition type            Default Boot label          |
|[/dev/hda6   Linux Native              *       linux     ] :       |
|                                                           :       |
|                                                           :       |
|                                                           :       |
|                                                           :       |
|                                                                   |
|        +----+              +------+              +------+         |
|        | Ok |              | Edit |              | Back |         |
|        +----+              +------+              +------+         |
|                                                                   |
|                                                                   |
+-------------------------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>The upgrade continues.  As installing the packages may take a
   few hours, you can disconnect.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3936"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+-------------+ Package Installation +--------------+
|                                                   |
| Name   :                                          |
| Size   :                                          |
| Summary:                                          |
|                                                   |
|                  Packages       Bytes        Time |
| Total    :              0         0M              |
| Completed:              0         0M              |
| Remaining:              0         0M              |
|                                                   |
|                                                   |
+---------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>If you disconnected, then when reconnecting it is best to
   press <B
CLASS="KEYCAP"
>Tab</B
> rather than pressing
   <B
CLASS="KEYCAP"
>Return</B
>.</P
><P
>Pressing <B
CLASS="KEYCAP"
>Return</B
> on the
   <SPAN
CLASS="GUIMENU"
>Bootdisk</SPAN
> screen writes a boot disk.  This will
   overwrite the upgrade disk.</P
><P
>You may wish to deliberately create a boot disk if you cannot
   alter the <SPAN
CLASS="ACRONYM"
>BIOS</SPAN
> parameters to boot from the hard
   disk, or if you cannot wait for someone to eject the floppy disk
   before rebooting.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3946"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+------------------+ Bootdisk +-------------------+
|                                                 |
| A custom boot disk provides a way of booting    |
| into your Linux system without depending on     |
| the normal bootloader. This is useful if you    |
| don't want to install lilo on your system,      |
| another operating system removes lilo, or lilo  |
| doesn't work with your hardware configuration.  |
| A custom boot disk can also be used with the    |
| Red Hat rescue image, making it much easier to  |
| recover from severe system failures.            |
|                                                 |
| Would you like to create a boot disk for your   |
| system?                                         |
|                                                 |
|         +-----+                 +----+          |
|         |[Yes]|                 | No |          |
|         +-----+                 +----+          |
|                                                 |
+-------------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
><P
>When the <SPAN
CLASS="GUIMENU"
>Complete</SPAN
> screen appears prepare
   to reboot into Linux.  If you have a serial <SPAN
CLASS="ACRONYM"
>BIOS</SPAN
>
   be prepared to alter the <SPAN
CLASS="ACRONYM"
>BIOS</SPAN
> parameters to boot
   from the hard disk first.  If you do not have a serial
   <SPAN
CLASS="ACRONYM"
>BIOS</SPAN
> ask someone to eject the floppy disk.</P
><DIV
CLASS="INFORMALFIGURE"
><A
NAME="AEN3953"
></A
><P
></P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>+-----------------+ Complete +------------------+
|                                               |
| Congratulations, installation is complete.  # |
|                                             : |
| Press return to reboot, and be sure to      : |
| remove your boot medium after the system    : |
| reboots, or your system will rerun the      : |
| install. For information on fixes which     : |
| are available for this release of Red Hat   : |
| Linux, consult the Errata available from    : |
| http://www.redhat.com/errata.               : |
|                                             : |
| Information on configuring and using your   : |
| Red Hat Linux system is contained in the    : |
|                                               |
|                    +----+                     |
|                    |[OK]|                     |
|                    +----+                     |
|                                               |
+-----------------------------------------------+</PRE
></FONT
></TD
></TR
></TABLE
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
><TT
CLASS="COMPUTEROUTPUT"
>sending termination signals...done
sending kill signals...done
disabling swap...
	/tmp/swap/hda5
unmounting filesystems...
	/mnt/sysimage/var/www/html
	/mnt/sysimage/boot
	/mnt/sysimage/proc
	/mnt/runtime/usr
	/mnt/sysimage
	/proc/bus/usb
	/mnt/runtime
	/dev/pts
	/proc
rebooting system
Restarting system.

LILO 
Loading linux......................
Linux version 2.4.3-12 (root@porky.devel.redhat.com) (gcc version 2.96 20000731 (Red Hat Linux 7.1 2.96-85)) #1 Fri Jun 8 15:05:56 EDT 2001</TT
></PRE
></FONT
></TD
></TR
></TABLE
><P
></P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="rhl-liloconfig.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="rhbootdisk.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Record LILO configuration</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="rhl.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Create boot disk for serial console</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>