<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>2. Examples for tcpdump packet dumps</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Linux IPv6 HOWTO (en)"><link rel="up" href="ch14.html" title="Chapter 14. Network debugging"><link rel="prev" href="ch14s01.html" title="1. Server socket binding"><link rel="next" href="ch15.html" title="Chapter 15. Support for persistent IPv6 configuration in Linux distributions"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2. Examples for tcpdump packet dumps</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch14s01.html">Prev</a> </td><th width="60%" align="center">Chapter 14. Network debugging</th><td width="20%" align="right"> <a accesskey="n" href="ch15.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="examples-tcpdump"></a>2. Examples for tcpdump packet dumps</h2></div></div></div><p>Here some examples of captured packets are shown, perhaps useful for your own debugging...</p><p>...more coming next...</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idp51081920"></a>2.1. Router discovery</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idp51082592"></a>2.1.1. Router advertisement</h4></div></div></div><pre class="screen">
15:43:49.484751 fe80::212:34ff:fe12:3450 &gt; ff02::1: icmp6: router
¬ advertisement(chlim=64, router_ltime=30, reachable_time=0,
¬ retrans_time=0)(prefix info: AR valid_ltime=30, preffered_ltime=20,
¬ prefix=2002:0102:0304:1::/64)(prefix info: LAR valid_ltime=2592000,
¬ preffered_ltime=604800, prefix=2001:0db8:0:1::/64)(src lladdr:
¬ 0:12:34:12:34:50) (len 88, hlim 255)
</pre><p>Router with link-local address &#8221;fe80::212:34ff:fe12:3450&#8221; send an advertisement to the all-node-on-link multicast address &#8221;ff02::1&#8221; containing two prefixes &#8221;2002:0102:0304:1::/64&#8221; (lifetime 30 s) and &#8221;2001:0db8:0:1::/64&#8221; (lifetime 2592000 s) including its own layer 2 MAC address &#8221;0:12:34:12:34:50&#8221;.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idp51085664"></a>2.1.2. Router solicitation</h4></div></div></div><pre class="screen">
15:44:21.152646 fe80::212:34ff:fe12:3456 &gt; ff02::2: icmp6: router solicitation
¬ (src lladdr: 0:12:34:12:34:56) (len 16, hlim 255)
</pre><p>Node with link-local address &#8221;fe80::212:34ff:fe12:3456&#8221; and layer 2 MAC address &#8221;0:12:34:12:34:56&#8221; is looking for a router on-link, therefore sending this solicitation to the all-router-on-link multicast address &#8221;ff02::2&#8221;.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idp51094288"></a>2.2. Neighbor discovery</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idp51094928"></a>2.2.1. Neighbor discovery solicitation for duplicate address detection</h4></div></div></div><p>Following packets are sent by a node with layer 2 MAC address &#8221;0:12:34:12:34:56&#8221; during autoconfiguration to check whether a potential address is already used by another node on the link sending this to the solicited-node link-local multicast address.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Node wants to configure its link-local address &#8221;fe80::212:34ff:fe12:3456&#8221;, checks for duplicate now</p></li></ul></div><pre class="screen">
15:44:17.712338 :: &gt; ff02::1:ff12:3456: icmp6: neighbor sol: who has
¬ fe80::212:34ff:fe12:3456(src lladdr: 0:12:34:12:34:56) (len 32, hlim 255)
</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Node wants to configure its global address &#8221;2002:0102:0304:1:212:34ff:fe12:3456&#8221; (after receiving advertisement shown above), checks for duplicate now</p></li></ul></div><pre class="screen">
15:44:21.905596 :: &gt; ff02::1:ff12:3456: icmp6: neighbor sol: who has
¬ 2002:0102:0304:1:212:34ff:fe12:3456(src lladdr: 0:12:34:12:34:56) (len 32,
¬ hlim 255)
</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Node wants to configure its global address &#8221;2001:0db8:0:1:212:34ff:fe12:3456&#8221; (after receiving advertisement shown above), checks for duplicate now</p></li></ul></div><pre class="screen">
15:44:22.304028 :: &gt; ff02::1:ff12:3456: icmp6: neighbor sol: who has
¬ 2001:0db8:0:1:212:34ff:fe12:3456(src lladdr: 0:12:34:12:34:56) (len 32, hlim
¬ 255)
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idp51101424"></a>2.2.2. Neighbor discovery solicitation for looking for host or gateway</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Node wants to send packages to &#8221;2001:0db8:0:1::10&#8221; but has no layer 2 MAC address to send packet, so send solicitation now</p></li></ul></div><pre class="screen">
13:07:47.664538 2002:0102:0304:1:2e0:18ff:fe90:9205 &gt; ff02::1:ff00:10: icmp6:
¬ neighbor sol: who has 2001:0db8:0:1::10(src lladdr: 0:e0:18:90:92:5) (len 32,
¬ hlim 255)
</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Node looks for &#8221;fe80::10&#8221; now</p></li></ul></div><pre class="screen">
13:11:20.870070 fe80::2e0:18ff:fe90:9205 &gt; ff02::1:ff00:10: icmp6: neighbor
¬ sol: who has fe80::10(src lladdr: 0:e0:18:90:92:5) (len 32, hlim 255)
</pre></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch14s01.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch14.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch15.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">1. Server socket binding </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 15. Support for persistent IPv6 configuration in Linux distributions</td></tr></table></div></body></html>
