<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML
><HEAD
><TITLE
>Troubleshooting</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="The Linux 2.4 SCSI subsystem HOWTO"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Changes during the lk 2.4 series"
HREF="chg24.html"><LINK
REL="NEXT"
TITLE="Performance, Test and Debugging tools"
HREF="perform.html"></HEAD
><BODY
CLASS="appendix"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>The Linux 2.4 SCSI subsystem HOWTO</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="chg24.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="perform.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="appendix"
><H1
><A
NAME="trouble"
></A
>Appendix C. Troubleshooting</H1
><P
>&#13;Many SCSI problems are caused by cabling and (lack of, or inappropriate)
termination. This often results in repeated SCSI bus resets, parity
or CRC errors and sometimes reduced transfer speeds. There is a good
SCSI termination tutorial at this site:
<A
HREF="http://www.scsita.org/aboutscsi/SCSI_Termination_Tutorial.html"
TARGET="_top"
>&#13;www.scsita.org/aboutscsi/SCSI_Termination_Tutorial.html</A
>. There is
other useful SCSI information at that site (see <A
HREF="refs.html#W9"
>W9</A
>).
</P
><P
>&#13;There is also a SCSI "faq" site (see <A
HREF="refs.html#W10"
>W10</A
>)
that addresses many configuration and troubleshooting issues. Although
the main focus of this site is Windows (and its ASPI interface), much
is relevant to SCSI in Linux and other Unix implementations.
</P
><P
>&#13;When it looks like something has partially locked up the system, the
<B
CLASS="command"
>ps</B
> command can be useful for finding out what may be
causing the problem. The following options may be useful for identifying what
part of the kernel may be causing the problem. This information could be
forwarded to the maintainers.
<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="programlisting"
>&#13;ps -eo cmd,wchan
ps -eo fname,tty,pid,stat,pcpu,wchan
ps -eo pid,stat,pcpu,nwchan,wchan=WIDE-WCHAN-COLUMN -o args
</PRE
></FONT
></TD
></TR
></TABLE
>
The most interesting option for finding the location of the "hang" is
"wchan". If this is a kernel address then <B
CLASS="command"
>ps</B
> will
use <TT
CLASS="filename"
>/proc/ksyms</TT
> to find the nearest symbolic
location. The "nwchan" option outputs the numerical address of the "hang".
</P
><P
>&#13;If the system is not responding to keystrokes, then &#60;Alt+ScrollLock&#62;
in text mode should output a stack trace while &#60;Ctrl+ScrollLock&#62;
should output a list of all processes. If the log is still working, the
output will be sent there as well as appearing on the console.
</P
><P
>&#13;If the kernel has been built with the CONFIG_MAGIC_SYSRQ, then in text
mode &#60;Alt+SysRq+H&#62; will list available commands. Of these &#60;Alt+SysRq+S&#62;
is useful for doing an emergency sync while &#60;Alt+SysRq+U&#62; will remount
file systems in read only mode. After that &#60;Alt+SysRq+B&#62; to reboot the
machine might be your next move.
</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="chg24.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="perform.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Changes during the lk 2.4 series</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Performance, Test and Debugging tools</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>