<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
 <META http-equiv="Content-Type" content="text/html; charset=iso-8859-9">
 <META NAME="GENERATOR" CONTENT="lfparser_2.50">
 <META NAME="LFCATEGORY" CONTENT="Hardware">
 <link rel="icon" href="../../common/images/lf-16.png" type="image/png">
 <TITLE>lf352, Hardware: GCC libc-1.0.4 ile AVR mikroiþlemcisini programlamak</TITLE>
<style type="text/css">
<!--
 td.top {font-family: Arial,Geneva,Verdana,Helvetica,sans-serif; font-size:12 }
 pre { font-family:monospace,Courier }
 pre.code { font-family:monospace,Courier;background-color:#aedbe8; }
 p.cl { color:#EE9500 }
 table.left { margin-right:0.3cm }
 a.nodec { text-decoration:none }
 p.trans { font-size:8pt; text-align:right }
 p.clbox { width:50%; alignment:center; background-color:#FFD700; 
           border-style:none; border-width:medium; border-color:#FFD700; 
           padding:0.5cm;  text-align:center }
 p.code { width:80%; alignment:center; background-color:#aedbe8; 
          border-style:none; border-width:medium; border-color:#aedbe8; 
          padding:0.1cm;  text-align:left }
 p.foot { background-color:#AAAAAA; color:#FFFFFF; border-style:none; 
          border-width:medium; border-color:#AAAAAA; padding:0.5cm ; 
          margin-top:0.1cm; margin-right:1cm; margin-left:1cm; 
          text-align:center }
 div.tbbutton {
   background: #ddd;
   border-right: 1px solid #aaa;
   border-bottom: 1px solid #aaa;
   margin: 2px 5px 2px 5px;
   text-align: center;
   width: 20em;
   line-height: 1.2em;
   padding: 2px;
   font-size: 12px;
   white-space: nowrap;
   color: #555;
 }
 div.bbutton {
   background: #ddd;
   border-right: 1px solid #aaa;
   border-bottom: 1px solid #aaa;
   float: left;
   margin: 2px 5px 2px 5px;
   text-align: center;
   line-height: 1.2em;
   padding: 2px;
   font-size: 12px;
   white-space: nowrap;
   color: #555;
 }
-->
</style>
 
</HEAD>
<BODY bgcolor="#ffffff" text="#000000">
 <!-- this is generated html code. NEVER use this file for your
 translation work. Instead get the file with the same article number
 and .meta.shtml in its name. Translate this meta file and then
 use lfparser program to generate the final article -->
 <!-- lfparser can be obtained from http://main.linuxfocus.org/~guido/dev/lfparser.html -->

<!-- this is used by a number of tools:
 =LF=AUTHOR: Guido Socher
 =LF=CAT___: Hardware
 =LF=TITLE_: GCC libc-1.0.4 ile AVR mikroiþlemcisini programlamak
 =LF=NUMBER: 352
 =LF=ANAME_: article352.shtml
 =LF=PARSER: 2.50
 -->

<!-- 2pdaIgnoreStart -->

<!-- start navegation bar, current, style=2 -->
 <!-- top navegation bar -->
 <TABLE summary="topbar_1" cellspacing="0" cellpadding="0" border="0" align="center" width="90%">
   <TR bgcolor="#2e2292">
     <TD class="top"><TABLE summary="topbar_1_logo" cellspacing="0" cellpadding="0" border="0" width=
       "100%">
         <TR><TD width="319"><a href="../../index.shtml"><IMG src="../../common/images/logolftop_319x45.gif"
           alt="[LinuxFocus-icon]" width="319" height="45" align="left" 
           border="0"></a></TD>

           <TD class="top">
             <TABLE summary="topbar_1_links" width="100%">
               <TR align="right">
                 <TD class="top">
                 
                 <A class="nodec" href="../../index.shtml"><FONT color=
                 "#DDDDDD" size="2">&lt;--</FONT></A> &nbsp;| 
                 <A class="nodec" href="../map.html"><FONT color=
                 "#DDDDDD" size="2">Eriþimdüzeni</FONT></A> &nbsp;| 
                 <A class="nodec" href="../indice.html"><FONT color=
                 "#DDDDDD" size="2">Ýçindekiler</FONT></A> &nbsp;| 
                 <A class="nodec" href="../Search/index.shtml"><FONT color=
                 "#DDDDDD" size="2">Arama</FONT></A> </TD>
                 
               </TR>

               <TR align="right">
                 <TD class="top">
                   <HR width="100%" noshade size="1">
                 </TD>
               </TR>
             </TABLE>
           </TD>
         </TR>
       </TABLE>
     </TD>
   </TR>
 </TABLE>
 <!-- end top navegation bar -->
 <!-- blue bar -->
 <TABLE summary="topbar_2" cellspacing="0" cellpadding="0" border="0" align="center"
 width="90%">
   <TR bgcolor="#00ffff">
     <TD><IMG src="../../common/images/transpix.gif" width="1" height=
     "2" alt=""></TD>
   </TR>
 </TABLE>
 <!-- end blue bar -->
 <!-- bottom navegation bar -->
 <TABLE summary="topbar_3" cellspacing="0" cellpadding="0" border="0" align="center"
 width="94%">
   <TR bgcolor="#000000">
     <TD>
       <TABLE summary="topbar_3_links" cellspacing="0" cellpadding="1" border="0" width=
       "100%">
         <TR align="center">
           <TD WIDTH="20%"><A class="nodec" href="../News/index.html"><FONT color=
           "#FFFFFF">Duyumlar</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../Archives/"><FONT color=
           "#FFFFFF">Belgelikler</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../Links/index.html"><FONT color=
           "#FFFFFF">Baðlantýlar</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../aboutus.html"><FONT color=
           "#FFFFFF">LF Nedir</FONT></A> </TD>
         </TR>
       </TABLE>
     </TD>
   </TR>
 </TABLE>
 <!-- end bottom navegation bar -->
<!-- stop navegation bar -->

<!-- SSI_INFO -->

<!-- tr_staticssi include virtual -->
<!-- tr_staticssi exec cmd -->
<!-- addedByLfdynahead ver 1.5 --><TABLE ALIGN="right" border=0><TR><TD ALIGN="right"><FONT SIZE="-1" FACE="Arial,Helvetica">Bu makalenin farklý dillerde bulunduðu adresler: <A href="../../English/November2004/article352.shtml">English</a> &nbsp;<A href="../../Castellano/November2004/article352.shtml">Castellano</a> &nbsp;<A href="../../Deutsch/November2004/article352.shtml">Deutsch</a> &nbsp;<A href="../../Francais/November2004/article352.shtml">Francais</a> &nbsp;<A href="../../Italiano/November2004/article352.shtml">Italiano</a> &nbsp;<A href="../../Turkce/November2004/article352.shtml">Turkce</a> &nbsp;</FONT></TD></TR></TABLE><br>
 


<!-- SSI_INFO STOP -->
<!-- 2pdaIgnoreStop -->

<!-- SHORT_BIO_ABOUT_THE_AUTHOR_AND_INDEX_START -->
<TABLE ALIGN="LEFT" BORDER="0" WIDTH="195" summary="about the author" class="left">
<TR>
<TD>

<img src="../../common/images/Guido-S.gif" alt=
    "[Photo of the Author]" height="164" width="173">
<BR>   Guido Socher <a href="http://linuxfocus.org/~guido/"><font size="1">(homepage)</font></a>
<BR><BR>
<I>Yazar hakkýnda:</I><BR>
<!-- aboutauthor_start -->
<p>Guido Linux'u, kendi donanýmýný geliþtirmek için gerçekten
    çok iyi bir iþletim sistemi olduðu için beðenmektedir.</p>
<!-- aboutauthor_stop -->
<!-- TRANSLATED_TO tr -->
<BR><BR><I>Türkçe'ye çeviri:</I><BR>
Erdal Mutlu <small>&lt;erdal(at)linuxfocus.org&gt;</small>
<br>
<!--
 =LF=TRANSTO=tr: Erdal Mutlu
-->
<!-- TRANSLATED_TO_STOP -->
<!-- INDEX_START -->
<BR><i>Ýçerik</i>:
<UL>
  <LI><A HREF="#352lfindex0">Giriþ</A></LI>
  <LI><A HREF="#352lfindex1">Gerekli olan yazýlýmlar</A></LI>
  <LI><A HREF="#352lfindex2">GNU araçlarýnýn yüklenmesi</A></LI>
  <LI><A HREF="#352lfindex3">AVR gcc derleyicisinin yüklenmesi</A></LI>
  <LI><A HREF="#352lfindex4">AVR C kütüphanesinin yüklenmesi</A></LI>
  <LI><A HREF="#352lfindex5">Programlayýcý yazýlýmýnýn yüklenmesi</A></LI>
  <LI><A HREF="#352lfindex6">Küçük bir deneme projesi</A></LI>
  <LI><A HREF="#352lfindex7">Gerekli donanýmlar</A></LI>
  <LI><A HREF="#352lfindex8">Programlayýcý donanýmý oluþturmak</A></LI>
  <LI><A HREF="#352lfindex9">Uygulama geliþtirmek</A></LI>
  <LI><A HREF="#352lfindex10">Derleme ve yükleme</A></LI>
  <LI><A HREF="#352lfindex11">Bazý ilginç araçlar</A></LI>
  <LI><A HREF="#352lfindex12">Düþünce ve öneriler</A></LI>
  <LI><A HREF="#352lfindex13">Kaynakça</A></LI>
  <LI><A HREF="http://cgi.linuxfocus.org/cgi-bin/lftalkback?anum=352">Bu yazý için görüþ bildiriminde bulunabilirsiniz</A></LI>
</UL>

</TD></TR></TABLE>
<!-- INDEX_STOP -->
<!-- SHORT_BIO_ABOUT_THE_AUTHOR_AND_INDEX_STOP -->
<!-- HEAD_OF_THE_ARTICLE_START -->
<br>&nbsp;
<table border="0"><tr><td>
<H2>GCC libc-1.0.4 ile AVR mikroiþlemcisini programlamak</H2>
 <img src="../../common/images2/article352/illustration.gif"
    alt="[Illustration]" hspace="10" width="208" height="148">
<!-- ABSTRACT OF THE ARTICLE -->
<P><i>Özet</i>:
<P>
<!-- articleabstract_start -->

    Atmel firmasýnýn AVR 8-Bit RISC Mikroiþlemcisi, çok yaygýn
    bir mikroiþlemcidir. EEPROM, Ram, Analog'dan sayýsala
    (digital) çevirici, birçok sayýsal giriþ ve çýkýþ hatý, zamanlayýcýlar, RS 232
    haberleþmesi için UART ve daha fazlasý tek bir çipte barýndýrmaktadýr.
    <br><br>
    En önemlisi, Linux için tam bir uygulama geliþtirme ortamýna sahip
    olmasýdýr. Mikroiþlemciyi C ve GCC kullanarak programlayabilirsiniz.<br><br>
    Ayný konu hakkýnda <a href="../March2002/article231.shtml">Mart 2002 sayýsýnda</a>
    bir yazý yazmýþtým. O günden bu güne bir çok þey deðiþti. Kullanmýþ olduðum
    AT90S4433 mikroiþlemcisi Atmel tarafýndan artýk üretilmiyor. Bu yazý,
    Mart 2002 yazýsý için güncelleme niteliðindedir. libc-1.0.4 ile ATmega8
    mikroiþlemcisini kullanacaðým.<br><br>
    Dolayýsýyla, bu yazý konuya giriþ niteliði taþýyacak ve
    serinin ileriki yazýlarýnda ATmega8 mikroiþlemcisini kullanan
    daha ilginç aletler oluþturacaðýz.

    
<!-- articleabstract_stop -->

<br><!-- HR divider --><center><font color="#8282e0"><b>_________________ _________________ _________________</b></font></center><br>
</td></tr></table>
<!-- HEAD_OF_THE_ARTICLE_STOP -->
<!-- BODY_OF_THE_ARTICLE_START -->


    <A NAME="352lfindex0">&nbsp;</A>
<H2>Giriþ</H2>

    2002 yýlýnda yazdýðým yazýdan sonra
    mikroiþlemcilerin programlanmasý bir çok insanýn ilgisini çekmiþti.
    Ancak, uygulama geliþtirme ortamýnýn yüklenip ayarlanmasý en zor adýmdýr.
    Eðer, bir þey çalýþmýyorsa, hatanýn nerede oluþtuðu hakkýnda
    hiçbir düþünce yürütülemiyor. Programlayýcý kablosu mu bozuk? Devre mi hatalý?
    Yüklemede mi sorun var? BIOS'ta paralel baðlantý iptal mi edilmiþ?
    ppdev için olan çekirdek modülleri yanlýþ mý derlendi? Neden çalýþmadýðý
    hakkýnda bir sürü neden olabilir.
    <a href="http://shop.tuxgraphics.org/electronic/microcontroller.html"><img
     src="../../common/images2/article352/linuxavrcd_th.jpg" align=
    "right" width="150" height="213"></a> <br>
     <br>
    Mikroiþlemci dünyasýna eylenceli bir giriþ yapabilmeniz için
    <a href="http://shop.tuxgraphics.org/electronic/microcontroller.html">shop.tuxgraphics.org</a>
    adresinden, belgeleri içeren baþlatýlabilir bir CD ile
    programlayýcý donanýmýný elde edebilirsiniz. Yapmanýz gereken tek þey,
    CD'den bilgisayarýnýzý açmaktýr. Yazýlým yüklemenize gerek
    yoktur ve bilgisayarýnýzda hiçbir þeyi deðiþtirmeniz de gerekmiyor.
    <br>
    <br>
    Hatta ben bile böyle bir CD kullanýyorum, çünkü
    geliþtirdiðim donanýmlar, bilgisayarýmdaki birkaç çekirdek nesli ile
    Linux daðýtýmýný deðþtirmeme karþýn, deðiþmeden kalmaktadýr.
    Elimde CD olduðu için, geliþtirmiþ olduðum yazýlýmda güncelleme
    yapmak istediðimde, uygulama geliþtirme ortamýnýn bilgisayarýmda hala
    yüklü ve ayarlý olup olmadýðý pek önemli olmamaktadýr.
    Yapmam greken tek þey, CD'den bilgisayarýmý açmaktýr.<br>
     <br>
    CD'den baðýmýsýz olarak, GCC avr uygulama geliþtirme
    ortamýnýn yükleniþini burada açýklayacaðým. tuxgraphics'ten
    bu CD'yi elde ettiyseniz, okumaya "Küçük bir deneme projesi"
    bölümünden devam edebilirsiniz.

    <A NAME="352lfindex1">&nbsp;</A>
<H2>Gerekli olan yazýlýmlar</H2>


    <p>GNU C uygulama geliþtirme ortamýný kullanabilmek için aþaðýdaki yazýlýmlara gereksinim
    duyacaksýnýz:</p>

    <table border="1">
      <tr>
        <td>binutils-2.15.tar.bz2</td>

        <td>ftp://ftp.gnu.org/gnu/binutils/<br>
          veya yansý yöresi olan<br>
         ftp://gatekeeper.dec.com/pub/GNU/binutils/ adresinden elde
          edebilirsiniz.</td>
      </tr>

      <tr>
        <td>gcc-core-3.4.2.tar.bz2</td>

        <td>ftp://ftp.gnu.org/gnu/gcc/<br>
         veya yansý yöresi olan <br>
         ftp://gatekeeper.dec.com/pub/GNU/gcc/ adresinden elde edebilirsiniz.</td>
      </tr>

      <tr>
        <td>avr-libc-1.0.4.tar.bz2.tar</td>

        <td>AVR C kütüphanesini
        http://savannah.nongnu.org/projects/avr-libc/ adresinden elde
        edebilirsiniz.</td>
      </tr>

      <tr>
        <td>uisp-20040311.tar.bz2</td>

        <td>AVR programlayýcý yazýlýmýný
        http://savannah.nongnu.org/projects/uisp adresinden elde edebilirsiniz.</td>
      </tr>
    </table>
    <br>
    <br>
    Tüm yazýlýmlarý /usr/local/avr dizinine yükleyeceðiz.
    Böylece yazýlýmlarý bilgisayarýnýzdaki C derleyicisinden ayrý
    tutumuþ oluruz. Bu dizini aþaðýdaki buyrukla yaratýn:
<pre class="code">
    mkdir /usr/local/avr

Çalýþabilir programlarýnýn bulunduðu bin dizinini, PATH çevre
deðiþkenine ekleyebilirisiniz:
    mkdir /usr/local/avr/bin
    export PATH=/usr/local/avr/bin:${PATH}
</pre>

    <A NAME="352lfindex2">&nbsp;</A>
<H2>GNU araçlarýnýn yüklenmesi</H2>

    Nesne dosyalarý yaratmak için gerekli tüm düþük seviye
    araçlarý binutils paketiyle birlikte gelmektedir.
    Paket içerisinde, AVR assembler (avr-as), baðlayýcý (avr-ld),
    kütüphane iþleme araçlarý (avr-runlib, avr-ar), mikroiþlemcinin
    EEPROM'una yüklenebilir nesne dosyalarý yaratmaya yarayan programlar
    (avr-objcopy), avr-objdump, avr-size ve avr-strip gibi
    araçlar bulunmaktadýr.
   <br>
     <br>
     binutils paketini oluþturmak ve yüklemek için aþaðýdaki buyruklarý verin:

<pre class="code">
tar jxvf binutils-2.15.tar.bz2
cd binutils-2.15/
mkdir obj-avr
cd obj-avr
../configure --target=avr --prefix=/usr/local/avr --disable-nls
make

# ve root kullanýcýsý olarak:
make install
</pre>
    <br>
    <br>
     /usr/local/avr/lib satýrýný /etc/ld.so.conf dosyasýna
    ekleyin ve baðlayýcý geçici belleðini yenilemek için /sbin/ldconfig
    buyruðunu çalýþtýrýn.


    <A NAME="352lfindex3">&nbsp;</A>
<H2>AVR gcc derleyicisinin yüklenmesi</H2>

    avr-gcc bizim kullanacaðýmýz C derleyicimiz olacak. <br>
     <br>
    Derleyiciyi oluþturup yüklemek için aþaðýdaki buyruklarý verin:
<pre class="code">
tar jxvf gcc-core-3.4.2.tar.bz2
cd gcc-3.4.2

mkdir obj-avr
cd obj-avr
../configure --target=avr --prefix=/usr/local/avr --disable-nls --enable-language=c

make

# ve root kullanýcýsý olarak:
make install

</pre>

    <A NAME="352lfindex4">&nbsp;</A>
<H2>AVR C kütüphanesinin yüklenmesi</H2>

    Þimdiki C kütüphanesi, Mart 2002 yazýsýnda kullandýðýmdan daha
    saðlamdýr.<br>
    Kütüphaneyi oluþturup yüklemek için aþaðýdaki buyruklarý verin:
<pre class="code">
tar jxvf avr-libc-1.0.4.tar.bz2.tar
cd avr-libc-1.0.4
PREFIX=/usr/local/avr
export PREFIX
sh -x ./doconf
./domake

cd build
#ve root kullanýcýsý olarak:
make install

</pre>

    <A NAME="352lfindex5">&nbsp;</A>
<H2>Programlayýcý yazýlýmýnýn yüklenmesi</H2>

    Programlayýcý yazýlýmý, özel hazýrlanmýþ nesne kodunu
    mikroiþlemcinin EEPROM'una yüklenmesini saðlamaktadýr.<br>
    Linux için olan uisp programlayýcýsý çok iyi bir programlayýcýdýr.
    Kendisini Makefile dosyasý içerisinden doðrudan kullanabilirsiniz.
    Yazýlýmý derleme ve yüklemek için yapmanýz gereken tek þey
    "make load" kuralýný Makefile dosyasýna eklemek olacaktýr.<br>
     <br>
     uisp aþaðýdaki gibi yüklenmektedir:
<pre class="code">
tar jxvf uisp-20040311.tar.bz2.tar
cd uisp-20040311
./configure --prefix=/usr/local/avr
make

# ve root kullanýcýsý olarak:
make install

</pre>

    <A NAME="352lfindex6">&nbsp;</A>
<H2>Küçük bir deneme projesi</H2>

    Ýþe, daha sonra geliþtirebileceðiniz küçük bir deneme devresiyle
    baþlayacaðýz.<br>
    <br>
    Devreyi, daha karmaþýk donanýmlarý denemek için de kullanabilirsiniz.
    Yazýlým yükleme denemesi, algýlayýcý veya baþka ölçüm aygýtý
    ekleme gibi iþleri, devre ile kolayca yapabilirsiniz.<br>
    <br>
    Burada vermiþ olduðumuz deneme programý sadece LED'in yanýp sönmesine
    yaramaktadýr.<br>
    Mikroiþlemci için küçük bir baský devresi yapmanýzý öneririm.<br>
     <img src="../../common/images2/article352/circuit.gif" width=
    "600" height="400"> <br>


    <A NAME="352lfindex7">&nbsp;</A>
<H2>Gerekli donanýmlar</H2>

    <img src=
    "../../common/images2/article352/avrm8ledtest_circuit.jpg" alt=
    "[test circuit]" align="right" width="300" height="286"><br>
    Gerekli parçalarýn listesi aþaðýdaki tabloda verilmiþtir.
    Ýþlemcinin yaygýn kullanýlmýna karþýn, iþlemciyi tüm yerel elektronik
    malzemeleri satan dükkanlarda bulamayabilirsiniz. Almanya'daki
    www.conrad.de, Fransa'daki www.selectronic.fr, ABD'deki
    digikey.com vs. gibi elektronik malzeme satan büyük
    daðýtýcýlarýn elinde bu mikroiþlemci kesin olarak bulunmaktadýr.
    <br>
    Ayrýca, tüm parçalarý veya sadece mikroiþlemciyi
    <a href="http://shop.tuxgraphics.org/">shop.tuxgraphics.org</a> adresinden
    de elde edebilirsiniz.
    <br clear="all">


    <table border="1" width="70%">
      <tr>
        <td>1 x ATmega8 DIP sürümlü, Atmel 8 bit Avr risc iþlemcisi.</td>
      </tr>

      <tr>
        <td>1 x 28 pin 7.5mm IC socket<br>
         28 delikli (pin) socket zor bulunmaktadýr.
        28 delikli socket ler genillikle 14mm geniþliðindedir.
        Bize ise, 7.5mm geniþliðinde olaný gerekmektedir.
        </td>
      </tr>

      <tr>
        <td>Bir adet 10K direnç (Renk kodu: kahverengi, siyah, turuncu)<br>
         Bir adet 1K direnç (Renk kodu: kahverengi, siyah, kýrmýzý)<br>
         Bir adet 10uF electrolytic kapasitör<br>
         Kablo<br>
         Bir adet LED<br>
         Delikli matris devresi<br>
        </td>
      </tr>

      <tr>
        <td>Aþaðýdaki parçalar programlayýcý için gereklidir.
        <small>"Linux AVR programming kit" i tuxgraphics ten aldýysanýz,
        gerekli deðil.)</small>:<br>
        Paralel baðlantý noktasýna baðlantý yapmak için bir adet DB25
        baðlaçý.<br>
        Programlayýcý için 5 bacaklý herhangi bir baðlayici veya socket.
        IC socket'lerine benzer olan baðlaçlardan kullanmanýzý ve beþ
        bacaklý olacak þekilde onu kesmenizi öneririm.<br>
        Bir adet 220 Ohm direnç (Renk kodu: kýrmýzý, kýrmýzý, kahverengi)<br>
        Üç adet 470 Ohm direnç (Renk kodu: sarý, mor, kahverengi)<br>
        </td>
      </tr>
    </table>
    Yukarýdakilerin yaný sýra, elektronik olarak dengeleþtirilen
    5V doðru akým kaynaðýna veya 4.5V pile gereksiniminiz olacaktýr.
    <br>
    <br>
    Kristale gereksinim duymadýðýmýzý belki de fark etmiþsinizdir.
    Bunun nedeni, ATmega8'in içinde bir osilatörüm olmasýdýr.
    Çok hassas zamanlama gerekmediðinde, bu osilatör kullanýlabilir.
    Eðer, hassas ölçü aletleri yapacaksanýz veya UART/RS232 arayüzünü
    kullanacaksýnýz, bir kristale gereksinim duyacaksýnýz.
    Programlayýcý aracýlýðý ile sigorta bitlerini ayarlayarak, hangi tür
    osilatörün kullanýlacaðý tanýmlanabilir. Fabrikadan ayarlanmýþ olarak gelen
    1Mhz'lik osilatör çalýþýr durumdadýr.

    <A NAME="352lfindex8">&nbsp;</A>
<H2>Programlayýcý donanýmý oluþturmak</H2>

    AVR mikroiþlemcileri devredeyken programlanmalarýna izin vermektedir.
    (in circuit programming - ISP). <img src=
    "../../common/images2/article352/avr_programmer.jpg" alt=
    "[Linux AVR programmer]" align="right" width="300" height=
    "303"><br>
    Baþka bir deyiþle, mikroiþlemciyi programlamak için
    devreden çýkartmanýza gerek yoktur. Çeþitli programlayýcý
    aletlerini 50 ila 150 Euro'ya satýn alabilirsiniz.
    Ancak, Linux'unuz varsa, basit ama iþe yarayan bir
    programlayýcý oluþturabilirsiniz. Aþaðýdaki kablonun yaný sýra,
    bilgisayarýnýzda boþ bir paralel baðlantýsýna gereksinim
    duyacaksýnýz:<br>
   <br>
    Bu programlayýcý Mart 2002 yazýsýnda oluþturduðumuz
    programlayýcýdan daha geliþmiþtir. Koruma dirençlerini
    programlayýcýnýn içerisine yerleþtiriyoruz. Böylece,
    devre üzerinde daha fazla boþ yer kalmýþ oluryor.
    Programlayýcý kablosunun baðlantýlarý aþaðýdaki gibi
    yapýlmalýdýr:<br>


    <table border="1" bgcolor="#CDCDCD">
      <tr>
        <th>pcb bacaðý</th>

        <th>AVR bacaðý</th>

        <th>koruma direnci</th>

        <th>paralel baðlantýsý bacaðý</th>
      </tr>

      <tr>
        <td>5</td>

        <td>Yenileme (Reset) (1)</td>

        <td>--</td>

        <td>Ýlklendirme (Init) (16)</td>
      </tr>

      <tr>
        <td>4</td>

        <td>MOSI (17)</td>

        <td>470 Ohm</td>

        <td>D0 (2)</td>
      </tr>

      <tr>
        <td>3</td>

        <td>MISO (18)</td>

        <td>220 Ohm</td>

        <td>Meþkul (Busy) (11)</td>
      </tr>

      <tr>
        <td>2</td>

        <td>SCK (19)</td>

        <td>470 Ohm</td>

        <td>Strobe (1)</td>
      </tr>

      <tr>
        <td>1</td>

        <td>GND</td>

        <td>--</td>

        <td>GND (18)</td>
      </tr>
    </table>
    <br>
    Kablo 70 santimetreden daha uzun olmamalýdýr.<br>
    <br>
    Saðdaki resimde de gösterildiði gibi, koruma dirençleri
    baðlaçýn içine yerleþtirilebilirler.

    <A NAME="352lfindex9">&nbsp;</A>
<H2>Uygulama geliþtirmek</H2>

    ATmega8 mikroiþlemcisi gcc ve C programlama diliyle programlanabilir.
    AVR assembler dilini biraz bilmeniz, size yarar saðlayabilir, ama
    gerekli deðildir.
    <br>
    <br>
    AVR libc'si tüm C fonksiyonlarýný anlatan bir
    <a href="../../common/src2/article352/avr-libc-user-manual-1.0.4.pdf">
    avr-libc kullanýcý kýlavuzuyla PDF (1139921 bytes)</a> birlikte
    gelmektedir. Atmel'in sayfasýndan
    (<a href="http://www.atmel.com">www.atmel.com</a>,  avr ürünleri kýsmýna
    -&gt; 8 bit risc-&gt; Datasheets bakýnýz.), tüm verileri indirebilirsiniz.
    Orada tüm yazmaçlar (register) ile iþlemci kullanýmý anlatýlmaktadýr.
    <br>
     <br>
    Mikroiþlemciyi kullanýrken aklýnýzda tutmanýz gereken þey, iþlemcinin
    sadece birkaç byte geçici belleðe sahip olmasýdýr.
    Baþka bir deyiþle, büyük veri yapýlarý veya karakter katarlarý
    tanýmlamamalýsýnýz. Ýç içe girmiþ fonksiyon veya özyinemeli
    fonksiyonlarýn programýnýzda kullanmaktan kaçýnmalýsýnýz.<br>
    <br>
    <br>
    Teori yerine gerçek bir örnek her zaman için daha iyidir.
    Yazacaðýmýz program, devredeki LED'in 0.5 saniye aralýklarla
    yanýp sönmesini gerçekleþtirecektir.
    Pek kullanýþlý bir örnek deðil, ama baþlangýç için yeterlidir.<br>
   <br>
    avr-libc çok deðiþti. Bir baðlantý noktasý için bir biti
    bir yapmak için sbi ve sýfýr yapmak için de cbi fonksiyonlarý
    kullanýlmaktadýydý. Þimdi ise, bu fonksiyonlar artýk yok.
    Ben ilk önce "eski güzel" fonksiyonlarý kullanabilmek için
    ilgili fonksiyonlarý, makrolar aracýlýðý ile tanýmlýyorum:
<pre class="code">
    /* Ýleriki kullanýmlarda uyumlu olmasý için tanýmlanan fonksiyonlar */
    #ifndef cbi
    #define cbi(sfr, bit) (_SFR_BYTE(sfr) &amp;= ~_BV(bit))
    #endif
    #ifndef sbi
    #define sbi(sfr, bit) (_SFR_BYTE(sfr) |= _BV(bit))
    #endif

    void main(void)
    {
          /* INITIALIZE */
          /* enable PC5 as output */
          sbi(DDRC,PC5);


          /* BLINK, BLINK ... */
          while (1) {
                /* led on, pin=0 */
                cbi(PORTC,PC5);
                delay_ms(500);
                /* set output to 5V, LED off */
                sbi(PORTC,PC5);
                delay_ms(500);
          }
    }

</pre>
    Aþaðýdaki örnek, yeni kullanýmla yazýlmýþ ve ayný iþi görmektedir.
<pre class="code">
    void main(void)
    {
          /* Ýlklendirme */
          /* PC5 çýkýþ olarak ayarla */
          DDRC|= _BV(PC5);


          /* Yan, sön, yan sön ... */

          /* PC5, 5 dir (include/avr/iom8.h bakýnýz) ve _BV(PC5), 00100000  dýr.*/
          while (1) {
                /* led on, pin=0 */
                PORTC&amp;= ~_BV(PC5);
                delay_ms(500);
                /* set output to 5V, LED off */
                PORTC|= _BV(PC5);
                delay_ms(500);
          }
    }

</pre>
    Yukarýdaki program parçasý, mikroiþlemciyi ne kadar kolay
    programlayabileceðinizi göstermektedir.
    Siz sadece ana program kýsmýný görüyorsunuz, delay_ms fonksiyonunu
    <a href="../../common/src2/article352/avrm8ledtest.c.html">tüm program
    (avrm8ledtest.c)</a> dosyasýndan elde edebilirsiniz.
    PC5 bacaðýný çýkýþ olarak kullanmak isterseniz,
    C (DDRC) baðlantý noktasý için olan ve veri doðrultusundaki yazmaçta
    PC5 bitini bir yapmanýz gerekir. Bunu yaptýktan sonra,
    PC5 bitini cbi(PORTC,PC5) fonksiyonu ile sýfýr yaparsanýz PC5'e 0V,
    PC5 bitini sbi(PORTC,PC5) fonksiyonu ile bir yaparsanýz PC5'e 5V
    vermiþ olursunuz. PC5'in deðeri io.h tarafýndan dahil edilen iom8.h
    baþlýk dosyasýnda tanýmlanmýþtýr. Dolayýsýyla bunun için endiþelenmenize
    gerek yoktur. Eðer, Linux gibi çok kullanýcýlý ve çok iþlemli
    sistemler için program yazdýysanýz, sonsuz döngülerinizi bir
    bekleme olmaksýzýn yapýlmamasý gerektiðini biliyorsunuzdur.
    Yoksa, iþlemci zamanýný boþa kullanýr ve böylece sisteminizi
    bayaðý yavaþlatmýþ olursunuz. AVR iþlemcisinde durum baþkadýr.
    Birden fazla iþlem yok ve çalýþan baþka bir program da yoktur.
    Ýþletim sistemi bile yok. Dolayýsýyla, meþkul döngüyü burada kullanmak
    gayet doðaldýr.

    <A NAME="352lfindex10">&nbsp;</A>
<H2>Derleme ve yükleme</H2>

    Ýþe baþlamadan önce /usr/local/avr/bin dizinin yoltanýmý içerisinde yer
    aldýðýndan emin olun. Eðer, gerekiyorsa, .bash_profile veya
    .tcshrc dosyasýný aþaðýdaki gibi deðiþtirin:


    <p class="code">export PATH=/usr/local/avr/bin:${PATH} (bash için)<br>
     setenv PATH /usr/local/atmel/bin:${PATH} (tcsh için)</p>
    AVR'yi programlamak için uisp ve paralel baðlantý noktasýný kullanýyoruz.
    Uisp, çekirdeðin ppdev arayüzünü kullanmaktadýr. Dolayýsýyla,
    aþaðýdaki çekirdek modüllerine gereksinim duyacaksýnýz:
<pre class="code">
    # /sbin/lsmod
    parport_pc
    ppdev
    parport
</pre>
    lsmod buyruðu ile modüllerinin yüklü olup olmadýðýný denetleyin ve
    eðer yüklü deðiller ise, root kullanýcýsý olarak modülleri aþaðýdaki
    buyruklarla yükleyin:
<pre class="code">
    modprobe parport
    modprobe parport_pc
    modprobe ppdev

</pre>
    Bu buyruklerýn sistem açýlýrken kendiliðinde verilmesinde
    yarar vardýr. Bunun için buyruklarý rc betiklerine (Sözgelimi, RedHat için
    olan rc betiði /etc/rc.d/rc.local dýr.) ekleyebilirsiniz.<br>
    ppdev arayüzünü sýradan bir kullanýcý olarak kullanmak istediðinizde,
    root kullanýcýsý bir defa olmak üzere aþaðýdaki buyrukla size yazma
    hakký vermesi gerekir:

    <p class="code">chmod 666 /dev/parport0</p>

    Ayrýca, sisteminizde yazýcý servisinin çalýþmadýðýndan da emin olun.
    Eðer, çalýþýyorsa, programlayýcý kabloyu kullanmadan önce onu durdurun.
    Programlarýmýzý derlemek ve mikroiþlemcimizi programlamak için artýk her þey
    hazýr.<bR>
    <br>
    Deneme programýmýz için olan
    (<a href="../../common/src2/article352/avrm8ledtest-0.1.tar.gz">avrm8ledtest-0.1.tar.gz</a>)
    paketinde bir Makefile dosyasý vardýr. Yapmanýz gereken tek þey
    aþaðýdaki buyruklarý vermek:<br>
     make <br>
     make load<br>
    Bunlar, yazýlýmý derleyip yükleyecektir. Tüm buyruklarýn ayrýntýsýna
    girmeyeceðim. Onlarý
    <a href="../../common/src2/article352/Makefile.html">Makefile</a>
    dosyasý içerisinde görebilirsiniz ve buyruklar hep ayynýdýr zaten.
    Ben bile tüm buyruklarý hatýrlayamýyorum. Tek bilmemem gereken
    "make load" buyruðunu vermemdir. Eðer, yeni bir program yazmak istiyorsanýz,
    Makefile dosyasý içerisinde avrm8ledtest sözcüðünü, yazdýðýnýz program adýyla
    deðiþtirmeniz yeterli olacaktýr.

    <A NAME="352lfindex11">&nbsp;</A>
<H2>Bazý ilginç araçlar</H2>

    Derleme sürecinden daha ilginç olan binutils araçlarýdýr.<br>
    Ancak, bu araçlar Mart 2002'den beri pek deðiþmedi.
    Daha fazla bilgi için
    <a href="../March2002/article231.shtml">Mart 2002 deki 231 nolu yazýnýn</a>
    "Bazý ilginç binutils'ler" bölümüne bakabilirsiniz.

    <A NAME="352lfindex12">&nbsp;</A>
<H2>Düþünce ve öneriler</H2>

    Birçok kullaným için ATmega8 mikroiþlemcisi AT90S4433 ile uyumludur.
    Dýþ osilatörü kullanabilmek için sigorta bitlerini programlamanýz
    gerekecektir. Önceden yapmýþ olduðumuz donanýmlar çok az deðiþiklikler ile
    aynen kullanýlabilir. Ancak, eski yazýlarda AT90S4433 ile yapmýþ olduðum
    devreleri zamansýzlýktan deneme olanaðým ne yazýk ki olmadý.
    Eðer, kendinizi saðlama almak istiyorsanýz, eski devrelerle
    AT90S4433 kullanýn. Eðer, ben uðraþýrým ve çýkabilecek sorunlarý seve
    seve çözerim diyorsanýz, eski devreleri ATmega8 ile kullanmayý
    deneyebilirsiniz.<br>
<br>
    Eski yazýlarýn listesi aþaðýda verilmiþtir:

    <ul>
      <li><a href="../May2002/article236.shtml">Linux sunucunuz için LCD denetim paneli</a></li>
      <li><a href="../November2002/article251.shtml">Mikroiþlemci tabanlý doðru akým güç kaynaðý</a></li>
      <li><a href="../September2002/article253.shtml">LCD görüntü ve RS232
arayüxü olan 1Hz-100MHz sýklýk (frekans) sayacý</a></li>
      <li><a href="../March2003/article286.shtml">Watchdog ve tuþlu Linux USB LCD ekraný</a></li>
      <li><a href="../July2003/article297.shtml">Otomatik ýþýk izleyici robot yapmak</a></li>
    </ul>
    <br>
    <br>
    Eski devrelerde devre üzerinde bulunan koruma dirençlerinin,
    þimdiki programlayýcý üzerinde olduðunu unutmayýn. Eðer,
    programlayýcýyý eski devrelerle kullanmak isterseniz,
    devre üzerinde bulunan koruma dirençlerini kablolar
    aracýlýðý ile devredýþý býrakabilirsiniz.

    <A NAME="352lfindex13">&nbsp;</A>
<H2>Kaynakça</H2>


    <ul>
      <li>Pascal Stang'ýn AVRlib: <a href=
      "http://www.procyonengineering.com/avr/avrlib/index.html">http://www.procyonengineering.com/avr/avrlib/index.html</a></li>

      <li>avrfreaks <small>(Dikkatli olmalýsýnýz, çünkü orada bazý insanlar
Windows kullanýyorlar)</small>: <a href="http://www.avrfreaks.net/">http://www.avrfreaks.net/</a></li>

      <li>Linux için tavrasm assembler: <a href="http://www.tavrasm.org/">www.tavrasm.org</a></li>

      <li>AVR webring: <a href="http://R.webring.com/hub?ring=avr&amp;list">R.webring.com/hub?ring=avr&amp;list</a></li>

      <li> <a href="../../common/src2/article352/index.html">Bu yazýda</a> sözü edilen tüm yazýlým ve belgeler.</li>

      <li>Atmel'in sayfasý: <a href=
      "http://www.atmel.com/">www.atmel.com/</a></li>

      <li>tuxgraphics'teki elektronik sayfalar:
<a href=
    "http://shop.tuxgraphics.org/">shop.tuxgraphics.org</a>
<br>(Linux AVR programlayýcý CD'si ile mikroiþlemciyi buradan satýn
alabilirsiniz.)
    </li>
    </ul>
    <!-- vim: set sw=2 ts=2 et tw=80: -->
  



<!-- BODY_OF_THE_ARTICLE_STOP -->
<!-- 2pdaIgnoreStart -->
<A NAME="talkback">&nbsp;</a>
<h2>Bu yazý için görüþ bildiriminde bulunabilirsiniz</h2>
Her yazý kendi görüþ bildirim sayfasýna sahiptir. Bu sayfaya yorumlarýnýzý yazabilir ve diðer okuyucularýn yorumlarýna bakabilirsiniz.
<center>
    <table width="250" border=0><tr><td>
    <div class="tbbutton"><A class="nodec" href="http://cgi.linuxfocus.org/cgi-bin/lftalkback?anum=352">&nbsp;talkback page&nbsp;</a></div>
    </td></tr></table>
</center>

<br clear="all">
<HR size="2" noshade>
<table width="250" border=0><tr><td>
<div class="bbutton"><a class="nodec" href="../../index.shtml">&lt;--, LF Ana Sayfa</a></div>
</td><td>
<div class="bbutton"><a class="nodec" href="index.shtml">Bu sayýnýn ana sayfasýna gider</a></div>
</td></tr></table>
<br clear="all">
<HR size="2" noshade>
<!-- ARTICLE FOOT -->
<CENTER><TABLE WIDTH="98%" summary="footer">
<TR><TD ALIGN=CENTER BGCOLOR="#bdc6d5" WIDTH="50%">
<A HREF="../../common/lfteam.html">Görselyöre sayfalarýnýn bakýmý, LinuxFocus Editörleri tarafýndan yapýlmaktadýr</A>
<BR><FONT COLOR="#1111aa"><a href="../../common/copy.html">&copy; Guido Socher</a><br>&quot;some rights reserved&quot; see <a href="../../license/index.shtml">linuxfocus.org/license/</a><br><a href="http://www.linuxfocus.org">http://www.LinuxFocus.org</a></FONT>
</TD>
<TD BGCOLOR="#bdc6d5">
<!-- TRANSLATION INFO -->
<font size=2>Çeviri bilgisi:</font>
<TABLE summary="translators">
  <tr><td><font size="2">en --&gt; -- : Guido Socher (<a href="http://linuxfocus.org/~guido/"><font size="1">homepage</font></a>)</font></td></tr>
  <tr><td><font size="2">en --&gt; tr: Erdal Mutlu &lt;erdal(at)linuxfocus.org&gt;</font></td></tr>
</TABLE>
</TD>
</TR></TABLE></CENTER>
<p><font size=1>2004-11-09, generated by lfparser version 2.50</font></p>
<!-- 2pdaIgnoreStop -->
</BODY>
</HTML>
