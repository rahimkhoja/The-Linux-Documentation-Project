<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>La herramienta NTP</title><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="Guía Para Administradores de Sistemas GNU/Linux"><link rel="up" href="ch13.html" title="Capítulo 13. Manteniendo La Hora"><link rel="prev" href="ch13s06.html" title="Configuración básica de NTP"><link rel="next" href="ch13s08.html" title="Algunos servidores NTP conocidos"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">La herramienta NTP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch13s06.html">Anterior</a> </td><th width="60%" align="center">Capítulo 13. Manteniendo La Hora</th><td width="20%" align="right"> <a accesskey="n" href="ch13s08.html">Siguiente</a></td></tr></table><hr></div><div class="sect1" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2563029"></a>La herramienta NTP</h2></div></div></div><p>
Hay innumerables utilidades disponibles para comprobar si NTP está 
haciendo su trabajo. El comando <span><strong class="command">ntpq -p</strong></span> mostrará el estado de la hora
actual de su sistema.

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>ntpq -p</code></strong>
<code class="computeroutput">     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*cudns.cit.corne ntp0.usno.navy.  2 u  832 1024  377   43.208    0.361   2.646
 LOCAL(0)        LOCAL(0)        10 l   13   64  377    0.000    0.000   0.008
</code>
</pre><p>
	</p><p>
<span><strong class="command">ntpdc -c</strong></span> loopinfo mostrará cómo de desviado está el reloj del sistema
en segundos, basándose en la última vez que se contactó con el servidor 
remoto.

</p><pre class="screen">

<code class="prompt">#</code> <strong class="userinput"><code>ntpdc -c loopinfo</code></strong>
<code class="computeroutput">offset:               -0.004479 s
frequency:            133.625 ppm
poll adjust:          30
watchdog timer:       404 s
</code>
</pre><p>
	</p><p><span><strong class="command">ntpdc -c kerninfo</strong></span>  mostrará la corrección actual acumulada.

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>ntpdc -c kerninfo</code></strong>
<code class="computeroutput">pll offset:           -0.003917 s
pll frequency:        133.625 ppm
maximum error:        0.391414 s
estimated error:      0.003676 s
status:               0001  pll
pll time constant:    6
precision:            1e-06 s
frequency tolerance:  512 ppm
pps frequency:        0.000 ppm
pps stability:        512.000 ppm
pps jitter:           0.0002 s
calibration interval: 4 s
calibration cycles:   0
jitter exceeded:      0
stability exceeded:   0
calibration errors:   0
</code>
</pre><p>
	</p><p>
Una versión ligeramente distinta de <span><strong class="command">ntpdc -c kerninfo</strong></span> es <span><strong class="command">ntptime</strong></span>

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>ntptime</code></strong>
<code class="computeroutput">ntp_gettime() returns code 0 (OK)
  time c35e2cc7.879ba000  Thu, Nov 13 2003 11:16:07.529, (.529718),
  maximum error 425206 us, estimated error 3676 us
ntp_adjtime() returns code 0 (OK)
  modes 0x0 (),
  offset -3854.000 us, frequency 133.625 ppm, interval 4 s,
  maximum error 425206 us, estimated error 3676 us,
  status 0x1 (PLL),
  time constant 6, precision 1.000 us, tolerance 512 ppm,
  pps frequency 0.000 ppm, stability 512.000 ppm, jitter 200.000 us,
  intervals 0, jitter exceeded 0, stability exceeded 0, errors 0.
</code>
</pre><p>
	</p><p>
Existe todavía otra manera de ver cómo de bien está trabajando NTP con 
el comando <span><strong class="command">ntpdate -d</strong></span>. Éste contactará con un servidor NTP y
determinará la diferencia de tiempos pero no modificará el reloj de su sistema.


</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>ntpdate -d 132.236.56.250</code></strong>
<code class="computeroutput">13 Nov 14:43:17 ntpdate[29631]: ntpdate 4.1.1c-rc1@1.836 Thu Feb 13 12:17:20 EST 2003 (1)
transmit(132.236.56.250)
receive(132.236.56.250)
transmit(132.236.56.250)
receive(132.236.56.250)
transmit(132.236.56.250)
receive(132.236.56.250)
transmit(132.236.56.250)
receive(132.236.56.250)
transmit(132.236.56.250)
server 132.236.56.250, port 123
stratum 2, precision -17, leap 00, trust 000
refid [192.5.41.209], delay 0.06372, dispersion 0.00044
transmitted 4, in filter 4
reference time:    c35e5998.4a46cfc8  Thu, Nov 13 2003 14:27:20.290
originate timestamp: c35e5d55.d69a6f82  Thu, Nov 13 2003 14:43:17.838
transmit timestamp:  c35e5d55.d16fc9bc  Thu, Nov 13 2003 14:43:17.818
filter delay:  0.06522  0.06372  0.06442  0.06442
         0.00000  0.00000  0.00000  0.00000
filter offset: 0.000036 0.001020 0.000527 0.000684
         0.000000 0.000000 0.000000 0.000000
delay 0.06372, dispersion 0.00044
offset 0.001020

13 Nov 14:43:17 ntpdate[29631]: adjust time server 132.236.56.250 offset 0.001020 sec
</code>
</pre><p>
	</p><p>
Si quiere ver al sistema sincronizarse en tiempo real puede utilizar 
<span><strong class="command">ntptrace</strong></span>.

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>ntptrace 132.236.56.250</code></strong>
<code class="computeroutput">cudns.cit.cornell.edu: stratum 2, offset -0.003278, synch distance 0.02779
dtc-truetime.ntp.aol.com: stratum 1, offset -0.014363, synch distance 0.00000, refid 'ACTS'</code>
</pre><p>
	</p><p>
Si necesita sincronizar su sistema inmediatamente puede utilizar
<span><strong class="command">ntpdate remote-servername</strong></span> para forzar una sincronización. ¡Sin esperas!

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>ntpdate 132.236.56.250</code></strong>
13 Nov 14:56:28 ntpdate[29676]: adjust time server 132.236.56.250 offset -0.003151 sec
<code class="computeroutput"></code>
</pre><p>
</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch13s06.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ch13.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ch13s08.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Configuración básica de NTP </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Algunos servidores NTP conocidos</td></tr></table></div></body></html>
