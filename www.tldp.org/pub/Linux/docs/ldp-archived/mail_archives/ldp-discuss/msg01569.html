<!-- MHonArc v2.5.0b2 -->
<!--X-Subject: Re: cvs development -->
<!--X-From-R13: Uenag Fnlybe <tgnlybeNcvpnagr.pbz> -->
<!--X-Date: Fri, 18 Feb 2000 13:57:54 &#45;0500 (EST) -->
<!--X-Message-Id: 200002181857.NAA19166@pace.picante.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: A5F46F4ED18FD211ABEE00105AC6CF077F7C81@email.cu&#45;portland.edu -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: cvs development</title>
<link rev="made" href="mailto:gtaylor@picante.com">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg01568.html">Date Prev</a>][<a href="msg01570.html">Date Next</a>][<a href="msg01561.html">Thread Prev</a>][<a href="msg01549.html">Thread Next</a>][<a href="maillist.html#01569">Date Index</a>][<a href="threads.html#01569">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: cvs development</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: &quot;Ldp-Discuss \(E-mail\)&quot; &lt;<A HREF="mailto:ldp-discuss@lists.linuxdoc.org">ldp-discuss@lists.linuxdoc.org</A>&gt;</li>
<li><em>Subject</em>: Re: cvs development </li>
<li><em>From</em>: Grant Taylor &lt;<A HREF="mailto:gtaylor@picante.com">gtaylor@picante.com</A>&gt;</li>
<li><em>Date</em>: Fri, 18 Feb 2000 13:57:27 -0500</li>
<li><em>In-reply-to</em>: Your message of &quot;Thu, 17 Feb 2000 16:48:24 PST.&quot;            &lt;<a href="msg01561.html">A5F46F4ED18FD211ABEE00105AC6CF077F7C81@email.cu-portland.edu</a>&gt; </li>
<li><em>Resent-cc</em>: recipient list not shown: ;</li>
<li><em>Resent-date</em>: 18 Feb 2000 18:57:39 -0000</li>
<li><em>Resent-from</em>: <A HREF="mailto:ldp-discuss@lists.debian.org">ldp-discuss@lists.debian.org</A></li>
<li><em>Resent-message-id</em>: &lt;KwH9t.A.SYH.jYZr4@murphy&gt;</li>
<li><em>Resent-sender</em>: <A HREF="mailto:ldp-discuss-request@lists.debian.org">ldp-discuss-request@lists.debian.org</A></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
&gt;&gt;&gt;&gt;&gt; Gregory Leblanc &lt;GLeblanc@cu-portland.edu&gt; writes:

&gt; Ah, yeah, I see your point.  This does pose some dificulties to what
&gt; we were thinking the other day.  The plan was to have the CVS
&gt; read/write repository hosted by Serek in Poland, and for metalab to
&gt; mirror that nightly.  The scripts were to be run on metalab, and not
&gt; on Serek's server.  If things were to be set up this way, then it
&gt; would be impossible to have the scripts create the output on CVS
&gt; commits.

I think the build-on-commit model is nicer in terms of total
computation, but it does mean that somone who does checkout to mirror
the thing (ie, the obvious method), will not be guaranteed the correct
results, at least for my bizzare document.

I think what I'll do is eliminate my difficulty by dual-versioning my
HOWTO.  I'll have a version for the document, plus a separate
versioned list-o-printers as one section.  I'll just setup a cron job
to periodically checkin a new sgml snippet version of the
list-o-printers, and that's that.

&gt; If we want to process documents when they're committed to CVS, then
&gt; that has to be done on the CVS server, and not on a read-only
&gt; mirror.  This will sifignantly increase the ammount of data that's
&gt; going from Serek's server to metalab once a day.

I'm not worth these problems; I'll change my versioning scheme as
described above.

&gt; I don't know if that's a problem or not, but it is something to
&gt; think about.  Are there any volunteers to write the Makefiles that
&gt; will be needed to process documents when they're committed to CVS?

I can offer my existing makefile as a starting point.  I've cleaned
this up a bit to be more generic; the whole EXTRA mechanism is rather
half-basked at the moment but would be straightforward to extend to
handle figures.

Note that this does an &quot;evil&quot; checkout when you do make install; this
*destroys* the $...$ RCS tags, replacing $Version$ with only the
version number and so on for $Date$ as well.  This results in 
presentable output, but you can't edit or check the document back in
because it's mangled.  I only do make install from my CVS commit
handler, with this somewhat poor script:

------- &quot;install_module&quot; ---------
#! /bin/sh

cd /tmp
mkdir work.$$
cd work.$$

cvs co $1
cd $1
make install
cd /tmp/work.$$
yes | cvs release -d $1
cd /tmp
rm -rf work.$$

For clarification, we should change the target to &quot;automagicbuild&quot; or
something no human would run.

Here's a makefile.  Note that I've edited it somewhat for increased
generality, but not tested it since those edits.  My mailer also
religiously detabs things, although I think I was careful to explicity
tabify this properly.  Basically all the indented-seeming lines need
real tabs at the front...

------- &quot;makefile&quot; ---------
# The basename of your sgml file
# 
NAME=pht
INSTALLDIR=/home/gtaylor/public_html/pht/current

LDP=ldp-submit@lists.linuxdoc.org
TRANS=jeanne@mbox.kyoto-inet.or.jp roman.maurer@hermes.si henryjen@mail.net.tw chmoreira@yahoo.com

# tadokoro@ask.or.jp   Japanese?

# extra files that the results depend on.  
EXTRA=printers.sgml

# The extra macro can have various common include types handled for
# all output types.  Ie, the pdf version can depend on every name in
# EXTRA ending in .fig ith the ending changed to .pdf; this then will
# invoke rules to turn fig into eps and eps into pdf.  Etc...


# BEGIN stuff that ought to be in an included file so you can change
#       it or everyone as we go

# default target for `make', a combination of ps, html, txt, or dvi
#
all: ps html txt dvi

everything: co ps dvi html txt

##################################################
#
# You shouldn't need to change anything below here
#
##################################################
#
# shortcut targets
#
# funky evil checkout...
co: 
	(cd .. ; cvs co -kv pht/src.sgml)

html: $(NAME).html

ps: $(NAME).ps

dvi: $(NAME).dvi

txt: $(NAME).txt

ascii: $(NAME).txt

clean: 
	rm -f $(NAME).ps *.html $(NAME).txt *~ *.log *.dvi \
		$(NAME).aux $(NAME).tex $(NAME).toc \
		$(EXTRA) \
		pht.sgml


%.ps: %.sgml $(EXTRA)
	sgml2latex -o ps $&lt;

%.dvi: %.sgml $(EXTRA)
      	sgml2latex -o dvi $&lt;

%.txt: %.sgml $(EXTRA)
	sgml2txt -f $&lt;

%.html: %.sgml $(EXTRA)
	sgml2html $&lt;

# END stuff that ought to be in an included file so you can change
#     it or everyone as we go

# This is all particular to my howto
# The install rule, in particular, should come from the &quot;standard&quot;
# rules included from elsewhere.

pht.sgml: src.sgml printers.sgml
	./embed src.sgml &gt; pht.sgml

printers.sgml: distill_printers
	./distill_printers &gt; printers.sgml

install: everything
	rm -f $(INSTALLDIR)/$(NAME).sgml
	cp $(NAME).sgml *.html $(NAME).dvi $(NAME).ps printers.sgml\
		$(INSTALLDIR)
	cat -s $(NAME).txt &gt; $(INSTALLDIR)/$(NAME).txt
	/usr/bin/mail -s &quot;New version of the Printing-HOWTO&quot; $(LDP) &lt; \
		$(INSTALLDIR)/$(NAME).sgml
	/usr/bin/mail -s &quot;New version of the Printing-HOWTO&quot; $(TRANS) &lt; \
		$(INSTALLDIR)/$(NAME).sgml

# Other fun rules for pdftex and XFig figures
%.pdf: %.eps
	epstopdf $&lt; --outfile=$@

%.eps: %.fig
	fig2dev -L eps $&lt; $@

--
Grant Taylor - gtaylor@picante.com - <A  HREF="http://www.picante.com/~gtaylor/">http://www.picante.com/~gtaylor/</A>
    Linux Printing HOWTO:  <A  HREF="http://www.picante.com/~gtaylor/pht/">http://www.picante.com/~gtaylor/pht/</A>


--  
To UNSUBSCRIBE, email to ldp-discuss-request@lists.debian.org
with a subject of &quot;unsubscribe&quot;. Trouble? Contact listmaster@lists.debian.org

</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="01561" href="msg01561.html">RE: cvs development</a></strong>
<ul><li><em>From:</em> Gregory Leblanc &lt;GLeblanc@cu-portland.edu&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg01568.html">Re: Mini-HOWTOs?</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg01570.html">DocBook, etc</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg01561.html">RE: cvs development</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg01549.html">PDF Versions</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#01569"><strong>Date</strong></a></li>
<li><a href="threads.html#01569"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
