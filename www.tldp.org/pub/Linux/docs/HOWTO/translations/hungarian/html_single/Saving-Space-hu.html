<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">

 <TITLE>Helyspórolás mini-HOGYAN</TITLE>
</HEAD>
<BODY>
<H1>Helyspórolás mini-HOGYAN</H1>

<H2>Írta Guido Gonzato, 
<A HREF="mailto:guido@ibogeo.df.unibo.it">mailto:guido@ibogeo.df.unibo.it</A></H2>v1.0.1, 1999. április 7.
<HR>
<EM>Ez a mini-HOGYAN elmagyarázza, hogyan lehet a lehetõ lehetõ legkisebb helyre beszorítani egy Linux rendszert. Fõleg notebook felhasználóknak hasznos.</EM>
<HR>
<H2><A NAME="s1">1. Bevezetés</A></H2>


<P>Kaptam egy notebookot elõtelepített Windows 95 operációs rendszerrel, és felraktam rá egy Linuxot is. Összenyomtam a Windows partícióját 500 MB-ra, 240 MB maradt a Linux partíció számára. Ez elég kevésnek tûnik, de mégis sikerült egy eléggé teljes Red Hat 4.1 alapú Linux rendszert rátennem, némi trükközés árán, amivel sok helyet spóroltam meg.</P>
<P>Ha helyre van szükségünk, a következõ fejezetekben leírt tanácsok megfogadásával elég sok lemezhelyet szabadíthatunk fel. Felhívom a figyelmet, hogy senki ne engem okoljon, ha valami tönkremegy. Jópár olyan programot kell majd használni, amelyek nálam klasszul mûködtek, de természetüknél fogva veszélyesek.
Én megmondtam...</P>


<H2><A NAME="s2">2. Szoftverkövetelmények</A></H2>


<P>Szükség lesz:</P>
<P>
<UL>
<LI> egy mûködõ Linux rendszerre (bármelyik verzió megfelel);
</LI>
<LI> a széles körben elterjedt <CODE>gzip</CODE> tömörítõprogramra, vagy a  <CODE>bzip2</CODE>-re, ami letölthetõ a 
<A HREF="ftp://sunsite.unc.edu/pub/Linux/utils/compress">ftp://sunsite.unc.edu/pub/Linux/utils/compress</A> webhelyrõl, és jobban tömörít, mint a <CODE>gzip</CODE>, de lassabb és rengeteg memóriát használ; 
</LI>
<LI> az <CODE>upx</CODE> végrehajtható állományokat tömörítõ programra, amelynek a honlapja a 
<A HREF="http://www.nexus.hu/upx/">http://www.nexus.hu/upx/</A> és a 
<A HREF="http://wildsau.idv.uni-linz.ac.at/mfx/upx.html">http://wildsau.idv.uni-linz.ac.at/mfx/upx.html</A> webhelyeken található;
</LI>
<LI> és a 
<A HREF="ftp://sunsite.unc.edu:/pub/Linux/libs/compression">ftp://sunsite.unc.edu:/pub/Linux/libs/compression</A> webhelyrõl letölthetõ <CODE>zlibc</CODE> csomagra, amelyet <CODE>zlibc-X.X.tar.gz</CODE>-nek hívnak, ahol <CODE>X.X</CODE> a legújabb verzió .
</LI>
</UL>
</P>
<P>Vannak más végrehajtható állományokat tömörítõ programok is. Az egyik a  <CODE>gzexe</CODE> (felejtsük el), egy másik a  <CODE>tcx</CODE>, ami talán a legjobb volt, mielõtt az <CODE>upx</CODE> megjelent, egy harmadik a  <CODE>tzx</CODE>, ami elvileg jobb, mint a <CODE>tcx</CODE>.  A helyzet az, hogy mindent tönkretett, amikor kipróbáltam egy tartalék számítógépen, bár nem vagyok biztos benne, hogy mindent jól csináltam. A legjobb, ha az  <CODE>upx</CODE>-et használjuk, mert megbízható, hatékony és kényelmes. </P>
<P>Léteznek olyan kernel foltok, amelyek Stacker-szerû röptömörített fájlrendszert hoznak létre, de jelen pillanatban egyik sem a stabilitásáról és a megbízhatóságáról híres. Biztos, ami biztos, tartózkodjunk ezek használatától.</P>


<H2><A NAME="s3">3. Az eljárás</A></H2>




<H2><A NAME="ss3.1">3.1 A kernelforrás eltávolítása</A>
</H2>


<P>A kernel forrása több mit 20 MB helyet foglal, megfontolhatjuk a letörlését.
Ha így döntenénk, fordítsunk egy kernelt egyszer és mindenkorra, ami a gépünkre kell, és szabaduljunk meg a forráskódtól. Azért legyünk óvatosak.</P>
<P>A kernelforrás eltávolítása <EM>nem</EM> ajánlatos, ha nem vagyunk biztosak benne, hogy a gépünk megfelelõen be van konfigurálva. Emellett a kernel # fejlécfájljai szükségesek a C programok fordításához. Gondoljuk meg kétszer!</P>
<P>Ha a törlés mellett döntünk, <EM>akkor se</EM> töröljük le az include/linux könyvtárstruktúrát, hacsak nem vagyunk biztosak benne, hogy soha nem fogunk alkalmazásokat fordítani a gépen.</P>


<H2><A NAME="ss3.2">3.2 Az alkalmazások ritkítása</A>
</H2>


<P>Döntsük el, hogy melyik programra van <EM>igazán</EM> szükségünk. Néhány alkalmazás felesleges lehet. Például: biztos, hogy kell az <CODE>emacs</CODE>?  Használhatjuk helyette a <CODE>jed</CODE> szövegszerkesztõt. </P>
<P>Rajtunk múlik, hogy mit tartunk meg. Néhány általános ötlet:</P>
<P>
<UL>
<LI> A <CODE>gcc</CODE> elég nagy csomag. Ez szükséges a kernel újrafordításához, és minden olyan alkalmazás lefordításához, amelynek nincs elõre lefordított Linux bináris változata. Természetesen akkor is szükségünk lesz rá, ha a saját C vagy Fortran  (<CODE>f2c</CODE>-vel vagy <CODE>g77</CODE>-tel)  programjainkat akarjuk lefordítani, törlés elõtt gondoljuk át, hogy fogunk-e valaha programokat fejleszteni..
Más fordítóprogramok, pl. az  <CODE>lcc</CODE> elég jók, de nem érik el a  <CODE>gcc</CODE> szintjét.  Azt javaslom, tartsuk meg!
</LI>
<LI> Az X11 szörnyen nagy, de jó ha megvan. Ha nem tudunk meglenni nélküle, legalább próbáljuk a méretét a lehetõ legkisebbre leszorítani: csak a megfelelõ X szerver program, csak egy egyszerû ablakkezelõ, csak egy <CODE>xterm</CODE>, ne telepítsük a 100 dpi-s betûkészleteket, stb.

</LI>
<LI> A TeX és kiegészítõ csomagjai szintén nagyon nagyok. Ha nem használjuk a LaTeX csomagot, és megelégszünk a plain TeX csomaggal, sok helyet spórolhatunk. Nem kell használnunk az X11 alatti nézegetõket (<CODE>xdvi</CODE> és <CODE>ghostview</CODE>), mert használhatjuk a <CODE>dvitty</CODE>, a <CODE>dvivga</CODE>  és a hasonló programokat. Ha nincs szükségünk az X11 alatti nézegetõkre, akár maga az X11 is feleslegessé válhat.
</LI>
<LI> A játékok sosem létfontosságúak.
</LI>
</UL>
</P>


<H2><A NAME="ss3.3">3.3 A bináris fájlok méretének csökkentése</A>
</H2>


<P>Kezdjük el csökkenteni a bináris fájlok méretét! Lépjünk be az /usr/bin könyvtárba, és adjuk a következõ parancsot:</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 machine:/usr/bin# strip * 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ez eltávolítja a bináris fájlokba beágyazott szimbólumokat. Ismételjük meg ezt a lépést az /usr/X11R6/bin/ könyvtárban is, és az összes olyan könyvtárban, ahol végrehajtható fájlok lehetnek. Ne feledjük megkeresni a TeX és a <CODE>gcc</CODE> binárisait. Ha nem akarjuk tönkretenni a rendszerünket, akkor <EM>ne</EM> futtassuk ezt a parancsot az /sbin, a /bin, vagy az  /usr/sbin/ könyvtárakban! </P>


<H2><A NAME="ss3.4">3.4 Tömörítés az <CODE>upx</CODE> programmal</A>
</H2>


<P>Telepítsük az <CODE>upx</CODE> programot, és olvassuk el a dokumentációját.  Utána lépjünk be az /usr/bin könyvtárba és adjuk ki az <CODE>upx *</CODE> parancsot. Ez minden végrehajtható fájlt tömörít, a suid-osakat is (a <CODE>tcx</CODE> ezt nem tenné).  Ismételjük meg ezt a lépést a többi fent említett könyvtárra.</P>
<P>Ne feledjük tömöríteni a végrehajtható fájlokat, amikor új csomagot telepítünk!</P>


<H2><A NAME="ss3.5">3.5 Gzippeljük, amit lehet</A>
</H2>


<P>Van egy csomó fájl, amit egyszer és mindenkorra tömöríthetünk. Kezdjük az /usr/doc/ könyvtárral! Lépjünk bele és adjuk ki a következõ parancsot:</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 machine:/usr/doc# find . -type f -exec gzip -9 {} \; 2> /dev/null 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ne feledjük tömöríteni a dokumentációt, amikor új csomagot telepítünk!</P>
<P>Ismételjük meg ezt a lépést a TeX dokumentációját tartalmazó könyvtárra (az én rendszeremen ez az /usr/lib/texmf/texmf/doc/).  Ha  <EM>teljesen biztosak</EM> vagyunk benne, akár le is törölhetjük ezeket a könyvtárakat.</P>
<P>Telepítsük a <CODE>zlibc</CODE> csomagot és fordítsuk le.  Az olyan rendszereken, mint az enyém, a fordítás megszakad, mert a fordító nem találja a (statikus) libc könyvtárat.
Semmi gond, fogunk találni egy <CODE>uncompress.o</CODE> nevû fájlt, és ez az, amire szükségünk van.  Másoljuk ezt a fájlt az /usr/local/lib/ könyvtárba, és adjuk hozzá a következõ sort az /etc/profile fájlhoz: </P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 export LD_ELF_PRELOAD=/usr/local/lib/uncompress.o 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ezek után nemcsak a dokumentációt tömöríthetjük a <CODE>gzip</CODE> programmal, hanem az adatfájlokat is, az õket használó alkalmazások mégis tudják majd használni õket.
Elvileg ennek trükknek mûködni kellene a legtöbb alkalmazásra, de gyakorlatilag ez nem feltétlenül van így. Én nem értem el különösebb sikert ezzel a trükkel.</P>


<H2><A NAME="s4">4. Egy valódi példa</A></H2>


<P>Az alábbiakban olvasható, hogy hogyan alkalmaztam a fent említett eljárásokat a saját gépemre.
A kezelés elõtt a <CODE>df</CODE> szerint 398.798 db. 1024 bájt méretû blokkot használtam.</P>
<P>
<UL>
<LI> Nem távolítottam el a kernelforrást és a kernel fejlécfájljait.

</LI>
<LI> Eltávolítottam egy csomó alkalmazást és az összes játékot, de meghagytam az X11-et, az X11 fejlesztõkészletet, a C és Fortran fejlesztõkészletet, a Tcl/Tk-et, a hálózati segédprogramokat és még néhány egyéb alkalmazást. A  <CODE>df</CODE> szerint ekkor 244.668 blokk volt foglalt.
</LI>
<LI> Lefuttattam az  <CODE>upx</CODE> programot az /usr/bin, az /usr/X11R6/bin, az /usr/lib/texmf/bin/i586-linux és az  /usr/lib/gcc-lib/i386-linux/2.7.2.1 könyvtárakban.  226.270 foglalt blokkra csökkent a felhasznált terület.
</LI>
<LI> Tömörítettem a dokumentációt az /usr/doc és az /usr/lib/texmf/texmf/doc könyvtárakban. 198.745 foglalt blokkra csökkent a felhasznált terület.
</LI>
</UL>
</P>
<P>Összefoglalva, 398.798 blokkal kezdtem, és 198.745 blokkal fejeztem be. Gondoljunk arra, hogy mennyi mindent tárolhatunk azon a 200.000 megspórolt blokkon! Még több helyet felszabadíthattam volna, ha a <CODE>bzip2</CODE> programot használom a  <CODE>gzip</CODE> helyett.</P>
<P>Átlagos esetben, ha az elejétõl fogva óvatosak vagyunk, és csak a szükséges alkalmazásokat telepítjük, a végrehajtható állományok és a dokumentáció tömörítése kb. 20 MB helyet szabadít fel. Egy notebook gépen ez ``életet menthet''.</P>


<H2><A NAME="s5">5. Befejezés</A></H2>



<H2><A NAME="ss5.1">5.1 Szerzõi jogok</A>
</H2>


<P>A Linux HOGYAN dokumentumok szerzõi joga a megfelelõ szerzõké, hacsak másképp nem rendelkeznek. A Linux HOGYAN dokumentumokat szabad részben vagy egészben másolni és terjeszteni bármilyen fizikai vagy elektronikus adathordozón, de ezt a szerzõi jogokra vonatozó megjegyzést minden másolathoz mellékelni kell. Az üzleti célú terjesztés megengedett és bátorított, de a szerzõ szeretne tudomást szerezni minden ilyen terjesztésrõl.</P>
<P>Minden Linux HOGYANon alapuló fordítás, származtatott mû vagy összefoglaló munka ezen szerzõi jogi kötelmek alá kell essen. Ez azt jelenti, hogy nem szabad olyan HOGYANon alapuló mûvet létrehozni, amely további megkötéseket tartalmaz a terjesztésre. Bizonyos feltételek esetén ezek a szabályok figyelmen kívül hagyhatóak, errõl a Linux HOGYAN koorditátor ad felvilágosítást a lent olvasható címen.</P>
<P>Röviden megfogalmazva, szeretnénk, ha az információ elterjedne minél több csatornán, de szeretnénk megtartani a HOGYAN dokumentumok szerzõi jogát, és szeretnénk értesülni bármilyen terjesztési tervrõl.</P>
<P>Kérdésekkel a Linux HOGYAN koordinátorát, Tim Bynumot lehet megkeresni a  <CODE>linux-howto@metalab.unc.edu</CODE>  drótpostacímen.</P>

<H2><A NAME="ss5.2">5.2 Jogi felelõsség</A>
</H2>


<P>A Helyspórolás mini-HOGYANt Guido Gonzato írta (
<A HREF="REMOVE_MEguido@ibogeo.df.unibo.it">REMOVE_MEguido@ibogeo.df.unibo.it</A>).</P>
<P>Erre a dokumentumra nem vonatkozik semmilyen garancia. Nagyon igyekeztem, hogy hibátlan legyen, de mindenki csak a saját felelõsségére használhatja az itt közölt információkat. Semmilyen esetben sem lehet engem felelõssé tenni az itt leírtak felhasználásából eredõ károkért.</P>
<P>A visszajelzéseket örömmel veszem. Bármilyen kérdést, kérést, javaslatot szívesen meghallgatok.</P>
<P>Élvezzük a Linuxot és az életet!</P>
<P>Guido   <CODE>=8-)</CODE></P>

<H2><A NAME="ss5.3">5.3 Magyar fordítás</A>
</H2>


<P>A magyar fordítást 
<A HREF="mailto:timar_a@freemail.hu_NO_SPAM">Tímár András</A> készítette.
A lektorálást 
<A HREF="mailto:dacas@freemail.hu_NO_SPAM">Daczi László</A> végezte el (2002.11.11).
Bármilyen fordítással kapcsolatos észrevételt a 
<A HREF="mailto:linuxhowto@sch.bme.hu_NO_SPAM">linuxhowto@sch.bme.hu</A> címre küldjetek.
A dokumentum legfrissebb változata megtalálható a 
<A HREF="http://tldp.fsf.hu/index.html">Magyar Linux Dokumentációs Projekt</A> honlapján.</P>

</BODY>
</HTML>
