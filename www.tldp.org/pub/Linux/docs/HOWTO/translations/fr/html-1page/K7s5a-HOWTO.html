<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>

Guide pratique d'utilisation de la carte m&egrave;re Elite K7s5a sous Linux

</title><link href="style.css" rel="stylesheet" type="text/css"><meta content="DocBook XSL Stylesheets V1.68.1" name="generator"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" lang="fr"><div class="titlepage"><div><div><h1 class="title"><a name="N10002"></a>

Guide pratique d'utilisation de la carte m&egrave;re Elite K7s5a sous Linux

</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Sebfrance</span></h3><code class="email">&lt;<a href="mailto:rf POINT eerf CHEZ otwohecnarfbes">rf POINT eerf CHEZ otwohecnarfbes</a>&gt;</code></div></div><div><p class="othercredit"><span class="contrib">Pr&eacute;paration de la publication de la v.f.</span>: <span class="firstname">Jean-Philippe</span> <span class="surname">Gu&eacute;rard</span></p></div><div><p class="releaseinfo">Version&nbsp;: 1.1</p></div><div><p class="pubdate">30 mars 2002</p></div></div><hr></div><div class="toc"><p><b>Table des mati&egrave;res</b></p><dl><dt><span class="sect1"><a href="#N10022">1. Introduction</a></span></dt><dt><span class="sect1"><a href="#N10035">2. La carte son int&eacute;gr&eacute;e</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10038">2.1. Obtention des pilotes</a></span></dt><dt><span class="sect2"><a href="#N10049">2.2. Installation</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N10064">3. Les capteurs de la carte m&egrave;re</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10067">3.1. Obtention des pilotes</a></span></dt><dt><span class="sect2"><a href="#N1007A">3.2. Installation</a></span></dt></dl></dd></dl></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="N10022"></a>1.&nbsp;Introduction</h2></div></div></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td valign="top" align="center" rowspan="2" width="25"><img alt="[Important]" src="images/important.png"></td><th align="left">Important</th></tr><tr><td valign="top" align="left"><p>

La version fran&ccedil;aise de ce document est largement d&eacute;pass&eacute;e. 
Reportez-vous &agrave; l'original anglais... <a href="http://seb.france.free.fr/linux/K7S5A/en/K7s5a-HOWTO.html" target="_top">http://seb.france.free.fr/linux/K7S5A/en/K7s5a-HOWTO.html</a>.

</p></td></tr></table></div><p>

J'ai eut cette carte pour no&euml;l 2001, et apr&egrave;s quelques recherches, j'ai 
compris que le chipset sis735 n'&eacute;tait pas reconnu par <a href="http://www.mandrake.com" target="_top">mandrake</a> 8.0, <a href="http://www.opensound.com" target="_top">OSS</a> avait des pilotes qui 
fonctionnait bien mais je ne voulais pas les payer, donc j'ai &eacute;t&eacute; voir 
sur le cvs d'alsa et ai d&eacute;couvert qu'ils avait quelque chose pour le sis 
7012 et plus tard, ai aussi trouve&eacute; les pilotes pour les capteurs de 
temp&eacute;ratures de la carte.

</p></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="N10035"></a>2.&nbsp;La carte son int&eacute;gr&eacute;e</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="N10038"></a>2.1.&nbsp;Obtention des pilotes</h3></div></div></div><p>

Donc nous allons compiler les sources r&eacute;centes d'alsa, qui devrait 
fonctionner de la m&ecirc;me mani&egrave;re sur les autres distrib... Seulement les 
sources du noyau changeront puisque mandrake a ses propres patches. Vous 
pouvez obtenir ces sources sur le cd ou un ftp de votre distribution ou 
de <a href="http://www.kernel.org/pub/linux/kernel/" target="_top">http://www.kernel.org</a>. 
Ici, on pourra trouver les sources du noyau Mandrake utilis&eacute; sous 
8.0&nbsp;: <a href="ftp://ftp.univ-savoie.fr/pub/Linux/Mandrake/8.0/i586/Mandrake/RPMS/kernel-source-2.4.3-20mdk.i586.rpm" target="_top">ftp://ftp.univ-savoie.fr/pub/Linux/Mandrake/8.0/i586/Mandrake/RPMS/kernel-source-2.4.3-20mdk.i586.rpm</a>

</p><p>

il vous faudra aussi les pilotes d'alsa&nbsp;: <a href="ftp://ftp.alsa-project.org/pub/driver/alsa-driver-0.9.0beta10.tar.bz2" target="_top">ftp://ftp.alsa-project.org/pub/driver/alsa-driver-0.9.0beta10.tar.bz2</a>.

</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="N10049"></a>2.2.&nbsp;Installation</h3></div></div></div><p>

Installez vos sources du noyau, dans mon cas&nbsp;:

</p><pre class="programlisting">
rpm -ivh kernel-source-2.4.3-20mdk.i586.rpm
</pre><p>

Puis d&eacute;compressez les pilotes alsa&nbsp;:

</p><pre class="programlisting">
bzip2 -d alsa-driver-0.9.0beta10.tar.bz2 &amp;&amp; \
    tar -xvf alsa-driver-0.9.0beta10.tar
</pre><p>

les compiler, les installer, et cr&eacute;er les fichiers de p&eacute;riph&eacute;riques dans 
<code class="filename">/dev</code>.

</p><pre class="programlisting">
cd alsa-driver-0.9.0beta10 &amp;&amp; \
    make install &amp;&amp; ./snddevices
</pre><p>

&Eacute;ditez /etc/modules.conf pour tout r&eacute;gler en y ajoutant ces 
lignes&nbsp;:

</p><pre class="programlisting">
alias char-major-116 snd
alias char-major-14 soundcore
alias sound-slot-0 snd-card-0
alias sound-service-0-0 snd-mixer-oss
alias sound-service-0-1 snd-seq-oss
alias sound-service-0-3 snd-pcm-oss
alias sound-service-0-8 snd-seq-oss
alias sound-service-0-12 snd-pcm-oss
alias snd-card-0 snd-card-intel8x0
</pre></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="N10064"></a>3.&nbsp;Les capteurs de la carte m&egrave;re</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="N10067"></a>3.1.&nbsp;Obtention des pilotes</h3></div></div></div><p>

Il est <span class="emphasis"><em>imp&eacute;ratif</em></span> de prendre lm_sensors 2.6.2 
ou plus r&eacute;cent&nbsp;: <a href="http://www.lm-sensors.nu/archive/lm_sensors-2.6.2.tar.gz" target="_top">http://www.lm-sensors.nu/archive/lm_sensors-2.6.2.tar.gz</a>

</p><p>

Il vous faudra aussi les sources du noyau voir la rubrique 
&laquo;&nbsp;<span class="quote">Obtention des pilotes</span>&nbsp;&raquo; pour &laquo;&nbsp;<span class="quote">la carte son 
int&eacute;gr&eacute;e</span>&nbsp;&raquo;

</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="N1007A"></a>3.2.&nbsp;Installation</h3></div></div></div><pre class="programlisting">
tar -xzvf i2c-2.6.2.tar.gz
cd i2c-2.6.2
make &amp;&amp; make install
</pre><p>

Ensuite, j'ai eut un probl&egrave;me en faisant 
<code class="literal">make&nbsp;install</code>, donc si cela ne marche pas pour 
vous non plus, faites les commandes suivantes&nbsp;:

</p><pre class="programlisting">
cp kernel/i2c-core.o /lib/modules/`uname -r`/misc/i2c-core.o
cp kernel/i2c-proc.o /lib/modules/`uname -r`/misc/i2c-proc.o
cp kernel/chips/it87.o /lib/modules/`uname -r`/misc/it87.o
</pre><p>

ok, maintenant copie du programme sensors&nbsp;:

</p><pre class="programlisting">
cp prog/sensors/sensors /usr/bin/sensors
</pre><p>

&Eacute;ditez alors <code class="filename">/etc/modules.conf</code> et ajoutez lui ces 
lignes&nbsp;:

</p><pre class="programlisting">
alias char-major-89 i2c-dev
options it87 temp_type=0x31
</pre><p>
effectuez alors&nbsp;:
</p><pre class="programlisting">
modprobe i2c-proc
modprobe it87
modprobe i2c-isa
sensors
</pre><p>

Et l&agrave;, miracle&nbsp;! &Ccedil;a devrait fonctionner.

</p><p>

Sous le compte root, vous devriez &eacute;diter le 
<code class="filename">/etc/sensors.conf</code> la ligne contenant&nbsp;: 
<code class="literal">chip "it87-*"</code> et les suivantes permettent de modifier 
les r&eacute;glages pour obtenir les bons r&eacute;sultats, voici une copie de cette 
partie modifi&eacute;e de mon fichier (temp1 ne correspond &agrave; rien de pr&eacute;cis, 
seul temp2 et temp3 fonctionnent).

</p><pre class="programlisting">
chip "it87-*"
# The values below have been tested on Asus CUSI, CUM motherboards.
# Voltage monitors as advised in the It8705 data sheet
label in0 "VCore"
label in1 "Vcc2.5v"
label in2 "Vcc5v"
label in3 "+5V"
label in4 "+12V"
label in5 "-12V"
label in6 "-5V"
label in7 "SB 5V"
label in8 "V battery"
set in0_min 1.5 * 0.95
set in0_max 1.5 * 1.05
set in1_min 2.4
set in1_max 2.6
set in2_min 3.3 * 0.95
set in2_max 3.3 * 1.05
set in3_min 5.0 * 0.95
set in3_max 5.0 * 1.05
set in4_min 12 * 0.95
set in4_max 12 * 1.05
set in5_min -12 * 0.95
set in5_max -12 * 1.05
set in6_min -5 * 0.95
set in6_max -5 * 1.05
set in7_min 5 * 0.95
set in7_max 5 * 1.05
# vid not monitored by IT8705F
ignore  vid
# For this family of chips the negative voltage equation is different from
# the lm78.  The chip uses two external resistor for scaling but one is
# tied to a positive reference voltage.  See ITE8705/12 datasheet (SIS950
# data sheet is wrong)
# Vs = (1 + Rin/Rf) * Vin - (Rin/Rf) * Vref.
# Vref = 4.096 volts, Vin is voltage measured, Vs is actual voltage.
compute in2 (1 + 1)*@ ,       @/(1 + 1)
compute in3 ((6.8/10)+1)*@ ,  @/((6.8/10)+1)
compute in4 ((30/10) +1)*@  , @/((30/10) +1)
# The next two are negative voltages (-12 and -5).
# The following formulas must be used. Unfortunately the datasheet
# does not give recommendations for Rin, Rf, but we can back into
# them based on a nominal +2V input to the chip, together with a 4.096V Vref.
# Formula:
#    actual V = (Vmeasured * (1 + Rin/Rf)) - (Vref * (Rin/Rf))
#    For -12V input use Rin/Rf = 6.68
#    For -5V input use Rin/Rf = 3.33
# Then you can convert the forumula to a standard form like&nbsp;:
compute in5 (7.67 * @) - 27.36  ,  (@ + 27.36) / 7.67
compute in6 (4.33 * @) - 13.64  ,  (@ + 13.64) / 4.33
#
compute in7 ((6.8/10)+1)*@ ,  @/((6.8/10)+1)
# Temperature
label temp3       "Processor"
set   temp3_over  40
set   temp3_hyst  20
label temp2       "Mainboard"
set   temp2_over  45
set   temp2_hyst  25
ignore temp1
# Fans
label fan1"Processor's Fan"
set fan1_min 2000
ignore fan3
ignore fan2
</pre></div></div></div></body></html>