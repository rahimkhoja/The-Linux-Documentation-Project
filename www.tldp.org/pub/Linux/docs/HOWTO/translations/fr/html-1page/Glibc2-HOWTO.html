<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>HOWTO Glibc 2</TITLE>
</HEAD>
<BODY>
<H1>HOWTO Glibc 2</H1>

<H2>Eric Green, <CODE>ejg3@cornell.edu</CODE></H2>v1.5, 8 février 1998
<HR>
<EM>
<!--
Bibliothèque C  GNU (voir glibc)
-->
 
<!--
glibc
-->
 (Maintenance
de la version française par  Géraud Canet, <CODE>canet@labri.u-bordeaux.fr</CODE>) Le
HOWTO Glibc 2 couvre l'installation et l'utilisation de la bibliothèque C GNU
version 2 (libc 6) sur les systèmes Linux.</EM>
<HR>
<H2><A NAME="s1">1. Introduction</A></H2>



<H2><A NAME="ss1.1">1.1 Note du traducteur</A>
</H2>


<P>Ce document  a été  traduit  et maintenu jusqu'à  la  version 1.4 par Olivier
Tharan, dont je ne fais que reprendre modestement le travail. </P>
<P>Le document est  truffé  de signes  "cabalistiques"  comme des dièse et   des
pourcent,   dont    la    représentation    en     SGML   est  respectivement
<CODE>&amp;num;</CODE> et <CODE>&amp;percnt;</CODE> ;  le source LaTeX généré par les
outils  de conversion SGML introduit le  signe antislash devant ces signes et
reste dans la  version PostScript de ce document.  Les données d'exemple sont
donc erronées, mais vous pouvez vous rapporter  à la version HTML du document
qui n'a pas ces erreurs. La version d'origine connait les mêmes problèmes.</P>

<H2><A NAME="ss1.2">1.2 À propos de glibc 2</A>
</H2>

<P>
<!--
glibc!vue d'ensemble
-->
</P>
<P>Glibc 2 est la toute dernière version de la bibliothèque C du
GNU. Elle fonctionne pour l'instant sans modifications sur les
systèmes GNU Hurd, et les systèmes Linux sur architectures i386, m68k
et alpha. Les adaptations pour Linux PowerPC, MIPS, Sparc, Sparc 64 et
ARM seront dans la version 2.1. À l'avenir, d'autres architectures et
systèmes d'exploitation seront supportés.</P>
<P>Sur Linux, glibc 2 est utilisée comme libc avec un numéro majeur de
version égal à 6, le successeur de la libc 5 pour Linux. Elle est
destinée par les développeurs de la libc Linux à remplacer en fin de
compte la libc 5. À l'heure de la version 2.0.6, on considère que
glibc est de qualité suffisante pour être utilisée en production. La
version 2.1 (à venir dans un futur proche) sera prête pour une
utilisation normale avec l'ajout de plus de portages et de
possibilités.</P>
<P>Il y a trois extensions disponibles en option sur la glibc 2 :</P>
<P>
<DL>
<DT><B>Crypt</B><DD><P>Le paquetage UFC-crypt pour le cryptage des données. Il est
disponible séparément à cause de restrictions à l'exportation.</P>
<DT><B>LinuxThreads</B><DD><P>Une mise en oeuvre de l'interface Posix 1003.1c &quot;pthread&quot;.</P>
<DT><B>Locale data</B><DD><P>Contient les données nécessaires à la construction
des fichiers de données locale pour utiliser les possibilités
d'internationalisation de la glibc.</P>
</DL>
</P>
<P>Les extensions crypt et LinuxThreads sont fortement recommandées... Ne
pas les utiliser risque de les rendre incompatibles avec les
bibliothèques d'autres systèmes. (Si vous ne voulez pas les utiliser,
vous devez ajouter l'option --disable-sanity-checks quand vous lancez
configure.)</P>

<H2><A NAME="ss1.3">1.3 À propos de ce document</A>
</H2>


<P>Ce HOWTO couvre l'installation de la bibliothèque glibc 2 sur un
système Linux existant. Il est fait pour les utilisateurs de systèmes
à base de processeurs Intel qui utilisent pour l'instant la libc 5,
mais les utilisateurs d'autres systèmes et de bibliothèques similaires
(comme la glibc 1) devraient pouvoir utiliser ces informations en
substituant les noms de fichiers et d'architecture adéquats aux
endroits appropriés.</P>
<P>La copie la plus récente de ce HOWTO fait partie du 
<A HREF="http://sunsite.unc.edu/LDP">Linux Documentation Project</A>,
ou bien vous en trouverez une version à 
<A HREF="http://www.imaxx.net/~thrytis/glibc/Glibc2-HOWTO.html">http://www.imaxx.net/~thrytis/glibc/Glibc2-HOWTO.html</A>.</P>

<H2><A NAME="ss1.4">1.4 Changements récents dans ce document</A>
</H2>


<P>Différences entre la version 1.5 et 1.4 :</P>
<P>
<UL>
<LI>Indexage ajouté par Ed Bailey.</LI>
<LI>Changement de mon adresse électronique.</LI>
</UL>
</P>
<P>Différences entre la version 1.4 et 1.3 :</P>
<P>
<UL>
<LI>Changé l'état courant d'expérimental à production.</LI>
<LI>Mis à jour la liste des portages en développement.</LI>
<LI>Mis à jour la dernière version en 2.0.6.</LI>
</UL>
</P>

<H2><A NAME="s2">2. Choix de la méthode d'installation</A></H2>

<P>
<!--
glibc!installation
-->
</P>
<P>Il y a plusieurs manières d'installer glibc. Vous pouvez installer les
bibliothèques   pour  les    tester,  en  continuant   d'utiliser  les
bibliothèques existantes par défaut, tout en vous permettant d'essayer
les nouvelles bibliothèques  par l'utilisation d'options différentes à
la   compilation de votre programme.  L'installation  de cette manière
facilite aussi la désinstallation  de glibc dans le  futur (cependant,
tout programme  lié avec  la glibc  ne fonctionnera  plus une fois que
vous aurez enlevé les bibliothèques). L'utilisation de glibc comme une
bibliothèque de test demande  que  vous compiliez les  bibliothèques à
partir des   sources.  Il  n'y  a pas  de  distribution   binaire pour
l'installation de cette  manière. Cette installation  est décrite dans
la       section    
<A HREF="#test-install">installation comme bibliothèque de test</A>.</P>
<P>L'autre manière  de   l'installer,   décrite dans ce     document, est
d'utiliser  glibc  comme bibliothèque  principale.  Tous les  nouveaux
programmes que vous compilerez sur   votre système utiliseront  glibc,
bien que  vous puissiez toujours lier des  programmes  à vos anciennes
bibliothèques par des options de compilation différentes. Vous pouvez,
soit installer les bibliothèques  à partir de binaires,  soit compiler
la  bibliothèque vous-même.    Si vous  voulez  changer les    options
d'optimisation   ou de configuration,  ou  utiliser  une extension qui
n'est  pas distribuée  en  paquetage binaire,  vous devrez obtenir  la
distribution  de sources    et  compiler  vous-même.  Cette  procédure
d'installation est décrite dans  la section 
<A HREF="#primary-install">installation comme bibliothèque C principale</A>.</P>
<P>Frodo Looijaard décrit encore une autre  manière d'installer glibc. Sa
méthode implique l'installation de glibc comme bibliothèque secondaire
et la mise en place d'un compilateur croisé (<I>cross-compiler</I>) pour
compiler  en   utilisant  glibc.  Pour   cette   méthode, la procédure
d'installation est plus   compliquée que  l'installation en tant   que
bibliothèque de  test  décrite dans  ce   document, mais facilite   la
compilation  et l'édition   de  liens avec glibc.    Cette méthode est
décrite            dans       son            document             
<A HREF="http://huizen.dds.nl/~frodol/glibc/">Installer  glibc-2 sur Linux</A> (en anglais).</P>
<P>Si vous utilisez en  ce moment un système Debian  1.3 et ne voulez pas
le mettre à   jour en installant la   version instable de Debian  pour
utiliser             glibc,                    le                 
<A HREF="http://www.gate.net/~storm/FAQ/libc5-libc6-Mini-HOWTO.html">HOWTO libc5 vers libc6 Debian</A> décrit la manière d'utiliser les
paquetages Debian pour mettre votre système à jour.</P>
<P>Si vous installez glibc 2 sur un  système important, vous voudrez sans
doute utiliser l'installation de test. Même  s'il n'y a pas de bogues,
certains programmes devront être modifiés avant compilation à cause de
changements dans les prototypes de fonctions et les types de données.</P>


<H2><A NAME="getting"></A> <A NAME="s3">3. Obtenir la bibliothèque</A></H2>

<P>
<!--
glibc!obtention
-->
</P>
<P>La glibc 2 contient le paquetage glibc et trois paquetages
supplémentaires optionnels, LinuxThreads, Locale et Crypt. Vous pouvez
trouver les sources à </P>
<P>
<UL>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.6.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.6.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-linuxthreads-2.0.6.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-linuxthreads-2.0.6.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-localedata-2.0.6.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-localedata-2.0.6.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.6.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.6.tar.gz</A></LI>
</UL>
</P>
<P>Il vous faudra à peu près 150 Mo d'espace disque pour la compilation
complète et l'installation. L'installation binaire de base du
paquetage de la bibliothèque prend aux alentours de 50 Mo.</P>
<P>Les paquetages binaires pour la version 2.0.6 ne sont pas
disponibles. Les paquetages binaires pour la version 2.0.4 sont
disponibles pour i386 et m68k, et la version 2.0.1 pour les alpha,
vous les trouverez à</P>
<P>
<UL>
<LI>Intel x86:
<UL>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.4.bin.i386.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.4.bin.i386.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.4.bin.i386.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.4.bin.i386.tar.gz</A></LI>
</UL>
</LI>
<LI>Alpha:
<UL>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.1.bin.alpha-linux.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.1.bin.alpha-linux.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.1.bin.alpha-linux.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.1.bin.alpha-linux.tar.gz</A></LI>
</UL>
</LI>
<LI>m68k:
<UL>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.4-m68k-linux.bin.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.4-m68k-linux.bin.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.4-m68k-linux.bin.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.4-m68k-linux.bin.tar.gz</A></LI>
</UL>
</LI>
</UL>
</P>
<P>Il y a des restrictions à l'exportation de l'extension crypt. Les
utilisateurs non-ressortissants des États-Unis devraient l'obtenir à
<A HREF="ftp://ftp.ifi.uio.no/pub/gnu">ftp://ftp.ifi.uio.no/pub/gnu</A>.</P>
<P>Si vous utilisez une distribution Red Hat, vous pouvez obtenir les
RPMs pour la glibc 2 à 
<A HREF="ftp://ftp.redhat.com/pub/redhat/">ftp://ftp.redhat.com/pub/redhat/</A>. La glibc 2 est la
bibliothèque C principale de la nouvelle distribution Red Hat 5.0.</P>
<P>Si vous utilisez une distribution Debian, vous pouvez obtenir les
paquetages pour glibc 2 à 
<A HREF="ftp://ftp.debian.org/debian/dists/unstable/main/">ftp://ftp.debian.org/debian/dists/unstable/main/</A>. Les
fichiers sont nommés libc6. Glibc 2 fait maintenant partie du
paquetage de base de la version hamm de Debian, et sera la libc
principale quand Debian 2.0 sortira.</P>


<H2><A NAME="test-install"></A> <A NAME="s4">4. Installation comme bibliothèque de test</A></H2>

<P>
<!--
glibc!test
-->
</P>
<P>Cette section couvre l'installation de glibc 2 comme bibliothèque de
test. Tout ce que vous compilerez sera lié à vos bibliothèques
existantes sauf si vous donnez des paramètres supplémentaires pour les
lier aux nouvelles bibliothèques. Il semble que les chemins d'accès
soient compilés dans un certain nombre de fichiers, et vous devrez
probablement installer la bibliothèque à partir des sources.</P>

<H2><A NAME="ss4.1">4.1 Compilation et installation</A>
</H2>



<H3>Éléments requis</H3>

<P>
<!--
glibc!test!éléments requis
-->
</P>
<P>
<UL>
<LI>À peu pres 150 Mo d'espace disque libre</LI>
<LI>GNU make 3.75</LI>
<LI>gcc &gt;= 2.7.2 (ou mieux, 2.7.2.1)</LI>
<LI>binutils 2.8.1 (pour les alpha vous devez utiliser une mise à
jour temporaire ou <I>snapshot</I>)</LI>
<LI>bash 2.0</LI>
<LI>autoconf 2.12 (si vous changez configure.in)</LI>
<LI>texinfo 3.11</LI>
</UL>
</P>
<P>Sur un i586 à 133 MHz avec 64 Mo de RAM, il faut environ trois heures
pour compiler les bibliothèques complètes avec les extensions. Sur un
i686 à 200 MHz chargé, il faut environ une demi-heure.</P>

<H3>Extraction des sources</H3>

<P>
<!--
glibc!test!sources, extraction
-->
</P>
<P>Vous devez extraire les sources des archives pour pouvoir les
compiler. La meilleure façon de procéder est de faire ainsi :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 tar xzf glibc-2.0.6.tar.gz
 cd glibc-2.0.6
 tar xzf ../glibc-linuxthreads-2.0.6.tar.gz
 tar xzf ../glibc-crypt-2.0.6.tar.gz
 tar xzf ../glibc-localedata-2.0.6.tar.gz
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ceci mettra les répertoires linuxthreads, crypt et localedate dans le
répertoire glibc-2.0.6 où configure pourra trouver ces extensions.</P>

<H3>Configuration</H3>

<P>
<!--
glibc!test!configuration
-->
</P>
<P>Dans le répertoire glibc-2.0.6, créez un répertoire appelé compile, et
déplacez-vous dedans.  Tout  le travail  doit   être effectué dans  ce
répertoire,  ce qui simplifiera le  nettoyage  (les développeurs ne se
sont pas très occupés de rendre 'make clean' parfait pour l'instant).</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 mkdir compile
 cd compile
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Lancez <CODE>../configure</CODE>. Pour utiliser les paquetages
d'extension, vous devez les spécifier avec --enable-add-ons, comme
--enable-add-ons=linuxthreads,crypt,localedata. Vous devez aussi
choisir un répertoire de destination pour
l'installation. /usr/i486-linuxglibc2 est un bon choix. La ligne de
commande de configure pour ceci serait :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 ../configure --enable-add-ons=linuxthreads,crypt,localedata --prefix=/usr/i486-linuxglibc2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3>Compilation et installation</H3>

<P>
<!--
glibc!test!compilation
-->

<!--
glibc!test!installation
-->
</P>
<P>Pour compiler et vérifier, lancez :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 make
 make check
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Si le 'make check' réussit, installez la bibliothèque :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 make install
 
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="ss4.2">4.2 Mise à jour du chargeur de liens dynamique</A>
</H2>

<P>
<!--
glibc!test!chargeur de liens dynamique, mise à jour
-->

<!--
glibc!test!ld.so.conf, mise à jour
-->
</P>
<P>
<OL>
<LI>Créez un lien à partir du nouvel <CODE>ld.so</CODE> vers <CODE>/lib/ld-linux.so.2</CODE> :
<BLOCKQUOTE><CODE>
<PRE>
 ln -s /usr/i486-linuxglibc2/lib/ld-linux.so.2 /lib/ld-linux.so.2
 
</PRE>
</CODE></BLOCKQUOTE>


C'est la seule bibliothèque dont l'emplacement est fixé une fois qu'un
programme est lié, et l'utilisation d'un lien dans <CODE>/lib</CODE> facilitera le
passage à glibc en tant que bibliothèque C principale quand la version
stable sortira.
</LI>
<LI>Éditez <CODE>/etc/ld.so.conf</CODE>. Vous devez ajouter le chemin vers le
répertoire lib dans lequel se trouvent les nouvelles bibliothèques à
la fin du fichier, qui sera <CODE>&lt;préfixe&gt;/lib</CODE>, comme
<CODE>/usr/i486-linuxglibc2/lib</CODE> dans l'exemple ci-dessus. Après avoir
modifié <CODE>/etc/ld.so.conf</CODE>, lancez

<BLOCKQUOTE><CODE>
<PRE>
 ldconfig -v
 
</PRE>
</CODE></BLOCKQUOTE>
</LI>
</OL>
</P>

<H2><A NAME="ss4.3">4.3 Configuration pour gcc</A>
</H2>

<P>
<!--
glibc!test!configuration de gcc
-->
</P>
<P>La dernière étape de l'installation est la mise à jour de
<CODE>/usr/lib/gcc-lib</CODE> pour que gcc sache comment utiliser les nouvelles
bibliothèques. D'abord vous devez dupliquer la configuration
existante. Pour savoir quelle est la configuration en cours, utilisez
l'option -v de gcc :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 % gcc -v
 Reading specs from /usr/lib/gcc-lib/i486-unknown-linux/2.7.2.2/specs
 gcc version 2.7.2.2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Dans ce cas, i486-unknown-linux est le système, et 2.7.2.2 est la
version. Vous devez copier <CODE>/usr/lib/gcc-lib/&lt;système&gt;</CODE>
vers le nouveau répertoire système de test :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/lib/gcc-lib/
 cp -r i486-unknown-linux i486-linuxglibc2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Allez dans le nouveau répertoire système de test et dans le répertoire
version</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>et éditez le fichier <CODE>specs</CODE> se trouvant dans ce
répertoire. Dans ce fichier, changez <CODE>/lib/ld-linux.so.1</CODE> en
<CODE>/lib/ld-linux.so.2</CODE>. Vous devrez aussi enlever toutes les
expressions <CODE>%{...:-lgmon}</CODE> du fichier, puisque glibc
n'utilise pas la bibliothèque gmon pour les optimisations. Vous
trouverez un fichier specs d'exemple dans la section 
<A HREF="#specs">Fichiers specs d'exemple</A>.</P>

<H2><A NAME="ss4.4">4.4 Mise à jour des liens des fichiers d'en-tête</A>
</H2>

<P>
<!--
glibc!test!fichiers d'en-tête, mise à jour
-->
</P>
<P>Vous devez créer des liens dans votre nouveau répertoire d'en-têtes
vers d'autres répertoires d'en-têtes :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/i486-linuxglibc2/include
 ln -s /usr/src/linux/include/linux
 ln -s /usr/src/linux/include/asm
 ln -s /usr/X11R6/include/X11
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Vous avez peut-être d'autres bibliothèques comme ncurses qui
nécessitent d'avoir leurs fichiers d'en-têtes dans ce répertoire. Vous
devriez copier ou faire un lien vers ces fichiers depuis
<CODE>/usr/include</CODE>. (Certaines bibliothèques auront besoin d'être
recompilées avec glibc2 pour pouvoir fonctionner avec glibc2. Dans ces
cas, compilez simplement et installez les paquetages dans
<CODE>/usr/i486-linuxglibc2</CODE>.)</P>

<H2><A NAME="ss4.5">4.5 Test de l'installation</A>
</H2>

<P>
<!--
glibc!test
-->
</P>
<P>Pour tester l'installation, créez le programme suivant dans un fichier
appelé glibc.c :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 #include &lt;stdio.h&gt;

 main()
 {
     printf("hello world!\n");
 }
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>et compilez-le avec les options &quot;-b &lt;répertoire d'installation&gt; -nostdinc -I&lt;répertoire d'installation&gt;/include -I/usr/lib/gcc-lib/&lt;nouveau système&gt;/&lt;version de gcc&gt;/include&quot; :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 % gcc -b i486-linuxglibc2 -nostdinc -I/usr/i486-linuxglibc2/include -I/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include glibc.c -o glibc
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Utilisez ldd pour vérifier que le programme a été lié avec glibc2, et
non avec votre ancienne libc :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 % ldd glibc
 libc.so.6 => /usr/i486-linuxglibc2/lib/libc-2.0.6.so (0x4000d000)
 /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>S'il compile, que les liens sont effectués et qu'il génère
&quot;hello world!&quot; quand vous le lancez, l'installation a
fonctionné.</P>


<H2><A NAME="primary-install"></A> <A NAME="s5">5. Installation comme bibliothèque C principale</A></H2>

<P>
<!--
glibc!installation
-->
</P>
<P>Cette section couvre l'installation de glibc2 comme bibliothèque C
principale. Tous les nouveaux programmes que vous compilerez seront
liés avec cette bibliothèque, sauf si vous utilisez des options de
compilation spéciales pour le lier avec une autre version.</P>
<P>Si  vous utilisez Redhat ou Debian  et avez chargé  les fichier rpm ou
deb  adéquats, voyez    les  instructions  d'installation   Redhat  ou
Debian. Vous pouvez alors sauter cette section.</P>


<H2><A NAME="compiling"></A> <A NAME="ss5.1">5.1 Construction de la bibliothèque à partir des sources</A>
</H2>

<P>
<!--
glibc!installation!compilation
-->
</P>
<P>Cette section explique comment compiler glibc 2 et ses extensions à
partir des sources. Vous devez compiler la bibliothèque si vous voulez
changer les options d'optimisation ou de configuration ou utiliser un
paquetage pour lequel vous n'avez pas de binaire.</P>

<H3>Éléments requis</H3>

<P>
<!--
glibc!installation!éléments requis
-->
</P>
<P>
<UL>
<LI>Environ 150 Mo d'espace disque libre</LI>
<LI>GNU make 3.75</LI>
<LI>gcc &gt;= 2.7.2 (ou mieux, 2.7.2.1)</LI>
<LI>binutils 2.8.1 (pour les alpha vous aurez besoin d'une version 'snapshot')</LI>
<LI>bash 2.0</LI>
<LI>autoconf 2.12 (si vous changez configure.in)</LI>
<LI>texinfo 3.11</LI>
</UL>
</P>
<P>Sur un i586 à 133 MHz avec 64 Mo de RAM, il faut environ trois heures
pour compiler toutes les bibliothèques avec les extensions. Sur un
i686 à 200 MHz chargé, il faut environ une demi-heure.</P>


<H3>Extraction des sources</H3>

<P>
<!--
glibc!installation!sources, extraction
-->
</P>
<P>Vous devez extraire les sources des archives pour compiler. La
meilleure façon de le faire est ainsi :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 tar xzf glibc-2.0.6.tar.gz
 cd glibc-2.0.6
 tar xzf ../glibc-linuxthreads-2.0.6.tar.gz
 tar xzf ../glibc-crypt-2.0.6.tar.gz
 tar xzf ../glibc-localedata-2.0.6.tar.gz
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ceci mettra les répertoires linuxthreads, crypt et localedata dans le
répertoire glibc-2.0.6 où configure pourra trouver ces extensions.</P>

<H3>Configuration</H3>

<P>
<!--
glibc!installation!configuration
-->
</P>
<P>Dans   le répertoire <CODE>glibc-2.0.6</CODE>,  créez  un répertoire nommé
compile, et  allez   dedans.  Tout  le  travail   sera fait   dans  ce
répertoire, ce qui simplifiera le   nettoyage (les développeurs ne  se
sont pas vraiment soucié du 'make clean' pour l'instant).</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
mkdir compile
cd compile
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Lancez <CODE>../configure</CODE>. Pour utiliser les paquetages supplémentaires,
vous devez les spécifier avec --enable-add-ons, comme
--enable-add-ons=linuxthreads,crypt,localedata. Vous devrez aussi
sûrement spécifier les chemins où elle sera installée. Pour coller aux
distributions Linux normales, spécifiez --prefix=/usr. (Quand on
spécifie le préfixe <CODE>/usr</CODE> sur un système Linux, configure sait ajuster
les autres chemins pour placer libc.so et d'autres bibliothèques
importantes dans <CODE>/lib</CODE>.) La ligne de commande complète de configure
serait :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 ../configure --enable-add-ons=linuxthreads,crypt,localedata --prefix=/usr
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3>Compilation</H3>

<P>
<!--
glibc!installation!compilation
-->
</P>
<P>Pour compiler et vérifier, lancez :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 make
 make check
 
</PRE>
</CODE></BLOCKQUOTE>
</P>


<H2><A NAME="ss5.2">5.2 Préparation à l'installation</A>
</H2>

<P>
<!--
glibc!installation!preparation pour
-->
</P>
<P>Vous devez maintenant déplacer certains fichiers pour vous préparer à
l'arrivée de la nouvelle bibliothèque, que vous l'installiez à partir
des sources ou de binaires. Tous les nouveaux programmes compilés
seront liés à glibc, mais les vieux programmes qui ne sont pas liés en
statique dépendront encore de libc 5, et vous ne pouvez donc pas
écraser l'ancienne version.</P>
<P>
<OL>
<LI>Créez un nouveau répertoire pour y mettre les anciens fichiers :
<BLOCKQUOTE><CODE>
<PRE>
 mkdir -p /usr/i486-linuxlibc5/lib
 
</PRE>
</CODE></BLOCKQUOTE>

</LI>
<LI>Les vieux fichiers d'en-tête doivent être évacués de
<CODE>/usr/include</CODE> :
<BLOCKQUOTE><CODE>
<PRE>
 mv /usr/include /usr/i486-linuxlibc5/include
 
</PRE>
</CODE></BLOCKQUOTE>

</LI>
<LI>Créez un nouveau répertoire d'en-têtes et activez les liens vers
d'autres en-têtes :
<BLOCKQUOTE><CODE>
<PRE>
 mkdir /usr/include

 ln -s /usr/src/linux/include/linux /usr/include/linux
 ln -s /usr/src/linux/include/asm /usr/include/asm
 ln -s /usr/X11R6/include/X11 /usr/include/X11
 ln -s /usr/lib/g++-include /usr/include/g++
 
</PRE>
</CODE></BLOCKQUOTE>


Les liens devront être ajustés au besoin selon votre
distribution. Rien que la Slackware installe les en-têtes g++ dans
<CODE>/usr/local/g++-include</CODE>, alors que Debian met les en-têtes
dans <CODE>/usr/include/g++</CODE>, et fait un lien de
<CODE>/usr/lib/g++-include</CODE> vers <CODE>/usr/include/g++</CODE>. Dans
d'autres cas, vous voudrez sûrement déplacer le répertoire d'en-têtes
g++ d'origine à son ancien emplacement <CODE>/usr/include</CODE>.
</LI>
<LI>Remettre des fichiers d'en-têtes et des liens
supplémentaires. Certaines bibliothèques non standards comme ncurses
installent des fichiers dans <CODE>/usr/include</CODE> ou installent un
lien vers leur répertoire d'en-tête dans <CODE>/usr/include</CODE>. Ces
fichiers et liens doivent être remis en place pour pouvoir utiliser
les bibliothèques supplémentaires correctement.
</LI>
<LI>Ajoutez le nouveau répertoire de bibliothèque (comme
<CODE>/usr/i486-linuxlibc5/lib</CODE>) <EM>en haut</EM> de votre fichier
<CODE>/etc/ld.so.conf</CODE>. Vous devriez avoir ld.so-1.8.8 ou mieux
installé pour éviter d'avoir des messages bizarres une fois que glibc
sera installée.
</LI>
<LI>Déplacez ou copiez toutes les anciennes bibliothèques C dans le
nouveau répertoire.

<BLOCKQUOTE><CODE>
<PRE>
 mv /usr/lib/libbsd.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libc.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libgmon.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libm.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libmcheck.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libc.so /usr/i486-linuxlibc5/lib
 mv /usr/lib/libm.so /usr/i486-linuxlibc5/lib
 cp /lib/libm.so.5.* /usr/i486-linuxlibc5/lib
 cp /lib/libc.so.5.* /usr/i486-linuxlibc5/lib
 
</PRE>
</CODE></BLOCKQUOTE>


<CODE>libm.so.5</CODE> et <CODE>libc.so.5</CODE> doivent être copiées et non
déplacées si <CODE>/usr</CODE> est une partition différente de <CODE>/</CODE>,
parce qu'elles sont nécessaires aux programmes utilisés pour démarrer
Linux et doivent être situées sur la partition racine.
</LI>
<LI>Déplacez les fichiers <CODE>/usr/lib/*.o</CODE> dans le nouveau
répertoire.

<BLOCKQUOTE><CODE>
<PRE>
 mv /usr/lib/crt1.o /usr/i486-linuxlibc5/lib
 mv /usr/lib/crti.o /usr/i486-linuxlibc5/lib
 mv /usr/lib/crtn.o /usr/i486-linuxlibc5/lib
 mv /usr/lib/gcrt1.o /usr/i486-linuxlibc5/lib
 
</PRE>
</CODE></BLOCKQUOTE>

</LI>
<LI>Mettez à jour votre cache de bibliothèque après avoir déplacé
vos bibliothèques.

<BLOCKQUOTE><CODE>
<PRE>
 ldconfig -v
 
</PRE>
</CODE></BLOCKQUOTE>
</LI>
</OL>
</P>

<H2><A NAME="ss5.3">5.3 Installation à partir du paquetage binaire</A>
</H2>

<P>
<!--
glibc!installation!binaires pré-compilés
-->
</P>
<P>Si vous installez glibc à partir de binaires précompilés, vous devez :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 cd /
 gzip -dc glibc-2.0.bin.i386.tar.gz | tar tvvf -
 gzip -dc glibc-crypt-2.0.bin.i386.tar.gz | tar tvvf -
 ldconfig -v
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Si vous avez une architecure ou une version différente, substituez les
noms de fichiers adéquats.</P>

<H2><A NAME="ss5.4">5.4 Installation à partir des sources</A>
</H2>

<P>
<!--
glibc!installation!à partir des sources
-->
</P>
<P>Pour installer la bibliothèque à partir des sources, lancez :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 make install
 ldconfig -v
 
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="ss5.5">5.5 Mise à jour des specs gcc</A>
</H2>

<P>
<!--
glibc!installation!fichier de specs gcc, mise à jour
-->
</P>
<P>L'étape finale de l'installation (à la fois pour les installations
binaires et sources) est de mettre à jour le fichier <CODE>specs</CODE> de
gcc pour que vous puissiez lier vos programmes proprement. Pour
déterminer quel fichier specs est utilisé par gcc, lancez :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 % gcc -v
 reading specs from /usr/lib/gcc-lib/i486-unknown-linux/2.7.2.2/specs
 gcc version 2.7.2.2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Dans ce cas, i486-unknown-linux est le système, et 2.7.2.2 est la
version. Vous devez copier <CODE>/usr/lib/gcc-lib/&lt;système&gt;</CODE>
dans l'ancien répertoire système :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/lib/gcc-lib/
 cp -r i486-unknown-linux i486-linuxlibc5
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Allez dans le répertoire d'origine et dans le répertoire de version</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/lib/gcc-lib/i486-unknown-linux/2.7.2.2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>et éditez le fichier <CODE>specs</CODE> que vous y trouverez. Dans ce
fichier, changez <CODE>/lib/ld-linux.so.1</CODE> en
<CODE>/lib/ld-linux.so.2</CODE>. Vous devrez aussi enlever toutes les
expressions <CODE>%{...:-lgmon}</CODE> de ce fichier, puisque glibc
n'utilise pas la bibliothèque gmon pour les optimisations. Un fichier
specs d'exemple se trouve dans la section 
<A HREF="#specs">fichiers specs d'exemple</A>.</P>


<H2><A NAME="ss5.6">5.6 Test de l'installation</A>
</H2>

<P>
<!--
glibc!installation!test
-->
</P>
<P>Pour tester l'installation, créez le programme suivant dans un fichier
appelé glibc.c :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 #include &lt;stdio.h&gt;

 main()
 {
     printf("hello world!\n");
 }
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>et compilez le programme.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 % gcc glibc.c -o glibc
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Utilisez ldd pour vérifier que le programme a été lié avec glibc2, et
non avec votre ancienne libc :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 % ldd glibc
 libc.so.6 => /lib/libc.so.6 (0x4000e000)
 /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Si ça compile et que ça génère &quot;hello world!&quot; quand vous
le lancez, l'installation est réussie.</P>


<H2><A NAME="s6">6. Compilation avec la libc non principale</A></H2>

<P>
<!--
glibc!compilation avec une autre bibliothèque
-->
</P>
<P>Il y  a des fois où vous  voudrez utiliser une bibliothèque différente
pour compiler vos programmes. Cette section explique comment faire, en
utilisant les noms de  répertoires et d'installation utilisés dans les
exemples des deux  sections précédentes. Souvenez-vous  de changer les
noms pour coller à votre configuration.</P>


<H2><A NAME="ss6.1">6.1 Avertissement concernant l'utilisation de libcs non principales</A>
</H2>

<P>
<!--
glibc!compilation avec une autre bibliothèque!avertissement
-->
</P>
<P>Avant de compiler un programme utilisé dans le processus de démarrage,
rappelez-vous que   si  le programme est  lié  dynamiquement,   et est
utilisé avant  que  les partitions non-racines  soient montées, toutes
les  bibliothèques liées doivent    être sur la partition racine.   En
suivant  la procédure d'installation   de la  section précédente  pour
installer glibc comme bibliothèque C principale, la vieille libc reste
dans  <CODE>/lib</CODE>,  qui sera sur  votre  partition racine. Ceci veut
dire  que   tous  vos programmes    fonctionneront   encore lors    du
démarrage.    Cependant,  si  <CODE>/usr</CODE>   est  sur   une partition
différente et que vous installez glibc comme bibliothèque de test dans
<CODE>/usr/i486-linuxglibc2</CODE>, tous les  nouveaux programmes que vous
compilerez  avec  glibc ne fonctionneront pas   tant  que la partition
<CODE>/usr</CODE> ne sera pas montée.</P>

<H2><A NAME="ss6.2">6.2 Compilation des programmes avec une glibc de test</A>
</H2>

<P>
<!--
glibc!compilation avec une autre bibliothèque!glibc
-->
</P>
<P>Pour compiler un programme avec glibc en installation de test, vous
devez mettre à zéro les chemins d'en-tête pour qu'ils pointent vers
les en-têtes glibc. En spécifiant &quot;-nostdinc&quot;, vous
annulerez les chemins normaux, et
&quot;-I/usr/i486-linuxglibc2/include&quot; pointera vers les
entêtes de glibc. Vous devrez aussi spécifier les en-têtes gcc, que
l'on trouve dans
<CODE>/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include</CODE> (en
supposant que vous ayez installé la bibliothèque de test dans
i486-linuxglibc2 avec gcc version 2.7.2.2).</P>
<P>Pour lier un programme à une glibc de test, vous devez spécifier la
configuration gcc. Vous le faites avec l'option &quot;-b
i486-linuxglibc2&quot;.</P>
<P>Pour la plupart des programmes, vous pouvez spécifier ces nouvelles
options en les ajoutant aux options de makefile
<CODE>$CFLAGS</CODE> et <CODE>$LDFLAGS</CODE> :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 CFLAGS = -nostdinc -I/usr/i486-linuxglibc2/include -I/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include -b i486-linuxglibc2
 LDFLAGS = -b i486-linuxglibc2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Si vous utilisez un script configure, définissez les variables shell
<CODE>$CFLAGS</CODE> et <CODE>$LDFLAGS</CODE> (en utilisant
env/setenv pour csh/tcsh ou set/export pour sh/bash/etc) avant de
lancer configure. Les makefiles générés par celui-ci devraient
contenir les variables <CODE>$CFLAGS</CODE> et
<CODE>$LDFLAGS</CODE> correctes. Tous les scripts configure ne
tiendront pas compte des variables, et par conséquent vous devriez
vérifier après avoir lancé configure et éditer les makefiles à la main
si nécessaire.</P>
<P>Si les programmes que vous compilez n'appellent que gcc (et pas cpp ou
les binutils directement), vous pouvez utiliser le script suivant pour
économiser la spécification des options à chaque fois :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 #!/bin/bash
 /usr/bin/gcc -b i486-linuxglibc2 -nostdinc \
              -I/usr/i486-linuxglibc2/include \
              -I/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include "$@"
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Vous pourrez alors utiliser ce script à la place de &quot;gcc&quot;
pour compiler.</P>

<H2><A NAME="ss6.3">6.3 Compilation des programmes avec libc 5 quand glibc est la bibliothèque principale</A>
</H2>

<P>
<!--
glibc!compilation avec une autre bibliothèque!libc 5
-->
</P>
<P>Pour compiler un programme avec vos anciennes bibliothèques quand vous
avez installé glibc comme bibliothèque principale, vous devez mettre à
zéro les chemins d'en-têtes vers les anciennes en-têtes. En spécifiant
&quot;-nostdinc&quot;, vous annulerez les chemins normaux et
&quot;-I/usr/i486-linuxlibc5/include&quot; pointera vers les
en-têtes libc 5. Vous devez aussi indiquer
&quot;-I/usr/lib/gcc-lib/i486-linuxlibc5/2.7.2.2/include&quot; pour
inclure les en-têtes spécifiques à gcc. Rappelez-vous d'ajuster ces
chemins selon la manière dont vous avez nommé les nouveaux répertoires
et selon votre version de gcc.</P>
<P>Pour lier un programme à votre ancienne libc, vous devez spécifier la
configuration de gcc. Vous le faites en utilisant l'option &quot;-b
i486-linuxlibc5&quot;.</P>
<P>Pour la plupart des programmes, vous pouvez indiquer ces nouvelles
options en les ajoutant aux options de makefile
<CODE>$CFLAGS</CODE> et <CODE>$LDFLAGS</CODE> :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 CFLAGS = -nostdinc -I/usr/i486-linuxlibc5/include -I/usr/lib/gcc-lib/i486-linuxlibc5/2.7.2.2/include -b i486-linuxlibc5
 LDFLAGS = -b i486-linuxlibc5
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Si vous utilisez un script configure, définissez les variables shell
<CODE>$CFLAGS</CODE> et <CODE>$LDFLAGS</CODE> (en utilisant
env/setenv pour csh/tcsh, ou set/export pour sh/bash/etc) avant de
lancer configure. Les makefiles générés par celui-ci devraient
contenir les variables <CODE>$CFLAGS</CODE> et
<CODE>$LDFLAGS</CODE> corrects. Tous les scripts configure ne
verront pas les variables, et vous devriez donc vérifier après avoir
lancé configure et éditer les makefiles si nécessaire.</P>
<P>Si les programmes que vous compilez n'appellent que gcc (et pas cpp ou
binutils directement), vous pouvez utiliser le script suivant pour
éviter de devoir indiquer toutes les options à chaque fois :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 #!/bin/bash
 /usr/bin/gcc -b i486-linuxlibc5 -nostdinc \
              -I/usr/i486-linuxlibc5/include \
              -I/usr/lib/gcc-lib/i486-linuxlibc5/2.7.2.2/include "$@"
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Vous pouvez alors utiliser ce script à la place de &quot;gcc&quot;
pour la compilation.</P>


<H2><A NAME="s7">7. Compilation des programmes C++</A></H2>

<P>
<!--
glibc!programmes C++, compilation
-->
</P>
<P>Libg++ utilise des parties de la bibliothèque mathématique, elle est
donc liée à libm. Puisque votre bibliothèque libg++ existante aura été
compilée avec votre ancienne bibliothèque, vous devrez recompiler
libg++ avec glibc ou obtenir une copie binaire. Les dernières sources
de libg++, en même temps qu'un binaire lié à glibc (pour x86) se
trouvent à 
<A HREF="ftp://ftp.yggdrasil.com/private/hjl/">ftp://ftp.yggdrasil.com/private/hjl/</A>.</P>


<H2><A NAME="ss7.1">7.1 Installation de libg++ pour une installation glibc de test</A>
</H2>

<P>
<!--
glibc!libg++, installation!comme bibliothèque de test
-->
</P>
<P>Si vous avez installé glibc comme bibliothèque de test, vous devez
installer les fichiers dans le répertoire dans lequel vous avez
installé glibc (comme <CODE>/usr/i486-linuxglibc2</CODE> pour l'exemple
des sections précédentes). Si vous installez à partir du paquetage
binaire (ce que je recommanderais, puisque je n'ai jamais eu de chance
pour compiler libg++ de cette manière), vous devez extraire les
fichiers dans un répertoire temporaire et déplacer tous les fichiers
<CODE>usr/lib/</CODE> dans le répertoire <CODE>&lt;répertoire
install&gt;/lib/</CODE>, les fichiers <CODE>usr/include/</CODE> dans le
répertoire <CODE>&lt;répertoire install&gt;/include/</CODE> (rappelez-vous
d'effacer le lien <CODE>include/g++</CODE> avant !), et les fichiers
<CODE>usr/bin/</CODE> dans le répertoire <CODE>&lt;répertoire
install&gt;/bin/</CODE>.</P>

<H2><A NAME="ss7.2">7.2 Installation de libg++ pour une installation glibc principale</A>
</H2>

<P>
<!--
glibc!libg++, installation!comme bibliothèque primaire
-->
</P>
<P>Si vous avez installé glibc comme bibliothèque principale, vous devez
d'abord déplacer vos anciens fichiers libg++ dans l'ancien répertoire
libc si vous voulez encore pouvoir compiler des programmes g++ avec votre
ancienne libc. La meilleure façon de procéder est probablement
d'installer une nouvelle copie de libg++ compilée avec libc 5 comme
dans la section précédente, et ensuite d'installer la version glibc
normalement.</P>

<H2><A NAME="ss7.3">7.3 Compilation de programmes C++ avec la libc non principale</A>
</H2>

<P>
<!--
glibc!programmes C++, compilation!avec une libc non principale
-->
</P>
<P>Si vous essayez de compiler un programme C++ avec une libc non
principale, vous devrez inclure le répertoire d'en-têtes g++, qui dans
les exemples ci-dessus serait <CODE>/usr/i486-linuxglibc2/include/g++</CODE> pour
une installation glibc de test ou <CODE>/usr/i486-linuxlibc5/include/g++</CODE>
pour une installation glibc principale. On peut faire cela en général
en ajoutant à la variable <CODE>$CXXFLAGS</CODE> :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 CXXFLAGS = -nostdinc -I/usr/i486-linuxglibc2/include -I/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include -I/usr/i486-linuxlibc5/include/g++ -b i486-linuxglibc2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>


<H2><A NAME="s8">8. Indiquer les bogues</A></H2>

<P>
<!--
glibc!bogues, indication
-->
</P>
<P>Si vous pensez que la bibliothèque est vérolée, veuillez d'abord lire
la FAQ. Il se peut que d'autres personnes aient eu ce problème et
qu'il y ait une solution simple. Vous devriez aussi regarder la partie
"Outils recommandés pour l'installation de la bibliothèque C de GNU"
dans le fichier <CODE>INSTALL</CODE> puisque certains bogues proviennent des
outils et non de glibc.</P>
<P>Une  fois que  vous  avez trouvé   un bug, assurez-vous   que c'en est
vraiment un.  Une bonne manière  de le  faire  est  de regarder si  la
bibliothèque C  GNU se   comporte de  la   même manière  qu'une  autre
bibliothèque  C.  S'il en   est ainsi, vous  vous  êtes  trompé et les
bibliothèques ont raison (mais pas forcément).  Dans le cas contraire,
l'une des bibliothèques a probablement tort.</P>
<P>Ensuite, dirigez-vous vers 
<A HREF="http://www-gnats.gnu.org:8080/cgi-bin/wwwgnats.pl">http://www-gnats.gnu.org:8080/cgi-bin/wwwgnats.pl</A>, et parcourez
la base de données des bugs. Vérifiez bien que le problème n'a pas
déjà été indiqué. Vous devriez aussi jeter un coup d'oeil au fichier
<CODE>BUGS</CODE> (ditribué avec glibc) pour prendre connaissance des bugs
connus.</P>
<P>Une fois que vous êtes sûr d'avoir trouvé un bug, essayez de le
réduire au plus petit test pratique qui reproduit le problème. Dans le
cas d'une bibliothèque C, vous ne devrez probablement en être réduit
qu'à un appel de fonction de la bibliothèque, si possible. Ceci ne
devrait pas être trop difficile.</P>
<P>L'étape finale une fois que vous avez un exemple simple de test est
d'indiquer le bug. En indiquant un bug, envoyez votre exemple de test,
les résultats que vous avez obtenus, ce que vous pensez être le
problème (si vous avez pensé à quelque chose), le type de votre
système, les versions de la bibliothèque C GNU, du compilateur GNU CC
et des GNU binutils que vous utilisez. Ajoutez aussi les fichiers
<CODE>config.status</CODE> et <CODE>config.mak</CODE> créés en lançant
<CODE>configure</CODE> ; ils seront dans le répertoire qui était le
répertoire courant quand vous avez lancé <CODE>configure</CODE>.</P>
<P>Vous devez envoyer tous les rapports de bug pour la bibliothèque C GNU
en utilisant le script shell <CODE>glibcbug</CODE> livré avec la libc GNU à
<A HREF="bugs@gnu.org">bugs@gnu.org</A> (l'ancienne adresse 
<A HREF="bugs@gnu.ai.mit.edu">bugs@gnu.ai.mit.edu</A> fonctionne encore), ou par l'intermédiaire
de l'interface Web de GNATS à 
<A HREF="http://www-gnats.gnu.org:8080/cgi-bin/wwwgnats.pl">http://www-gnats.gnu.org:8080/cgi-bin/wwwgnats.pl</A>.</P>
<P>Les suggestions et les questions doivent être envoyées à la liste de
distribution à 
<A HREF="bugs-glibc@prep.ai.mit.edu">bugs-glibc@prep.ai.mit.edu</A>. Si vous ne
lisez pas le groupe de gnews gnu.bug.glibc, vous pouvez vous abonner à
la liste en demandant à 
<A HREF="bug-glibc-request@prep.ai.mit.edu">bug-glibc-request@prep.ai.mit.edu</A>.</P>
<P>Veuillez s'il vous plait ne pas envoyer de rapport de bug concernant
la bibliothèque C GNU à &lt;bug-gcc@prep.ai.mit.edu&gt;. Cette liste
s'occupe des rapports de bug de GNU CC. GNU CC et la bibliothèque C
GNU sont des entités distinctes maintenues par des personnes
différentes.</P>


<H2><A NAME="specs"></A> <A NAME="s9">9. Fichiers specs d'exemple</A></H2>

<P>
<!--
glibc!fichier de specs GCC, exemple
-->
</P>
<P>Voici ci-inclus un fichier d'exemple <CODE>specs</CODE> pour glibc 2 que
gcc utilise pour la compilation et la liaison dynamique. On devrait le
trouver dans le répertoire <CODE>/usr/lib/gcc-lib/&lt;nouveau
répertoire&gt;/&lt;version gcc&gt;</CODE>. Si vous utilisez un système
x86, vous pouvez copier exactement cette section dans le fichier.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 *asm:
 %{V} %{v:%{!V:-V}} %{Qy:} %{!Qn:-Qy} %{n} %{T} %{Ym,*} %{Yd,*} %{Wa,*:%*}

 *asm_final:
 %{pipe:-}

 *cpp:
 %{fPIC:-D__PIC__ -D__pic__} %{fpic:-D__PIC__ -D__pic__} %{!m386:-D__i486__} %{posix:-D_POSIX_SOURCE} %{pthread:-D_REENTRANT}

 *cc1:
 %{profile:-p}

 *cc1plus:


 *endfile:
 %{!shared:crtend.o%s} %{shared:crtendS.o%s} crtn.o%s

 *link:
 -m elf_i386 %{shared:-shared}   %{!shared:     %{!ibcs:       %{!static:       %{rdynamic:-export-dynamic}     %{!dynamic-linker:-dynamic-linker /lib/ld-linux.so.2}}  %{static:-static}}}

 *lib:
 %{!shared: %{pthread:-lpthread}        %{profile:-lc_p} %{!profile: -lc}}

 *libgcc:
 -lgcc

 *startfile:
 %{!shared:      %{pg:gcrt1.o%s} %{!pg:%{p:gcrt1.o%s}                  %{!p:%{profile:gcrt1.o%s}                         %{!profile:crt1.o%s}}}}    crti.o%s %{!shared:crtbegin.o%s} %{shared:crtbeginS.o%s}

 *switches_need_spaces:


 *signed_char:
 %{funsigned-char:-D__CHAR_UNSIGNED__}

 *predefines:
 -D__ELF__ -Dunix -Di386 -Dlinux -Asystem(unix) -Asystem(posix) -Acpu(i386) -Amachine(i386)

 *cross_compile:
 0

 *multilib:
 . ;
 
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="s10">10. Divers</A></H2>

<P>
<!--
glibc!divers
-->
</P>

<H2><A NAME="ss10.1">10.1 Informations supplémentaires</A>
</H2>

<P>
<!--
glibc!sources d'informations
-->
</P>

<H3>Pages Web</H3>

<P>
<!--
glibc!sources d'information!WWW
-->
</P>
<P>
<UL>
<LI>
<A HREF="http://www.gnu.org/software/libc/libc.html">Page d'accueil de la bibliothèque C GNU chez FSF</A></LI>
<LI>
<A HREF="http://www.imaxx.net/~thrytis/glibc/">Utilisation de GNU Libc 2 avec Linux</A></LI>
<LI>
<A HREF="http://huizen.dds.nl/~frodol/glibc/">Installer glibc-2 sur Linux</A></LI>
<LI>
<A HREF="http://www.gate.net/~storm/FAQ/libc5-libc6-Mini-HOWTO.html">HOWTO libc5 vers libc6 Debian</A></LI>
</UL>
</P>

<H3>Groupes de news</H3>

<P>
<!--
glibc!sources d'informations!groupes de news
-->
</P>
<P>
<UL>
<LI>
<A HREF="news:comp.os.linux.development.system">comp.os.linux.development.system</A></LI>
<LI>
<A HREF="news:comp.os.linux.development.apps">comp.os.linux.development.apps</A></LI>
<LI>
<A HREF="news:linux.dev.kernel">linux.dev.kernel</A></LI>
<LI>
<A HREF="news:gnu.bug.glibc">gnu.bugs.glibc</A></LI>
</UL>
</P>

<H3>Listes de distribution</H3>

<P>
<!--
glibc!sources d'informations!listes de distribution
-->
</P>
<P>
<DL>
<DT><B>Liste de discussion Glibc 2 Linux.</B><DD><P>Cette liste est destinée à la discussion entre les utilisateurs Linux
qui ont installé glibc2, la nouvelle bibliothèque C. Les sujets
peuvent comprendre des problèmes de compatibilité et des questions sur
la compilation de code dans un environnement Linux/glibc. Pour
s'abonner, envoyer un courrier à 
<A HREF="mailto:Majordomo@ricardo.ecn.wfu.edu">Majordomo@ricardo.ecn.wfu.edu</A> avec dans le corps "subscribe
glibc-linux &lt;votre adresse email&gt;".</P>
</DL>
</P>

<H2><A NAME="ss10.2">10.2 Remerciements</A>
</H2>


<P>J'ai volé une bonne partie de ces informations sur la 
<A HREF="http://www.gnu.org/software/libc/libc.html">page web de GNU Libc</A> et de l'annonce de glibc 2 par Ulrich Drepper
&lt;drepper@gnu.ai.mit.edu&gt; et ses commentaires. Andreas Jaeger
&lt;aj@arthur.rhein-neckar.de&gt; a alimenté une partie de la section
sur l'indication des bugs.</P>
<P>Les personnes suivantes ont fourni des informations et un retour sur
ce document :</P>
<P>
<UL>
<LI>Allex &lt;allex@ms2.accmail.com.tw&gt;</LI>
<LI>Mark Brown &lt;M.A.Brown-4@sms.ed.ac.uk&gt;</LI>
<LI>Ulrich Drepper &lt;drepper@gnu.ai.mit.edu&gt;</LI>
<LI>Scott K. Ellis &lt;ellis@valueweb.net&gt;</LI>
<LI>Aron Griffis &lt;agriffis@coat.com&gt;</LI>
<LI>Andreas Jaeger &lt;aj@arthur.rhein-neckar.de&gt;</LI>
<LI>Frodo Looijaard &lt;frodol@dds.nl&gt;</LI>
<LI>Ryan McGuire &lt;rmcguire@freenet.columbus.oh.us&gt;</LI>
<LI>Shaya Potter &lt;spotter@capaccess.org&gt;</LI>
<LI>Les Schaffer &lt;godzilla@futuris.net&gt;</LI>
<LI>Andy Sewell &lt;puck@pookhill.demon.co.uk&gt;</LI>
<LI>Gary Shea &lt;shea@gtsdesign.com&gt;</LI>
<LI>Stephane &lt;sr@adb.fr&gt;</LI>
<LI>Jan Vandenbos &lt;jan@imaxx.net&gt;</LI>
</UL>
</P>
<P>Les traductions de ce document sont faites par :</P>
<P>
<UL>
<LI>chinois : Allex &lt;allex@ms2.accmail.com.tw&gt;</LI>
<LI>français : Géraud Canet&lt;canet@labri.u-bordeaux.fr&gt;</LI>
<LI>japonais : Kazuyuki Okamoto &lt;ikko-@pacific.rim.or.jp&gt;</LI>
</UL>
</P>

<H2><A NAME="ss10.3">10.3 Retour d'informations</A>
</H2>


<P>En plus d'écrire ce HOWTO, maintenir la page 
<A HREF="http://www.imaxx.net/~thrytis/glibc">glibc 2 pour Linux</A>,
et l'utiliser sur ma machine, je n'ai rien à voir avec le projet
glibc. Je suis loin d'être un expert dans ce domaine, bien que
j'essaie de résoudre les problèmes qu'on m'envoie par courrier
électronique. J'apprécie tout retour, correction ou suggestion que
vous pourriez me faire. Veuillez les envoyer à 
<A HREF="mailto:ejg3@cornell.edu">ejg3@cornell.edu</A>.</P>

<H2><A NAME="ss10.4">10.4 Copyright</A>
</H2>


<P>Copyright (c) 1997 par Eric Green. Ce document peut être distribué
sous les termes de la licence LDP.</P>

</BODY>
</HTML>
