<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>Token-Ring HOWTO</TITLE>
</HEAD>
<BODY>
<H1>Token-Ring HOWTO</H1>

<H2>Mike Eckhoff (<CODE>meckhoff@zaphod.wayne.esu1.k12.ne.us</CODE>). <BR><BR>Version fran&ccedil;aise et adaptation&nbsp;: Etienne BERNARD
(<CODE>eb@via.ecp.fr</CODE>) <BR>v1.0, 22 Octobre 1996</H2>Version 3, 5 Juillet 1995
<HR>
<EM>L'Ethernet-HOWTO fait r&eacute;f&eacute;rence au driver Token Ring qui est
en cours
d'&eacute;criture. Ce Howto a &eacute;t&eacute; cr&eacute;&eacute; dans le
but de vous
aider &agrave; installer le
patch pour le noyau et aussi essayer de mettre en &eacute;vidence les points
&agrave;
surveiller. Je sugg&egrave;re que vous lisiez, au moins rapidement, ce document,
avant d'essayer d'installer quelque partie que ce soit du driver Token
Ring pour Linux.</EM>
<HR>
<H2><A NAME="s1">1. Introduction</A></H2>

<H2><A NAME="ss1.1">1.1 Remerciements</A>
</H2>

<P>Remerciements &agrave; Mark Swanson, Peter De Schrijver, David Morris et toutes
les autres personnes que j'aurais pu oublier qui ont rendu possible le
support Token Ring pour Linux.</P>
<P>Remerciements aussi &agrave; Larry Sanders (<CODE>lsanders@iadfw.net</CODE>) qui m'a
aid&eacute; &agrave; corriger ce document.</P>

<H2><A NAME="ss1.2">1.2 Mise en garde</A>
</H2>

<P>Nous ne garantissons pas que ce Howto sera valable pour votre syst&egrave;me. De
nombreuses personnes l'ont utilis&eacute; avec de tr&egrave;s bons
r&eacute;sultats pour
installer Linux sur un r&eacute;seau Token Ring.</P>
<P>VOUS UTILISEZ CE DOCUMENT A VOS PROPRES RISQUES&nbsp;! ... Nous ne sommes
responsables d'aucun des probl&egrave;mes pouvant vous arriver en utilisant ce
Howto.</P>
<P>Si vous avez un quelconque probl&egrave;me qui n'est pas signal&eacute; dans ce
document, envoyez moi un mail &agrave;
<CODE>meckhoff@zaphod.wayne.esu1.k12.ne.us</CODE>.</P>
<P>Ce document est copyright &copy; 1995 Michael Eckhoff. Vous pouvez faire
des copies de ce document (en entier ou certaines portions du document),
sur quelque support physique ou &eacute;lectronique que ce soit, du moment que
cette notice de copyright soit incluse dans chaque copie. Une
redistribution commerciale est autoris&eacute;e et encourag&eacute;e&nbsp;;
cependant,
veuillez me tenir au courant afin que je v&eacute;rifie que vous avez la
derni&egrave;re
version.</P>

<H2><A NAME="s2">2. Exigences mat&eacute;rielles</A></H2>

<P>V&eacute;rifiez que vous avez une carte Token Ring qui est support&eacute;e
par le
driver. Jusqu'&agrave; pr&eacute;sent, les seules cartes support&eacute;es
sont celles qui
utilisent le chipset Tropic.</P>
<P>Les cartes qui sont r&eacute;put&eacute;es marcher sous Linux sont&nbsp;:</P>
<P>
<UL>
<LI>IBM Token Ring 16/4 Adapter&nbsp;;</LI>
<LI>IBM Token Ring Adapter&nbsp;;</LI>
<LI>IBM Token Ring Adapter II (4 M&eacute;gabit seulement)&nbsp;;</LI>
<LI>Carte IBM 16/4 ISA Token Ring (16 bit)&nbsp;;</LI>
<LI>Carte IBM 16/4 ISA Token Ring (8 bit)&nbsp;;</LI>
<LI>3Com TokenLink Adapter (mode IBM et 3Com)&nbsp;;</LI>
<LI>HyperRing Classic 16/4.</LI>
</UL>
</P>
<P>Veuillez noter qu'IBM fabrique une carte <CODE>IBM Token-Ring Network 16/4
Adapter II</CODE>. Cette carte <B>n'est pas reconnue sous Linux</B>. Il ne
faut pas la confondre avec la carte <CODE>IBM Token Ring Adapter II
(4mbit)</CODE>, qui elle est support&eacute;e.</P>
<P>Si vous trouvez une autre carte qui fonctionne sous Linux, envoyez-moi un mail
d&eacute;crivant la marque et le type de la carte afin que je puisse l'inclure
dans la liste pr&eacute;c&eacute;dente
(<CODE>meckhoff@zaphod.wayne.esu1.k12.ne.us</CODE>).</P>

<H2><A NAME="s3">3. Les logiciels requis</A></H2>

<P>Si vous utilisez une version du noyau Linux de la s&eacute;rie 1.3 ou
sup&eacute;rieur,
le support pour le Token Ring y est d&eacute;j&agrave; inclus.</P>
<P>Sinon, je vous encourage vivement &agrave; mettre &agrave; jour votre noyau
Linux vers
un de ceux de la s&eacute;rie 2.0 ou sup&eacute;rieur.</P>

<H2><A NAME="s4">4. Installation et configuration</A></H2>

<P>Installez la carte Token Ring dans l'ordinateur et configurez-la pour les
r&eacute;glages que vous voulez utiliser. Il est conseill&eacute; de
v&eacute;rifier que la
carte fonctionne sous Dos ou Windows avant d'essayer de l'utiliser sous
Linux. Si elle marche sous Dos ou Windows, il y a de fortes chances pour
que cela marche sous Linux.</P>
<P>Configurez votre noyau Linux pour l'utilisation de la carte Token Ring.
<BLOCKQUOTE><CODE>
<PRE>
cd /usr/src/linux
make config
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>R&eacute;pondre ''y'' (yes) &agrave; la question&nbsp;:
<BLOCKQUOTE><CODE>
<PRE>
Token Ring support (CONFIG_TR) [N/y/?]
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ainsi qu'&agrave; la question&nbsp;:
<BLOCKQUOTE><CODE>
<PRE>
IBM Tropic chipset based adaptor support (CONFIG_IBMTR) [N/y/m/?] (NEW)
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Reconstruire le noyau avec les commandes&nbsp;:
<BLOCKQUOTE><CODE>
<PRE>
make dep
make clean
make zImage
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Il faut ensuite reconfigurer lilo pour d&eacute;marrer sur ce nouveau noyau.
Pour cela, il faut d'abord renommer votre noyau <CODE>/vmlinuz</CODE> en
<CODE>/vmlinuz.old</CODE> et copier le nouveau en <CODE>/vmlinuz</CODE>. Sur mon
syst&egrave;me, cela revient &agrave; copier
<CODE>/usr/src/linux/arch/i386/boot/zImage</CODE> en <CODE>/vmlinuz</CODE> et &agrave;
&eacute;diter <CODE>/etc/lilo.conf</CODE> pour d&eacute;marrer sur ce noyau.
N'oubliez 
pas de lancer lilo (avec la commande <CODE>lilo</CODE>) afin que les changements
de noyau soient pris en compte.</P>
<P>Si ce n'est pas d&eacute;j&agrave; fait, lancez le programme ``netconfig''
sur votre
syst&egrave;me. Configurez votre machine comme si celle-ci se trouvait sur un
r&eacute;seau Ethernet.</P>
<P>Editez votre fichier <CODE>/etc/rc.d/rc.inet1</CODE> (ou un fichier dans
<CODE>/etc/init.d</CODE> pour certaines distributions) et changez toutes les
r&eacute;f&eacute;rences &agrave; <CODE>eth0</CODE> en <CODE>tr0</CODE>. Vous devriez avoir
une ligne
ressemblant &agrave;
<BLOCKQUOTE><CODE>
<PRE>
/sbin/ifconfig eth0 ${IPADDR} broadcast ${BROADCAST} netmask ${NETMASK}
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>qu'il faut changer en
<BLOCKQUOTE><CODE>
<PRE>
/sbin/ifconfig tr0 ${IPADDR} broadcast ${BROADCAST} netmask ${NETMASK}
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Vous devriez maintenant pouvoir rebooter votre syst&egrave;me et utiliser la
carte Token Ring avec votre ordinateur.</P>

<H2><A NAME="s5">5. Probl&egrave;mes connus</A></H2>

<P>J'ai personnellement eu quelques petits probl&egrave;mes avec ce driver. Selon
Peter De Schrijver, un des probl&egrave;mes principaux avec ce driver est le
routage.
<BLOCKQUOTE><CODE>
<PRE>
From: Peter de Schrijver &lt;Peter.DeSchrijver@linux.cc.kuleuven.ac.be>

La cause principale du probl&egrave;me est le routage. Si vous ne pouvez pas
atteindre un noeud du r&eacute;seau situ&eacute; derri&egrave;re un pont,
vous avez un probl&egrave;me
de routage. Contactez-moi si vous rencontrez ce probl&egrave;me, et j'essaierai
de faire ce que je peux. Je n'ai pas moi-m&ecirc;me acc&egrave;s &agrave; un
anneau comportant
un pont, il devrait donc &ecirc;tre difficile de r&eacute;soudre le
probl&egrave;me.

Peter.
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Notre r&eacute;seau, ici, &agrave; la Wayne Community Schools est
constitu&eacute; de deux
anneaux et d'un r&eacute;seau Ethernet dont le pont est
r&eacute;alis&eacute; par des IBM 8229.
Je n'ai eu aucun probl&egrave;me de routage avec ces ponts.</P>
<P>J'ai aussi test&eacute; le driver sur un r&eacute;seau constitu&eacute; de 7
ponts, reli&eacute;s par
une combinaison d'IBM 8229 et d'IBM PC utilisant le logiciel IBM. Aucun
probl&egrave;me l&agrave; non plus.</P>

<H2><A NAME="s6">6. Questions</A></H2>

<P>Voici quelques questions que j'ai re&ccedil;ues par mail &agrave; propos du
Token Ring
sous Linux.</P>

<P>
<UL>
<LI>Au d&eacute;marrage, j'ai le message
<BLOCKQUOTE><CODE>
<PRE>
tr0: Can't assign device to adapter
</PRE>
</CODE></BLOCKQUOTE>


Lorsque c'est le seul message produit au d&eacute;marrage, cela signifie que la
requ&ecirc;te PIO d'information sur l'adaptateur est tellement en dehors de
l'intervalle qu'il n'y a pas de carte &agrave; cette adresse
d'entr&eacute;e-sortie 
(voir <CODE>segment = inb(PIOaddr)</CODE> dans <CODE>ibmtr.c</CODE>).</LI>
<LI>Ma carte est une <CODE>Olicom 16/4 Adapter</CODE>. J'ai le message suivant dans
<CODE>/var/log/messages</CODE>&nbsp;:
<BLOCKQUOTE><CODE>
<PRE>
May  2 10:03:14 linux kernel: tr0: Unable to assign adapter to device.
May  2 10:03:14 linux kernel: tr1: Unable to assign adapter to device.
</PRE>
</CODE></BLOCKQUOTE>


Cette carte ne doit pas utiliser le chipset Tropic. Essayez d'utiliser une
des cartes de la liste du d&eacute;but du document.</LI>
<LI>J'ai une carte Token Ring IBM, mais j'ai les messages suivants au
d&eacute;marrage&nbsp;:
<BLOCKQUOTE><CODE>
<PRE>
May  2 16:23:07 linux kernel: tr0: PIOaddr:  a20 seg/intr: b8 mmio base:
000dc000 intr: 0
May  2 16:23:07 linux kernel: tr0: Channel ID string not found for PIOaddr:  a20
May  2 16:23:07 linux kernel: tr0: Expected for ISA: 5049434f3631313039393020
May  2 16:23:07 linux kernel: tr0:            found: 000902003021111000182000
May  2 16:23:07 linux kernel: tr0: Expected for MCA: 4d4152533633583435313820
May  2 16:23:07 linux kernel: tr0: Unable to assign adapter to device.
May  2 16:23:07 linux kernel: tr1: Unable to assign adapter to device.
</PRE>
</CODE></BLOCKQUOTE>


Ce message indique soit un conflit m&eacute;moire soit une carte Token Ring
qui n'est
pas reconnue (la signature de cette carte n'est en tout cas pas
connue).</LI>
<LI>Je trouve dans mon fichier <CODE>/var/log/messages</CODE> des dizaines de
lignes de
ce type&nbsp;:
<BLOCKQUOTE><CODE>
<PRE>
May  3 15:11:47 linux kernel: tr0: Arrg. Transmitter busy for more than 50
msec. Donald resets adapter, but resetting
May  3 15:11:47 linux kernel:  the IBM tokenring adapter takes a long time.
It might not even help when the
May  3 15:11:47 linux kernel:  ring is very busy, so we just wait a little
longer and hope for the best.
</PRE>
</CODE></BLOCKQUOTE>

Ces messages apparaissent lorsque j'essaye un telnet, un rlogin ou un ftp sur
une machine distante. La connexion est alors bloqu&eacute;e pendant longtemps.

Certaines personnes travaillent &agrave; la correction de ce
probl&egrave;me. Je mettrai &agrave;
jour cette r&eacute;ponse lorsqu'une solution sera trouv&eacute;e.</LI>
</UL>
</P>
</BODY>
</HTML>
