<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Guide pratique de la voix sur IP (VoIP)</title><link href="style.css" rel="stylesheet" type="text/css" /><meta content="DocBook XSL Stylesheets Vsnapshot_6768" name="generator" /><meta name="description" content="Grâce à la transmission de la voix sur un réseau IP (abrégée voix sur IP), il est possible, pour un coût quasi nul, d'utiliser Internet pour téléphoner. Ce guide pratique explique le fonctionnement de cette technique, et présente les normes et systèmes utilisés." /></head><body><div class="article" lang="fr"><div class="titlepage"><div><div><h1 class="title"><a id="N10001" />Guide pratique de la voix sur IP (VoIP)</h1></div><div><h3 class="subtitle"><i>
  
      Version française du guide pratique <span class="foreignphrase" lang="en"><em class="foreignphrase">VoIP 
      Howto</em></span>

    </i></h3></div><div><div class="author"><h3 class="author"><span class="firstname">Roberto</span> <span class="surname">Arcomano</span></h3><code class="email">&lt;<a class="email" href="mailto:berto CHEZ fatamorgana POINT com">berto CHEZ fatamorgana POINT com</a>&gt;</code></div></div><div><div class="othercredit"><h3 class="othercredit"><span class="firstname">Jérôme</span> <span class="surname">Blondel</span></h3><span class="contrib">Adaptation française</span> <code class="email">&lt;<a class="email" href="mailto:jeromeblondel CHEZ yahoo POINT fr">jeromeblondel CHEZ yahoo POINT fr</a>&gt;</code></div></div><div><div class="othercredit"><h3 class="othercredit"><span class="firstname">Alain</span> <span class="surname">Boulé</span></h3><span class="contrib">Relecture de la version française</span> <code class="email">&lt;<a class="email" href="mailto:alain POINT boule CHEZ free POINT fr">alain POINT boule CHEZ free POINT fr</a>&gt;</code></div></div><div><div class="othercredit"><h3 class="othercredit"><span class="firstname">Jean-Philippe</span> <span class="surname">Guérard</span></h3><span class="contrib">Préparation de la publication de la v.f.</span> <code class="email">&lt;<a class="email" href="mailto:fevrier CHEZ tigreraye POINT org">fevrier CHEZ tigreraye POINT org</a>&gt;</code></div></div><div><p class="releaseinfo">Version : 1.7.fr.1.0</p></div><div><p class="pubdate">3 mai 2007</p></div><div><div class="revhistory"><table summary="Revision history" width="100%" border="1"><tr><th colspan="3" valign="top" align="left"><b>Historique des versions</b></th></tr><tr><td align="left">Version 1.7.fr.1.0</td><td align="left">2007-05-03</td><td align="left">JB, AB, JPG</td></tr><tr><td colspan="3" align="left">Première traduction française.</td></tr><tr><td align="left">Version 1.7</td><td align="left">2002-08-07</td><td align="left">RA</td></tr><tr><td colspan="3" align="left">Version originale.</td></tr></table></div></div><div><div class="abstract"><p class="title"><b>Résumé</b></p><p>
    
      Grâce à la transmission de la voix sur un réseau IP (abrégée 
      « <span class="quote">voix sur IP</span> »), il est possible, pour un coût quasi 
      nul, d'utiliser Internet pour téléphoner. Ce guide pratique 
      explique le fonctionnement de cette technique, et présente les 
      normes et systèmes utilisés.
      
      

    </p></div></div></div><hr /></div><div class="toc"><p><b>Table des matières</b></p><dl><dt><span class="sect1"><a href="#N10061">1. Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10064">1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#N1006E">1.2. Copyright</a></span></dt><dt><span class="sect2"><a href="#N10079">1.3. 
         Nouvelles versions de ce document
     </a></span></dt><dt><span class="sect2"><a href="#N1008B">1.4. Traductions</a></span></dt><dt><span class="sect2"><a href="#N100B8">1.5. Remerciements</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N100CD">2. Contexte</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N100D0">2.1. Le passé</a></span></dt><dt><span class="sect2"><a href="#N100D7">2.2. Hier</a></span></dt><dt><span class="sect2"><a href="#N100E3">2.3. Aujourd'hui</a></span></dt><dt><span class="sect2"><a href="#N100E8">2.4. Le futur</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N100ED">3. Généralités</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N100F0">3.1. Qu'est-ce que la VoIP ?</a></span></dt><dt><span class="sect2"><a href="#N100F5">3.2. Comment cela fonctionne-t-il ?</a></span></dt><dt><span class="sect2"><a href="#N10103">3.3. Quel est l'avantage de la VoIP sur le RTCP ?</a></span></dt><dt><span class="sect2"><a href="#N1010C">3.4. Alors pourquoi tout le monde ne l'utilise pas déjà ?</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N10113">4. Infos techniques sur la VoIP</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10118">4.1. Description d'une connexion VoIP</a></span></dt><dt><span class="sect2"><a href="#N10138">4.2. Conversion Analogique-Numérique</a></span></dt><dt><span class="sect2"><a href="#N10141">4.3. Algorithmes de compression</a></span></dt><dt><span class="sect2"><a href="#N10163">4.4. RTP : Real Time Transport Protocol</a></span></dt><dt><span class="sect2"><a href="#N10196">4.5. RSVP</a></span></dt><dt><span class="sect2"><a href="#N101A2">4.6. Qualité de Service (QoS, Quality of Service)</a></span></dt><dt><span class="sect2"><a href="#N101E1">4.7. Protocole de signalisation H323</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N1022D">5. Prérequis</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10230">5.1. Prérequis matériel</a></span></dt><dt><span class="sect2"><a href="#N1024C">5.2. Cartes d'accélération matérielle</a></span></dt><dt><span class="sect2"><a href="#N1027D">5.3. Cartes passerelles matérielles</a></span></dt><dt><span class="sect2"><a href="#N10284">5.4. Prérequis logiciels</a></span></dt><dt><span class="sect2"><a href="#N102B2">5.5. Logiciel de passerelle</a></span></dt><dt><span class="sect2"><a href="#N102C9">5.6. Logiciel de portier</a></span></dt><dt><span class="sect2"><a href="#N102E2">5.7. Autres logiciels</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N102F6">6. Configuration des cartes</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N102FB">6.1. Quicknet PhoneJack</a></span></dt><dt><span class="sect2"><a href="#N1037E">6.2. Quicknet LineJack</a></span></dt><dt><span class="sect2"><a href="#N10389">6.3. Produits VoiceTronix</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N103BB">7. Installation</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N103C0">7.1. Communication simple : IP vers IP</a></span></dt><dt><span class="sect2"><a href="#N103D6">7.2. Utiliser des noms</a></span></dt><dt><span class="sect2"><a href="#N103E9">7.3. Appels sur Internet avec un serveur WINS</a></span></dt><dt><span class="sect2"><a href="#N103F7">7.4. Serveur ILS</a></span></dt><dt><span class="sect2"><a href="#N103FC">7.5. Un gros problème : le masquerading.</a></span></dt><dt><span class="sect2"><a href="#N1042C">7.6. Applications Open Source</a></span></dt><dt><span class="sect2"><a href="#N10474">7.7. Installer un portier</a></span></dt><dt><span class="sect2"><a href="#N1049F">7.8. Installer une passerelle</a></span></dt><dt><span class="sect2"><a href="#N104BE">7.9. Matrice de compatibilité</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N104E6">8. Communications sur des lignes RTCP</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N104E9">8.1. Généralités</a></span></dt><dt><span class="sect2"><a href="#N104EE">8.2. Scénario</a></span></dt><dt><span class="sect2"><a href="#N1050B">8.3. Que peut-on changer dans cette configuration ?</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N10537">9. Considérations de bande passante</a></span></dt><dt><span class="sect1"><a href="#N1054A">10. Glossaire</a></span></dt><dt><span class="sect1"><a href="#N1055F">11. Liens utiles</a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10562">11.1. Liens vers des logiciels open source</a></span></dt><dt><span class="sect2"><a href="#N105A1">11.2. Liens commerciaux</a></span></dt></dl></dd></dl></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N10061" />1. Introduction</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10064" />1.1. Introduction</h3></div></div></div><p>Ce document explique les systèmes de VoIP. Des événements 
		récents, tels que la diffusion sur Internet à faible coût, 
		l'intégration récente de processeurs dédiés de compression de voix, ont 
		modifié les exigences des utilisateurs ordinaires et ont rendu possible 
		la diffusion des normes VoIP. Ce guide pratique essaie de définir 
		certains éléments de base de l'architecture VoIP.</p><p>Merci d'envoyer suggestions et critiques à mon 
      <a class="ulink" href="mailto:berto@fatamorgana.com" target="_top">mon adresse électronique
		</a></p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1006E" />1.2. Copyright</h3></div></div></div><p>
      
        Copyright © 2000, 2001 Roberto Arcomano. Ce document est 
        libre   vous pouvez le redistribuer et le modifier sous les 
        termes de la licence GNU General Public License publiée par la 
        Free Software Foundation ; soit la version 2 de la Licence 
        ou (selon votre choix) toute version ultérieure. Ce document est 
        distribué dans l'espoir qu'il sera utile mais
        
      </p><p>
      
        SANS AUCUNE GARANTIE ; sans même les garanties implicites 
        de COMMERCIALISATION et de CONFORMITÉ À UNE UTILISATION 
        PARTICULIÈRE. Voir la GNU General Public License pour plus de 
        détails. Vous trouverez un exemplaire de la GNU GPL <a class="ulink" href="http://www.gnu.org/copyleft/gpl.html" target="_top">ici</a>
        
      </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10079" />1.3. 
         Nouvelles versions de ce document
     </h3></div></div></div><p>

         La <a class="ulink" href="http://www.traduc.org/docs/howto/lecture/VoIP-HOWTO.html" target="_top">plus récente version 
         française</a> de ce guide pratique est disponible sur le 
         site de l'association <a class="ulink" href="http://www.traduc.org" target="_top">Traduc.org</a>.

     </p><p>
      
         Le site <a class="ulink" href="http://www.bertolinux.com/" target="_top">http://www.bertolinux.com/</a> contient la 
         plus récente version originale de ce document.
  
     </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1008B" />1.4. Traductions</h3></div></div></div><p>Si vous voulez traduire ce document vous êtes libre, vous devez 
		simplement :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>Vérifier qu'une autre version n'existe pas déjà à votre LDP 
				local.</p></li><li><p>
            
            Conserver toute la partie « <span class="quote">Introduction</span> » (y 
            compris « <span class="quote">Introduction</span> », 
            « <span class="quote">Copyright</span> », « <span class="quote">Traductions</span> » et 
            « <span class="quote">Remerciements</span> »).
	   
	   </p></li></ol></div>
      </p><p>Attention ! Vous n'avez pas besoin de traduire les fichiers TXT 
		ou HTML, vous devez modifier le fichier LYX, pour qu'il soit possible 
		de le convertir dans tous les autres formats (TXT, HTML, RIFF, et cætera) : 
		pour cela vous pouvez utiliser l'application « <span class="quote">LyX</span> » téléchargeable à
      <a class="ulink" href="http://www.lyx.org" target="_top">http://www.lyx.org</a>.</p><p>Il n'est pas nécessaire de me demander l'autorisation de traduire
		 ! Faites-le moi savoir (si vous le souhaitez) lorsque vous aurez 
		fait une traduction.
		</p><p>Merci pour votre traduction !</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N100B8" />1.5. Remerciements</h3></div></div></div><p>Merci à 
      <a class="ulink" href="http://www.fatamorgana.com" target="_top">Fatamorgana
      Computers</a> pour le matériel et les opportunités d'expérimentation.
		</p><p>Merci au 
      <a class="ulink" href="http://www.linuxdoc.org" target="_top">Linux Documentation
      Project</a> pour la publication et la mise en ligne très rapide de 
		mon document.</p><p>Merci à  
      <a class="ulink" href="mailto:dprice@intercorp.com.au" target="_top">David Price</a> pour son
      soutien.</p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N100CD" />2. Contexte</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N100D0" />2.1. Le passé</h3></div></div></div><p>Il y a plus de 30 ans, Internet n'existait pas. Les communications 
		interactives se faisaient seulement par téléphone au prix de la ligne du
		RTCP (réseau téléphonique commuté public).</p><p>Les échanges de données étaient coûteux (pour les longues 
		distances) et personne n'avait pensé à des interactions vidéo (il n'y 
		avait que la télévision qui n'est pas interactive comme on le sait).
		</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N100D7" />2.2. Hier</h3></div></div></div><p>
      
          Il y a quelques années nous avons vu apparaître des choses 
          intéressantes : les PC pour le grand public, les 
          nouvelles technologies pour communiquer, comme les téléphones 
          cellulaires et enfin le grand réseau : Internet. Les gens 
          ont commencé à communiquer à l'aide de nouveaux services comme 
          le courrier électronique, les discussions en ligne 
          (<span class="foreignphrase" lang="en"><em class="foreignphrase">chat</em></span>), et cætera, 
          et le commerce, transformé par le web, a permis aux gens de 
          faire des achats d'un simple « <span class="quote">clic</span> ».
          
      </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N100E3" />2.3. Aujourd'hui</h3></div></div></div><p>Aujourd'hui nous assistons à une véritable révolution du monde des 
		communications : tout le monde commence à utiliser des PC et Internet au
		travail et pendant son temps libre pour communiquer avec les autres, pour
		échanger des données (images, sons, documents) et, parfois, pour se
		parler à l'aide d'applications comme Netmeeting ou Internet Phone. Une
		nouvelle idée, en particulier, commence à se répandre, qui représente 
      peut-être l'avenir, et qui permet l'échange de communications vocales en 
		temps réel : la voix sur IP (VoIP).</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N100E8" />2.4. Le futur</h3></div></div></div><p>Nous ne pouvons pas connaître l'avenir, mais nous pouvons essayer
		de nous le représenter avec une multitude d'ordinateurs, l'Internet 
		haut débit presque partout et des gens qui se parlent (en audio et en 
		vidéo) en temps réel. Pour cela, ils nous suffit de connaître les
		moyens d'y parvenir : l'UMTS, la VoIP (avec extension vidéo) ou 
		peut-être autre chose . En tout cas, nous pouvons remarquer 
		qu'Internet s'est beaucoup développé ces dernières années, qu'il est 
		gratuit (au moins en tant que média international) et qu'il pourrait 
		bien être le moyen de communication du futur.</p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N100ED" />3. Généralités</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N100F0" />3.1. Qu'est-ce que la VoIP ?</h3></div></div></div><p>VoIP signifie Voice over Internet Protocol ou Voix sur IP (IP = 
		Protocole Internet). Comme son nom l'indique, la VoIP essaie de 
		transmettre des sons (en particulier la voix) dans des paquets IP 
		circulant sur Internet. La VoIP peut utiliser du matériel d'accélération 
		pour réaliser ce but et peut aussi être utilisée en environnement de PC.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N100F5" />3.2. Comment cela fonctionne-t-il ?</h3></div></div></div><p>De nombreuses années en arrière, nous avons découvert qu'il était 
		possible de transmettre un signal à une destination éloignée sous forme
		de données numériques. Avant la transmission, il faut numériser le
		signal à l'aide d'un CAN (convertisseur analogique-numérique). Le 
		signal est ensuite transmis, et, pour être utilisable, doit être 
		transformé à nouveau, par le récepteur, en un signal analogique, à 
		l'aide d'un CNA (convertisseur numérique-analogique).</p><p>La VoIP fonctionne ainsi, par numérisation de la voix et 
		transmission dans des paquets de données, puis par reconversion des 
		paquets numériques en voix à l'arrivée.</p><p>Le format numérique est plus facile à contrôler : on peut le 
		compresser, le router, le convertir en un nouveau format meilleur, et 
		ainsi de suite ; nous avons également découvert que le signal numérique 
		est plus tolérant au bruit que l'analogique (comparer GSM et TACS).
		</p><p>Les réseaux TCP/IP sont des supports de circulation de paquets IP
		contenant un en-tête (pour contrôler la communication) et une charge 
		utile pour transporter les données : la VoIP s'en sert pour 
		traverser le réseau et arriver à destination.</p><pre class="screen">
Voix (source) - - CAN - - - - Internet - - - CNA - - Voix (dest)
</pre></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10103" />3.3. Quel est l'avantage de la VoIP sur le RTCP ?</h3></div></div></div><p>Quand vous utilisez une ligne du RTCP, vous payez généralement le 
		temps de communication à la société qui gère la ligne téléphonique : 
		plus vous passez de temps au téléphone et plus vous payez. De plus, 
		vous ne pouvez parler qu'à une personne à la fois.</p><p>La VoIP vous permet, au contraire, à tout moment, de parler à la
		personne que vous souhaitez (pourvu qu'elle soit connectée à Internet 
		au même moment), aussi longtemps que vous le souhaitez (sans coût
		supplémentaire), et de plus, vous pouvez parler à plusieurs 
		personnes en même temps.</p><p>Si vous n'êtes pas encore convaincu, considérez qu'il est 
		possible, en simultané, d'échanger des données avec vos interlocuteurs, 
		d'envoyer des images, des graphiques et des vidéos.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1010C" />3.4. Alors pourquoi tout le monde ne l'utilise pas déjà ?</h3></div></div></div><p>Malheureusement, il faut reconnaître des problèmes d'intégration 
		de l'architecture VoIP et d'Internet. Comme vous pouvez 
		facilement l'imaginer, les communications de données vocales 
		nécessitent une transmission en temps réel (on n'admettrait pas de 
		parler et d'attendre plusieurs secondes qu'arrive la réponse à l'autre 
		bout). Cette contrainte entre en contradiction avec l'architecture 
		hétérogène d'Internet qui comprend de nombreux routeurs (équipement
		d'aiguillage des paquets), un nombre typique est 20-30, voire plus, 
		ce qui donne un temps d'aller-retour (RTT, round trip time) très long. 
		Il est donc nécessaire d'effectuer des modifications pour que cela
		fonctionne.</p><p>Dans les sections ci-dessous nous allons essayer de comprendre 
		comment il est possible de résoudre ce problème majeur. En général, 
		nous savons qu'il est très difficile de garantir une bande passante sur 
		Internet pour les applications de VoIP.</p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N10113" />4. Infos techniques sur la VoIP</h2></div></div></div><p>Ci-dessous sont présentés des aspects importants qu'il faut 
	 connaître pour comprendre le fonctionnement de la VoIP.</p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10118" />4.1. Description d'une connexion VoIP</h3></div></div></div><p>L'établissement d'une connexion VoIP nécessite :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>D'abord le CAN qui permet de convertir la voix analogique en 
				signaux numériques (bits).</p></li><li><p>Les bits doivent être ensuite compressés en un format 
				adapté à la transmission : il existe plusieurs protocoles 
				que nous allons examiner ci-dessous.</p></li><li><p>Il faut ensuite transmettre les données numériques vocales 
				dans des paquets de données à l'aide d'un protocole temps réel 
				(généralement RTP sur UDP sur IP).</p></li><li><p>Il est nécessaire d'utiliser un protocole de signalisation 
				pour appeler les usagers. ITU-T H323 le permet.</p></li><li><p>À la réception, il faut désassembler les paquets, 
				extraire les données, les convertir en signaux analogiques 
				représentant la voix, puis les transmettre à une carte son (ou 
				à un téléphone).
				</p></li><li><p>Tout cela doit être réalisé en temps réel, afin d'éviter 
				une attente trop longue de la réponse vocale ! (voir la 
				section QoS)</p></li></ol></div>
      </p><pre class="screen">
                          Architecture de base
Voix )) CAN - Algorithme de Compression -  Assembler RTP dans TCP/IP -----
                                                             ----&gt;     |
                                                             &lt;----     | 
Voix (( CNA - Algorithme de Décompression -  Désass. RTP de TCP/IP   -----
</pre></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10138" />4.2. Conversion Analogique-Numérique</h3></div></div></div><p>Celle-ci est faite par le matériel, généralement une carte CAN 
		intégrée.</p><p>Aujourd'hui, n'importe quelle carte son vous permet de convertir 
		une bande de 22050 Hz en données de 16 bits (l'échantillonnage doit 
		être réalisé à une fréquence de 44100 Hz en raison du principe de 
		Nyquist), cela donne un débit de 2 octets * 44100 échantillons par 
		seconde = 88200 octets/s soit 176,4 ko/s pour un flux stéréo.</p><p>La VoIP ne nécessite pas un tel débit pour la transmission des 
		paquets de voix : nous allons examiner ci-dessous les différents 
		codages qui seront utilisés en pratique.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10141" />4.3. Algorithmes de compression</h3></div></div></div><p>Comme nous disposons maintenant de données numériques, nous 
		pouvons les convertir dans un format standard qui permet une 
		transmission rapide.</p><pre class="screen">
PCM, modulation par impulsion et codage (MIC), norme ITU-T G.711
</pre><p>
        <div class="itemizedlist"><ul><li><p>La bande passante de la voix est de 4 kHz, donc la fréquence 
				d'échantillonnage doit être de 8 kHz (Nyquist).</p></li><li><p>Nous représentons chaque échantillon par 8 bits (ce qui 
				donne 256 valeurs possibles).</p></li><li><p>
                 Le débit est de 8000 Hz * 8 bits = 64 kbps, comme une 
                 ligne téléphonique typique.
            </p></li><li><p>
            
                Dans les applications réelles, les variantes à loi mu 
                (Amérique du Nord) et à loi a (Europe) sont utilisées 
                pour encoder le signal analogique sur une échelle 
                logarithmique en utilisant 12 ou 13 bits au lieu de 8 
                (voir la norme ITU-T G.711).
	    
	    </p></li></ul></div>
      </p><pre class="screen">
ADPCM, modulation par impulsion et codage différentiel adaptatif (MICDA), norme ITU-T G.726
</pre><p>Seule la différence entre le paquet de voix actuel et le précédent
		est converti, ce qui nécessite 32 kbps (Norme ITU-T G.726).
		</p><pre class="screen">
LD-CELP, norme ITU-T G.728
CS-ACELP, normes ITU-T G.729 et G.729a
MP-MLQ, norme ITU-T G.723.1, 6.3kbps, Truespeech
ACELP, norme ITU-T G.723.1, 5.3kbps, Truespeech
LPC-10, norme capable d'atteindre 2.5 kbps!!
</pre><p>Ces derniers protocoles sont les plus importants car ils peuvent 
		garantir une bande minimale très basse par un codage à la source. De 
		plus les codecs G.723.1 ont une note moyenne d'opinion très élevé 
		(utilisée pour mesurer la fidélité de la voix), mais attention aux 
		performances d'élaboration qu'ils nécessitent : jusqu'à 26 MIPS !</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10163" />4.4. RTP : Real Time Transport Protocol</h3></div></div></div><p>Nous disposons maintenant des données brutes, il faut les 
		empaqueter en données de protocole TCP/IP, en respectant le schéma
		suivant :</p><pre class="screen">
paquets de données VoIP
     RTP
     UDP
     IP  
   couches I, II
</pre><p>Les paquets de VoIP sont placés dans des paquets RTP (Real Time 
		Transport Protocol) à l'intérieur de paquets UDP/IP.</p><p>On remarque, d'abord, que la VoIP n'utilise pas le protocole TCP, 
		trop lourd pour les applications en temps réel. On utilise, à la place,
		les datagrammes du protocole UDP.</p><p>Ensuite, UDP ne garantit ni l'ordre d'arrivée à destination des 
		paquets, ni leur temps de transfert (principe du datagramme). Ces deux 
		propriétés sont très importantes pour la qualité générale de la voix 
		(la bonne compréhension des paroles de l'interlocuteur) et la qualité 
		de la conversation (la facilité de son déroulement). RTP résout le 
		problème en permettant au destinataire de remettre les paquets dans 
		l'ordre et en évitant une attente excessive des paquets égarés en
		chemin ou trop longs à parvenir (il n'est pas nécessaire de recevoir 
		chaque paquet, il faut par contre disposer d'un flux continu, en
		nombre suffisant, de paquets dans l'ordre).</p><pre class="screen">
             Real Time Transport Protocol
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|V=2|P|X|  CC   |M|     PT      |     numéro de séquence        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       empreinte temporelle                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   identifiant de la source de synchronization source (SSRC)   |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
|     identifiants des sources contribuantes (CSRC)             |
|                             ....                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>Où :</p><p>
        <div class="itemizedlist"><ul><li><p>V représente la version utilisée du protocole RTP</p></li><li><p>P indique la présence d'un octet de bourrage (padding), à 
				la fin du paquet, pour obtenir un paquet de longueur paire</p></li><li><p>X indique la présence d'une extension d'en-tête</p></li><li><p>Le champ CC représente le nombre d'identifiants CSRC qui 
				suivent l'en-tête fixe. Les champs CSRC servent, notamment, 
				pour les conférences.</p></li><li><p>M est un bit marqueur.</p></li><li><p>PT est le type de charge utile (payload type).</p></li></ul></div>
      </p><p>Pour une description complète du protocole RTP et de toutes ses 
		applications, voir les RFC 
      <a class="ulink" href="http://www.ietf.org/rfc/rfc1889.txt" target="_top">1889</a>et 
      <a class="ulink" href="http://www.ietf.org/rfc/rfc1890.txt" target="_top">1890</a>.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10196" />4.5. RSVP</h3></div></div></div><p>D'autres protocoles sont utilisés en VoIP, comme RSVP, qui peut 
		prendre en charge la Qualité de Service (QoS, Quality of Service).</p><p>RSVP est un protocole avec signalisation, qui nécessite une 
		certaine bande passante et un délai à chaque bond réseau le prenant en 
		charge.</p><p>Pour des informations détaillées sur RSVP, voir 
      <a class="ulink" href="http://www.ietf.org/rfc/rfc2205.txt?number=2205" target="_top">RFC
      2205</a></p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N101A2" />4.6. Qualité de Service (QoS, Quality of Service)</h3></div></div></div><p>Nous avons répété à plusieurs reprises que les applications de 
		VoIP nécessitaient un flux de données en temps réel car le but est 
		d'obtenir un échange vocal interactif.</p><p>Malheureusement, TCP/IP ne permet pas d'atteindre cet d'objectif, 
		il ne peut que faire « <span class="quote">au mieux</span> ». Il va falloir utiliser 
		des astuces et des stratégies pour la gestion du flux des paquets dans
		CHACUN des routeur que nous allons traverser.</p><p>On peut ainsi utiliser :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>
            
            Le champ TOS du protocol IP, qui indique le type de 
            service : une valeur élevée signifie un degré d'urgence 
				faible, alors que des valeurs faibles signifient un degré
				d'urgence important, compatible avec le temps réel.
            
	    </p></li><li><p>Méthodes de mise en file d'attente des paquets :
            <div class="orderedlist"><ol type="a"><li><p>FIFO (First In First Out, Premier Entré Premier Sorti), 
					 la méthode la plus stupide, qui fait passer les paquets dans 
					 leur ordre d'arrivée.</p></li><li><p>WFQ (Weighted Fair Queuing, file d'attente équitable
					 pondérée) consiste en un passage équitable des paquets
					 (ainsi, FTP ne peut pas consommer la totalité de la bande 
					 passante disponible) entre les différents flux de données,
					 avec, en général, un paquet pour UDP et un pour TCP, en
					 alternance.</p></li><li><p>CQ (Custom Queuing, mise en file d'attente 
					 personnalisée), les utilisateurs peuvent décider de la 
					 priorité.</p></li><li><p>PQ (Priority Queuing, file d'attente avec priorité), il
					 existe plusieurs files (en général quatre), chacune 
					 disposant d'un niveau de priorité. Les paquets de la file la
					 plus prioritaire sont envoyés en premier puis (quand elle est
					 vide), on passe à la seconde, et ainsi de suite.</p></li><li><p>CB-WFQ (Class Based Weighted Fair Queuing - Mise en file 
					 d'attente par classes, pondérée et équitable), semblable à WFQ, 
					 avec en plus une notion de classes (jusqu'à 64)  à 
					 chaque classe est associée une valeur de bande passante.</p></li></ol></div></p></li><li><p>La capacité de mise en forme du trafic, qui permet de 
				limiter la source à une bande passante fixe en :
            <div class="orderedlist"><ol type="a"><li><p>téléchargement (download)</p></li><li><p>mise en ligne (upload)</p></li></ol></div></p></li><li><p>Evitement de congestion (Congestion Avoidance), comme RED 
				(Random Early Detection).</p></li></ol></div>
      </p><p>Pour des informations exhaustives sur la QoS, voir
      <a class="ulink" href="http://www.ietf.org/html.charters/diffserv-charter.html" target="_top">
      Differentiated Services</a> à l'IETF.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N101E1" />4.7. Protocole de signalisation H323</h3></div></div></div><p>Le protocole H323 est utilisé par exemple par Microsoft 
		NetMeeting pour faire des appels VoIP.</p><p>Ce protocole permet à plusieurs éléments de se parler :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>Des terminaux, clients qui initient une connexion VoIP.
				Bien que les terminaux puissent se parler sans l'aide d'un
				intermédiaire, nous avons besoin d'éléments additionnels dans la
				perspective d'une montée en charge.</p></li><li><p>Des portiers, qui réalisent essentiellement :
            <div class="orderedlist"><ol type="a"><li><p>un service de traduction d'adresses, pour utiliser des 
					 noms à la place des adresses IP</p></li><li><p>un contrôle des admissions, pour autoriser ou refuser 
					 certaines machines ou certains usagers</p></li><li><p>une gestion de la bande passante</p></li></ol></div></p></li><li><p>Des passerelles, points de référence pour la conversion 
				TCP/IP-RTCP.</p></li><li><p>Des Unités de Contrôle Multipoint (MCU, Multipoint Control 
				Units), pour permettre les conférences.</p></li><li><p>Des serveurs proxies sont également utilisés.</p></li></ol></div>
      </p><p>Le protocole H323 concerne non seulement la VoIP mais aussi les 
		communications de données et de vidéo.</p><p>En ce qui concerne la VoIP, h323 peut utiliser les codecs audio 
		G.711, G.722, G.723, G.728 et G.729 ; pour la vidéo il prend en 
		charge h261 et h263.</p><p>On trouvera des informations complémentaires sur h323 sur les
		sites Web <a class="ulink" href="http://www.openh323.org/standards.html" target="_top">Openh323
      Standards</a> et 
      <a class="ulink" href="http://www.cs.columbia.edu/~hgs/rtp/h323.html" target="_top">h323</a>
		 ainsi que dans le document de définition de la norme : 
      <a class="ulink" href="http://www.itu.int/itudoc/itu-t/rec/h/" target="_top">ITU H-series
      Recommendations</a>.</p><p>On le trouve implémenté dans différents logiciels comme 
      <a class="ulink" href="http://www.microsoft.com" target="_top">Microsoft Netmeeting</a>, 
      <a class="ulink" href="http://www.net2phone.com" target="_top">Net2Phone</a>, 
      <a class="ulink" href="http://www.dialpad.com" target="_top">DialPad</a>, ... et aussi dans
		des produits freeware qu'on peut trouver au
      <a class="ulink" href="http://www.openh323.org" target="_top">site web Openh323</a>.</p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N1022D" />5. Prérequis</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10230" />5.1. Prérequis matériel</h3></div></div></div><p>Pour créer un petit système VoIP vous avez besoin du matériel 
		suivant :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>PC 386 ou supérieur</p></li><li><p>Carte son, compatible full duplex (duplex intégral)</p></li><li><p>une carte réseau, une connexion Internet ou tout autre type 
				d'interface permettant la communication entre deux PC</p></li></ol></div>
      </p><p>Chacun de ces éléments doit être présent en double exemplaire 
		comme pour une véritable communication.</p><p>Les éléments ci-dessus sont le minimum requis pour une 
		connexion VoIP : nous verrons plus loin quel est le matériel qui 
      serait nécessaire (et qui l'est pour Internet) pour assurer la même 
		fonction en situation réelle.</p><p>La carte son doit être full duplex si on veut pouvoir parler 
		et entendre en même temps !</p><p>Il est possible par ailleurs d'utiliser des cartes (voir 
		ci-dessous) qui gèrent un flux de données en format compressé (voir § 
		4.3).</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1024C" />5.2. Cartes d'accélération matérielle</h3></div></div></div><p>Il est possible d'utiliser des cartes spéciales dotées de fonctions
		d'accélération matérielle. Cinq d'entre elles (les seules à 
		être prises en charge actuellement par le noyau Linux) sont les
		suivantes :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>Quicknet PhoneJack</p></li><li><p>Quicknet LineJack</p></li><li><p>VoiceTronix V4PCI</p></li><li><p>VoiceTronix VPB4</p></li><li><p>VoiceTronix VPB8L</p></li></ol></div>
      </p><p>Quicknet PhoneJack est une carte son qui utilise des algorithmes 
		standards pour compresser un flux audio comme G723.1 (section 4.3) 
		jusqu'à un débit de 4,1 kbps.</p><p>Elle peut être directement connectée à un téléphone (prise 
		téléphone classique) ou à un couple micro-haut-parleur.</p><p>Elle se connecte à un bus ISA ou PCI.</p><p>La carte Quicknet LineJack fonctionne comme la carte PhoneJack avec des 
		caractéristiques en plus (voir ci-dessous).</p><p>La carte VoiceTronix V4PCI est une carte PCI comme la carte Quicknet 
		LineJack mais avec 4 ports de type téléphone.</p><p>La carte VoiceTronix VPB4 est une carte ISA équivalente à la carte V4PCI.</p><p>La carte VoiceTronix VPB8L est une carte à journalisation à 8 ports.
		</p><p>Pour obtenir des infos supplémentaires, consultez 
      <a class="ulink" href="http://www.quicknet.net" target="_top">le site web de Quicknet</a> et 
      <a class="ulink" href="http://www.voicetronix.com.au" target="_top">le site web de VoiceTronix
		</a></p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1027D" />5.3. Cartes passerelles matérielles</h3></div></div></div><p>Les cartes Quicknet LineJack et VoiceTronix peuvent être 
		connectées à une ligne RTCP ce qui leur permet de fonctionner comme 
		passerelle VoIP.</p><p>Un logiciel spécifique est nécessaire pour cette utilisation (voir 
		ci-dessous).</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10284" />5.4. Prérequis logiciels</h3></div></div></div><p>On peut choisir l'un de ces systèmes d'exploitation :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>Win9x</p></li><li><p>Linux</p></li></ol></div>
      </p><p>Les logiciels pour Win9x sont, en particulier, Microsoft NetMeeting, 
		Internet Phone, DialPad, et, pour les cartes Quicknet, Internet Switchboard 
		(disponible sur le <a class="ulink" href="http://www.quicknet.net" target="_top">site web de 
		Quicknet</a>).
		</p><p>Attention !! Les dernières cartes Quicknet utilisant Switchboard 
		(ancienne version aussi) DOIVENT être connectées à Internet pour 
		avoir accès à un compte Microtelco (payant), aussi, si vous ne
		souhaitez pas être connecté à Internet vous devrez installer
      <a class="ulink" href="http://www.openh323.org" target="_top">les logiciels OpenH323</a>.
		</p><p>Pour les cartes VoiceTronix, vous trouverez des logiciels au 
      <a class="ulink" href="http://www.voicetronix.com.au" target="_top">site web de VoiceTronix
		</a></p><p>Sous Linux, nous avons les logiciels libres 
      <a class="ulink" href="http://www.gnomemeeting.org" target="_top">GnomeMeeting</a>, clone de
      Microsoft Netmeeting, et en mode console nous utilisons les 
		applications (également libres) du site web
      <a class="ulink" href="http://www.openh323.org" target="_top">OpenH323</a>: simph323
      ou ohphone, qui fonctionnent aussi avec le matériel d'accélération de 
		Quicknet.</p><p>Attention : le code source complet d'Openh323 doit être compilé dans 
		un répertoire utilisateur (sinon il est nécessaire de modifier certaines variables
		d'environnement). Notez que le temps de compilation peut
		être très long et qu'une quantité importante de RAM est nécessaire si
		on veut le réduire à une durée raisonnable.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N102B2" />5.5. Logiciel de passerelle</h3></div></div></div><p>La fonction de passerelle (qui assure la liaison entre les lignes TCP/IP, 
		VoIP et RTCP) nécessite un logiciel, tel que :</p><p>
        <div class="itemizedlist"><ul><li><p>
            <a class="ulink" href="http://www.quicknet.net" target="_top">Internet
            SwitchBoard</a> (nécessitant une connexion à Internet) 
				pour les systèmes Windows, qui fonctionne aussi comme terminal h323.
				</p></li><li><p>PSTNGw pour les systèmes Linux et Windows, à télécharger sur
            <a class="ulink" href="http://www.openh323.org/code.html" target="_top">
            OpenH323</a>.</p></li></ul></div>
      </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N102C9" />5.6. Logiciel de portier</h3></div></div></div><p>Vous pouvez choisir comme portier :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>Opengatekeeper, téléchargeable au  
            <a class="ulink" href="http://www.opengatekeeper.sourceforge.net" target="_top">site web 
				d'opengatekeeper</a>pour Linux et Win9x.</p></li><li><p>Openh323 Gatekeeper (GK) 
				<a class="ulink" href="http://www.willamowius.de/openh323gk.html" target="_top">ici
            </a>.</p></li></ol></div>
      </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N102E2" />5.7. Autres logiciels</h3></div></div></div><p>
      
          <a id="phonepatch" />En complément, 
          voici un logiciel utile conformes à h323 :
				
      </p><p>
        <div class="itemizedlist"><ul><li><p>Phonepatch, pouvant fonctionner derrière un pare-feu 
				NAT. Il permet aux utilisateurs (aussi bien externes qu'internes) 
				d'appeler, simplement, à partir une page web. Quand l'application web 
				voit que l'hôte distant est prêt, elle appelle la source, en h323, 
            pour l'informer que la communication peut 
				être établie. Phonepatch est un logiciel propriétaire (avec une 
				version de démo pour des conversations de moins de 3 minutes),
				que vous pouvez télécharger
            <a class="ulink" href="http://www.equival.com/phonepatch" target="_top">
            ici</a>.</p></li></ul></div>
      </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N102F6" />6. Configuration des cartes</h2></div></div></div><p>La configuration du matériel spécifique, en environnement Linux ou 
	 Windows, est présentée ci-dessous.</p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N102FB" />6.1. Quicknet PhoneJack</h3></div></div></div><p>Comme nous l'avons déja vu, la carte Quicknet PhoneJack est une 
		carte son à fonction d'accélération spécifique à la VoIP. Ses 
		caractéristiques sont les suivantes :</p><p>
        <div class="itemizedlist"><ul><li><p>G.711 normal et à loi mu/A, G.728-9, G.723.1 (TrueSpeech)
            et LPC10.</p></li><li><p>Connecteur pour téléphone (permettant d'appeler directement 
				depuis un téléphone) ou</p></li><li><p>prises Jacks pour microphone et hauts-parleurs.</p></li></ul></div>
      </p><p>La carte Quicknet PhoneJack est une carte ISA (ou PCI) à installer 
		dans le boîtier du PC. Elle peut fonctionner sans IRQ.</p><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a id="N1030F" />6.1.1. Installation du logiciel</h4></div></div></div><p>Sous Windows vous devez installer :</p><p>
          <div class="orderedlist"><ol type="1"><li><p>Le pilote de la carte</p></li><li><p>L'application Internet Switchboard (ne fonctionne qu'avec 
				  Internet, avec les nouvelles cartes Quicknet)</p></li></ol></div>
        </p><p>tous téléchargeables sur 
        <a class="ulink" href="http://www.quicknet.net" target="_top">le site web de Quicknet
		  </a></p><p>Une fois Switchboard installé, il faut s'enregistrer auprès de 
		  Quicknet pour bénéficier des pleines capacités de la carte.</p><p>Lorsque vous décrochez le téléphone, Internet Switchboard se 
		  réveille et attend que vous composiez un numéro d'appel (directement 
		  à partir du téléphone). Vous pouvez effectuer l'une des opérations 
		  suivantes : </p><p>
          <div class="orderedlist"><ol type="1"><li><p>Taper un astérisque, puis un numéro IP (des astérisques 
				  remplaçant les points), et un # à la fin</p></li><li><p>Composer le numéro d'appel (avec préfixe international) 
				  d'un abonné du réseau téléphonique classique. Dans ce cas, il 
				  est nécessaire d'être abonné à un gestionnaire de passerelle 
				  qui vous facturera le temps de communication.</p></li><li><p>Composer un code d'accès rapide (un ou deux chiffres), 
				  que vous aurez stocké au préalable, pour effectuer un appel de 
				  type IP ou RTCP.</p></li></ol></div>
        </p><p>Internet Switchboard est compatible avec h323, il est ainsi 
		  possible de correspondre, par exemple, avec Microsoft Netmeeting.</p><p>Attention !! Internet Switchboard DOIT être connecté à Internet 
		  quand il est utilisé avec les nouvelles cartes Quicknet.</p><p>À la place d'Internet Switchboard, vous pouvez utiliser les 
		  applications
        <a class="ulink" href="http://www.openh323.org/code.html" target="_top">
        openphone</a>(avec interface utilisateur graphique) ou 
        <a class="ulink" href="http://www.openh323.org/code.html" target="_top">
        ohphone</a>(ligne de commande) d'openh323.</p><p>Sous Linux vous devez installer :</p><p>
          <div class="orderedlist"><ol type="1"><li><p>Le pilote de carte, à partir du 
              <a class="ulink" href="http://www.quicknet.net" target="_top">site web de Quicknet
				  </a>. Une fois téléchargés, vous devrez compiler les 
				  fichiers sources. (il faut disposer d'un lien symbolique ou 
				  physique vers le répertoire des sources de linux /usr/src/linux). 
				  Pour obtenir la marche à suivre, tapez la commande 'make'.</p></li><li><p>Une des applications 
              <a class="ulink" href="http://www.openh323.org/code.html" target="_top">
              openphone</a> ou
              <a class="ulink" href="http://www.openh323.org/code.html" target="_top">
              ohphone</a>.</p></li><li><p>Si vous êtes développeur, vous pouvez utiliser le 
              <a class="ulink" href="ftp://ftp.quicknet.net/Developer/Linux/Docs/" target="_top">
              SDK</a> pour créer votre propre application (valable aussi pour
				  Windows).</p></li></ol></div>
        </p></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a id="N10367" />6.1.2. Configuration</h4></div></div></div><p>Avec Internet Switchboard (et les autres applications), vous
		  pouvez :</p><p>
          <div class="orderedlist"><ol type="1"><li><p>Changer votre algorithme de compression préféré</p></li><li><p>Régler le délai de gigue (jitter)</p></li><li><p>Régler le volume</p></li><li><p>Régler le niveau d'annulation d'écho.</p></li></ol></div>
        </p></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1037E" />6.2. Quicknet LineJack</h3></div></div></div><p>Cette carte ressemble beaucoup à la précédente, elle prend aussi
		en charge la fonction de passerelle.</p><p>Remarquons simplement qu'il faut 
      <a class="ulink" href="http://www.quicknet.net/code.html" target="_top">télécharger</a>
		l'application PSTNGx (pour Linux et Windows) ou utiliser Internet 
		Switchboard pour utiliser la fonction de passerelle.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10389" />6.3. Produits VoiceTronix</h3></div></div></div><p>
        <div class="orderedlist"><ol type="1"><li><p>Téléchargez d'abord le logiciel 
            <a class="ulink" href="http://www.voicetronix.com.au/vpb-driver-2.1.8.tar.gz" target="_top">
            ici</a></p></li><li><p>Décompactez-le</p></li><li><p>Modifiez 'src/vpbreglinux.cpp' selon le fichier 
            README</p></li><li><p>Tapez 'make'</p></li><li><p>Tapez 'make install'</p></li><li><p>Se placer dans le répertoire src (cd src)</p></li><li><p>Tapez 'insmod vpb.o'</p></li><li><p>Retrouvez (à partir de la console ou à l'aide de la commande 
				'dmesg') le numéro majeur, noté ci-dessous MAJEUR</p></li><li><p>tapez 'mknod /dev/vpb0 c MAJEUR 0' où MAJEUR est le numéro
				susmentionné</p></li><li><p>se placer dans le répertoire unittest (cd unittest) et taper './echo'</p></li></ol></div>
      </p><p>Le fichier README contient des informations plus détaillées</p><p>Je n'ai pas testé personnellement les produits VoiceTronix.
		Contactez 
      <a class="ulink" href="http://www.voicetronix.com.au" target="_top">le site web de VoiceTronix
		</a>pour tout support.</p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N103BB" />7. Installation</h2></div></div></div><p>Dans ce chapitre, nous allons installer un système VoIP, d'abord 
	 simple, puis, de plus en plus complexe.</p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N103C0" />7.1. Communication simple : IP vers IP</h3></div></div></div><pre class="screen">
 A (Carte son) - - - B (Carte son)

   192.168.1.1 - - - 192.168.1.2


 192.168.1.1 appelle 192.168.1.2 et vice-versa.
</pre><p>A et B devraient avoir</p><p>
        <div class="orderedlist"><ol type="1"><li><p>une application comme Microsoft Netmeeting, Internet
            Switchboard, Openh323 (sous environnement Windows) ou Ohphone,
            Gnomemeeting (sous Linux), installée et correctement configurée.
            </p></li><li><p>une carte réseau ou autre type d'interface TCP/IP pour 
				communiquer.</p></li></ol></div>
      </p><p>Dans ce cas de figure, A fait un appel H323 à B (si B a une 
		application serveur active) à l'aide de l'adresse IP de B. Puis B peut 
		répondre s'il le souhaite. Une fois l'appel accepté, les paquets de 
		données VoIP commencent à circuler</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N103D6" />7.2. Utiliser des noms</h3></div></div></div><p>Sous Microsoft Windows, on peut utiliser un nom NetBIOS à la 
		place d'une adresse IP.</p><pre class="screen">
          A - - - B
192.168.1.1 - - - 192.168.1.2
       John - - - Alice
       

       John appelle Alice.
</pre><p>Ceci est possible car la requête d'appel de John à Alice a été 
		convertie en appel IP par le protocole NetBIOS</p><p>Ces deux exemples sont très faciles à implémenter mais n'autorisent 
		pas la montée en charge.</p><p>Dans le cas d'un réseau plus étendu, comme Internet, il est 
		impossible d'utiliser l'appel direct, car, en général, les appelants ne 
		connaissent pas l'adresse IP du destinataire. De plus, la gestion des 
		noms NetBIOS ne peut pas fonctionner car elle utilise des messages broadcast, 
		qui ne passent pas au travers des routeurs des FAI, en général.</p><p>Vous pouvez aussi utiliser DNS pour la résolution des noms en 
		adresses IP. Il est possible, par exemple, d'appeler le correspondant 
		nommé « <span class="quote">ordinateur.domaine.com</span> ».</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N103E9" />7.3. Appels sur Internet avec un serveur WINS</h3></div></div></div><p>L'idée d'appeler des noms NetBIOS peut aussi être implémentée en 
		environnement Internet à l'aide d'un serveur WINS. Il est possible de 
		configurer les clients NetBIOS afin qu'ils utilisent un serveur WINS 
		pour la résolution des noms</p><p>Les PC qui utilisent le même serveur WINS peuvent s'appeler 
		directement</p><pre class="screen">
A (serveur WINS S) - - - - - I - - - - B (serveur WINS S)
                             N
                             T
                             E - - - - - S (serveur Wins)
C (serveur WINS S) - - - - - R
                             N
                             E - - - - D (serveur WINS S)
                             T 


                    Communication Internet
</pre><p>A, B, C et D sont dans des sous-réseaux différents, mais ils 
		peuvent s'appeler à la manière d'un appel de nom NetBIOS. Il faut que 
		tous utilisent S comme serveur WINS.</p><p>Remarque : les performances du serveur WINS sont réduites 
		car il utilise NetBIOS  on ne devrait l'utiliser que pour un nombre 
		restreint de sous-réseaux .</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N103F7" />7.4. Serveur ILS</h3></div></div></div><p>Les serveurs de type ILS permettent de résoudre un nom lors d'un 
		appel H323 : lorsque vous démarrez une application VoIP, vous 
		commencez par enregistrer un nom sur le serveur ILS. L'ensemble des 
		utilisateurs pourront alors vous joindre à l'aide de ce nom (s'ils 
		possèdent le même serveur ILS !). 
		</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N103FC" />7.5. Un gros problème : le masquerading.</h3></div></div></div><p>On peut remédier à une pénurie d'adresses IP par utilisation du 
		masquage d'adresses (masquerading ou NAT, network address translation, 
		traduction d'adresse réseau) : une seule adresse IP est publique 
		(« <span class="quote">vue</span> » sur Internet), les autres machines sont 
		« <span class="quote">masquées</span> » par cette adresse IP.</p><pre class="screen">
A - - -
B - - - Routeur NAT - - - Internet
C - - -


         Ça ne fonctionne pas.
</pre><p>Dans l'exemple, A, B et C peuvent naviguer, pinguer, utiliser le 
		mail et les news avec des gens sur Internet, mais ils NE PEUVENT PAS 
		faire un appel de VoIP. En effet le protocole H323 envoie l'adresse IP 
		au niveau applicatif, donc la réponse n'arrivera jamais à la source 
		(qui utilise une adresse IP privée).</p><p>Solutions:</p><p>
        <div class="itemizedlist"><ul><li><p>Un module Linux particulier qui modifie les paquets h323 
				permet d'éviter ce problème. Vous pouvez le télécharger 
            <a class="ulink" href="http://www.coritel.it/coritel/ip/sofia/nat/nat2/nat2.htm" target="_top">
            ici</a>. Pour l'installer vous devez le copier dans le 
				répertoire source spécifié, modifier le Makefile, le compiler 
				et installer le module avec « <span class="quote">modprobe ip_masq_h323</span> ».
				Malheureusement ce module ne fonctionne pas actuellement avec
				ohphone (je ne sais pas pourquoi).</p></li></ul></div>
      </p><pre class="screen">
A - - - Routeur NAT
B - - -          +          - - - Internet
C - - - module ip_masq_h323


         Ça fonctionne.
</pre><p>
        <div class="itemizedlist"><ul><li><p>
            
              Il y a aussi une application qui résout ce problème. Voir 
              <a class="xref" href="#phonepatch">Phonepatch</a>
            
            </p></li></ul></div>
      </p><pre class="screen">
A - - -
B - - - PhonePatch - - - Internet
C - - -

        
        Ça fonctionne.
</pre></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1042C" />7.6. Applications Open Source</h3></div></div></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a id="N1042F" />7.6.1. Syntaxe d'Ohphone</h4></div></div></div><p>La syntaxe est :</p><p>« <span class="quote">ohphone -l [options] ou 
		  ohphone --listen [options]</span> »</p><p>« <span class="quote">ohphone [options]... adresse</span> »</p><p>
          <div class="itemizedlist"><ul><li><p>« <span class="quote">-l</span> », écoute sur le port standard (1720)</p></li><li><p>« <span class="quote">adresse</span> », signifie que nous n'attendons pas d'appel,
				  mais que nous nous connectons à la machine « <span class="quote">adresse</span> »</p></li><li><p>« <span class="quote">-n</span> », « <span class="quote">--no-gatekeeper</span> », convient en
				  l'absence de portier</p></li><li><p>« <span class="quote">-q num</span> », « <span class="quote">--quicknet num</span> », utiliser la carte Quicknet,
				  périphérique /dev/phone(num)</p></li><li><p>« <span class="quote">-s device</span> », « <span class="quote">--sound device</span> », utiliser le périphérique
				  audio /dev/device.</p></li><li><p>« <span class="quote">-j délai</span> », « <span class="quote">--jitter délai</span> », passer le 
				  délai du tampon à la valeur « <span class="quote">délai</span> ».</p></li></ul></div>
        </p><p>De plus, une fois ohphone lancé, il est possible de passer 
		  directement des commandes à l'aide de l'interpréteur (par exemple, pour 
		  diminuer l'AEC, Automatic Echo Cancellation, annulation automatique d'écho). 
		  </p></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a id="N1046F" />7.6.2. Gnomemeeting</h4></div></div></div><p>Gnomemeeting est une application avec interface utilisateur 
		  graphique permettant d'effectuer des appels VoIP. Son utilisation est 
		  très simple et elle fournit, entre autres, un serveur ILS, et un chat.</p></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10474" />7.7. Installer un portier</h3></div></div></div><p>Vous pouvez aussi faire l'essai d'un portier.</p><pre class="screen">
Exemple

  (Terminal H323) A - - -
                         \
  (Terminal H323) B - - - D (Portier)
                         / 
  (Terminal H323) C - - -
  

      Configuration du portier
</pre><p>
        <div class="orderedlist"><ol type="1"><li><p>Les machines A, B et C sont configurées pour pointer sur le 
				portier D.</p></li><li><p>Au démarrage, chaque machine fournit, à D, ses adresse et 
				nom propres (des alias également), qui pourront être utilisés, 
				par un appelant, pour la contacter.</p></li><li><p>Quand un terminal demande, à D, l'accès à une machine, D 
				répond en fournissant l'adresse IP, qui permet d'établir la 
				communication.</p></li></ol></div>
      </p><p>Il faut noter que le Portier n'est capable que de résoudre des 
		noms en adresses IP : il ne peut pas relier des machines injoignables 
		entre-elles au niveau IP, autrement dit il ne peut pas fonctionner comme 
		routeur NAT.</p><p>Vous pourrez trouver le code source d'un portier 
      <a class="ulink" href="http://www.opengatekeeper.org" target="_top">ici</a> : la
      <a class="ulink" href="http://www.openh323.org/code.html" target="_top">librairie openh323
      </a>est nécessaire.</p><p>Le programme peut être lancé avec les paramètres -d (démon) ou 
		-x (execute).</p><p>Vous pouvez de plus utiliser un fichier de config (.ini) que
		vous trouverez <a class="ulink" href="http://www.opengatekeeper.org/opengate.ini" target="_top">
		ici</a>.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1049F" />7.8. Installer une passerelle</h3></div></div></div><p>Comme nous l'avons déja dit, une passerelle relie la VoIP aux lignes 
		du réseau téléphonique (RTCP) ce qui permet d'appeler un téléphone 
		classique depuis Internet. Il faut donc, en plus, une carte capable de 
		gérer des lignes RTCP : la carte Quicknet LineJack convient.</p><p>Sur le 
      <a class="ulink" href="http://www.openh323.org" target="_top">site web OpenH323</a> nous
      téléchargeons :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>le pilote de Linejack</p></li><li><p>l'application PSTNGw qui servira de passerelle.</p></li></ol></div>
      </p><p>Si l'exécutable ne fonctionne pas, il faut télécharger le code source 
		et la 
      <a class="ulink" href="http://www.openh323.org/code.html" target="_top">librairie openh323
      </a>, puis installer le tout dans un répertoire personnel.</p><p>Il suffit ensuite de lancer PSTNGw pour démarrer la passerelle 
		H323.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N104BE" />7.9. Matrice de compatibilité</h3></div></div></div><p>La première matrice concerne les :</p><p>
        <div class="orderedlist"><ol type="1"><li><p>Communications entre logiciels (ex: Netmeeting avec 
				Switchboard)</p></li><li><p>Communication entre logiciels, pilotes et matériel (ex: 
				Netmeeting peut utiliser une carte PhoneJack)</p></li></ol></div>
      </p><pre class="screen">
 _______________________________________________________________________________________________
|            | Net-    | Switch- |Simph323 | OhPhone | LinPhone| Speak-  |    HW    |    HW    |
|            | meeting | Board   |         |         |         | Freely  | PhoneJACK| LineJACK |
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
| Netmeeting |    V         V         V         V         X         X         V          V
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
|SwitchBoard |    V         V         V         V         X         X         V          V
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
| Simph323   |    V         V         V         V         X         X         X          X
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
| OhPhone    |    V         V         V         V         X         X         V          V
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
| LinPhone   |    X         X         X         X         V         X         X          X
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
|SpeakFreely |    X         X         X         X         X         V         X          X
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
|HW PhoneJACK|    V         V         X         V         X         X         _          _
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
|HW LineJACK |    V         V         X         V         X         X         _          _
|____________|_________|_________|_________|_________|_________|_________|__________|__________|
</pre><p>La seconde matrice fait référence aux logiciels de passerelle qui 
		gèrent la carte LineJack.</p><pre class="screen">
___________________________________________________________
|              |HW LineJACK GW| SwitchBoard  |   PSTNGW     |
|______________|______________|______________|______________|
|HW LineJACK GW|      _       |       V      |       V      |
|______________|______________|______________|______________|
| SwitchBoard  |      V       |       _      |       _      |
|______________|______________|______________|______________|
|   PSTNGW     |      V       |       _      |       _      |
|______________|______________|______________|______________|
</pre><p>Notation:</p><p>
        <div class="itemizedlist"><ul><li><p>V : Fonctionne</p></li><li><p>X : Ne fonctionne pas</p></li><li><p>-- : Non significatif</p></li></ul></div>
      </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N104E6" />8. Communications sur des lignes RTCP</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N104E9" />8.1. Généralités</h3></div></div></div><p>La VoIP devient très intéressante quand vous commencez à utiliser 
		des lignes RTCP pour appeler d'autres gens dans le monde, directement 
		sur leur téléphone à domicile.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N104EE" />8.2. Scénario</h3></div></div></div><p>Une application typique serait :</p><pre class="screen">
Téléphone 1 -- (RTCP) -- PC1 -- (Internet) -- PC2 -- (RTCP) -- Téléphone 2
</pre><p>
        <div class="orderedlist"><ol type="1"><li><p>Le téléphone 1 appelle le numéro du PC1 (sur le RTCP, càd 
				la ligne téléphonique classique)</p></li><li><p>Le PC1 lui répond.</p></li><li><p>Le téléphone 1 doit indiquer au PC1 la passerelle à utiliser 
				(le PC2 dans ce cas) en fournissant l'adresse IP (à l'aide du 
				clavier à tonalités) et/ou le numéro à appeler (dans ce cas, celui 
				du téléphone 2)</p></li><li><p>Le PC1 émet ensuite un appel H323 au PC2, et lui transmet 
				le numéro du téléphone 2 afin qu'il appelle ce dernier à l'aide 
				du RTCP</p></li><li><p>Le téléphone 2 répond à l'appel et la communication entre 
				le téléphone 1 et le téléphone 2 commence.</p></li></ol></div>
      </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N1050B" />8.3. Que peut-on changer dans cette configuration ?</h3></div></div></div><p>
        <div class="orderedlist"><ol type="1"><li><p>Il est possible d'utiliser un autocommutateur privé qui 
				fournit plusieurs lignes d'accès à la passerelle PC1 (l'une, par 
				exemple, pour des appels internes à l'état, l'une pour des appels 
				vers l'Europe, et cætera) : en général cette option est 
				inutile, car le coût est identique.</p></li><li><p>Il est possible de sélectionner, après appel de la passerelle 
				PC1, le PC2 de votre choix, (par exemple un PC2 situé en Angleterre 
				si on appelle un Anglais) afin de ne payer que des communications 
				nationales.</p></li></ol></div>
      </p><p>Votre décision dépendra donc des coûts des lignes RTCP. En fait, 
		la VoIP fait la conversion de :</p><pre class="screen">
Téléphone 1 --- (RTCP) --- Téléphone 2
             Coût d'un appel grande distance RTCP
</pre><p>en :</p><pre class="screen">
Téléphone 1 --- (RTCP) --- PC1   +
PC2 ---- (RTCP) --- Téléphone 2  =
--------------------------------------
2 coûts d'appel RTCP courte distance
</pre><p>Pour réaliser des économies il est nécessaire que :</p><pre class="screen">
2 coûts d'appel RTCP courte distance &lt; coût d'appel RTCP grande distance
</pre><p>Généralement, un « <span class="quote">appel à courte distance</span> » désigne un « <span class="quote">appel 
		local</span> » alors qu'un « <span class="quote">appel grande distance</span> » peut être un « <span class="quote">appel 
		intercontinental</span> » !</p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N10537" />9. Considérations de bande passante</h2></div></div></div><p>Dans ce qui a été dit jusqu'à présent le problème de bande passante 
	 n'a pas été résolu : comment créer un flux de données en temps réel.</p><p>Nous savons qu'il n'existe pas de solution en l'absence d'un protocole 
	 de gestion temps réel dans chaque routeur traversé. Qu'est-il possible de 
	 faire ?</p><p>On peut commencer par utiliser des algorithmes de compression à taux 
	 très élevé (le plus élevé possible), comme l'algorithme LPC10 qui ne 
	 consomme que 2,5 kbps de bande passante, environ 313 octets/s.</p><p>On peut ensuite essayer de classer les paquets, à l'aide du champ 
	 TOS, au niveau de priorité maximum, afin que chaque routeur les traite en 
	 urgence</p><p>Remarque importante : tout cela ne suffira pas à garantir que 
	 la permanence conversation sera toujours de bonne qualité, mais, en 
	 l'absence d'infrastructure importante qui assure, en particulier, la mise 
	 en forme du trafic et la réservation de bande passante, cela n'est pas 
	 réalisable : TCP/IP n'est pas un protocole temps réel</p><p>Une solution pourrait être d'utiliser, pour commencer, des petits 
	 réseau WAN à bande passante garantie et de les agrandir étape par étape.</p><p>Une remarque pour finir : les services supposés garantis, comme les 
	 lignes RTCP, ne peuvent pas non plus gérer l'ensemble de leurs clients au 
	 même instant. Par exemple, un appel GSM ne peut pas absorber un nombre supérieur à  
	 quelques centaines ou quelques milliers de clients</p><p>En tout cas, pour un service qui débute, limité à quelques 
	 utilisateurs, la VoIP peut être une alternative valable au service RTCP 
	 classique.</p></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N1054A" />10. Glossaire</h2></div></div></div><p>RTCP : Réseau Téléphonique Commuté Public</p><p>VoIP : Voice over Internet Protocol (Voix sur protocole Internet - Voix sur IP)</p><p>LAN : Local Area Network (réseau local)</p><p>WAN : Wide Area Network (réseau étendu)</p><p>TOS : Type Of Service (type de service)</p><p>FAI : Fournisseur d'Accès Internet</p><p>RTP : Real Time Protocol (protocole temps réel)</p><p>RSVP : ReSerVation Protocol (protocole de réservation)</p><p>QoS : Quality of Service (qualité de service)</p></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title"><a id="N1055F" />11. Liens utiles</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N10562" />11.1. Liens vers des logiciels open source</h3></div></div></div><p>
        <div class="itemizedlist"><ul><li><p>
              <a class="ulink" href="http://www.voxilla.org" target="_top">Voxilla</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.linuxtelephony.org" target="_top">Linux
              Telephony</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.openh323.org" target="_top">Site web Open H323</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.gnomemeeting.org/" target="_top">Gnomemeeting</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.speakfreely.org" target="_top">Speak Freely</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.linphone.org" target="_top">Linphone</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.fsf.org/software/osip" target="_top">Osip</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.gnu.org/software/bayonne" target="_top">Bayonne</a>
            </p></li></ul></div>
      </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a id="N105A1" />11.2. Liens commerciaux</h3></div></div></div><p>
        <div class="itemizedlist"><ul><li><p>
              <a class="ulink" href="http://www.fatamorgana.com" target="_top">Fatamorgana
              Computers</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.itu.org" target="_top">International Communication
              Union</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.voicetronix.com.au" target="_top">Voicetronix</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.quicknet.net" target="_top">Quicknet</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.cisco.com" target="_top">Cisco Systems</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.metropark.com" target="_top">http://www.metropark.com</a>
            </p></li><li><p>
              <a class="ulink" href="http://www.nbxsoftware.com" target="_top">http://www.nbxsoftware.com</a>
            </p></li></ul></div>
      </p></div></div></div></body></html>