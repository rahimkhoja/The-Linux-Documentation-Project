<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>Oracle Database HOWTO</TITLE>
</HEAD>
<BODY>
<H1>Oracle Database HOWTO</H1>

<H2>Paul Haigh, <CODE>
<A HREF="mailto:paul@nailed.demon.co.uk">paul@nailed.demon.co.uk</A></CODE> <BR>
Adaptation française par Stéphane Lee Chip Hing, <CODE>
<A HREF="mailto:slee@ile-maurice.com">slee@ile-maurice.com</A></CODE></H2>v1.2, 04 août 1998
<HR>
<EM>Un guide pour installer et configurer le Serveur de Base de Données Oracle sur un système Linux.</EM>
<HR>
<H2><A NAME="s1">1. Introduction</A></H2>

<H2><A NAME="ss1.1">1.1 Historique des Versions</A>
</H2>

<P>
<UL>
<LI><CODE>v0.1 - 21 fév. 1998 - Paul Haigh - Version Originale</CODE></LI>
<LI><CODE>v0.2 - 01 mars 1998 - Paul Haigh - Adjonction des Commentaires des Relecteurs</CODE></LI>
<LI><CODE>v1.0 - 10 mars 1998 - Paul Haigh - Publié sous LDP </CODE></LI>
<LI><CODE>v1.1 - 20 juin 1998 - Paul Haigh - Section Dépannage ajoutée et rangement général</CODE></LI>
<LI><CODE>v1.2 - 04 août 1998 - Paul Haigh - Nouvelles d'Oracle Corp ajoutée et section sur les Améloirations Futures supprimée. </CODE></LI>
</UL>
</P>

<H2><A NAME="ss1.2">1.2 Copyright</A>
</H2>

<P>Le HOWTO Oracle Database est copyright (c) 1998, Paul Haigh.</P>
<P>Comme tous les documents HOWTO Linux, celui-ci peut être reproduit et distribué en entier ou en extrait, sur n'importe quel support, physique ou électronique, tant que ce copyright est maintenu sur toutes les copies.</P>

<P>La redistribution commerciale est autorisée et encouragée. Cependant, l'auteur aimerait être avisé de telles distributions. Vous pouvez traduire ce HOWTO dans n'importe quelle langue tant que vous incluez une notice précisant celui
ou celle qui a traduit ce document.</P>

<H2><A NAME="ss1.3">1.3 Mise en garde</A>
</H2>

<P>Bien que j'ai essayé d'inclure les informations les plus correctes et les plus récentes a ma disposition, je ne peux garantir que leur utilisation ne va pas occasionner des pertes de données ou de matériel.
Je ne fournis AUCUNE GARANTIE sur les informations dans ce HOWTO et je ne suis responsable d'aucune conséquence résultant de l'utilisation des informations de ce document.</P>

<H2><A NAME="ss1.4">1.4 But de ce HOWTO</A>
</H2>

<P>Dans ce HOWTO, je vais essayer de couvrir l'installation et l'administration basique d'une base de données Oracle tournant sur une machine Linux. Je vais couvrir particulièrement l'installation du serveur Oracle, la configuration de SQL*Net et du client.</P>

<P>Ce document n'est pas un tutoriel complet sur l'utilisation et l'administration d'une base de données Oracle. Si c'est cela que vous recherchez, il y a de bons livres sur ces sujets publiés par O'Reilly et autres.</P>

<P>Je ne vais pas non plus couvrir le développement des programmes Oracle sous UNIX. Si cela vous est absolument nécessaire, je vous recommanderais d'acheter le système de développement de SCO (avec OpenServer 5.x) , dont
on m'a dit qu'il pouvait être obtenu pour un prix très raisonnable US $19, à 
<A HREF="http://www.sco.com">SCO</A></P>
<H2><A NAME="ss1.5">1.5 Pré-Requis</A>
</H2>

<P>Je suppose acquises un certain nombre de notions pour comprendre la suite du HOWTO.
<UL>
<LI><B>Le CD Serveur Oracle pour SCO OpenServer (Version 7.3.3.0.0.)</B>
<DL>
<P>Ceci  <B>doit</B> être une copie légale.  N'oubliez pas qu'Oracle est une société commerciale et vend ses produits. Si vous voulez une base de données compatible SQL gratuite, utilisez PostgreSQL ou quelque chose de
similaire.</P>
<P>Il est aussi possible d'installer Oracle, avec une licence d'évaluation de 60 jours, à partir d'un fichier <CODE>tar</CODE> téléchargeable sur le site web d'Oracle. Je ne l'ai pas personnellement essayé et ce n'est pas vérifié.</P>

</DL>

</LI>
<LI><B>Un Serveur Linux</B>

<DL>
<P>Vous n'auriez pas lu ceci sans un... N'est-ce pas?</P>

</DL>

</LI>
<LI><B>Noyau 2.0.30+</B>

<DL>
<P>Je ne peux garantir que les instructions seront fiables pour les autres noyaux. (ni pour le 2.0.30, d'ailleurs...)</P>

</DL>

</LI>
<LI><B>iBCS</B>

<DL>
<P>Il est très important que ceci soit installé et tourne avec la version la plus récente possible pour votre plate-forme. (J'utilise iBCS-2.0-10.i386.rpm de RedHat Linux).</P>

</DL>

</LI>
<LI><B>Beaucoup d'espace disque</B>

<DL>
<P>600 Mb+ est une quantité raisonnable. Il est possible d'installer avec moins de place mais vous devez faire des sacrifices, et je ne commence jamais avec ça. Néanmoins, je vais essayer de souligner les endroits où l'on peut libérer de l'espace. </P>

</DL>

</LI>
<LI><B>32Mb+ Ram</B>

<DL>
<P>Je sais que ceci peut sembler important, surtout en ce qui concerne Linux, mais n'oubliez pas que Oracle est un logiciel complexe. Vous n'auriez pas ces réserves sur SCO!</P>
<P>Je ne dis pas que Oracle ne marchera pas avec moins, mais que c'est le
minimum recommandé par Oracle, ce que je n'aurais pas conseillé.</P>
</DL>

</LI>
<LI><B>Licences de Oracle</B>

<DL>
<P>Je sais que je l'ai deja mentionné ceci mais je voudrais être clair
sur son importance. Utilisez les logiciels d'Oracle sans licence est illégal.</P>
</DL>

</LI>
</UL>
</P>


<H2><A NAME="ss1.6">1.6 Nouvelles d'Oracle Corporation</A>
</H2>

<P>Oracle a cédé sous la pression de la communauté Linux. Oracle Corporation a décidé de supporter <B>officiellement</B> Oracle 8 sur la plate-forme Linux (i386). Elle doit être lancé en décembre 1998, selon le site web d'Oracle.</P>
<P>Mieux encore, Oracle va aussi porter <CODE>Oracle Applications</CODE> sur Linux. Il doit être disponible dans le premier semestre 1999, selon le site web d'Oracle. </P>
<P>Références:
<UL>
<LI><CODE>
<A HREF="http://www.oracle.com/html/linux.html">http://www.oracle.com/html/linux.html</A></CODE></LI>
<LI><CODE>
<A HREF="http://www.news.com/News/Item/0,4,24436,00.html">http://www.news.com/News/Item/0,4,24436,00.html</A></CODE></LI>
<LI><CODE>
<A HREF="http://www.zdnet.com/pcweek/news/0720/20morac.html">http://www.zdnet.com/pcweek/news/0720/20morac.html</A></CODE></LI>
</UL>
</P>

<H2><A NAME="s2">2. Installation du logiciel Oracle</A></H2>

<H2><A NAME="ss2.1">2.1 Préparation du Serveur</A>
</H2>

<H3>Création d'un Utilisateur Oracle</H3>

<P>Nous avons évidemment besoin d'un utilisateur pour maintenir la base de données Oracle. Comme nous n'avons l'intention de relier le noyau Oracle (plus sur ceci plus tard), nous devons accepter les noms d'utilisateur et de groupe par défaut d'Oracle. Il inclut l'utilisateur ORACLE et le groupe DBA.</P>
<P>
<OL>
<LI>Se connecter comme root

</LI>
<LI>Créer l'utilisateur <CODE>oracle</CODE> et le groupe <CODE>dba</CODE>.
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ groupadd dba 
$ useradd  oracle
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</LI>
<LI> S'assurer que le répertoire personnel est créé pour l'utilisateur oracle.
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ mkdir /home/oracle
$ mkdir /home/oracle/7.3.3.0.0 (Version of Oracle)
$ chown -R oracle.dba /home/oracle
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</LI>
</OL>
</P>

<H2><A NAME="ss2.2">2.2 Installation depuis le CDROM</A>
</H2>

<P>Malheureusement, l'Installateur Oracle sur le CD SCO ne marchera pas. Beaucoup de problèmes peut être rencontrés, des <CODE>core dumps</CODE> aux blocages. On doit donc copier les fichiers du CDROM manuellement et les décompresser:</P>
<P>(S'assurer que le CDROM est monté sur le système).
<OL>
<LI>Se connecter comme utilisateur Oracle</LI>
<LI>Changer de répertoire pour <CODE>/home/oracle/7.3.3.0.0.</CODE></LI>
<LI>Copier les fichiers d'installation du CDROM
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ cp -a /mnt/cdrom/* .
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</LI>
<LI>Décompresser les fichiers Oracle du CDROM.  
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ find . -name *_ -exec ~/7.3.3.0.0/orainst/oiuncomp {} \;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</LI>
</OL>
</P>

<H2><A NAME="ss2.3">2.3 Tâches de Post Installation </A>
</H2>

<H3>Tâches pour Root</H3>

<P>Ajouter les lignes suivantes dans <CODE>/etc/profile</CODE> ou  dans  <CODE>.profile</CODE> pour chaque utilisateur d'Oracle.
<BLOCKQUOTE><CODE>
<HR>
<PRE>
# Oracle Specific
ORACLE_HOME=/home/oracle/7.3.3.0.0
ORACLE_SID=orcl
ORACLE_TERM=vt100
export ORACLE_HOME ORACLE_SID ORACLE_TERM

# Changer le chemin pour Oracle
PATH="$PATH:$ORACLE_HOME/bin"
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<P>Nous devons aussi changer le propriétaire et les permissions de l'utilitaire Oracle d'augmentation de <CODE>ulimit</CODE>.
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ chown root.root $ORACLE_HOME/bin/osh
$ chmod u+s $ORACLE_HOME/bin/osh
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<H3>Tâches pour Oracle</H3>

<P>Changer les permissions pour les fichiers Oracle pour s'assurer de leur bonne exécution.
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ chmod +x $ORACLE_HOME/bin/*
$ chmod u+s $ORACLE_HOME/bin/oracle
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<P>Les outils Oracle demandent que les messages soient dans le répertoire <CODE>$ORACLE_HOME/tool_name/mesg</CODE>.
Donc, déplacez les fichiers  <CODE>msb</CODE>  des répertoires  <CODE>msg_ship</CODE> aux répertoires <CODE>mesg</CODE>.
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ mv $ORACLE_HOME/plsql/mesg/mesg_ship/* $ORACLE_HOME/plsql/mesg/.
$ mv $ORACLE_HOME/rdbms/mesg/mesg_ship/* $ORACLE_HOME/rdbms/mesg/.
$ mv $ORACLE_HOME/svrmgr/mesg/mesg_ship/* $ORACLE_HOME/svrmgr/mesg/.
</PRE>
<HR>
</CODE></BLOCKQUOTE>

Créer les répertoires suivants, s'ils n'existent pas:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ mkdir $ORACLE_HOME/rdbms/log
$ mkdir $ORACLE_HOME/rdbms/audit
$ mkdir $ORACLE_HOME/network/log
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H3>Ceux que vous pouvez enlever</H3>

<P>Les répertoires suivants peuvent être enlevés sans problème:
<UL>
<LI><CODE>$ORACLE_HOME/guicommon2/</CODE></LI>
<LI><CODE>$ORACLE_HOME/ctx/</CODE></LI>
<LI><CODE>$ORACLE_HOME/md/</CODE></LI>
<LI><CODE>$ORACLE_HOME/mlx/</CODE></LI>
<LI><CODE>$RACLE_HOME/precomp/</CODE></LI>
<LI><CODE>$ORACLE_HOME/slax/</CODE></LI>
</UL>
</P>
<H2><A NAME="s3">3. Création d'une base de données</A></H2>

<P>Maintenant que le serveur Oracle est installé, nous devons créer une base de données pour tester l'installation.
<CODE>Si vous utilisez Oracle 7.2.x ou une version anterieure, veuillez lire la section Dépannage ci-dessous.</CODE></P>
<H2><A NAME="ss3.1">3.1 Créer le fichier d'Initialisation</A>
</H2>

<P>Copiez <CODE>$ORACLE_HOME/dbs/init.ora</CODE> vers <CODE>$ORACLE_HOME/dbs/initorcl.ora</CODE>:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ cd $ORACLE_HOME/dbs
$ cp init.ora initorcl.ora
</PRE>
<HR>
</CODE></BLOCKQUOTE>

Le modifier en ajoutant les lignes suivantes:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
db_name = orcl
COMPATIBLE=7.3.3.0.0
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>


<H2><A NAME="ss3.2">3.2 Création du script pour l'installation de la base de données</A>
</H2>

<P>Créer un fichier script nommé <CODE>makedb.sql</CODE> dans le répertoire  <CODE>$ORACLE_HOME/dbs</CODE>:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
connect internal
startup nomount
set echo on
spool makedb.log
create database orcl
        maxinstances 1
        maxlogfiles  8
        datafile '$ORACLE_HOME/dbs/orcl_syst_01.dbf' size 40M reuse
        logfile
                '$ORACLE_HOME/dbs/orcl_redo_01.dbf' size 1M reuse,
                '$ORACLE_HOME/dbs/orcl_redo_02.dbf' size 1M reuse,
                '$ORACLE_HOME/dbs/orcl_redo_03.dbf' size 1M reuse;
@$ORACLE_HOME/rdbms/admin/catalog.sql
create tablespace rollback
        datafile '$ORACLE_HOME/dbs/orcl_roll_01.dbf' size 8.5M reuse;
create tablespace temp
        datafile '$ORACLE_HOME/dbs/orcl_temp_01.dbf' size 5M reuse 
        temporary;
create tablespace users
        datafile '$ORACLE_HOME/dbs/orcl_user_01.dbf' size 10M reuse;
create rollback segment r1 tablespace rollback
        storage ( optimal 5M );
alter rollback segment r1 online;
connect system/manager
@$ORACLE_HOME/rdbms/admin/catdbsyn.sql
connect internal
@$ORACLE_HOME/rdbms/admin/catproc.sql
connect system/manager
@$ORACLE_HOME/sqlplus/admin/pupbld.sql
spool off
exit
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="ss3.3">3.3 Exécuter le script pour l'installation de la base de données</A>
</H2>

<P>Démarrer <CODE>svrmgrl</CODE> et exécuter le script:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ cd $ORACLE_HOME/dbs
$ svrmgrl

Oracle Server Manager Release 2.3.3.0.0 - Production

Copyright (c) Oracle Corporation 1994, 1995. All rights reserved.

Oracle7 Server Release 7.3.3.0.0 - Production Release
PL/SQL Release 2.3.3.0.0 - Production

SVRMGR> connect internal
Connected.
SVRMGR> startup nomount
ORACLE instance started.
Total System Global Area       4313312 bytes
Fixed Size                       41876 bytes
Variable Size                  4140364 bytes
Database Buffers                122880 bytes
Redo Buffers                      8192 bytes
SVRMGR> @makedb
&lt;beaucoup de messages>
SVRMGR> exit
Server Manager complete.
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H2><A NAME="ss3.4">3.4 Démarrer la base de données</A>
</H2>

<P>Premièrement, nous devons lancer la base de données manuellement (nous l'automatiserons plus tard). Pour démarrer une base de données Oracle, nous devons émettre la commande <CODE>startup</CODE> en étant connecté localement:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ svrmgrl

Oracle Server Manager Release 2.3.3.0.0 - Production

Copyright (c) Oracle Corporation 1994, 1995. All rights reserved.

Oracle7 Server Release 7.3.3.0.0 - Production Release
PL/SQL Release 2.3.3.0.0 - Production

SVRMGR> connect internal
Connected.
SVRMGR> startup
ORACLE instance started.
Total System Global Area       4313316 bytes
Fixed Size                       41876 bytes
Variable Size                  4140368 bytes
Database Buffers                122880 bytes
Redo Buffers                      8192 bytes
Database mounted.
Database opened.
SVRMGR> exit
Server Manager complete.
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H2><A NAME="ss3.5">3.5 Arrêter la base de données</A>
</H2>

<P>Il est important de mentionner ici que redémarrer un serveur Linux sans fermer
auparavant la base de données Oracle risque fort de corrompre la base de 
données.</P>
<P>Donc, avant d'émettre la commande Linux <CODE>shutdown</CODE>, il est sage de fermer le base de données:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ svrmgrl

Oracle Server Manager Release 2.3.3.0.0 - Production

Copyright (c) Oracle Corporation 1994, 1995. All rights reserved.

Oracle7 Server Release 7.3.3.0.0 - Production Release
PL/SQL Release 2.3.3.0.0 - Production

SVRMGR> connect internal
Connected.
SVRMGR> shutdown
Database closed.
Database dismounted.
ORACLE instance shut down.
SVRMGR> exit
Server Manager complete.
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H2><A NAME="ss3.6">3.6 Créer un Utilisateur par défaut</A>
</H2>

<P>La base de données, telle qu'elle a été créée, a deux utilisateurs spéciaux qui sont créés automatiquement. Ce sont;
<BLOCKQUOTE><CODE>
<HR>
<PRE>
Username                Password

SYSTEM                  MANAGER
SYS                     change_on_install
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<P>Ces utilisateurs sont typiquement utilisés pour maintenir les informations sur le dictionnaire standard de données pour la base de données. C'est une bonne idée de changer les mots de passe par défaut aussitôt que possible.</P>

<P>Ceci peut être fait par:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
sqlplus system/manager

SQL*Plus: Release 3.3.3.0.0 - Production on Sat Feb 21 12:43:33 1998

Copyright (c) Oracle Corporation 1979, 1996.  All rights reserved.


Connected to:
Oracle7 Server Release 7.3.3.0.0 - Production Release

SQL> alter user system identified by &lt;newpassword>;

User altered.

SQL> alter user sys identified by &lt;newpassword>;

User altered.

SQL> exit;
Disconnected from Oracle7 Server Release 7.3.3.0.0 - Production Release
PL/SQL Release 2.3.3.0.0 - Production
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<P>Comme l'utilisateur <CODE>system/manager</CODE> est similaire à l'utilisateur <CODE>root</CODE> sur une machine UNIX, nous devons créer un utilisateur avec moins de pouvoir
à causer des dégats possibles (rappelez-vous de lancer la base de données avant d'essayer de créer un utilisateur).</P>
<P>Se connecter à SQL*Plus et créer un utilisateur:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ sqlplus system/manager

SQL*Plus: Release 3.3.3.0.0 - Production on Sat Feb 21 12:43:33 1998

Copyright (c) Oracle Corporation 1979, 1996.  All rights reserved.


Connected to:
Oracle7 Server Release 7.3.3.0.0 - Production Release
PL/SQL Release 2.3.3.0.0 - Production

SQL> create user &lt;user> identified by &lt;psw> 
  2  default tablespace users 
  3  temporary tablespace temp;

User created.

SQL> grant connect, resource to &lt;user>

Grant succeeded.

SQL> exit
Disconnected from Oracle7 Server Release 7.3.3.0.0 - Production Release
PL/SQL Release 2.3.3.0.0 - Production
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Maintenant que vous avez un nouvel utilisateur sur le système, vous pouvez jouer avec. Pour se connecter sur la base de données Oracle:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ sqlplus &lt;user>/&lt;password>
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Si ceci s'exécute sans messages d'erreur, vous avez donc une base de données Oracle qui marche. Si vous ne voulez vous connecter qu'à partir de ce
serveur, votre travail est donc terminé. Amusez-vous!</P>
<P>Si, cependant, comme la plupart des gens, vous voulez configurer la partie réseau du logiciel pour que vous puissiez vous connecter depuis d'autres machine, continuez votre lecture.</P>


<H2><A NAME="s4">4. Configurer SQL*Net sur le Serveur</A></H2>

<P>Tous ces fichiers configurent la partie réseau d'Oracle (SQL*Net ou Net8 pour Oracle8). Ces fichiers doivent être créés sur le serveur dans le répertoire <CODE>$ORACLE_HOME/network/admin</CODE>.</P>
<H2><A NAME="ss4.1">4.1 <CODE>tnsnames.ora</CODE></A>
</H2>

<P>Le fichier <CODE>TNSNAMES.ORA</CODE> identifie les services disponibles depuis la machine. Dans notre cas, nous décrirons toutes les bases de données que le serveur a monté. Pour chaque base de données sur votre serveur, ajouter une section comme ci-dessous:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
orcl.world =
  (DESCRIPTION =
    (ADDRESS_LIST =
        (ADDRESS =
          (COMMUNITY = tcp.world)
          (PROTOCOL = TCP)
          (Host = &lt;INSERER LE NOM LOGIQUE DU SERVEUR ICI> )
          (Port = 1521)
        )
        (ADDRESS =
          (COMMUNITY = tcp.world)
          (PROTOCOL = TCP)
          (Host = &lt;INSERER LE NOM LOGIQUE DU SERVEUR ICI> )
          (Port = 1526)
        )
    )
    (CONNECT_DATA = (SID = ORCL)
    )
  )
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H2><A NAME="ss4.2">4.2 <CODE>listener.ora</CODE></A>
</H2>

<P>Le fichier <CODE>listener.ora</CODE> contient la description des services auxquels d'autres machines sont autorisées à se connecter et toutes les configurations nécessaires pour l'écouteur du serveur.</P>

<P>Il contient les sections pour le nom de l'écouteur, son
adresse, les bases de données desservies par l'écouteur et
les paramètres de configuration.</P>

<P>Voici un exemple:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
# Nom de l'écouteur et les adresses a écouter
LISTENER =
        ( ADDRESS_LIST =
                (ADDRESS =
                        (PROTOCOL=tcp)
                        (HOST=&lt;INSERT HOST>)
                        (PORT=1521)
                        (COMMUNITY=UK_SUP_TCPIP)
                )
                (ADDRESS =
                        (PROTOCOL=ipc)
                        (KEY=700)
                        (COMMUNITY=UK_SUP_TCPIP)
                )
        )

# Liste des services désservis par l'écouteur
SID_LIST_LISTENER=
        (SID_LIST=
                (SID_DESC=
                        (SID_NAME=orcl)
                        (ORACLE_HOME=/home/oracle/7.3.3.0.0)
                )
        )

# Début des paramètres de configuration
TRACE_LEVEL_LISTENER=OFF
TRACE_FILE_LISTENER = "listener"
LOG_FILE_LISTENER = "listener"
CONNECT_TIMEOUT_LISTENER = 10
STOP_LISTENER = YES
DBA_GROUP = dba
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H2><A NAME="ss4.3">4.3 <CODE>sqlnet.ora</CODE></A>
</H2>

<P>Le fichier <CODE>sqlnet.ora</CODE> contient la configuration pour le noeud du réseau. Ceci est indépendant du nombre de bases de données ou du nombre d'écouteurs. La chose la plus importante dans ce fichier est la variable de configuration
<CODE>Timeout des Connexions Mortes</CODE>.</P>

<P>Le timeout des connexions mortes vérifie chaque processus entrant à la base de données et assure que le côté client répond
toujours. Si le client (de tout type) ne répond pas, le processus en tâche de fond du serveur Oracle sera tué.</P>
<P>Ceci est très utile si vous avez plusieurs clients qui accèdent à la base de données, surtout pendant la phase de développement où ces clients ne réussiront certainement pas à sortir proprement de la base de données Oracle.</P>

<P>Voici une copie de mon fichier <CODE>sqlnet.ora</CODE> pour vous servir d'exemple:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
TRACE_LEVEL_CLIENT = OFF
sqlnet.expire_time = 30         # le nombre de secondes entre les vérifications des clients.
names.default_domain = world
name.default_zone = world
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="ss4.4">4.4 Lancer et Arrêter les Ecouteurs.</A>
</H2>

<P>Maintenant que la configuration des écouteurs et de SQL*Net est finie, nous pouvons essayer de connecter la base de données en utilisant la partie réseau. (Avant nous utilisions l'accès direct à la base de données, alors qu'ici nous simulons une connexion depuis une machine cliente distante).</P>

<P>Pour lancer l'écouteur en utilisant la configuration ci-dessus:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ lsnrctl

LSNRCTL for SCO System V/386: Version 2.3.3.0.0 - Production on 23-FEB-98 20:38:25

Copyright (c) Oracle Corporation 1994.  All rights reserved.

Welcome to LSNRCTL, type "help" for information.

LSNRCTL> start
Starting /home/oracle/7.3.3.0.0/bin/tnslsnr: please wait...

TNSLSNR for SCO System V/386: Version 2.3.3.0.0 - Production
System parameter file is /home/oracle/7.3.3.0.0/network/admin/listener.ora
Log messages written to /home/oracle/7.3.3.0.0/network/log/listener.log
Listening on: (ADDRESS=(PROTOCOL=tcp)(DEV=6)(HOST=192.168.1.1)(PORT=1521))
Listening on: (ADDRESS=(PROTOCOL=ipc)(DEV=10)(KEY=700))

Connecting to (ADDRESS=(PROTOCOL=tcp)(HOST=magic.com)(PORT=1521)(COMMUNITY=UK_SUP_TCPIP))
STATUS of the LISTENER
------------------------
Alias                     LISTENER
Version                   TNSLSNR for SCO System V/386: Version 2.3.3.0.0 - Production
Start Date                23-FEB-98 20:38:50
Uptime                    0 days 0 hr. 0 min. 0 sec
Trace Level               off
Security                  OFF
SNMP                      ON
Listener Parameter File   /home/oracle/7.3.3.0.0/network/admin/listener.ora
Listener Log File         /home/oracle/7.3.3.0.0/network/log/listener.log
Services Summary...
  orcl          has 1 service handler(s)
The command completed successfully
LSNRCTL> exit
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Pour arrêter les écouteurs:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ lsnrctl

LSNRCTL for SCO System V/386: Version 2.3.3.0.0 - Production on 23-FEB-98 20:43:20

Copyright (c) Oracle Corporation 1994.  All rights reserved.

Welcome to LSNRCTL, type "help" for information.

LSNRCTL> stop
Connecting to (ADDRESS=(PROTOCOL=tcp)(HOST=magic.com)(PORT=1521)(COMMUNITY=UK_SUP_TCPIP))
The command completed successfully
LSNRCTL> exit
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Si vous avez une configuration DNS qui ne retourne pas l'adresse IP pour le nom logique specifié, le lancement et l'arrêt de l'écouteur prendront donc in certain temps. (2-3 mins. dépendant de la variable timeout du DNS). Si c'est le cas
, ne vous inquiétez pas. Soyez patient.</P>


<H2><A NAME="s5">5. Configuration du Client</A></H2>

<H2><A NAME="ss5.1">5.1 Clients Windows</A>
</H2>

<P>La configuration SQL*Net sur un PC avec les versions récentes du logiciel Client Oracle est très facile. La meilleure façon (et la plus facile) pour réussir l'installation d'un client qui marche entièrement, est d'utiliser l'outil <CODE>SQL*Net Easy Configuration</CODE> fourni par Oracle.</P>
<P>Cet outil a une interface qui vous guidera dans l'installation des fichiers <CODE>tnsnames.ora</CODE> et <CODE>sqlnet.ora</CODE>.</P>
<P>Sélectionnez "Add Database Alias" et entrez le nom pour l'alias demandé.  Cet alias est le nom par lequel vous allez vous référer à l'instance de la base de données, et doit donc être le même que celui de l'instance (orcl dans ce cas).</P>
<P>Sélectionnez TCP/IP comme protocole, le nom logique de la machine hébergeant la base de données et le nom de l'instance de la base de données.  </P>
<P>C'est tout.</P>
<P>Cependant, si vous n'avez pas l'outil <CODE>SQL*Net Easy Configuration Tool</CODE>, ne vous inquietez pas. Vous pouvez simplement créer les fichiers <CODE>tnsnames.ora</CODE> et <CODE>sqlnet.ora</CODE> dans le répertoire <CODE>$ORACLE_HOME/network/admin</CODE> sur le client, exactement comme sur le serveur. 
Il fournira comme alias le même que sur le serveur (toujours une bonne idée de toute façon).</P>
<H2><A NAME="ss5.2">5.2 Clients Unix</A>
</H2>

<P>Les clients UNIX ne sont pas très différents des clients Windows. Si vous avez <CODE>Network Manager</CODE> d'Oracle, alors utilisez-le
de la même façon que ci-dessus, sinon vous pouvez utiliser juste les mêmes fichiers de configuration
que sur le serveur dans le répertoire <CODE>$ORACLE_HOME/network/admin</CODE>.</P>
<H2><A NAME="s6">6. Lancement et Arrêt Automatique</A></H2>

<H2><A NAME="ss6.1">6.1 <CODE>dbstart</CODE> et <CODE>dbstop</CODE></A>
</H2>

<P>Le démarrage et l'arrêt automatique de la base de données Oracle peuvent être effectués (avec la version 7.3.3.0.0) avec les 
fichiers <CODE>dbstart</CODE> et <CODE>dbshut</CODE>, tous deux fournis par Oracle. Ces fichiers dépendent sur l'existence du 
fichier <CODE>/etc/oratab</CODE> pour fonctionner (bien qu'en modifiant les fichiers <CODE>dbshut</CODE> et <CODE>dbstart</CODE> il puissent être déplacés).</P>
<P>Le format du fichier <CODE>/etc/oratab</CODE> est le suivant:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
SID:ORACLE_HOME:AUTO
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Un  exemple:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
orcl:/home/oracle/7.3.3.0.0:Y
leaveup:/home/oracle/7.3.2.1.0:N
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H2><A NAME="ss6.2">6.2 <CODE>init.d</CODE> et <CODE>rc.d</CODE></A>
</H2>

<P>Pour démarrer et arrêter la base de données quand la machine se lance ou s'éteint, il faut modifier les routines
de démarrage pour la machine Linux. Ceci est très facile, bien que je devrais
souligner que cela peut changer suivant
la distribution Linux (Slackware, Debian, RedHat, etc).  Je vais montrer quelques exemples qui marchent avec RedHat Linux 5.0. Pour modifier ceux-ci pour votre propre distribution Linux, veuillez voir votre documentation Linux. (bien que
ceci doit être valable pour n'importe quel UNIX de type Sys V)</P>

<P>Premièrement, nous devons créer le script qui exécutera  <CODE>dbshut</CODE> et <CODE>dbstart</CODE> dans le répertoire  <CODE>/etc/rc.d/init.d</CODE> . Créez le fichier suivant comme <CODE>/etc/rc.d/init.d/oracle</CODE>:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
#!/bin/sh
#
# /etc/rc.d/init.d/oracle
# Description: Starts and stops the Oracle database and listeners
# See how we were called.
case "$1" in
  start)
        echo -n "Starting Oracle Databases: "
        echo "----------------------------------------------------" >> /var/log/oracle
        date +"! %T %a %D : Starting Oracle Databases as part of system up." >> /var/log/oracle
        echo "----------------------------------------------------" >> /var/log/oracle
        su - oracle -c dbstart >> /var/log/oracle
        echo "Done."
        echo -n "Starting Oracle Listeners: "
        su - oracle -c "lsnrctl start" >> /var/log/oracle
        echo "Done."
        echo ""
        echo "----------------------------------------------------" >> /var/log/oracle
        date +"! %T %a %D : Finished." >> /var/log/oracle
        echo "----------------------------------------------------" >> /var/log/oracle
        touch /var/lock/subsys/oracle
        ;;
  stop)
        echo -n "Shutting Down Oracle Listeners: "
        echo "----------------------------------------------------" >> /var/log/oracle
        date +"! %T %a %D : Shutting Down Oracle Databases as part of system down." >> /var/log/oracle
        echo "----------------------------------------------------" >> /var/log/oracle
        su - oracle -c "lsnrctl stop" >> /var/log/oracle
        echo "Done."
        rm -f /var/lock/subsys/oracle
        echo -n "Shutting Down Oracle Databases: "
        su - oracle -c dbshut >> /var/log/oracle
        echo "Done."
        echo ""
        echo "----------------------------------------------------" >> /var/log/oracle
        date +"! %T %a %D : Finished." >> /var/log/oracle
        echo "----------------------------------------------------" >> /var/log/oracle
        ;;
  restart)
        echo -n "Restarting Oracle Databases: "
        echo "----------------------------------------------------" >> /var/log/oracle
        date +"! %T %a %D : Restarting Oracle Databases as part of system up." >> /var/log/oracle
        echo "----------------------------------------------------" >> /var/log/oracle
        su - oracle -c dbstop >> /var/log/oracle
        su - oracle -c dbstart >> /var/log/oracle
        echo "Done."
        echo -n "Restarting Oracle Listeners: "
        su - oracle -c "lsnrctl stop" >> /var/log/oracle
        su - oracle -c "lsnrctl start" >> /var/log/oracle
        echo "Done."
        echo ""
        echo "----------------------------------------------------" >> /var/log/oracle
        date +"! %T %a %D : Finished." >> /var/log/oracle
        echo "----------------------------------------------------" >> /var/log/oracle
        touch /var/lock/subsys/oracle
        ;;
  *)
        echo "Usage: oracle {start|stop|restart}"
        exit 1
esac
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Il vaut la peine de vérifier si le fichier arrête et démarre 
vraiment correctement les bases de données pour le système.
Vérifiez le fichier de log, <CODE>/var/log/oracle</CODE>, pour les messages d'erreur.</P>
<P>Une fois que le script marche, nous devons créer les liens symboliques de <CODE>start</CODE> et <CODE>kill</CODE> dans les répertoires appropriés de niveau d'exécution (runlevel)
<CODE>/etc/rc.d/rcX.d</CODE>.</P>
<P>Les commandes suivantes assureront que les bases de données vont démarrer dans les niveaux d'exécution 2,3 et 4:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ ln -s ../init.d/oracle /etc/rc.d/rc2.d/S99oracle
$ ln -s ../init.d/oracle /etc/rc.d/rc3.d/S99oracle
$ ln -s ../init.d/oracle /etc/rc.d/rc4.d/S99oracle
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Pour arrêter les bases de données avant un réamorçage ou arrêt, nous avons besoin des liens suivants: 
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ ln -s ../init.d/oracle /etc/rc.d/rc0.d/K01oracle          # Halting
$ ln -s ../init.d/oracle /etc/rc.d/rc6.d/K01oracle          # Rebooting
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H2><A NAME="s7">7. Autres trucs</A></H2>

<H2><A NAME="ss7.1">7.1 Agent Intelligent</A>
</H2>

<P>Si vous avez besoin d'un <CODE>Agent Intelligent Oracle</CODE>, vous pouvez l'exécuter sans changement
de la configuration. </P>
<P>Pour démarrer le AI, essayez:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ lsnrctl dbsnmp_start
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Pour arrêter l'AI, essayez:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ lsnrctl dbsnmp_stop
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Il ne semble pas y avoir de message indiquant le lancement avec succès ou non de l'agent intelligent. 
Cependant, l'AI répond au gestionnaire <EM>Enterprise</EM> sur le
côté client. Donc, je ne peux que supposer qu'il marche.</P>

<H2><A NAME="s8">8. Dépannage</A></H2>

<P>Voir ci-dessous les différents conseils de dépannage.</P>
<H2><A NAME="ss8.1">8.1 Je ne peux pas créer une base de données en utilisant Oracle 7.2.x.</A>
</H2>

<P>Les fichiers expédiés par Oracle dans les versions 7.2.x sont incorrects en supposant que vous voulez installer une configuration parallèle de serveur. Le fichier <CODE>init.ora</CODE> contient la ligne suivante:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
# define parallel server (multi-instance) parameters
ifile = ora_system:initps.ora
</PRE>
<HR>
</CODE></BLOCKQUOTE>

Pour fixer le problème, mettez la en commentaire:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
# define parallel server (multi-instance) parameters
#ifile = ora_system:initps.ora
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<H2><A NAME="ss8.2">8.2 J'obtiens les défauts de segmentation dans le  <CODE>svrmgrl</CODE> de la version 7.3.4.x.</A>
</H2>

<P>Ce problème m'a été signalé par un certain nombre de personnes.  Gerald Weber <CODE>gerald_weber@master.co.at</CODE> l'a résolu: 
<BLOCKQUOTE><CODE>
<HR>
<PRE>
Bonjour Paul,

D'abord merci pour votre aide, mais aucun des problèmes possubles que vous pensez n'était responsable de mon problème. 
Le problème esy l'émulateur iBCS lui-même.
Il semble que Oracle exécute les appels sysconf qui ne sont pas supportés dans la version en cours d'iBCS. 
Regardez la trace:

&lt;7>[22]615 sysconf(34)
&lt;7>iBCS2 unsupported sysconf call 34
&lt;7>[22]615 sysconf error return linux=-22 -> ibcs=22 &lt;Invalid argument>
&lt;7>[24]615 sysconf(34)
&lt;7>iBCS2 unsupported sysconf call 34
&lt;7>[24]615 sysconf error return linux=-22 -> ibcs=22 &lt;Invalid argument>

Solution:  patcher iBCS-source.apply avec le diff-patch suivant:


--- sysconf.c   Sun Apr 19 19:19:15 1998
+++ sysconf.c.ori       Sun Apr 19 19:28:45 1998
@@ -60,7 +60,6 @@
 #define _SC_JOB_CONTROL        5
 #define _SC_SAVED_IDS  6
 #define _SC_VERSION    7
-#define _SC_HACK_FOR_ORACLE 34

 #define _SC_PAGESIZE   11

@@ -97,11 +96,6 @@
                case _SC_SAVED_IDS: {
                        return (1);
                }
-
-               case _SC_HACK_FOR_ORACLE: {
-                 return (1);
-               }
-

                case _SC_PAGESIZE: {
                  return PAGE_SIZE;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="s9">9. Crédits</A></H2>

<P>Ce document est basé sur un document écrit par 
<A HREF="mailto:bwit@pobox.com">Bob Withers</A>. Des informations supplémentaires sont
extraites des documents écrits par 
<A HREF="mailto:rehfeld@wmd.de">Georg Rehfeld</A> et 
<A HREF="mailto:david@claremont.com">David Mansfield</A>.</P>
<P>Relectures supplémentaires faites par Bob Withers, 
<A HREF="mailto:mwatling@mjw-ltd.demon.co.uk">Mark Watling</A>, 
<A HREF="mailto:petersodhi@unn.unisys.com">Peter Sodhi</A> et 
<A HREF="mailto:greg.hankins@cc.gatech.edu">Greg Hankins</A>.</P>
<P>Mes remerciements vont au support immense de la part des gens 
impliqués dans ce document et aux recherches qu'ils ont effectuées. Remerciements particuliers à Bob Withers et Mark Watling pour leurs commentaires additionnels et l'aide qu'ils m'ont apportée.</P>
</BODY>
</HTML>
