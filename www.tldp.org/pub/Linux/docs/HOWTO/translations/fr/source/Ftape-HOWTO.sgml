<!doctype linuxdoc system>
<!-- Hey! Yo! Emacs! we're -*- SGML -*-  -->

<article>

<title>ftape-HOWTO
<author>Kai Harrekilde-Petersen, <tt>khp@login.dkuug.dk</tt>
<date>Derni&egrave;re mise &agrave; jour 17 juillet 1994 pour ftape-1.13b

<abstract>
Ce HOWTO pr&eacute;sente l'essentiel de ce qu'il faut faire et ne pas faire
pour utiliser avec succ&egrave;s le pilote (<sq>driver</sq>) <tt>ftape</tt> sous
Linux. Le pilote <tt>ftape</tt> g&egrave;re uniquement les lecteurs
compatibles aux normes QIC-80 et QIC-40. Ces lecteurs de bandes se
connectent au contr&ocirc;leur du lecteur de disquettes (par exemple &agrave; la
place d'un second lecteur). En revanche, il ne g&egrave;re
<bf>pas</bf> les lecteurs de bandes SCSI ou QIC-02, ni les lecteurs de
type DAT qui se connectent en g&eacute;n&eacute;ral (toujours?) &agrave; un contr&ocirc;leur
SCSI.
Ceci n'est qu'un des diff&eacute;rents HOWTOs disponibles pour
Linux. Vous pouvez obtenir la s&eacute;rie compl&egrave;te &agrave; partir de <url
url="http://sunsite.unc.edu/mdw/linux.hmtl" name="The Linux
Documentation home page">.
Ce HOWTO a &eacute;t&eacute; traduit de l'anglais par Lo&iuml;c
PRYLLI, <tt>lprylli@lip.ens-lyon.fr</tt>, derni&egrave;re mise &agrave; jour 2 septembre 1994.
</abstract>

<toc>

<sect>Droits de diffusion

<p>
Ceci constitue le `Frequently Asked Questions' (FAQ) / HOWTO guide
pour l'interface <tt>ftape</tt> (ftape-HOWTO), Copyright (C) 1993,1994 Kai
Harrekilde-Petersen.

<bf>Copyright&nbsp;:</bf>

Ce document peut &ecirc;tre librement diffus&eacute; <bf>en entier</bf>, sous
n'importe quelle forme et gratuitement. Une diffusion partielle est
autoris&eacute;e, &agrave; condition de conserver le message de copyright, et
d'inclure une note pr&eacute;cisant que ce n'est pas la version int&eacute;grale et
indiquant o&ugrave; obtenir le guide complet. Sous les m&ecirc;mes conditions, ce
document peut &ecirc;tre inclus dans une distribution commerciale, sans
accord pr&eacute;alable. L'auteur aimerait cependant &ecirc;tre inform&eacute; d'un tel
usage.

Ce HOWTO peut &ecirc;tre traduit dans n'importe quel langage, &agrave; condition
que la notice de copyright et les r&eacute;serves d'utilisation soient
pr&eacute;serv&eacute;es intactes, et qu'une note stipulant le traducteur soit
ajout&eacute;e.

<bf>R&eacute;serves pour l'utilisation&nbsp;:</bf>

Bien que des efforts aient &eacute;t&eacute; faits pour fournir une information
aussi correcte et &agrave; jour que possible, il est possible que
l'usage des informations de ce document puisse conduire &agrave; une perte
de donn&eacute;es. AUCUNE GARANTIE n'est fournie en ce qui concerne
l'information fournie par ce guide, et l'auteur ne peut pas &ecirc;tre tenu
pour responsable de quelque cons&eacute;quence que ce soit pour tout dommage
r&eacute;sultant de l'utilisation de ce guide.


<sect>Pr&eacute;liminaires

<p>

<sect1>La version la plus r&eacute;cente de ftape - et o&ugrave; l'obtenir

<p>

A l'&eacute;criture de ce guide, ftape-1.13b est la version plus r&eacute;cente du
pilote ftape, et peut &ecirc;tre rapatri&eacute;e &agrave; partir des sites suivants&nbsp;:

<tscreen><verb>
    tsx-11.mit.edu   [18.172.1.2]: /pub/linux/ALPHA/QIC-80/
    sunsite.unc.edu [152.2.22.81]: /pub/Linux/kernel/tapes/
    ftp.funet.fi  [128.214.248.6]: /pub/OS/Linux/BETA/QIC-80/
</verb>
</tscreen>

Vous devez obtenir les fichiers suivants&nbsp;: <tt>ftape-1.13b.tar.gz</tt>,
<tt>ftape-1.13b.lsm</tt> et <tt>modules.tar.gz</tt>.  Le fichier
<tt>ftape-1.13b</tt> est le pilote proprement dit, le fichier
<tt>.lsm</tt> est un fichier <sq>Linux Software Map (LSM)</sq> utilis&eacute; dans
le cadre du projet LSM, et le fichier <tt>modules</tt> contient un
ensemble d'utilitaires permettant de charger des pilotes
dynamiquement.
 Note&nbsp;: si vous poss&eacute;dez une version ancienne des modules, par exemple
les utilitaires <tt>modutils-0.99.14.tar.gz</tt> ou
<tt>modutils-0.99.15.tar.gz</tt>, vous allez probablement avoir besoin de
vous mettre &agrave; jour.

<p>

<sect1>D&eacute;veloppement du pilote ftape

<p>
Si vous voulez suivre le d&eacute;veloppement du pilote ftape, envisagez de
souscrire &agrave; la rubrique TAPE sur la liste de distribution
(mailing-list) Linux-activists. Pour ce faire, envoyez un courrier
&eacute;lectronique (e-mail) &agrave;
<tt>&lt;linux-activists-request@niksula.hut.fi&gt;</tt>, en mettant sur
la premi&egrave;re ligne (ou dans l'en-t&ecirc;te) `<tt>X-Mn-Admin: join
tape</tt>'. Si vous envoyez un message vide (ou si le syst&egrave;me
automatique de r&eacute;ponse ne peut interpr&eacute;ter votre message), vous
recevrez un guide sur comment &eacute;crire une requ&ecirc;te.

Pour diffuser un courrier technique sur cette liste, &eacute;crivez &agrave;
<tt>&lt;linux-activists@niksula.hut.fi&gt;</tt>, et n'oubliez pas que la
premi&egrave;re ligne (ou une ligne d'en-t&ecirc;te) doit contenir `<tt>X-Mn-Key:
TAPE</tt>'.

<sect1>Lecteurs support&eacute;s

<p>
Tous les lecteurs qui sont &agrave; la fois compatibles QIC-117 et soit
QIC-40, soit QIC-80 doivent fonctionner avec le pilote ftape.  Pour
l'instant, les lecteurs suivants ont &eacute;t&eacute; utilis&eacute;s avec succ&egrave;s&nbsp;:

<itemize>
<item> Colorado DJ-10 / DJ-20 (Jumbo 120 / Jumbo 250)
<item> Archive 5580i / XL9250i
<item> Insight 80Mb
<item> Conner C250MQ
<item> Wangtek 3080F
<item> Iomega 250 (seulement un fichier par bande, malheureusement)
<item> Escom / Archive (Hornet) 31250Q
<item> Summit SE 150 / SE 250
<item> Mountain FS8000
<item> Colorado FC-10 High-Speed Controller
</itemize>

La gestion du contr&ocirc;leur FC-10 a &eacute;t&eacute; int&eacute;gr&eacute; dans le pilote
ftape &agrave; partir de la version 1.12. Vous pouvez vous r&eacute;f&eacute;rer aux
fichiers (en anglais) <tt>RELEASE-NOTES</tt> et <tt>Makefile</tt> dans
la distribution ftape pour avoir plus de pr&eacute;cisions.

Quelques lecteurs de bande (Iomega) mettent &agrave; tort l'indicateur
`nouvelle-cartouche-charg&eacute;e' (new-cartridge-loaded) &agrave; l'&eacute;tat actif
chaque fois que le fichier de p&eacute;riph&eacute;rique est ouvert. Ces
lecteurs ne fonctionneront pas correctement avec les marques de
fichiers du fait qu'apr&egrave;s chaque fichier on se retrouve au d&eacute;but de la
bande.

NOTE&nbsp;: Si jamais vous poss&eacute;dez un lecteur qui fonctionne correctement,
et qui n'est pas list&eacute; ci-dessus, envoyez s'il vous pla&icirc;t un courrier
au responsable de ce guide (<tt>khp@login.dkuug.dk</tt>).


<sect1>Lecteurs NON-g&eacute;r&eacute;s

<p>
<itemize>
<item> Tous les lecteurs qui se connectent via le port parall&egrave;le (par exemple&nbsp;:
Colorado Trakker) 
<item> Contr&ocirc;leur &agrave; haute-vitesse. (par exemple&nbsp;: Colorado TC-15
&amp FC-20) 
<item> Irwin AX250L / Accutrak 250. (pas un lecteur QIC-80)
<item> IBM Internal Tape Backup Unit (identique au lecteur Irwin AX250L) 
<item> COREtape light
</itemize>


De mani&egrave;re g&eacute;n&eacute;rale, AUCUN lecteur se connectant au port parall&egrave;le
n'est g&eacute;r&eacute;, en effet ces lecteurs utilisent plusieurs interfaces
propri&eacute;taires diff&eacute;rentes, qui sont tr&egrave;s &eacute;loign&eacute;s du standard QIC-117.

Le contr&ocirc;leur Colorado TC-15 (et ses sosies) ne sont pas
g&eacute;r&eacute;s par l'interface ftape. Le Colorado FC-10 est le seul
contr&ocirc;leur qui peut &ecirc;tre utilis&eacute;. Le support pour celui-ci a &eacute;t&eacute;
int&eacute;gr&eacute; dans ftape version 1.12.

Le Irwin AX250L (et l'unit&eacute; de sauvegarde interne IBM) ne fonctionne
pas avec ftape. En effet, ils utilisent bien le standard QIC-117 mais
pas le standard QIC-80 (ils utilisent &agrave; la place le format
propri&eacute;taire servoe (Rhomat) de Irwin). L'auteur n'a aucune
information sur le format Rhomat, ni o&ugrave; l'on peut la trouver. D&eacute;sol&eacute;.

Le COREtape light ne fonctionne pas (encore). Quelques
caract&eacute;ristiques sont connues sur ce lecteur, mais on n'a pas encore
r&eacute;ussi &agrave; lui faire accepter les donn&eacute;es d'initialisation. Il n'est pas
s&ucirc;r qu'on arrive un jour &agrave; le faire marcher avec ftape.

<sect1>Compilation et installation de l'interface <tt>ftape</tt>

<p>
Un guide d'installation est fourni dans la distribution ftape (le fichier
<tt>Install-guide</tt> en anglais), lisez-le s'il vous pla&icirc;t.

<sect1>O&ugrave; obtenir les sources du noyau (kernel) ?

<p>

Vous pouvez obtenir les sources du noyau &agrave; l'endroit o&ugrave; vous avez
eu les sources de ftape. Ces sources sont disponibles dans les sites
suivants (et n'importe quelle site miroir).

<tscreen><verb>
    tsx-11.mit.edu [18.172.1.2]: /pub/linux/sources/system/
    sunsite.unc.edu [152.2.22.81]: /pub/Linux/kernel/
    ftp.funet.fi [128.214.248.6]: /pub/OS/Linux/PEOPLE/Linus
</verb></tscreen>

Vous trouverez un certain nombre de sous-r&eacute;pertoires, dont deux nomm&eacute;s
respectivement <tt>v1.0</tt> et <tt>v1.1</tt>. Ils contiennent (bien
&eacute;videmment) les versions <tt>v1.0</tt> et <tt>v1.1</tt> du noyau. Il
est sugg&eacute;r&eacute; de choisir la version <tt>1.1.</tt>&lt <tt>... &gt;</tt>.

<sect1>Peut-on formater des bandes sous Linux ?

<p>

Pour le moment, non&nbsp;! Cela est &agrave; l'&eacute;tude, mais mieux vaut ne pas
attendre que ce soit termin&eacute;. En attendant, vous allez devoir utiliser
MessyDos (arghhh&nbsp;!)  ou acheter des bandes pr&eacute;format&eacute;es. Cependant, la
pr&eacute;sence de secteurs d&eacute;fectueux n'est <em>PAS</em> v&eacute;rifi&eacute;e
sur certaines bandes pr&eacute;format&eacute;es. Par s&eacute;curit&eacute;, si le pilote ftape
rencontre une bande sans blocs d&eacute;fectueux, un message d'avertissement
sera &eacute;mis.

<sect1>Quels programmes de formatage peut-on utiliser sous DOS?

<p>
Les suivants ont &eacute;t&eacute; utilis&eacute;s avec succ&egrave;s&nbsp;:

<itemize>
<item> logiciels de Colorado Memory System (<tt>tape.exe</tt>)
<item> Connor Backup Basics v1.1 et toutes les versions Windows.
<item> Norton Backup
<item> QICstream version 2
</itemize>

Les programmes suivants  sont connus pour &ecirc;tre plus ou moins bogu&eacute;s.

<itemize>
<item> CONNER Backup Basics  1.0
<item> CP Backup (fonctionne OK mis &agrave; part un gaspillage de place)
</itemize>

En fait, la plupart des logiciels sous DOS devraient marcher. Le
Conner Backup Basics v1.0 a un param&egrave;tre erron&eacute; (quelqu'un a d&ucirc; mal
lire les sp&eacute;cifications QIC-80&nbsp;!), ce qui est corrig&eacute; dans la version
1.1. Dennis T. Flaherty (<tt>dennisf@denix.elk.miles.com</tt>) a
rapport&eacute; que les propri&eacute;taires d'un Conner C250MQ peuvent obtenir la
nouvelle version 1.1 en appelant au 1-800-230-5638 (aux Etats-unis)
pour demander une mise &agrave; jour (en &eacute;change du prix correspondant &agrave; la
disquette). Signalons que les versions pour Windows fonctionnent tr&egrave;s
bien.


On peut utiliser Central Point Backup, mais il gaspille de la place
quand il rencontre un point d&eacute;fectueux sur la bande.

NOTE&nbsp;: Si vous utilisez un logiciel de formatage sous DOS, qui n'est
pas mentionn&eacute; ci-dessus, pri&egrave;re d'&eacute;crire au responsable du guide
(<tt>khp@login.dkuug.dk</tt>) de mani&egrave;re &agrave; rajouter l'information
pertinente.

<sect>Sauvegarde et Restauration

<p>

<sect1><label id="write-backup"> Stocker une archive sur une bande

<p>
Les programmes classiques que vous pouvez utiliser sont
`<tt>tar</tt>', `<tt>dd</tt>' et `<tt>cpio</tt>'.  Vous devrez
aussi utiliser `<tt>mt</tt>' pour exploiter compl&egrave;tement le potentiel
de vos bandes et de l'interface ftape. Pour commencer, il est
recommand&eacute; de choisir `<tt>tar</tt>', qui permet d'archiver un
ensemble de r&eacute;pertoires et de r&eacute;cup&eacute;rer de mani&egrave;re isol&eacute;e des fichiers
d'une sauvegarde pr&eacute;c&eacute;dente. Il para&icirc;trait que <tt>cpio</tt> cr&eacute;e
des archives plus compactes, et soit plus souple que <tt>tar</tt>,
mais l'auteur n'a pas essay&eacute;. Pour effectuer par exemple, une
sauvegarde des sources de votre noyau en utilisant <tt>tar</tt>, vous
devez faire (en supposant que les sources soient dans
<tt>/usr/src/linux</tt>)&nbsp;:

<tscreen><verb>
	cd /usr/src
	tar cf /dev/ftape linux
</verb></tscreen>

Dans ce cas, les fichiers ne seront pas compress&eacute;s, mais l'&eacute;criture
sur la bande en sera plus continue. Si vous voulez cette fois utiliser
la compression (et que vous poss&eacute;dez tar 1.11.2), il suffit d'inclure
le drapeau(*) <tt>-z</tt>, par exemple&nbsp;: `<tt>tar czf /dev/ftape linux</tt>'

Pour plus d'informations sur l'utilisation de <tt>tar</tt>, <tt>dd</tt> et
<tt>mt</tt>, regardez dans les pages de r&eacute;f&eacute;rences (man pages) et dans
les fichiers texinfo qui sont fournis avec les distributions
correspondantes.

(*) <tt>tar</tt> suppose que le premier argument se constitue
d'options, donc le `<tt>-</tt>' n'est pas vraiment n&eacute;cessaire,
autrement dit les deux commandes suivantes sont identiques&nbsp;: `<tt>tar xzf
/dev/ftape</tt>' et `<tt>tar -xzf /dev/ftape</tt>'
 
<sect1>Restaurer une archive

<p>
Maintenant, restaurons la sauvegarde des sources du noyau que nous
venons de faire dans la section <ref id="write-backup"> ci-dessus.
Pour cela tapez simplement&nbsp;:

<tscreen><verb>
	tar xf /dev/ftape
</verb></tscreen>

Si lors de la sauvegarde vous avez utilis&eacute; la compression, tapez
plut&ocirc;t&nbsp;:

<tscreen><verb>
	tar xzf /dev/ftape
</verb></tscreen>

Lorsque vous utilisez la compression, gzip va se plaindre de
donn&eacute;es superflues &agrave; la fin de l'archive (et cela va produire un
message `broken pipe'). Ceci peut &ecirc;tre ignor&eacute; sans probl&egrave;me.

Pour les autres programmes utilitaires, lisez le manuel correspondant
s'il vous pla&icirc;t.

<sect1>Tester une archive

<p>
tar a une option (<tt>-d</tt>) qui permet de d&eacute;tecter les diff&eacute;rences
entre deux archives. Pour tester votre sauvegarde des sources du noyau,
tapez

<tscreen><verb>
	tar df /dev/ftape
</verb></tscreen>

Si vous n'avez pas la page de manuel de <tt>tar</tt>, vous n'&ecirc;tes pas
(forc&eacute;ment) perdu. tar poss&egrave;de une aide en ligne&nbsp;: essayez
`<tt>tar --help 2>&amp;1 | more</tt>'

<sect1>Comment stocker plus d'un fichier <tt>tar</tt> sur une bande

<p>
Pour stocker plus d'un fichier tar sur une bande, vous devez utiliser
l'utilitaire <tt>mt</tt>. Vous l'avez s&ucirc;rement d&eacute;j&agrave;, si vous poss&eacute;dez
l'une des distributions de Linux, par exemple Slackware ou Debian.

<tt>tar</tt> g&eacute;n&egrave;re une seule archive sur la bande et ne sait pas
comment naviguer entre plusieurs archives sur une m&ecirc;me bande, il se
contente de faire des lectures ou des &eacute;critures sur le fichier de
p&eacute;riph&eacute;rique. <tt>mt</tt> est d&eacute;di&eacute; aux manipulations de bande,
embobiner ou rembobiner pour se positionner sur une archive
sp&eacute;cifique, mais ne sait pas lire ou &eacute;crire des donn&eacute;es sur la
bande. Comme vous l'avez sans doute devin&eacute;, c'est l'association de
<tt>tar</tt> et <tt>mt</tt> qui permet d'obtenir la fonctionnalit&eacute;
d&eacute;sir&eacute;e.

En utilisant le fichier sp&eacute;cial <tt>nrft[0-3]</tt> (<tt>nftape</tt>),
vous pouvez vous servir de `<tt>mt</tt>' pour positionner la bande &agrave; la place
d&eacute;sir&eacute;e (par exemple `<tt>mt -f /dev/nftape fsf 2</tt>' pour embobiner
jusqu'&agrave; passer deux ``marques de fichiers'', autrement dit sauter deux fichiers
tar), et ensuite de <tt/tar/ pour lire ou &eacute;crire les donn&eacute;es appropri&eacute;es.


<sect1>Ajouter des fichiers &agrave; une archive

<p>
<sq>Est-il possible d'&eacute;tendre une archive (un fichier tar), c'est &agrave; dire
sauvegarder une archive, puis plus tard, de lui rajouter des fichiers</sq>

La r&eacute;ponse est NON. La documentation de <tt>tar</tt> vous dira
d'utiliser `<tt>tar -Ar</tt>', mais &ccedil;a ne fonctionnera pas &agrave; cause de
limitations du pilote ftape actuel.

<sect1>Monter/d&eacute;monter (Mount/unmounting) des bandes.

<p>
Dans la mesure o&ugrave; une bande ne contient pas un ``syst&egrave;me de
fichiers'', il n'y a aucune raison pour &agrave; vouloir monter/d&eacute;monter une bande
pour restaurer le contenu de la bande, vous l'ins&eacute;rez dans le lecteur
et ex&eacute;cutez la commande `<tt>tar</tt>' (ou la commande que vous
utilisez d'habitude pour acc&eacute;der au lecteur).

<sq>Y a t-il une commande explicite de (d&eacute;)montage de la bande ?</sq>

Aucune.  Le p&eacute;riph&eacute;rique (device) /dev/ftape est de type
`caract&egrave;re', et ne peut donc &ecirc;tre appliqu&eacute; &agrave; la commande
<tt>[u]mount</tt>. Seuls les p&eacute;riph&eacute;riques de type `bloc' le peuvent.

<sect>Questions fr&eacute;quemment pos&eacute;es

<p>

<sect1>Peut-on &eacute;changer des bandes avec un utilisateur de DOS?

<p>
Ce n'est pas possible pour l'instant. Ce probl&egrave;me <em>est</em>
cependant &agrave; l'&eacute;tude. Les logiciels DOS se conforment aux
sp&eacute;cifications QIC-80 en ce qui concerne la disposition du syst&egrave;mes de
fichiers DOS, et ce doit &ecirc;tre a priori facile d'&eacute;crire un programme
capable de lire le format DOS. En fait, cr&eacute;er une interface
utilisateur agr&eacute;able est s&ucirc;rement un probl&egrave;me plus compliqu&eacute;.


<sect1>Comment faire `....' avec <tt>tar</tt>?

<p>
Ces questions concernent le programme <tt>tar</tt>&nbsp;: lisez s'il vous
pla&icirc;t la page de manuel (<tt>man</tt> page) et la page <tt>info</tt>
correspondante. Si vous ne les poss&eacute;dez pas, essayez `<tt>tar --help -->
--2>&amp;1 | more</tt>'.

Si votre version de <tt>tar</tt> est v1.11.1 ou ant&eacute;rieure, consid&eacute;rez
la mise &agrave; jour &agrave; v1.11.2. Cette version peut appeler <tt>GNU zip</tt>
directement (autrement dit&nbsp;: elle supporte l'option de compression <tt>-z</tt>)
et a de plus une aide int&eacute;gr&eacute;e &eacute;labor&eacute;e. D'autre part, elle compile
sans probl&egrave;me pour Linux.

<sect1>Les transferts de DMA <tt>ftape</tt> donnent lieu &agrave; des erreurs ECC.

<p>
Malheureusement il y a quelques cartes graphiques SVGA qui ne d&eacute;codent
pas correctement leurs adresses. Ceci se produit typiquement quand les
zones tampons de ftape sont dans la r&eacute;gion <tt>0x1a0000</tt> &agrave;
<tt>0x1c0000</tt>. Il arrive alors que les cycles d'&eacute;criture DMA soient
fauss&eacute;s et qu'un octet &eacute;crit sur deux ait une valeur fausse
(<tt>0xff</tt>). Ces probl&egrave;mes ont &eacute;t&eacute; rapport&eacute;s avec &agrave; la fois des
cartes SVGA et des cartes ethernet. Nous connaissons au moins une
carte (d&eacute;ficiente?) ATI 16bit VGA qui cause ce probl&egrave;me.

La solution la plus simple est de mettre la carte dans un emplacement
8bit (ce n'est souvent pas suffisant pour reconfigurer la carte en 8bit).
D&eacute;placer la zone tampon ftape n'est qu'une solution partielle, a
priori toutes les zones tampons DMA utilis&eacute;es dans Linux peuvent avoir
ce probl&egrave;me&nbsp;! Mettons nous bien d'accord&nbsp;: ce comportement n'a rien &agrave;
voir avec le pilote ftape.

<sect1><tt>insmod</tt> indique que la version du noyau est erron&eacute;e

<p>
Le programme <tt>insmod</tt> v&eacute;rifie que la version du noyau courant
est la m&ecirc;me que celle m&eacute;moris&eacute;e dans le pilote ftape lors de la
compilation. C'est une cha&icirc;ne de caract&egrave;res dans
<tt>kernel-version.h</tt>, (par exemple&nbsp;: <tt>char kernel_version[] =
"1.0.4";</tt>) qui est extraite du noyau au moment o&ugrave; vous ex&eacute;cutez
`<tt>make dep</tt>'.  Si vous avez cette erreur lorsque vous essayer
d'ins&eacute;rer le pilote ftape, supprimer le fichier
`<tt>kernel-version.h</tt>' (dans la distribution ftape), tapez
`<tt>make dep ; make</tt>' &agrave; nouveau pour recompiler et vous devez
alors avoir une version &agrave; jour de
<tt>kernel-version.h</tt>. Souvenez-vous que cette op&eacute;ration doit &ecirc;tre
renouvel&eacute;e chaque fois que vous passez &agrave; une version diff&eacute;rente du
noyau.

<sect1>Le noyau 1.1.0 ne compile plus avec l'option de support pour ftape.

<p>

(Bien que ce probl&egrave;me ne soit pas &eacute;t&eacute; report&eacute; fr&eacute;quemment, je le cite
quand m&ecirc;me au cas o&ugrave;&nbsp;!)

Cela vient d'une erreur typographique (et d'un hacker (programmeur)
qui n'utilisait pas ftape lui-m&ecirc;me de sorte qu'il ne lui est jamais
arriv&eacute; de tester le code qu'il &eacute;crivait). Cela a &eacute;t&eacute; corrig&eacute; dans
<tt>patch1.gz</tt> qui peut &ecirc;tre trouv&eacute; sur les sites ftp usuels.)

<sect1>O&ugrave; sont les ex&eacute;cutables/sources/man-pages pour
<tt>tar</tt>/<tt>mt</tt>/<tt>cpio</tt>/<tt>dd</tt> ?

<p>
Tous ces outils sont d&eacute;velopp&eacute;s dans le cadre du projet GNU, et les
sources (ainsi que les pages de manuel) peuvent &ecirc;tre r&eacute;cup&eacute;r&eacute;es &agrave;
partir de pratiquement n'importe quel site ftp dans le monde entier (y
compris ftp.funet.fi, tsx-11.mit.edu, et sunsite.unc.edu).  Dans tous
les cas on peut les r&eacute;cup&eacute;rer &agrave; partir du site officiel GNU&nbsp;:
<tt>prep.ai.mit.edu [18.71.0.38]:/pub/gnu</tt>.  Les versions les plus
r&eacute;centes (au 26 mars 94) sont&nbsp;:

<tscreen><verb>
	cpio:	2.3 (cpio-2.3.tar.gz
	dd:	3.9 (fileutils-3.9.tar.gz)
	mt:	2.3 (cpio-2.3.tar.gz)
	tar:	1.11.2 (tar-1.11.2.tar.gz)
	gzip:	1.2.4 (gzip-1.2.4.tar.gz)
</verb></tscreen>

Ils compilent tous sans modifications sur Linux <tt>v1.0.4</tt> / <tt>libc
v4.5.19</tt> / <tt>gcc v2.5.8</tt> (Le programme <tt>rmt</tt>
n&eacute;cessite quelques adaptations, mais n'est pas indispensable puisqu'il
est seulement utilis&eacute; pour acc&eacute;der &agrave; distance &agrave; un lecteur de bande).

<sect>D&eacute;boguer le pilote ftape

<p>

<sect1>Le noyau/ftape se plante lorsque je fais  `...' - est-ce un
bogue&nbsp;?

<p>
Non, c'est une caract&eacute;ristique voulue  ;-) 

Plus s&eacute;rieusement, un logiciel fiable ne doit pas se planter. C'est
particuli&egrave;rement vrai pour le noyau qui ne peut pas ou plut&ocirc;t ne
<bf>devrait</bf> pas planter. Si le noyau se plante lorsque vous
utilisez ftape, et que vous pouvez montrer que c'est le pilote ftape
qui en est responsable, alors consid&eacute;rez cela comme une erreur
importante qui Doit Etre Corrig&eacute;e. Ecrivez les d&eacute;tails de votre situation
aux responsables du d&eacute;veloppement (voir section <ref id="email-addrs">
ci-dessous).

<sect1>ftape n'arr&ecirc;te pas de dire `... new tape' (nouvelle bande),
que doit-on faire&nbsp;?

<p>

&lsqb;Note&nbsp;: cette m&eacute;thode ne marche plus; l'auteur ne sait pas pour l'instant
rem&eacute;dier &agrave; cette situation&rsqb;

Pour arr&ecirc;ter cela, fa&icirc;tes (de m&eacute;moire)&nbsp;: loggez vous en tant que root
et faites `<tt>rmmod ftape</tt>'. ftape doit faire quelques `rat&eacute;s',
donner a peu pr&egrave;s trois `segmentations fault', et expirer
d&eacute;finitivement.

Observez le t&eacute;moin (LED) de votre lecteur de disquettes (vous en avez
bien un, n'est ce pas?). Si il reste allum&eacute; de mani&egrave;re permanente,
vous avez mis dans le mauvais sens le c&acirc;ble du lecteur de
disquettes. V&eacute;rifiez le c&acirc;ble entre le contr&ocirc;leur, le lecteur de bande
<em>et</em> le lecteur de disquettes. En g&eacute;n&eacute;ral, l'un (ou plusieurs)
d'un des connecteurs a &eacute;t&eacute; mis dans le mauvais sens (dessus dessous),
de sorte que l'emplacement 1 (broche 1) d'une extr&eacute;mit&eacute; se connecte &agrave;
l'emplacement 34 (broche 34) de l'autre c&ocirc;t&eacute; de la connexion. (Tous les
emplacements pairs sont mis &agrave; la terre, donc votre lecteur de
disquettes devrait aussi &ecirc;tre inutilisable). Ne vous inqui&eacute;tez pas;
cela ne peut pas ab&icirc;mer votre mat&eacute;riel.

<sect1>OK il y a bel et bien un bogue .... euhh.... une caract&eacute;ristique
- Comment soumettre un rapport ?

<p>
Premi&egrave;rement, assurez-vous que le probl&egrave;me est reproductible. Les
erreurs al&eacute;atoires sont tr&egrave;s emb&ecirc;tantes, du fait qu'elles sont
impossibles &agrave; isoler :-/
Voil&agrave; une liste rapide &agrave; v&eacute;rifier/reporter&nbsp;:

<itemize>
<item> La version du noyau, et les mises &agrave; jour appliqu&eacute;es (patches),
y compris celles de ftape.
<item> la version de ftape.
<item> Le mod&egrave;le et le fabriquant du lecteur de bande.
<item> Ce que vous avez fait pour d&eacute;clencher le probl&egrave;me.
<item> Un fichier de traces (log) de l'ex&eacute;cution avec un niveau de
tra&ccedil;age &eacute;gal &agrave; 7.
<item> Quelles anomalies se sont produites sur votre syst&egrave;me.
<item> Ne supprimez pas le noyau et le fichier <tt>ftape.o</tt> . Nous
voudrons peut-&ecirc;tre essayer quelques modifications ou ex&eacute;cuter des
tests diff&eacute;rents sur votre syst&egrave;me.
</itemize>

Augmenter le niveau de tra&ccedil;age jusqu'&agrave; 7 (juste en-dessous du niveau
maximum) et ex&eacute;cuter la commande fautive de nouveau. R&eacute;cup&eacute;rer les
donn&eacute;es de tra&ccedil;age &agrave; partir du `journal' du noyau ou de
<tt>/proc/kmsg</tt>, cela d&eacute;pendant d'o&ugrave; vous abritez vos messages
d'erreur.  N'essayez pas de `filtrer' les traces obtenues. Vous
pourriez consid&eacute;rer certaines choses superflues alors qu'elles sont
essentielles pour retrouver le bogue. D&eacute;crivez exactement ce que vous
avez fait, et ce qui s'est pass&eacute; sur votre syst&egrave;me. En effet, il est
possible que nous ne puissions pas reproduire l'erreur parce que nous
utilisons un lecteur diff&eacute;rent ou une autre version du noyau.

<sect1>Comment changer le niveau de tra&ccedil;age ?

<p>
Il y a deux mani&egrave;res de le faire&nbsp;: soit vous pouvez changer le niveau
de tra&ccedil;age par d&eacute;faut (la variable `<tt>tracing</tt>' dans le fichier
`<tt>ftape-rw.c</tt>') et recompiler, soit tapez

<tscreen><verb>
	mt /dev/ftape fsr <tracing-level>
</verb></tscreen>

L'utilisation de la commande `fsr' avec mt est <em>une sorte de
bidouille</em>, et est destin&eacute;e &agrave; dispara&icirc;tre.

<sect1>Lors de l'utilisation de <tt>/dev/nftape</tt>, il y a beaucoup
de message superflus ... pourquoi ?

<p>
Cela vient d'un probl&egrave;me `historique', avant la version 0.9.10. De
nos jours, les p&eacute;riph&eacute;riques `non-rembobinants' fonctionnent
correctement. Si votre version est ancienne, il est vivement
recommand&eacute; de se mettre &agrave; jour avec la version 1.13b.

</sect>

<sect>Aide au d&eacute;veloppement de ftape.

<p>
<sect1>J'<bf>ADORE</bf> tout simplement ce pilote ftape, comment
puis-je aider les d&eacute;veloppeurs.

<p>
Vous pouvez aider les d&eacute;veloppeurs de ftape en r&eacute;pondant aux questions
des utilisateurs sur les `newsgroups'. Il y a beaucoup d'utilisateurs
d&eacute;butants, qui ont juste besoin d'une r&eacute;ponse tr&egrave;s simple &agrave; leur
question, par exemple `O&ugrave; puis-je trouver le ftape-HOWTO'. En g&eacute;n&eacute;ral postez
s'il vous pla&icirc;t votre r&eacute;ponse directement sur le `newsgroup', de
mani&egrave;re &agrave; en faire profiter d'autres utilisateurs.

C'est la meilleure mani&egrave;re d'apporter votre contribution, avec bien
s&ucirc;r le fait de tester le pilote et d'&eacute;crire des rapports de
disfonctionnements pr&eacute;cis.

<sect1><label id="email-addrs">Je voudrais aider &agrave; d&eacute;velopper `...'
Qui dois-je contacter?

<p>
Vous trouverez une liste des d&eacute;veloppeurs ci-dessous. Si quelqu'un
travaille d&eacute;j&agrave; sur un projet similaire ou identique, contactez cette
personne directement. Si au contraire, vous avez un programme o&ugrave; des
ajouts sur lesquels personne ne travaille, contactez
<tt>&lt;khp@login.dkuug.dk&gt;</tt> (et <em>NON</em> Bas, du fait qu'il
est surcharg&eacute; de travail et a peu de temps pour r&eacute;pondre aux
questions.

<descrip>
<tag>Programme de formatage&nbsp;: (pas encore commenc&eacute;)</tag>
  Kai Harrekilde-Petersen, <tt>khp@login.dkuug.dk</tt>

  Cesare Mastroianni, <tt>cece@dist.dist.unige.it</tt>

<tag>le pilote ftape proprement dit&nbsp;:</tag>
  Bas Laarhoven, <tt>bas@vimec.nl</tt>

<tag>ECC code&nbsp;: (ne vous joignez pas &agrave; nous, nous sommes d&eacute;j&agrave; assez nombreux)</tag>
  Kai Harrekilde-Petersen, <tt>khp@login.dkuug.dk</tt>

  Bas Laarhoven, <tt>bas@vimec.nl</tt>

  David Mosberger-Tang, <tt>davidm@cs.arizona.edu</tt>

  Ning Mosberger-Tang, <tt>tn@cs.arizona.edu</tt>

<tag>ftape-HOWTO&nbsp;:</tag>
  Kai Harrekilde-Petersen, <tt>khp@login.dkuug.dk</tt>
  version fran&ccedil;aise&nbsp;: <tt>lprylli@lip.ens-lyon.fr</tt>

<tag>format logique QIC-80 (lecture/&eacute;criture au format DOS)&nbsp;:</tag>
  Guido Muench, <tt>odiug@pool.Informatik.RWTH-Aachen.de</tt>

  Kai Harrekilde-Petersen, <tt>khp@login.dkuug.dk</tt>
</descrip>

</sect1>

</sect>

</article>
