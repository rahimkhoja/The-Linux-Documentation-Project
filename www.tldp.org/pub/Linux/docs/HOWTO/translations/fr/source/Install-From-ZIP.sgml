<!doctype linuxdoc system>
<article>

<!-- Title information -->

<title>Installation de Linux à partir d'un lecteur ZIP parallèle.
<Author>by Kevin Snively, <tt><htmlurl url="mailto:k.snively@seaslug.org"
name="k.snively@seaslug.org"></tt> <newline>
Traduction Thierry Le Quéau, <tt><htmlurl url="mailto:thierry.lequeau@wanadoo.fr" name="Thierry.LeQuéau@wanadoo.fr"></tt>
<date>v01.02, 27 January 1998
<abstract>
Ce document vous explique comment installer Linux à partir 
d'un lecteur ZIP parallèle.
</abstract>

<toc>
 
<sect>Préface

<sect1>Introduction:

<p>
La méthode suivante a été écrite pour être utilisée avec la distribution 
Slackware. Elle requiert une bonne connaissance de l'installation  de 
celle-ci. 
De plus, l'utilisateur devra avoir accès à un système d'exploitation 
Linux quel qu'il soit. Elle demande également 4 à 6 Mo de mémoire vive. 
Les systèmes plus puissants peuvent aussi utiliser cette méthode, 
mais vous trouverez sûrement une voie plus simple et plus rapide pour ceux-ci.
Le but de ce document n'est pas de remplacer la documentation de la S
lackware ou d'un autre HOWTO Linux et ne concerne pas une première 
installation.
Je ne parlerai ici que de l'utilisation d'un lecteur ZIP comme 
seul moyen d'installation possible.

 
<sect1>Contexte:

<p> 
J'ai un vieux 486/20 Mhz avec un disque dur de 120 Mo, 4 Mo mémoire 
vive et un modem à 2400 Bds, et je veux utiliser Linux. 
Je n'ai pas de lecteur de cédérom ou PCMCIA, et n'ai jamais vu de 
carte ETHERNET (sur port parallèle). Il ne reste aucune possibilité 
d'améliorer cet ordinateur.

Linux est apparu à la fin du règne des 486, mais a aussi insufflé 
une nouvelle vie à ces vieux 486 et 386.
La documentation dit: " Un 386 avec 2 Mo de mémoire vive et sans 
coprocesseur mathématique " , mais essayez aujourd'hui de trouver une 
distribution qui le permette. La Slackware peut être installée sur une 
machine avec 4 Mo de mémoire vive mais avec beaucoup de travail et de prières.
La manip suivante réduira grandement le boulot. Vous aurez toujours besoin 
des prières, même avec le meilleur système. J'ai utilisé la méthode suivante 
sur 3 autres laptops et un 386, le moins puissant étant un 386 avec 
4 Mo mémoire vive, un disque dur de 60 Mo, pas de coprocesseur mathématique.
Puisque cette méthode fonctionne correctement, j'aimerais en faire autant 
avec la Debian, la RedHat, la SuSe, la Caldera Lite et d'autres distributions,
ceci pour offrir plus de choix aux linuxiens.


<sect1>Avantages:

<p>
L'installation par cédérom ou liaison éthernet est le meilleur choix 
s'il est disponible. Dans le cas où le seul moyen d'installation passe 
par le lecteur de disquette 1.44, un lecteur ZIP en parallèle offre de 
nombreux avantages (plus rapide qu'un lecteur 3"1/2 et moins de changement de 
disquettes). De plus, sur les machines ayant peu de mémoire vive 
(6 Mo ou moins), la possibilité d'installer une partition swap sur le disque 
root et d'utiliser la disquette root: color.gz ou text.gz.
Sur les machines avec seulement 4 Mo de mémoire vive, le fichier color.gz ne 
fonctionne pas pour une installation de base par lecteur 3"1/2. Avec une 
installation par ZIP pas de problème.
Il permet aussi la création d'une disquette de secours durant l'installation 
initiale, ce qui n'est pas possible avec un lecteur 3"1/2 sur un système 
ayant peu de mémoire.


 
<sect1>Matériel:

<p> 
Cette méthode a été utilisée avec la Slackware (version 3.1, 3.2 et 3.3). 
Une installation complète requiert 2 disquettes ZIP, un lecteur ZIP en 
parallèle avec cordon, une disquette boot 3"1/2, un crayon et du papier 
pour prendre quelques notes durant l'installation.

Vous avez besoin d'au moins deux systèmes pour utiliser cette méthode. Le 1er 
est utilisé pour préparer l'installation proprement dite et doit donc tourner 
sous Linux. La second est bien sûr la machine sur laquelle l'on veut 
installer Linux.
Une fois que les disquettes ont été créées, elles peuvent être utilisées pour 
autant de machines que vous voulez configurer.
J'utilise un lecteur de CD  mais vous pouvez télécharger une image disque si 
vous avez une connexion internet à haut débit. Pour ma part ce n'est pas 
pratique.

 
 
<sect1>Conventions:
 
<p>
<tscreen><verb>
supposons que (floppy)    représente le chemin pour monter votre
                          lecteur 3.5" et son répertoire


supposons que    (zip)    représente le chemin pour monter votre 
                          lecteur zip et son répertoire


supposons que  (cdrom)    représente le chemin pour monter votre 
                          lecteur cdrom et son répertoire


supposons que (verx.x)    représente la version que vous installez
</verb></tscreen>
Si vous téléchargez votre image disque, supposons que (cdrom)/slakware représente le 
chemin et le répertoire pour ces images. Mon port Zip parallèle est défini 
sur mon système par

<tscreen><verb>

        /dev/sda4

</verb></tscreen>

Je n'ai pas rencontré de problème jusqu'au lancement de fdisk. Ensuite 
j'obtenais toujours des messages d'erreurs quand j'essayais d'utiliser le 
disque. Vous avez également besoin de connaître les noms systèmes de vos 
lecteurs de cédérom et de disquette 3.5". Sur ma machine ils correspondent à

<tscreen><verb>

       /dev/hdc     cdrom
       /dev/fd0     1.44 meg floppy
     
</verb></tscreen>

J'utiliserai mes devices, vous les vôtres ;-)

Au sujet de Slackware et slakware (notez bien qu'il manque un c 
à ce dernier). Slackware est le nom de la distribution et slakware 
le nom du répertoire où Patrick Volkerding met les packages stables 
pour l'installation.
A chaque fois que j'écris slakware, je parle du répertoire.



<sect1>Autre lecture:
<p> 
Linux Installation &amp Getting Started de Matt Welsh.
 
Si vous avez des problèmes pour accéder à votre lecteur Zip voyez 
le « Linux ZIP drive mini-HOWTO » de Grant Guenther.
 
Je recommande également la lecture du fichier LOWMEM.TXT disponible 
sur le CD de la Slackware ou sur le site ftp de la distribution.

 
<sect>Technique:
<p>
<sect1>Création du premier disque ZIP.

<p>
1)    Branchez le lecteur ZIP sur la machine hôte, insérez le disque 
vierge et démarrez le système sous Linux.
 
2)    Se loguer.
De préférence Root ou, si vous êtes utilisateur, vous devez avoir 
le droit  de créer des fichiers systèmes, de monter ou démonter 
des disques, etc...
 
3)    Formatez le disque ZIP sous Linux avec la commande:
<tscreen><verb>
         /sbin/mke2fs -b 1024 /dev/sda4
 
</verb></tscreen>
4)    Montez le disque ZIP avec:
<tscreen><verb>
         mount /dev/sda4 /(zip)
 
</verb></tscreen>
5)    Insérez votre cdrom dans le lecteur et montez le:
<tscreen><verb>
         mount /dev/hdc /(cdrom)
 
</verb></tscreen>
6)    Créez le répertoire où vous voulez installer l'image 
disque slakware:
<tscreen><verb>
         mkdir /(zip)/slakware
 
</verb></tscreen>
7)    Créez un répertoire de travail temporaire sur votre 
disque dur. Je vous suggère:
<tscreen><verb>
         mkdir /root/slakware/(verx.x)
 
</verb></tscreen>
8)    Copiez l'image disque root sous le répertoire ci-dessus:
<tscreen><verb>
         cp /(cdrom)/rootdsks/text.gz /root/slakware/(verx.x)/
 
</verb></tscreen>
9)    Allez dans le répertoire où vous avez copié l'image 
disque et décompressez le fichier avec la commande:
<tscreen><verb>
         cd /root/slakware/(verx.x)
         gunzip text.gz

</verb></tscreen>
10)   Insérez une disquette 1.44 Mo formatée dos ou ext2fs et y 
copier l'image disque cette fois-ci avec la commande:
<tscreen><verb>
         dd if=text of=/dev/fd0
 
</verb></tscreen>
11)   Montez la disquette 1.44 Mo avec:
<tscreen><verb>
         mount /dev/fd0 /(floppy)
 
</verb></tscreen>
12)   Copiez l'image disque sur le ZIP:
<tscreen><verb>
         cp -dpR /(floppy)/* /(zip)/

</verb></tscreen>
13)   Pour faciliter le processus d'installation plus tard, 
nous allons créer une partition swap de 8 Mo sur le ZIP avec:
<tscreen><verb>
         dd if=/dev/zero of=/(zip)/swap bs=1024 count=8208

</verb></tscreen>
14)    Initialisez la partition swap avec:
<tscreen><verb>
         /sbin/mkswap /(zip)/swap 8208

</verb></tscreen>
15)     Puis, avec votre éditeur de texte favori, vous devez ouvrir le 
fichier  /(zip)/etc/rc  et après la ligne  /bin/mount -av -t nonfs  , 
insérez la ligne suivante :
<tscreen><verb>
         /sbin/swapon /swap

</verb></tscreen>
16)   Copiez l'image disque sur le ZIP:
<tscreen><verb>
         cp -r /(cdrom)/slakware/[a-ty]* /(zip)/slakware/ &
</verb></tscreen>
Enfermez entre crochets [a-ty]* exactement comme ci-dessus. 
Le signe &amp; à la fin de la ligne rend l'exécution possible en 
arrière plan. Il faut environ 20mn pour le faire. Vous pouvez 
aller boire un café pendant ce temps ou lire d'autres HOWTO.

17)  Les lecteurs ZIP externes ont 2 diodes -- les miennes 
sont vertes et jaunes. Le lecteur interne en a seulement une. 
Quand mon ZIP a terminé de recevoir des infos, la lumière jaune 
s'éteint laissant juste la lumière verte allumée, sur l'interne 
la seule diode s'éteint.

Vous pouvez maintenant démonter les différents disques 
en vue de leur éjection:
<tscreen><verb>

         cd
	 umount /dev/fd0
	 umount /dev/sda4

</verb></tscreen>
18)  La Slackware ne va pas apprécier, au redémarrage, si 
vous ne vérifiez pas maintenant que votre disque ZIP est bien système.
<tscreen><verb>
         /sbin/e2fsck -f /dev/sda4
</verb></tscreen>
S'il n'y a pas d'erreur au retour du prompt, vous pouvez 
éjecter les disquettes.
N'oubliez pas de les étiquetter (nom et version). Vous ne 
pouvez pas savoir comme ça va vous faciliter la vie.

<sect1>Créer la seconde disquette ZIP.

<p>
Si la surcouche graphique X Window doit être installée 
ou si vous avez besoin d'un autre noyau, il est temps de 
créer la seconde disquette.

 
x1)   Insérez le disque 2. Je préfère formater ce disque 
sous Linux également, mais si votre disque est formaté dos 
il n'y a pas de problème. J'utilise la " flèche vers le haut " 
pour visualiser les commandes précédentes parce que je suis 
fainéant, mais si vous voulez retaper les instructions 
reprenez les 3) 4) et 6) du disque 1. 

x2)  Copiez les paquetages X11R6  "X Window" sur le ZIP 
(j'utiliserai par la suite le terme package, c'est plus seyant).
<tscreen><verb>
         cp -r /(cdrom)/slakware/x* /(zip)/slakware/ &

</verb></tscreen>
Ca prendra à peu près 2 fois moins de temps que l'étape 9). 
Si votre machine pédalait, ça ne va pas aller plus vite. 
Plus de café à boire et de HOWTO à lire.


 
x3)  Il y a aussi de la place sur ce disque pour créer le 
répertoire du noyau personnalisé. C'est la classe d'en installer 
un qui se rapproche le plus possible de celui qui sera utilisé 
pour accéder au ZIP.
Faites de ce noyau le noyau par défaut. Créons-lui maintenant 
un répertoire et copions-y les informations suivantes:

<tscreen><verb>

         mkdir /(zip)/kernels
         cp -r /(cdrom)/kernels/* /(zip)/kernels/ &

</verb></tscreen>
Ca devrait vous prendre encore 10 à 15mn. Vous reprendrez un peu de café ? 
Un petit peu de lecture ?
 
x4)  Quand c'est terminé, démontez le ZIP et lancez fdisk:
<tscreen><verb>
         umount /dev/sda4
         /sbin/e2fsck -f /dev/sda4

</verb></tscreen>
x5)  Quand fdisk en a fini avec le ZIP et que le prompt réapparaît, 
éjectez le ZIP et étiquetez-le.


<sect1>Créer la disquette de boot.

<p> 
b1)  Je crée maintenant une disquette boot 1.44 en utilisant 
l'image du fichier (cdrom)/bootdsks.144/iomega.s
Insérez la nouvelle disquette et lancez la commande:
<tscreen><verb>
         dd if=/(cdrom)/bootdsks.144/iomega.s of=/dev/fd0
</verb></tscreen>
Une fois la disquette créée et le prompt revenu, vous pouvez 
si vous le souhaitez, éteindre la machine hôte, enlever le ZIP 
et partir gaiement installer Linux de Redmond jusque chez Billou 
avec votre ZIP.
 
<sect>L'installation
<sect1>Premier Round .

<p>
Après avoir connecté tout ce qu'il faut sur la machine de 
destination et inséré le 1er disque ZIP, je lance le système sur la 
disquette boot et au prompt, je donne le paramètre suivant à Lilo:
<tscreen><verb>
      mount root=/dev/sda4 ramdisk=0
</verb></tscreen>

 
Suivez attentivement les instructions à l'écran, loguez-vous root et lancez 
fdisk pour créer les partitions root et swap. Relancez la machine, en 
redonnant le paramètre ci-dessus à Lilo.

Relire avec attention les instructions à l'écran, et se loguer root.

Même sur une machine qui a seulement 4 Mo de mémoire vive, vous n'avez pas 
besoin de créer une partition swap jusqu'à qu'il vous le soit demandé par 
le programme d'installation. 
Nous avons déjà un swap opérant sur le ZIP. Lancez le setup de la Slackware:

<tscreen><verb>
          setup
</verb></tscreen>
ATTENTION: lisez et suivez attentivement les instructions des menus. 
La première chose que le setup voudra faire est de créer et d'initialiser 
une partition swap sur votre disque dur. Contrairement au message 
d'alerte, il n'y a pas de problème et ça n'affectera pas celle du ZIP.

Vous ne devez pas permettre au ZIP /dev/sda4 d'être monté automatiquement. 
Quand la question vous est posée dans le menu, ne le rajoutez pas à moins 
de vouloir laisser tout le temps le lecteur ZIP sur cette machine.

Quand vous arrivez au menu qui vous demande à partir de quelle source 
vous voulez installer Linux, sélectionnez l'article n°4 "Installation 
d'un répertoire déjà monté". 
L'écran suivant vous demande son nom, c'est /slakware.

Je vous recommande d'installer seulement le package "a" à ce niveau. 
Si l'installateur voit grand en sélectionnant les packages et remplit 
le disque dur avant que Lilo et le noyau soient installés, l'installation 
avortera.
Durant l'installation primaire, j'installe seulement le noyau du disque boot. 
Il y a relativement peu de choix à faire à partir d'ici et la documentation 
Slackware du cdrom ou du site ftp vous le dira mieux que moi.

Laissez le lecteur ZIP ainsi que la disquette en place après l'installation 
initiale. Enlever la disquette 1.44 quand vous pouvez le faire (au prompt) 
et relancer la machine.
Si tout va bien dans le monde de Billou, votre copain aura bientôt un 
système Linux opérant.


<sect1>Second Round.
<p>
Après avoir rebooté votre machine, loguz vous root et remontez a 
nouveau le ZIP.
<tscreen><verb>
          mount /dev/sda4 /mnt
 
</verb></tscreen>
Vérifiez l'espace disque disponible:
<tscreen><verb>
          df
 
</verb></tscreen>
Relancez le setup sur votre nouveau système:
<tscreen><verb>
          setup
 
</verb></tscreen>
Choisissez "s" SOURCE du menu et validez. Sélectionnez l'article n°4 
"Install from a premounted directory" (installer à partir d'un répertoire 
déjà monté) et validez.

Entrez le nom du répertoire, cette fois-ci:
<tscreen><verb>
          /mnt/slakware
 
</verb></tscreen>
Choisissez les packages que vous voulez ou dont avez besoin. 
Tous sont disponibles sauf ceux commençant par X. Quand vous avez fini 
d'installer les packages de ce disque, quitter l'installation et lancer:
<tscreen><verb>
          umount /dev/sda4
</verb></tscreen>
Vous devez maintenant enlever le disque et si X Window doit être installé, 
insérez le 2eme disque ZIP et relancez le setup en sélectionnant cette 
fois-ci seulement les packages commençant par X. Si vous avez à installer 
un noyau personnalisé à partir des noyaux préconçus, vous devez aussi le faire 
pendant que le 2eme disque est installé.

Ce mini-HOWTO vous est fourni sous les conditions de la licence GNU et du LDP.

Je remercie spécialement le Dr Randolph Bentson qui, par sa dévotion à Linux, 
m'a inspiré pour qu'à mon tour, je fasse quelque chose pour les personnes qui 
nous ont donné le SEUL système d'exploitation digne de ce nom.
<tscreen><verb>
    J'espère que cela aidera quelqu'un.
 
    Sincèrement
 
    Kevin Snively
    P.O. Box 1013
    Everett Wa. 98206-1013
    USA

</verb></tscreen>
 
<tt>
<htmlurl url="mailto:k.snively@seaslug.org"name="k.snively@seaslug.org">
</tt>
<tscreen><verb>
    root@aldrovanda
</verb></tscreen>
</article>
