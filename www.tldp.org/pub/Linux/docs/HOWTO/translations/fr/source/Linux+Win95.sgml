<!doctype linuxdoc system>

<article>

<title>Linux et Windows 95 - HOWTO
<author>par Jonathan Katz <tt>jkatz@in.net</tt>&nl;
Traducteur: <url name="Sébastien Blondeel"
url="http://www.lifl.fr/~blondeel">
(<htmlurl url="mailto:sebastien.blondeel@lifl.fr"
name="sebastien.blondeel@lifl.fr">)
<date>26 Oct 1996


<abstract>
Ce document décrit comment procéder pour installer à la fois Linux et Windows
95 sur un ordinateur.
</abstract>

<toc>

<sect>Corrections<p>
<itemize>
<item>février 1998: traduit en français par Sébastien Blondeel, 
<tt>Sebastien.Blondeel@lifl.fr</tt>
<item>26 octobre 1996: complété par Jonathan Katz
<item>25 juin 1996: remis à jour par Jonathan Katz
<item>10 avril 1996: relu et corrigé par Jonathan Katz
<item>novembre 1995: premier jet, par Jonathan Katz, <tt>jkatz@in.net</tt>
</itemize>

<sect>Introduction<p>
De nombreuses personnes ont récemment acheté de nouvelles machines, sur
lesquelles Windows 95 était (malheureusement) pré-installé. Après avoir 
exploré l'Internet, de nombreux utilisateurs entendent parler de Linux et
de ses semblables, et veulent faire tourner un meilleur système
d'exploitation pour bien moins cher. Il y a bien des sujets à traiter,
parce que les nouveaux ordinateurs sont généralement équipés de
gros disques EIDE, et parce que
Windows 95 dispose d'extensions au vieux système de
fichiers FAT. Linux comprend bien ces problèmes et il
est capable de gérer tout cela, au niveau logiciel
comme au niveau matériel.

<sect>C'est parti!<p>
Linux et Windows 95 peuvent très bien cohabiter sur le même disque dur.
Vous pouvez aussi installer Linux sur un autre disque dur, sur la même
machine. Si vous avez assez d'économies pour acheter un autre disque dur,
achetez-en un sans hésiter. Bien que la cohabitation entre les deux
systèmes soit fiable et ne présente aucun danger, il est préférable d'avoir
un autre disque. Cependant, comme je suis un pauvre étudiant (ainsi que la
plupart des gens que je connais,) il me faut me contenter d'un unique
disque.

Je suppose que votre disque dur ressemble à ceci:

<verb>

        +---------------------------------  
C:      |  800M environ, peut-être plus?
        |
        +---------------------------------

</verb>

et que Windows 95, MS-Office, Qmodem Pro, ainsi que tous vos autres 
logiciels tournant sous DOS ou Windows, prennent environ 400M plus l'espace
de pagination (swap) (ceci est une hypothèse quelque peu hasardeuse et
sarcastique)! Je suppose que vous ne voulez pas détruire tous ces logiciels
que vous avez passé beaucoup de temps à configurer et à installer, et que
par conséquent vous ne souhaitez pas effacer cette partition pour
recommencer à zéro. 

<sect>D'accord, j'ai cette partition et je veux l'épargner!<p>
Ne perdez pas espoir. Il existe un programme appelé FIPS, qui peut
re-partitionner votre disque dur sans détruire vos données. CEPENDANT,
assurez-vous avant de l'utiliser, que vous venez de défragmenter votre
disque dur (avec la méthode de défragmentation optimale). Utilisez le
défragmenteur livré avec Windows 95 et utilisez-le dans le système de
fenêtres - sans quoi vous perdrez vos noms de fichiers longs. Quand tout
est défragmenté, lancez FIPS et donnez à votre disque l'aspect qui suit:

<verb>

        +-------------------------------------
C:      | Ceci est votre partition FAT/VFAT/Win95
 450M   |
        +------------------------------------
???     | Ceci est l'espace libre qui commence 
        | EN DESSOUS du cylindre 1024
        +------------------------------------

</verb>

Vous trouverez FIPS à votre site FTP (protocole de transfert de fichiers)
préféré proposant Linux (par exemple sunsite.unc.edu, tsx-11.mit.edu,
ftp.redhat.com, ftp.lip6.fr), en général dans le répertoire
<verb>/pub/utils/msdos</verb>. 
Si vous disposez d'un CD contenant Linux, il s'y trouve
habituellement un répertoire 
<verb>\utils\msdos</verb> ou <verb>\utils</verb> contenant aussi FIPS.

C'est TRÈS IMPORTANT que votre partition pour Linux commence avant (en
dessous) du cylindre 1024, sans quoi vous ne pourrez pas l'utiliser à
l'amorçage de l'ordinateur (et ce n'est pas une très bonne chose).

Qu'est-ce que le cyclindre 1024 exactement? C'est là où se termine IDE et
où commence EIDE sur votre disque dur -- c'est la ``marque'' 528M sur votre
disque dur. Faites commencer votre partition Linux à environ 520M, de telle
sorte que le noyau en entier, ainsi que les autres fichiers d'amorçage et
le chargeur se trouvent entièrement sous ce cylindre. 

<sect>Et ensuite?<p>
Continuez et installez Linux sur cet espace libre. Si vous êtes
paranoïaque, 
quand la procédure d'installation de Linux réamorce l'ordinateur, vous
pouvez redémarrer sous Windows 95 et vous assurez qu'il fonctionne encore
correctement. VEUILLEZ, VEUILLEZ, VEUILLEZ lire les conseils prodigués à la
fin de la section 3, sans quoi vous ne pourrez pas utiliser Linux.

Quand il s'agira de partitionner
le disque, si vous faites comme tout le monde, vous mettrez en place une
partition Linux de 400M (ce qui est assez confortable), ainsi que 30M
d'espace de pagination (ce qui est plus qu'assez). 
   
Vous devriez maintenant pouvoir installer toute distribution de Linux dont
vous diposez sans problèmes.

<sect>Utilisez votre nouveau système!<p>
Linux peut monter, lire, et écrire dans les partitions VFAT de Win95 de
plusieurs façons. Vous pouvez utiliser le support pour
système de fichiers msdos qui a été mis en place dans tous les noyaux à
partir des versions 1.0. Cependant, l'utilisation de commandes telles que:

poubelle~#: mount -t msdos /dev/hda1 /mnt

ne vous laissera manipuler que des noms de fichiers dans le format 8 point
3. Beurk! Vous avez Windows 95 pour avoir accès aux noms de fichiers longs.

Certains utilisateurs de Linux utilisent encore d'anciens noyaux (dans
l'Histoire de Linux). En d'autres mots, des noyaux 1.2.xx. Il existe un
module pour cette série de noyaux de telle sorte qu'un utilisateur peut
lire des fichiers qui ne se conforment pas au vieux standard 8.3.
Rendez-vous dans 
ftp://mm-ftp.cs.berkeley.edu/pub/multimedia/linux/xmsdos/ et téléchargez
une copie du fichier README (LISEZMOI) avant de faire quoi que ce soit.

Enfin, les noyaux récents (1.3.4x) comme la série tant attendue des noyaux
2.0 proposent un support pour VFAT que vous pouvez compiler en interne. Ces
noyaux vous permettent d'écrire sur vos partitions VFAT en toute sécurité.

<bf>NOTE:</bf> Prenez garde!

Si vous faites tourner une version "récente" de Windows 95 -- c-à-d, une
version disponible sur des ordinateurs plus récents que juin 1996, ainsi
que sur la série P5-MMX, veuillez lire ce qui suit. 

Assurez-vous de la version de Windows 95 que vous faites tourner. Pour
cela, ouvrez une session DOS et tapez: "ver /r". Voici un exemple de cela:

<verb>
C:\> ver /r

Microsoft Windows 95 [4.00.1034]
        (C) 1981-1996 Microsoft Corporation.
</verb>

Remarquez le numéro de révision mineur. Si ce numéro est PLUS GRAND que 950
il se peut que vous fassiez tourner une version du type de partition FAT
connu sous le nom de FAT32. Si c'est le cas, vous pouvez quand même
utiliser Linux et Windows 95, CEPENDANT, il n'existe PAS de support pour
lire ou écrire sur des partitions FAT32. Si c'est le cas, vous êtes foutu.

Que vous fassiez tourner une version récente de Windows 95 ne signifie pas
que vous fassiez tourner FAT32. Lancez "fdisk" et utilisez l'option
"display partition information" (affichage des informations sur la
partition) pour savoir si vous utilisez FAT32.

<sect>AU SECOURS! Je suis coincé avec FAT32!<p>

<sect1>J'ai ce nouvel ordinateur acheté à Carroufe<p>
Si vous installez Linux sur un disque avec FAT32 suivez les étapes qui
précèdent concernant l'installation de Linux sur un système avec Windows
95, mais n'installez PAS LILO. Au lieu de cela, rendez-vous à la section
5.1.3
intitulée "loadlin, c'est quoi?" et lisez la procédure pas à pas pour cette
situation malheureuse.

<sect1>Je me suis trompé -- tout est cassé!<p>
Cela m'est arrivé -- j'utilisais une version beta de Windows 95 avec FAT32,
je suis passé à la version supérieure de Windows 95, et mon système est
mort.
Je n'avais pas de disquette d'amorce pour la version de Windows 95 
à laquelle je venais de passer. Voici comment contourner le problème.

Mettez la main sur une disquette d'amorce de MS QUELCONQUE utilisant la
version 5.0, ou une version ultérieure, de DOS. Sous Linux, montez le CD de
la version BETA de Windows 95. Montez également la disquette. 


poubelle~# mount -t iso9660 /dev/cdrom /cdrom
poubelle~# mount -t msdos /dev/fd0 /mnt

Sur le CD, trouvez le répertoire "beta stuff" (trucs beta). Les gens de MS
ne le mettent jamais au même endroit... essayez /cdrom/admin/beta/floppy, 
/cdrom/betaonly/floppy. Copiez (cp) les fichiers io.sys, msdos.sys, et
command.com sur la disquette. Synchronisez ("sync") et démontez
les disques que vous avez montés. Réamorcez l'ordinateur et cette disquette
d'amorce *devrait* fonctionner. 

<sect1>Loadlin, c'est quoi?<p>
Loadlin
est un exécutable DOS qui charge une image du noyau à partir d'un disque
dur (ou d'une disquette) et qui amorce le reste du système d'exploitation
Linux à partir d'une partition racine appropriée. Si vous savez bien
bidouiller, vous pouvez de cette manière faire une installation de Linux
sans disquette, mais nous nous contenterons de présenter des usages plus
traditionnels. Quand vous amorcez Windows 95, enfoncez la touche F8 (quand: 

Starting Windows 95...

apparaît) et sélectionnez "Safe mode, command prompt only." (mode sécurisé,
ligne de commande uniquement). Rendez-vous dans le répertoire où vous avez
mis le noyau et lancez 

<verb>
C:\LINUX> loadlin.exe zimage root=/dev/hda2 ro"
</verb>

à partir de là. Si vous connaissez bien les configurations sous MS-DOS,
vous pouvez programmer plusieurs fichiers AUTOEXEC.BAT et CONFIG.SYS pour
voir un menu apparaître et pouvoir choisir sous quel système d'exploitation
amorcer.

<sect>Des problèmes?<p>
Dans le scénario inverse de ce qui précède (vous avez une machine sous
Linux en état de marche et une puissance étrangère vous oblige à installer
Windows 95) Windows 95 VA écraser votre MBR (secteur d'amorce) et ainsi
écraser LILO.
Vous avez deux possibilités: utiliser loadlin.exe pour charger votre noyau,
et utiliser cela pour lancer Linux, ou amorcer Linux à partir d'une
disquette et/ou de loadlin, puis ré-installer LILO.

Bonne chance avec votre nouveau système!

<verb>
-Jon
jkatz@mac.edu
+1 217 479-7309
Box 4454 MacMurray College
Jacksonville, Illinois 62650
Personal: http://www.in.net/~jkatz
Corinne:  http://corinne.mac.edu
Resume:   http://www.in.net/~jkatz/resume.html
Room-101: http://room-101.1984.org
HOWTO:    http://www.in.net/~jkatz/win95/Linux-HOWTO.html
</verb>
</article>
