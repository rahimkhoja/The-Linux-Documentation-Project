<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook V3.1//EN">

<!ENTITY howto      "http://www.traduc.org/docs/howto/lecture/">
<!ENTITY guide      "http://www.traduc.org/docs/guides/lecture/">

<article>

<!-- Header -->

 <artheader>

 <section>
<title>
    Commentaires et corrections
</title>
<para>
     
     Merci de faire parvenir en anglais à l'auteur vos questions
     et commentaires relatifs à la version originale de ce
     document à l'adresse
     
     <email>tapselj0 CHEZ cs POINT man POINT ac POINT uk</email>.
     
</para>
<para>
    
    N'hésitez pas à faire parvenir vos commentaires et suggestions
    concernant l'adaptation française de ce document au projet
    <ulink url="http://traduc.org">Traduc.org</ulink> à
    l'adresse&nbsp;:
    
    <email>commentaires CHEZ traduc POINT org</email>.

</para>
</section>

  <!-- titre du Guide pratique, incluant le mot HOWTO -->

  <title>Guide pratique de l'IP masquerade simplifié</title>
  	<subtitle>Version française du <foreignphrase lang="en">
	Masquerading made simple HOWTO</foreignphrase></subtitle>
  <author>
     <firstname>John</firstname>
     <surname>Tapsell</surname>
     <affiliation>
	<address>
	   <email>tapselj0@cs.man.ac.uk</email>
	</address>
     </affiliation>
  </author>

  <author>
     <firstname>Thomas</firstname>
     <surname>Spellman</surname>
     <affiliation>
	<address>
	   <email>thomasNO@SPAMresonancePLEASE.org</email>
	</address>
     </affiliation>
  </author>

  <author>
     <firstname>Matthias</firstname>
     <surname>Grimm</surname>
     <affiliation>
	<address>
	   <email>DeadBull@gmx.net</email>
	</address>
     </affiliation>
  </author>
  <othercredit role="traduction" class="translator">
     <firstname>Eddie</firstname>
     <surname>Mechling</surname>
     <contrib>Adaptation française</contrib>
     <email>eddie POINT mechling CHEZ gmail POINT com</email>
  </othercredit>
   <releaseinfo>Version&nbsp;: 0.09.fr.1.0</releaseinfo>
      <pubdate>10 octobre 2007</pubdate>
   <revhistory>
      <revision>
	<revnumber>0.09.fr.1.0</revnumber>
	<date>2007-10-07</date>
	<authorinitials>EM</authorinitials>
	<revremark>Première traduction française</revremark>
      </revision>
      <revision>
	 <revnumber>0.09</revnumber>
	 <date>2004-07-21</date>
	 <authorinitials>TS</authorinitials>
      </revision>
      <revision>
	 <revnumber>0.08</revnumber>
	 <date>2002-07-11</date>
	 <authorinitials>JPT</authorinitials>
      </revision>
      <revision>
	 <revnumber>0.07</revnumber>
	 <date>2002-02-27</date>
	 <authorinitials>JPT</authorinitials>
      </revision>
      <revision>
	 <revnumber>0.06</revnumber>
	 <date>2001-09-08</date>
	 <authorinitials>JPT</authorinitials>
      </revision>
      <revision>
	 <revnumber>0.05</revnumber>
	 <date>2001-09-07</date>
	 <authorinitials>JPT</authorinitials>
      </revision>
      <revision>
	 <revnumber>0.04</revnumber>
	 <date>2001-09-01</date>
	 <authorinitials>JPT</authorinitials>
      </revision>
      <revision>
	 <revnumber>0.03</revnumber>
	 <date>2001-07-06</date>
	 <authorinitials>JPT</authorinitials>
      </revision>

      <!-- Mettre ici les révisions récentes -->
   
   </revhistory>
<title>
Nouvelles versions de ce document
</title>

<para>
Vous trouverez la plus récente version française de ce document à 
l'adresse&nbsp;: <ulink url="http://www.traduc.org/docs/howto/lecture/Masquerading-Simple-HOWTO.html"/>
</para>

<para>
La plus récente version originale de ce document est disponible à 
l'adresse&nbsp;: <ulink 
url="http://tldp.org/HOWTO/Masquerading-Simple-HOWTO/">.
</para>
  <abstract>
    <indexterm>
      <primary>Avant-Propos</primary>
    </indexterm>
     <para>
      Ce guide pratique NE REMPLACE PAS le 'guide pratique de l'IP masquerade', 
      mais le complète. Ces deux documents devraient être lus en parallèle. 
      Je n'y ai inclu aucun élément déjà détaillé dans cet autre guide pratique,
      ni aucune explication sur leur fonctionnement et leur signification. 
      Veuillez vous reporter à l'adresse <ulink url="http://ipmasq.webhop.net/">
      http://ipmasq.webhop.net/</ulink>
      et lisez le 'guide pratique du masquerade standard', pour une bien meilleure aide.
     </para>Résumé
     <para>
      Ce document décrit l'activation du dispositif dIP Masquerading sur une machine hôte Linux. 
      Le masquage d'adresse IP est une forme de traduction d'adresse réseau 
      ( Network Address Translation ou NAT en anglais ),permettant aux ordinateurs 
      d'un réseau privé n'ayant aucune adresse IP d'accéder à Internet via 
      l'adresser IP unique d'une machine Linux.
     </para>
     <para>
      Tous les auteurs sont joignables sur le canal #debian sur irc.opensource.net
     </para><para>
      John Tapsell (JohnFlux) est le responsable officiel.
     </para><para>
      Contactez-moi (John Tapsell) pour toutes demandes, réactions, réclamations, rendez-vous, etc.      !!!!!!!!!
     </para><para>
      Impudemment tiré du travail de David Ranch - <email>dranch@trinnet.net</email>
     </para><para>
      Ce document est placé sous la GNU Free Documentation License, consultable sur 
     </para><para>
      <ulink url="http://www.gnu.org/copyleft/fdl.html">
      http://www.gnu.org/copyleft/fdl.html
      </ulink> pour la version originale.
      La version française est consultable sur <ulink://="http://www.rodage.org/gpl-3.0.fr.html">
      http://www.rodage.org/gpl-3.0.fr.html</ulink>.
      Attention! La version française de la Gnu Free Documentation License est une version
      non officielle, traduite afin d'améliorer la compréhension de cette licence. Elle ne fait pas
      foi au-niveau juridique!
     </para>
  </abstract>

 </artheader>

<!-- Section1: intro -->

 <sect1 id="intro">
   <title>Introduction</title>

   <indexterm>
    <primary>Introduction</primary>
   </indexterm>

  <para>
  Cette introduction est volontairement courte et ciblée.
  </para><para>
  Admettons que vous aviez un réseau que vous voulez raccorder à l'extérieur:
  </para><para>
    <mediaobject>
      <imageobject>
	<imagedata fileref="network.png">
      </imageobject>
      <textobject>
	<literallayout>
   _____________
  /             \     Adresse IP externe  _____  Adresse IP locale
 |   Internet    |      123.12.23.43   | machine|  192.168.0.1
 |   google.fr   |<--[interface réseau]|  Linux |-[interface réseau interne]
  \_____________/         externe       ---------          |
							   |
			  _____________              ______|_______
			 | 192.168.0.2 |            /              \
			 | ordinateur  |-----------|  192.168.0.0   |
			 |   interne   |           |  Réseau local  |
			  -------------             \______________/ 

	</literallayout>
      </textobject>
      <textobject>
	<phrase>maquette du réseau</phrase>
      </textobject>
    </mediaobject>
  </para>
 </sect1>



<!-- Section1: summary  -->

 <sect1 id="summary">
  <title>Sommaire (J'aime bien débuter par un sommaire!)</title>

  <para>
   Considérons que l'interface réseau externe est eth0, l'adresse IP 123.12.23.43
   et l'interface réseau interne est eth1 :
  </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>modprobe ipt_MASQUERADE</command> # Si cela échoue, essayez tout-de-même de continuer
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -F; iptables -t nat -F; iptables -t mangle -F</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -t nat -A POSTROUTING -o eth0 -j SNAT --to 123.12.23.43</command>
<prompt moreinfo="none">$&gt;</prompt> <command>echo 1 > /proc/sys/net/ipv4/ip_forward</command></screen>
   <para>
   Ou pour une connexion par modem:
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>modprobe ipt_MASQUERADE</command> # Si cela échoue, essayez tout-de-même de continuer
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -F; iptables -t nat -F; iptables -t mangle -F</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE</command>
<prompt moreinfo="none">$&gt;</prompt> <command>echo 1 > /proc/sys/net/ipv4/ip_forward</command></screen>
   <para>
   Pour sécuriser cela:
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT -m state --state NEW -i ! eth0 -j ACCEPT</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -P INPUT DROP</command>   #seulement si les deux commandes précédentes ont abouties
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A FORWARD -i eth0 -o eth0 -j REJECT</command></screen>
   <para>
   Ou pour une connexion par modem (avec eth0 comme interface réseau interne):
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT -m state --state NEW -i ! ppp0 -j ACCEPT</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -P INPUT DROP</command>   #seulement si les deux commandes précédentes ont abouties
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A FORWARD -i ppp0 -o ppp0 -j REJECT</command></screen>
   <para>
   Et voilà!  Pour visualiser les règles tapez "<command>iptables -t nat -L</command>"
   </para>
  </sect1>
  
<!-- Section1: en détail -->

  <sect1 id="indepth">
   <title>Version un peu plus détaillée</title>
   <para>
    Compilation du noyau: (Utilisez un noyau 2.4.x ou supérieur)
   </para>
   <para>
    Le noyau doit inclure les supports suivants:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Dans la section Networking Options
     </para>
     <itemizedlist>
      <listitem>
       <para>
	Network packet filtering  (CONFIG_NETFILTER)
       </para>
      </listitem>
     </itemizedlist>
    </listitem>
    <listitem>
     <para>
      Section Networking Options->Netfilter Configuration
     </para>
     <itemizedlist>
      <listitem>
       <para>
	Connection tracking (CONFIG_IP_NF_CONNTRACK)
       </para>
      </listitem>
      <listitem>
       <para>
	FTP Protocol support (CONFIG_IP_NF_FTP)
       </para>
      </listitem>
      <listitem>
       <para>
	IP tables support (CONFIG_IP_NF_IPTABLES)
       </para>
      </listitem>
      <listitem>
       <para>   
	Connection state match support (CONFIG_IP_NF_MATCH_STATE)
       </para>
      </listitem>
      <listitem>
       <para>
	Packet filtering (CONFIG_IP_NF_FILTER)
       </para>
       <itemizedlist>
	<listitem>
	 <para>
	  REJECT target support (CONFIG_IP_NF_TARGET_REJECT)
	 </para>
	</listitem>
       </itemizedlist>
      </listitem>
      <listitem>
       <para>
	Full NAT (CONFIG_IP_NF_NAT)
       </para>
       <itemizedlist>
	<listitem>
	 <para>
	  MASQUERADE target support (CONFIG_IP_NF_TARGET_MASQUERADE)
	 </para>
	</listitem>
	<listitem>
	 <para>
	  REDIRECT target support (CONFIG_IP_NF_TARGET_REDIRECT)
	 </para>
	</listitem>
       </itemizedlist>
      </listitem>
      <listitem>
       <para>
	Packet mangling (CONFIG_IP_NF_MANGLE)
       </para>
      </listitem>
      <listitem>
       <para>
	LOG target support (CONFIG_IP_NF_TARGET_LOG)
       </para>
      </listitem>
     </itemizedlist>
    </listitem>
   </itemizedlist>
   <para>
    Tout d'abord, si les modules iptables et masq ne sont pas compilés dans le 
    noyau ni installés, mais présents en tant que modules, il faut les installer.
    Si vous chargez le module ipt_MASQUERADE,les modules ip_tables, ip_conntrack et
    iptable_nat seront aussi chargés.
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>modprobe ipt_MASQUERADE</command></screen>
   <para>
    Que votre réseau interne soit vaste, ou bien que vous vouliez connecter 
    deux ou trois machines sur Internet, cela ne fera aucune différence dans tous les cas.
   </para><para>
    Ok, je vais suppposer que vous n'avez aucune autre règle à rajouter, donc vous tapez:
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -F; iptables -t nat -F; iptables -t mangle -F</command></screen>
   <para>
    Si vous obtenez un message d'erreur indiquant "can't find iptables", téléchargez-le et installez-le. 
    Si le message d'erreur indique "no such table 'nat'", recompilez le noyau avec le support nat.
    Si le message d'erreur indique "no such table as 'mangle'", ne vous inquiétez pas, 
    cette table n'est pas nécessaire pour le Masquerading.
    Si le message d'erreur indique "iptables is incompatible with your kernel", téléchargez une
    version de noyau supérieure à 2.4 et compilez-le avec le support iptables.
   </para><para>
    Ensuite si vous avez une adresse IP statique(Par exemple une interface réseau 
    n'utilisant pas le DHCP):
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -t nat -A POSTROUTING -o eth0 -j SNAT --to 123.12.23.43</command></screen>
   <para>
    ou pour une adresse dynamique (Par exemple un modem rtc - vous devez appelez un numéro tout d'abord):
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE</command></screen>
   <para>
    Enfin, afin d'indiquer au noyau que vous voulez activer le routage de packets :
    ( A faire après chaque redémarrage de la session - pas trop contraignant)
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>echo 1 > /proc/sys/net/ipv4/ip_forward</command></screen>
   <para>
    Une fois vérifié que tout fonctionne (voir section Post-install) vous n'allez autoriser
    l'IP masquerade que pour le réseau interne - vous ne souhaitez pas autoriser 
    des personnes sur Internet à l'utiliser après tout :)   
   </para>
   <para>
    En premier lieu, autorisez toutes les connections existantes, ou les connections en dépendant
    ( par exemple un serveur ftp vous renvoyant une réponse)
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</command></screen>
   <para>
    Si vous obtenez une erreur, vous n'avez probablement pas activé le marquage d'état sur les paquets dans
     le noyau - vous devrez le recompiler avec cette option. Nous allons ensuite n'autoriser que les nouvelles connections 
    venant de notre réseau interne (réseau interne ou local). Remplacez  ppp0 par eth0, 
    ou par le nom de votre interface réseau <emphasis>externe</emphasis>
    (Le caractère ! signifie "tout sauf")
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT -m state --state NEW -i ! ppp0 -j ACCEPT</command></screen>
   <para>
    Et bloquez maintenant tout le reste:
   </para>
   <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -P INPUT DROP</command>   #seulement si les deux commandes précédentes ont abouties</screen>
   <para>
    Si l'une des deux premières commandes échoue, cette règle empêchera le masquerading de fonctionner
    Pour annuler cette règle : 
    "<command>iptables -P INPUT ACCEPT</command>".
   </para>   
  </sect1>

<!-- Section1: Post-install -->

  <sect1 id="post-install">   
   <title>Instructions post-installation</title>
    <para>
     Cela devrait fonctionner maintenant.  N'oubliez pas de :
    </para>
     <itemizedlist>
      <listitem>
       <para>
	Configurer toutes les machines du réseau interne afin d'indiquer comme passerelle
	l'adresse réseau unique de la machine Linux.
	(Sous Windows, clic droit sur le voisinage réseau ->propriétés->connexion au réseau local ->
	propriétés -> Protocol Internet (TCP/IP) -> passerelle,
	et remplacez-la par l'adresse IP interne de la machine Linux.)
       </para>
      </listitem>
      <listitem>
       <para>
	Configurer tous vos clients afin d'utiliser le serveur proxy http de votre
	fournisseur d'accès si vos clients en ont un, et utiliser un proxy en mode transparent
	(ATTENTION - Certains rapports font état de proxy en mode transparent engendrant un 
	ralentissement très important sur les très grands réseaux ), ou activez le squid 
	sur votre passerelle Linux (ceci est facultatif mais préférable pour les grands réseaux)
       </para>
      </listitem>
      <listitem>
       <para>
	Spécifier un serveur de DNS sur les machines clientes.  Sinon
	vous obtiendrez un message d'erreur indiquant 'cannot resolve address'
	etc.  Si la résolution d'adresse DNS fonctionnait (adresse URL fonctionnelle) 
	avant d'avoir configuré le MASQUERADING, cela signifie que le serveur DHCP 
	de votre fournisseur d'accès n'arrive plus à vous indiquer quelle est l'adresse DNS.
       </para><para>
	[Aparté] Je me demande si vous ne pourriez pas simplement envoyer un broadcast
	DHCP qui sera acheminé vers le serveur dns ( et vers le proxy http pendant qu'on y est) 
	sans avoir à configurer un serveur DHCP (ou même si vous le faites).
	Quelqu'un pourrait-il me renseigner à ce sujet? :)
       </para><para>
	Merci à Richard Atcheson pour me l'avoir fait remarquer
       </para>
      </listitem>
      <listitem>
       <para>
	A présent, vous devriez commencer à sécuriser un peu tout cela! 
	Premièrement, désactivez le routage :
	"<command>iptables -P FORWARD DROP</command>", puis apprenez à utiliser
	les règles de filtrage iptables, <filename>/etc/hosts.allow</filename> et 
	<filename>/etc/hosts.deny</filename> afin de sécuriser votre système.  ATTENTION 
	- N'essayez pas d'appliquer ces règles iptables avant d'avoir un masquerading opérationnel. 
	Vous devez explicitement autoriser chaque transfert de paquet si vous paramétrez
	la dernière règle avec l'option DENY. 
	(Annulez avec "<command>iptables -P FORWARD ACCEPT</command>")
       </para>
      </listitem>
      <listitem>
       <para>
	Autorisez les accès provenant d'Internet pour chaque service.
       </para>
       <para>
	Par exemple, pour autoriser l'accès au serveur web, vous faites:
       </para>
       <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT --protocol tcp --dport 80 -j ACCEPT</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT --protocol tcp --dport 443 -j ACCEPT</command></screen>
       <para>
	Pour autoriser l'authentification ( Se connecter sur les channels IRC etc...), faites
       </para>
       <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -A INPUT --protocol tcp --dport 113 -j ACCEPT</command></screen>
      </listitem>
     </itemizedlist>

    <para>
     Pour le tester:
    </para>

     <itemizedlist>
     <listitem>
      <para>
       Essayez de vous connecter sur Internet depuis une machine cliente 
       en utilisant une adresse IP.  L'adresse IP de Google est 64.233.183.103
       (enfin, l'une d'entre elles) et vous devriez obtenir une réponse en retour
       Par exemple "<command>ping 64.233.183.103</command>"
       "<command>lynx 64.233.183.103</command>".
      </para>
     </listitem>
     <listitem>
      <para>
       Essazyez une connexion par nom, par exemple "<command>ping google.fr</command>" 
       "<command>lynx google.fr</command>" ou depuis Internet Explorer / netscape.
      </para>
     </listitem>
     </itemizedlist>

    <para>
     Où eth0 est l'interface réseau externe, et 123.12.23.43 est l'adresse ip
     de ce client.
    </para>

  </sect1>

<!-- Section1: FAQ -->

  <sect1 id="FAQ">
   <title>FAQ - Foire aux réclama****  Questions</title>
   <itemizedlist>
    <listitem>
     <para>
      Comment lister les règles appliquées?
     </para><para>
      - Essayez
      <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -L</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -t nat -L</command></screen>
     </para>
    </listitem>
    <listitem>
     <para>
      Je ne peux résoudre les adresses IP! Je tape 'www.microsoft.com' et cela m'indique
      qu'il ne le trouve pas!
     </para><para>
      - Assurez-vous d'avoir ajouté l'adresse IP du serveur dns sur les machines clientes
     </para>
    <listitem>   
     <para>    
      Cela ne fonctionne pas!  Il ne supporte pas iptables / NAT / SNAT / MASQ
     </para><para>
      - Téléchargez le dernier noyau et compilez-le avec le support iptables et full NAT.
     </para>
    </listitem>
    <listitem>
     <para>
      Cela ne marche pas!  Le masquerading ne fonctionne pas du tout! Meurs pourriture!
     </para><para>
      - Essayez <command>echo 1 > /proc/sys/net/ipv4/ip_forward</command>
     </para>
    </listitem>
    <listitem>
     <para>
      Cela ne fonctionne pas!  Je ne peux plus utiliser le réseau et je vous hais!
     </para><para>
      - Essayez 
      <screen format="linespecific">
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -F</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -t nat -F</command>
<prompt moreinfo="none">$&gt;</prompt> <command>iptables -t mangle -F</command></screen>
     </para><para>
     (Toutes les règles sont effacées) puis redémarrez les autres règles iptables.
     </para>
     <para>
      - Essayez<command>iptables -P FORWARD ACCEPT</command>
     </para>
    </listitem>
    <listitem>
     <para>
      Cela ne marche toujours pas!
     </para><para>
      - Hmm, la commande "<command>dmesg | tail</command>"  vous renvoie-t'elle des erreurs? 
	ou bien "<command>cat /var/log/messages | tail</command>" ?  Comme je le crains...
     </para>
    </listitem>
    <listitem>
     <para>
      Cela ne renvoit rien. Et cela ne fonctionne toujours pas!
     </para><para>
      - Je ne sais pas... mais vous devriez est capable de :
     </para><screen format="linespecific">
	1) pinguer l'extérieur depuis la passerelle
	2) pinguer les machines locales depuis la passerelle
	3) pinguer la passerelle depuis les machines locales</screen>
     <para>
      Et cela <emphasis>avant</emphasis> que vous n'appliquiez le masquerading   
     </para> 
    </listitem>
    <listitem>
     <para>
      Où dois-placer ces trucs?
     </para>
     <para>
      - Dans le fichier <filename>/etc/network/interfaces</filename>, ou 
	firewall.rc.  Si vous le placez dans le fichier interfaces, mettez le avant 
	l'activation de l'interface réseau externe, et placez "<command>iptables -t nat -F</command>"
	après la désactivation de celle-ci.
     </para>
    </listitem>
    <listitem>
     <para>
      How do I get it to only bring the ppp up on demand?
     </para><para>
      - Considérant que l'adresse IP de votre passerelle FAI est 23.43.12.43 pour le bien-fondé de l'argument, then
	rajoutez une ligne comme celle-ci:
     </para><para> 
	<command>:23.43.12.43</command>
     </para><para>
	à la fin du fichier<filename>/etc/ppp/peers/provider</filename>.
	(Pour une adresse IP dynamique). Pour une adresse IP statique :
	<command>external.ip.number:23.43.12.43</command> )
     </para><para>
	A la fin de ce fichier, rajoutez une nouvelle ligne:
     </para><para>
	<command>demand</command>
     </para><para>
	Le démon pppd restera en arrière-plan pour relancer la connection si elle est désactivée,
	jusqu'à ce que vous faites un "<command>ifdown ppp0</command>" ou un "<command>poff</command>", 
	à moins que vous n'ajoutiez une option "<command>nopersist</command>" , dans chaque cas pppd 
	s'arrêtera une fois la connection activée. Vous pouvez également ajouter une ligne "<command>idle 600</command>"
	pour déconnecter après 10 minutes d'inactivité.
     </para><para>
     </para>
    </listitem>
    <listitem>
     <para>
      La connection reste inactive!
      </para><para>
      - Tout d'abord, avez-vous effectué la procédure de connection?  Est-ce que cela fonctionne comme cela est supposé?
	Vérifiez le fichier<filename>/etc/ppp/peers/provider</filename>, et assurez-vous que votre connection marche bien
	avant d'essayer le masquerading.
      </para><para>
      - Deuxièmement, si cela ne marche pas ( cela m'est arrivé ), cela devient peut-être étrange, et
	vous devrez revenir à un noyau 2.4.3 et voir si cela marche à la place.. je ne sais
	pas pourquoi.
      </para>      
    </listitem>
    <listitem>
     <para>
      Je n'aime pas faire cela moi-même!  Je voudrais un script tout fait, une interface graphique.
     </para><para>
      - Bien sûr:  <ulink url="http://shorewall.sourceforge.net/">
	http://shorewall.sourceforge.net/</ulink>
     </para><para>
      A déguster sans restrictions!
     </para>
    </listitem>
    <listitem>
     <para>
      Dois-je considérer les modems comme ayant une adresse IP statique ou dynamique?
     </para><para>
      - Bonne question..  Vous devriez la placer en dynamique.
     </para>
    </listitem>
    <listitem>
     <para>
      Dois-je considérer les cartes réseaux DHCP comme ayant des adresses IP
      statiques ou dynamiques?
     </para><para>
      - Elles sont dynamiques.
     </para>
    </listitem>
    <listitem>
     <para>
      Comment traiter les services entrants?
     </para><para>
      - Essayez de laisser passer ou de rediriger les requêtes en provenance de ces ports IP - encore une fois,
      assurez-vous de les bloquer si nécessaire.
     </para>
    </listitem>
    <listitem>
     <para>
      Depuis les machines clientes, je peux pinguer l'adresse IP externe de la passerelle Linux,
      mais je ne peux accéder à internet.
     </para><para>
      - Okay, essayez un "<command>rmmod iptable_filter</command>" - Plus d'info lorsque je les recevrai.
     </para><para>
      - Assurez-vous de ne pas avoir activé le <emphasis>routage</emphasis> ou la
	<emphasis>passerelle</emphasis> - pour vérifier l'activation : 
	"<command>ps aux | grep -e routed -e gated</command>".
     </para><para>
      - Reportez-vous au site <ulink url="http://ipmasq.webhop.net/">http://ipmasq.webhop.net/</ulink>
     </para>
    </listitem>
    <listitem>
     <para>
      Comment visualiser les connections établies? Avec netstat...
     </para><para>
      - Essayez la commande cat /proc/net/ip_conntrack
     </para>
    </listitem>
    <listitem>
     <para>
      Je désire plus d'information sur le filtrage, le routage et autres trucs!
     </para><para>
      - Lisez le Guide Pratique du routage avancé
      http://ftp.traduc.org/doc-vf/HOWTO/telechargement/html-1page/Adv-Routing-HOWTO.html
     </para>
    </listitem>
    <listitem>
     <para>
      Ce guide pratique est une foutaise! Comment puis-je engueler le gars qui l'a écrit?
     </para><para>
      - Allez sur le canal #debian sur irc.opensource.net, et dénichez JohnFlux.
      - Envoyez-moi un email (JohnFlux) à tapselj0@cs.man.ac.uk
     </para>
    </listitem>
    <listitem>
     <para>
      Cet How-To est nul!  Comment puis-je obtenir de meilleurs versions?
     </para><para>
      - Essayez <ulink url="http://ipmasq.cjb.net">http://ipmasq.cjb.net</ulink>
     </para><para>
      - Consultez la LDP Masq-HOWTO.
     </para>
    </listitem>
    <listitem>
     <para>
      Sur quoi d'autres travaillez-vous?
     </para><para>
      Actuellement j'écris un guide simplifié pour Linux sur des missiles anti-missile.
      Il n'existe pas de bons guides pour débutants concernant la protection de votre système 
      en cas d'attaque nucléaire
      Les gens semblent penser que c'est une science armée ou autre..
     </para>
    </listitem>
   </itemizedlist>

  </sect1>
</article>


