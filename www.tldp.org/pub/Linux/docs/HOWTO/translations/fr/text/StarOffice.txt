
                             StarOffice mini-HOWTO

Matthew Borowski,
Adapté par Nat Makarévitch

   Version 0.8fr8b
     _________________________________________________________________

   _Installation de StarOffice (StarDivision, GmbH) sous Linux._
     _________________________________________________________________

1. Introduction

   Site de référence de la Version Originale

   La plus récente version française de ce texte se trouve sur son site
   de référence. Seule la diffusion des versions non modifiées est
   autorisée.

   L'ensemble logiciel _StarOffice_, rédigé en langage C et exploitant la
   bibliothèque Motif, rassemble plusieurs outils de bureautique :
     * StarWriter, traitement de texte
     * StarCalc, tableur
     * StarImage, logiciel de dessin
     * StarDraw, logiciel de dessin objet
     * StarChart, grapheur
     * StarMath, éditeur d'équations

   La version Linux de StarOffice est librement utilisable en dehors des
   contextes commerciaux mais tout utilisateur professionnel doit
   acquérir une licence dont le coût est pour le moment non déterminé.

   Seule la distribution _OpenLinux_ (commercialisée par Caldera) permet
   d'employer partout StarOffice.

1.1 Motif

   StarOffice utilise la version 2.0 de la bibliothèque Motif.
   _Motif 1.2_ ou _LessTif_ ne permettront donc pas d'exploiter le
   binaire dépendant de bibliothèques dynamiques.

   La version "statique" du programme, générée de façon à intégrer les
   bibliothèques, fonctionne partout mais induit une charge sévère du
   système.

   StarOffice fonctionne bien sur mon Pentium 100 disposant de 48 Mo de
   mémoire vive, sous Linux Red Hat 4.1 et Motif 2.0. Le chargement de la
   version "dynamique" exige beaucoup moins de ressources que la version
   "statique" et dure environ une minute.

2. Pour obtenir StarOffice

   La la plus récente disponible se trouve sur le serveur FTP de Lire le
   fichier "README.StarOffice" avant de télécharger les archives
   proposées.

   Ces fichiers se trouvent aussi sur d'autres serveurs FTP, par exemple
   (France métropolitaine) au LIP6

   Liste des archives à télécharger (cas de la version 3.1) :

     * StarOffice31-common.tar.gz
     * l'une des archives de documents standard et d'exemples :
          + StarOffice31-english.tar.gz (version anglaise) ou
          + StarOffice31-german.tar.gz (version allemande)
     * l'une des archives de binaires :
          + StarOffice31-dynbin (dynamiques) ou
          + StarOffice31-statbin.tar.gz (statiques)
     * (le cas échéant) StarOffice31-upgrade2final.tar.gz

   Note : l'éditeur Caldera propose aussi StarOffice, par exemple sous
   forme de CD-ROM vendu 7,99 dollars américains.

3. Installation

   Voici les étapes de l'installation de StarOffice :
     * l'utilisateur _root_ doit décompacter sous /usr/local les archives
       _tar_ fournies
     * chaque utilisateur doit lancer au moins une fois le programme
       d'installation locale
     * chaque utilisateur doit "sourcer" un fichier créé lors de
       l'installation locale
       (_ /.sd.sh_ or _ /.sd.csh_)
     * chaque utilisateur lira avec profit la section de ce document
       consacrée à LANG.

3.1 Bibliothèque C (libc)

   Les binaires de StarOffice reposent sur la version 5.4.4 de la
   bibliothèque C, et fonctionneront avec la libc 5.3, _mais_ le
   programme d'installation ne donne satisfaction qu'avec une version de
   libc au moins égale à 5.4.4.

   Une solution (non testée) permettant d'installer le logiciel sans
   mettre à jour consisterait à désarchiver une libc adéquate dans un
   répertoire temporaire puis à la référencer dans la variable
   d'environnement _LD_LIBRARY_PATH_ avant d'invoquer l'utilitaire
   d'installation.

   Il est inutile d'essayer d'employer une libc trop ancienne car la
   procédure d'installation échoue en ce cas avec le message d'erreur :
 line 1: Syntax error at token 'I' expected declarator;

  Mise à jour de la libc

   La plus récente version de la libc se nomme _libc-VERSION.bin.tar.gz_
   (par exemple _libc-5.4.33.bin.tar.gz_) et se trouve dans le répertoire
   /pub/linux/GCC des sites FTP (par exemple _ftp.lip6.fr_).

   En extraire le contenu dans un répertoire temporaire puis, en tant que
   root, copier le fichier libc.so.* dans le répertoire /lib. Établir
   ensuite le lien symbolique nécessaire à sa prise en charge grâce à la
   commande :
ln -sf /lib/libc.so.VERSION /lib/libc.so.5

   où _VERSION_ remplace le numéro de version.

   Les utilisateurs de la distribution Red Hat utiliseront plutôt le
   paquet _rpm_ adéquat.

   Le _Dr. Romano Giannetti_ (romano@iet.unipi.it) nous révèle comment
   installer sans mise à jour de la libc sur une machine Red Hat 4.2 avec
   libc5.3 :
    1. récupérer une libc.so.5.4.x, pas exemple sous forme de rpm (il se
       trouve dans le répertoire contrib des sites FTP). L'extraire dans
       un répertoire temporaire vide grâce à : rpm2cpio
       libc.so.5.4.x-y.rpm | cpio --extract --make-directories. La
       bibliothèque se trouvera dans le répertoire ./lib
    2. déplacer libc.so.5.4.x idans votre répertoire home. Puis (correct
       sous un shell de la famille sh): ln -s libc.so.5.4.x libc.so.5 ;
       export LD_LIBRARY_PATH=$HOME:/lib:/usr/lib
    3. invoquer setup

  Installation du programme

   Il suffit, en tant que _root_, d'extraire les archives de StarOffice
   sous /usr/local/ :
cd /usr/local
tar -xzvf NOM_DU_FICHIER.tar.gz

  Configuration

   Chaque futur utilisateur de StarOffice doit invoquer les commandes
   suivantes :
cd /usr/local/StarOffice-3.1
./setup

   puis opter pour la "standard installation". Il est recommandé
   d'accepter d'installer dans le chemin de répertoire proposé ("default
   installation path").

   StarOffice utilise un certain nombre de variables d'environnement. Les
   fichiers ~/.sd.sh (pour le shell Bourne) et ~/.sd.csh (pour le shell
   C) mettent en place les valeurs adéquates. Les utilisateurs de _bash_
   devront placer à la fin de leur fichier ~/.bashrc une ligne :
source ~/.sd.sh

   Cette nécessaire modification ne sera prise en charge que lors des
   connexions ("login") suivantes.

  Bogue de Caldera OpenLinux

   Phil Reardon indique que la procédure d'installation du StarOffice
   d'OpenLinux ajoute à l'un des chemins de répertoires un caractère '/'
   inutile. Pour résoudre ce problème il suffit de supprimer le premier
   caractère '/' apparaissant dans la ligne :
exec ${pfad:='.'}/linux-x86/bin/$name;;

   Il faut donc supprimer le '/' placé avant "linux-x86".

  Variable d'environnement LANG

   Les fichiers ~/.sd.sh et ~/.sd.csh lient la variable d'environnement
   _LANG_ à une valeur, ce qui oblige divers programmes (dont _Perl_ et
   _man_) à émettre des messages d'avertissement, par exemple : "warning:
   setlocale(LC_CTYPE, "")..." ou bien "Failed to open the message
   catalog man on the path NLSPATH=".

   Il suffit, pour s'en affranchir, de supprimer la ligne "LANG=us" de
   ~/.sd.sh et la ligne "setenv LANG us" de ~/.sd.csh.

   Merci à Adam L. Klein, de m'avoir indiqué cela.

4. Invocation

   Lancer au préalable une seule instance par machine de :
     * "svdaemon" afin de disposer de l'aide en ligne
     * "svportmap" afin d'assurer la communication entre les applications

   Pour invoquer StarOffice :

export LANG=fr
. ~/sd.sh
/usr/local/StarOffice-3.1/linux-x86/bin/soffice3

   Lors de la première invocation bien vérifier que les chemins des
   fichiers de configuration sont corrects (menu « options »).

   Les binaires sont abrités dans
   /usr/local/StarOffice-3.1/linux-x86/bin/ et se nomment soffice3,
   sdraw3, swriter3, scalc3, smath3, schart3 et simage3.

5. Astuces

   Voici diverses astuces communiquées par _Patrick D'Cruze_
   (pdcruze@netpal.com.au)

    1. Les variables d'environnement mises en place par .sd.sh (ou
       .sd.csh) polluent parfois les autres applications. J'ai donc
       supprimé leur "sourcing" dans mes fichiers d'initialisation du
       shell (par exemple .bash_profile). Puis ai copié le fichier .sd.sh
       sous le nom de /usr/local/bin/swriter et y ai ajouté une première
       ligne #! /bin/bash et une ligne exec swriter3 $* à la fin. Il
       suffisait dès lors de le rendre exécutable (chmod a+rx
       /usr/local/bin/swriter) afin de permettre à tout utilisateur, en
       l'invoquant, d'utiliser StarWriter.
    2. De nombreux utilisateurs affirment que le chargement de StarOffice
       exige beaucoup de temps (jusqu'à une minute). Ce délai correspond,
       selon les auteurs de la plupart des articles Usenet pertinents, à
       l'allocation de mémoire effectuée par l'éditeur de liens
       dynamiques ld.so pour chaque symbole référencé par Star Office. Ce
       dernier exploite un nombre élevé de bibliothèques, l'éditeur de
       liens explore par conséquent une quantité importante de fichiers.
       Une solution consiste à confiner StarOffice, grâce à chroot, dans
       une arborescence où se trouveront dupliquées les seules
       bibliothèques nécessaires (/usr/X11R6/lib, libc/libm et
       libg++/libstdc++), afin d'épargner à l'éditeur de liens dynamiques
       d'inutiles recherches. StarWriter, sur mon P13/32 Mo, démarre
       ainsi en 15 secondes.

6. Problèmes divers

   En cas de problème de fontes : chmod -R a+r
   /usr/local/StarOffice3.1/Xp3

   En cas de problème d'impression invoquer, en tant que root, les
   commandes suivantes :
     _________________________________________________________________

mkdir /tmp/XpSp_
mkdir /tmp/Xp_
mkdir /tmp/XpSp_/tmp
mkdir /tmp/Xp_/tmp
chgrp -R users /tmp/XpSp_
chgrp -R users /tmp/Xp_
     _________________________________________________________________

7. Autres sources d'information

     * StarDivision, en particulier le forum.
     * M. Hoennig, donc la GUILDE propose une adaptation en français.
       Voici un autre document traitant de Star Office (concerne surtout
       la Red Hat 5).

8. Section ajoutée dans l'adaptation en français

8.1 Francophones

   Voici comment faire fonctionner les touches mortes d'accentuation.

   Saisir les accents sous Applixware est possible grâce à une table
   xmodmap adéquate.
   JP Lecaille (SO 4 sous RH 5)

   Je précise que j'utilise la Red Hat 5.

   je décompresse so40_lnx_01.tar.gz dans le répertoire /usr/local, puis
   libc-5.4.44.bin.tar.gz dans le même répertoire (je ne me rappelle plus
   où j'ai trouvé la libc, je suppose que c'est accessible sur FTP
   Search).

   Ensuite je me place dans le répertoire /usr/local/Office40_Install/lib
   et je fais :

ln -s libc.so.5.4.44 libc.so
ln -s libc.so.5.4.44 libc.so.5
ln -s libm.so.5.0.9 libm.so
ln -s libm.so.5.0.9 libm.so.5

   J'édite le fichier setup du répertoire /usr/local/Office40_Install et
   je le change en :

#!/bin/sh
#
# StarOffice setup script
# (c) 1997, Star Division GmbH

cd `dirname $0`
sd_archive_path=`pwd`
sd_setup_binary=setup.bin
sd_platform=`uname -s`

# some platforms may need an additional search path for X11 shared libraries
case $sd_platform in
  SunOS)
         LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/openwin/lib
         export LD_LIBRARY_PATH
         ;;
      *)
         LD_LIBRARY_PATH=/usr/local/Office40_Install/lib/:$LD_LIBRARY_PATH
         export LD_LIBRARY_PATH
         ;;
esac

        export SAL_FONTPATH XPPATH

# execute setup binary
exec $sd_archive_path/$sd_setup_binary $*

   Il ne reste plus qu'à invoquer ~/Office40_Install/setup /net.

9. Contributions

   Merci de contacter l'auteur ou le traducteur de ce document si vous
   disposez d'informations intéressantes.

   Cette adaptation française doit beaucoup à J. Chion et à P. Vaur.

10. Copyright

   Ce document est (C) 1997 by Matthew Borowski.

   La redistribution de ce document par tout moyen électronique est
   permise sous condition qu'il demeure inchangé. Si vous voulez inclure
   ce document dans un CD-ROM ou un livre, demandez une autorisation
   auparavent (je préfère que les demandes soient effectuées par courrier
   électronique).

   L'auteur décline toute responsabilité quant à ce qui pourrait advenir
   directement ou indirectement du fait de l'utilisation de ce document.
   L'auteur n'est pas employé chez de StarDivision, GmbH ou Caldera, Inc.

   Commentaires et questions peuvent être adressés directement à l'auteur
   à mkb@poboxes.com.
