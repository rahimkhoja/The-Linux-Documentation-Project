
                        Linux-DOS-Win95-OS2 mini-HOWTO

Mike Harlan, r3mdh@raex.com

   v1.3.1, 11 November 1997
     _________________________________________________________________

   _Ce document présente la procédure pour faire coexister 4 systèmes
   d'exploitation sur un seul disque dur. Adaptation française par
   Sylvain Mielot (Mielot@multimania.com), Réalisée le 14 Mars 1999._
     _________________________________________________________________

   _Mise en garde :_
          Tout dommage causé par vous à une machine suite à la lecture de
          ce HOWTO reste VOTRE FAUTE. Quand vous lisez des informations
          concernant la suppression de partitions et le formatage de
          disques, réfléchissez. Rendez-vous compte que ces actions
          auront pour résultat la perte de vos données. Donc, SAUVEGARDEZ
          D'ABORD, ET SAUVEGARDEZ SOUVENT. Cela était le dernier
          avertissement.

   _Trucs pour rendre heureux les avocats :_
          Jusqu'à nouvel ordre, les documents HOWTO Linux sont
          copyrightés par leurs auteurs respectifs. Les documents HOWTO
          Linux peuvent être reproduits et distribués en entier ou en
          partie, par tout moyen physique ou électronique aussi longtemps
          que l'information de copyright est maintenue sur chaque copie.
          La redistribution commerciale est autorisée et encouragée.
          Toutefois l'auteur de ce document doit être mis au courant de
          ce genre de distribution.

          Toute traduction, adaptation, ou bien tout travail incorporant
          tout document HOWTO Linux doit posséder ce copyright. De cette
          manière, vous ne pouvez pas imposer de restriction à la
          distribution de ce document. Des exceptions peuvent être
          éventuellement accordées sous certaines conditions : contactez
          le coordinateur des HOWTO Linux à l'adresse donnée ci-dessous.

          En résumé, nous souhaitons voir diffuser l'information de la
          manière la plus large qui soit. Toutefois, nous souhaitons
          garder la maîtrise de ces documents et nous aimerions être
          consultés avant toute diffusion des HOWTO's.

          Si vous avez des questions, vous pouvez contacter Tim Bynum, le
          coordinateur des HOWTO Linux, à l'adresse électronique suivante
          linux-howto@sunsite.unc.edu.

   _Mise à jour depuis la version 1.3 :_

          + Mettez à jour mon adresse électronique. Mon adresse a changé
            de r3mdh@imperium.net vers r3mdh@raex.com.

   _Mise à jour depuis la version 1.0 :_

          + Mettez à jour mon adresse électronique. Mon adresse a changé
            de r3mdh@dax.cc.uakron.edu vers r3mdh@imperium.net.

   Maintenant...........que le spectacle commence !

1. Introduction

   Après plusieurs jours de lutte et de frustration, j'ai finalement
   réussi à accomplir ce que je voulais. J'ai un PC avec un disque dur de
   1,2Go et 16Mo de mémoire. Je voulais avoir 4 systèmes d'exploitation
   sur ma machine : MSDOS v6.22, Windows 95, OS/2, et Linux. Jusqu'à
   présent, je n'ai pas pu trouver de HOWTO Linux pour réussir à
   installer chacun de ces systèmes d'exploitation sur une machine et
   avoir la possibilité de démarrer sur chacun (Il est possible d'écrire
   les OS sur des partitions différentes, mais les faire démarrer sans
   être accroché au message "Démarrage de MSDOS" par exemple, était
   quelque chose que je devais réussir. Eh bien, après de nombreux essais
   et de nombreuses erreurs, j'ai trouvé la recette suivante pour réussir
   cet exploit :

   Avant de commencer la procédure d'installation pas-à-pas, laissez-moi
   vous donner un aperçu de ce que je souhaite accomplir :

<NAME>                      <SIZE>   <LABEL>  <PARTITION NUMBER>
---------------------------------------------------------------------
MSDOS v6.22                   11MB   P1       Primary Partition 1
---------------------------------------------------------------------
Windows '95                  350MB   P2       Primary Partition 2
---------------------------------------------------------------------
OS/2 Boot Manager              2MB   P3       Primary Partition 3
---------------------------------------------------------------------
DOS/Win Data                 511MB   E1       Primary Partition 4
OS/2 Warp 3.0                127MB   E2       Extended into 4 logical
Linux Slakware 3.2 Swap        XMB   E3       drives (sub-partitions)
Linux Slakware 3.2 Native  219-XMB   E4       labeled E1-E4
---------------------------------------------------------------------

   Qu'est-ce que cela signifie ? Laissez-moi vous l'expliquer. Tout
   d'abord, nous avons besoin d'utiliser les 4 partitions de notre disque
   dur. Les partitions 1 à 3 sont des partitions PRIMAIRES. Nous allons y
   installer MSDOS, Win95 et le gestionnaire de démarrage d'OS/2 (qui a
   besoin de sa propre partition). Il nous reste une partition libre.
   Mais nous voulons avoir un disque seulement pour les données du DOS et
   de Win95 (cela nous donnera une large place pour stocker tous les
   fichiers ZIP que nous téléchargeons depuis Internet, ainsi que les
   programmes et les données de Windows 95 que nous ne pouvons installer
   par manque de place sur la partition Win95), un disque pour OS/2 et
   deux pour Linux (une partition Linux native et une partition de swap).

   Plus tard, j'ai reçu de nombreuses remarques par e-mail pour savoir
   pourquoi j'avais fait 2 partitions séparées pour Win95 et pour le DOS,
   et une autre pour les données de Win95/DOS. Voici la réponse : faire
   des partitions séparées pour Win95 et DOS n'est pas nécessaire pour
   tout le monde. Peut-être que vous n'utilisez même plus le DOS.
   Peut-être que Win95 est votre réponse pour tous les logiciels écrits
   pour la plate-forme Microsoft. Très bien, mais il y a de nombreuses
   personnes qui utilisent encore le DOS et qui ne peuvent vivre sans.
   Parce que le DOS peut exécuter plus rapidement et plus efficacement
   les applications 16 bits ou parce que certains programmes DOS que vous
   pourriez utiliser ne fonctionnent pas sous Windows (le programme de
   configuration de la carte Gravis Ultrasound par exemple), vous devez
   être capable de démarrer sous DOS de temps à autre. Ce HOWTO a été
   écrit dans cet esprit. Si vous avez encore des difficultés à admettre
   que le mot "MSDOS" intervienne dans ce HOWTO, alors asseyez-vous et
   écrivez le LINUX-WIN95-OS/2-Seulement HOWTO. :)

   Retournons à présent au diagramme précédent. Comme je l'ai dit, nous
   avons 1 partition pour installer 4 choses dessus : DOS/Win (données),
   OS/2, et Linux native & swap. Cela peut être fait en créant ce que
   l'on appelle des disques logiques (ou partitions logiques en fonction
   du livre qu'on lit) avec une partition principale. Quand nous créons
   ces disques logiques avec une partition principale, nous nous référons
   à cette partition primaire comme une PARTITION ETENDUE, parce qu'elle
   s'étend au-delà de la zone d'une simple partition principale, et à la
   place contient plus de 3 sous-partitions (disques logiques). Perdu ?
   Si c'est le cas, vous pourriez lire le manuel d'OS/2 sur ce sujet. Il
   explique les choses de façon plus claire que je ne le fais.

   Maintenant, vous devez vous arracher les cheveux en vous disant : "il
   veut installer 4 trucs sur une partition étendue, mais il vient juste
   de dire qu'on ne peut avoir que 3 sous-partitions pour installer le
   tout !" Cela est vrai, tout au moins du point de vue de MS-DOS et
   d'OS/2. Mais l'un des puissants avantages de Linux va nous venir en
   aide : Linux peut créer plus de 3 sous-partitions sur une partition
   étendue. Combien exactement, je ne sais pas. Mais je sais qu'il peut
   créer AU MOINS 4 partitions (ce dont nous avons besoin). Donc, pendant
   les étapes de l'installation qui suit, gardez à l'esprit que lorsque
   nous créerons des partitions en utilisant un programme MS-DOS ou OS/2,
   nous ne pourrons créer que 3 disques logiques. Ensuite, en utilisant
   Linux, nous découperons l'une des partitions en deux. Pour
   l'essentiel, vous pouvez penser qu'il s'agit de tromper MS-DOS et OS/2
   en leur faisant voir 3 partitions, mais en réalité (et pour Linux) il
   y en a bien 4.

2. Procédure

   _NOTE :_
          Les nombres entre parenthèses sont les nombres de Méga-octets
          que j'ai utilisé sur mon disque dur de 1.2 Giga-octets.

   Maintenant, débutons la procédure pas à pas :
    1. Lancez view.exe sur le CD Linux Slakware et créez les deux
       disquettes Linux Boot et Linux Root. Pour plusieurs raisons, le
       programme Linux bootstrap appelle le disque Root la disquette
       Ramdisk. Je ferai référence à ce disque à partir de maintenant
       comme la disquette Ramdisk.
    2. Sauvegardez toutes les informations que vous souhaitez conserver
       sur une bande (ou sur tout autre moyen de sauvegarde dont vous
       disposez).
    3. Démarrez votre ordinateur avec votre disquette MSDOS
       d'installation n°1.
    4. Quand ``Starting MSDOS'' apparaît,appuyez sur F5 pour ne pas
       exécuter les fichiers config.sys et autoexec.bat.
    5. Lancez a:\fdisk.exe.
    6. Effacez toutes les partitions (vous aurez été prévenu : LA
       SUPPRESSION OU LA MODIFICATION D'UNE PARTITION PROVOQUERA LA PERTE
       DE TOUTES LES DONNEES SUR CETTE PARTITION !).
    7. Ajoutez une partion principale MSDOS. (11Mo)
    8. Formatez cette partition.
    9. Lancez a:\setup.exe pour installer MSDOS sur cette partition.
   10. Démarrez OS/2.
   11. Selectionnez "installation avancée".
   12. Lancez FDISK. (cela peut être fait pour vous si vous êtes dans le
       programme d'installation d'OS/2.)
   13. Ajoutez une partition primaire après la partition MSDOS. Cela va
       devenir notre partition Windows 95. (349Mo)
   14. Ajoutez le gestionnaire de démarrage à la prochaine partition
       primaire. (2Mo)
   15. Ajoutez une partition étendue.
   16. Ajoutez un disque logique à cette partition étendue. Cela va
       devenir la partie données de notre système MSDOS. (511Mo)
   17. Ajoutez un autre disque logique à la partition étendue. Cela va
       devenir notre système de fichier OS/2 HPFS (``High Performance
       File System''). (127Mo)
   18. Ajoutez un dernier disque logique à la partition étendue en
       utilisant tout l'espace disponible restant sur cette partition.
       Cela deviendra plus tard 2 partitions sous Linux -- notre
       partition de swap et notre partition native Linux. Mais, comme
       OS/2 (de la même façon que le DOS) ne peut écrire que sur 6
       partitions par disque (3 primaires et 3 disques logiques logés
       dans une partition étendue), nous ne pouvons en créer qu'une seule
       cette fois. Et nous DEVONS créer cette partition. Ne laissez pas
       d'espace libre en espérant que Linux pourra ensuite créer ses deux
       partitions. A cause de la façon de travailler du programme FDISK
       d'OS/2, l'ajout du dernier disque logique sur la partition étendue
       marque la FIN de cette partition. Vous ne pouvez _pas_ ajouter de
       partitions au-delà de ce point. Donc, en d'autres termes, la
       création de ce dernier disque logique sert à remplir l'espace pour
       Linux. Plus tard, nous détruirons cette partition pour en ajouter
       2 nouvelles dans l'espace à nouveau libéré.
   19. Ajoutez les partitions 1, 2, et 5 au gestionnaire de démarrage.
   20. Rendez la partition 5 installable. Votre écran FDISK devrait
       ressembler à ceci (ou à quelque chose comme ceci) :
       ______________________________________________________________


                               FDISK

Disk 1
___________________________________________________________________________

Partition Information
Name            Status          Access          FS Type         MBytes
___________________________________________________________________________

MSDOS           Bootable        C: Primary      FAT              11
WIN 95          Bootable         : Primary      FAT             350
                Startable        : Primary      BOOT MANAGER      2
                None            D: Logical      Unformatted     511
OS/2            Installable     E: Logical      FAT             127
                None            F: Logical      Unformatted     219
       ______________________________________________________________

   21. Continuez la procédure d'installation d'OS/2.
   22. Redémarrez et sélectionnez la partition 2 (Windows 95) à partir du
       gestionnaire de démarrage.
   23. Quand le message d'erreur du système d'exploitation apparaît,
       démarrez avec la disquette d'installation MSDOS. Nous avons
       sélectionné cette partition dans le but de ``cacher'' la partition
       MSDOS. Le gestionnaire de démarrage d'OS/2 est assez étrange. Pour
       chaque partition démarrable que nous avons (dans notre cas, MSDOS
       et OS/2), nous ne pouvons en avoir qu'une seule visible au même
       moment. Cela signifie que lorsque vous démarrez sur une partition,
       MSDOS par exemple, l'autre partition (Win95) est invisible. LES
       partitionS MSDOS et Win95 partagent une seule lettre de disque.
       C'est pourquoi, sous ``Access'' du diagramme ci-dessus, MSDOS a la
       lettre de disque C et Win95 n'en a pas. En de telles
       circonstances, MSDOS est visible avec la lettre C et Win95 est
       invisible sans aucune lettre de lecteur. Si vous aviez démarré
       Win95, ce serait l'inverse : MSDOS serait invisible sans lettre de
       lecteur et Win95 serait visible sur le lecteur C. _On ne peut pas
       accéder du tout à un disque invisible._ Si vous voulez copier des
       fichiers entre 2 disques dont seulement un peut être visible au
       même moment, vous devrez utiliser un disque (non démarrable)
       intermédiaire. Dans notre cas, le disque de données DOS/Win95
       (disque D 511Mo au-dessus) servira de disque commun. Vous pourriez
       demander : ``Ne pourrions-nous pas également démarrer avec
       Linux ?''. La réponse est oui, nous allons le faire. Mais ne nous
       embarrassons pas de ça à présent.
   24. Installez MSDOS sur la Partition 2 (nous avons besoin de cela pour
       installer Windows 95).
   25. Démarrez sur la Partition 2.
   26. Installez Windows 95 sur cette partition (si vous installez la
       version de mise à jour de Win95, vous devriez avoir besoin de la
       disquette d'installation n°1 de Win 3.1 prête à être insérée).
   27. Démarrez sur la Partition 1.
   28. Formatez la Partition 4.
   29. Restaurez les données DOS à partir d'une sauvegarde (si besoin)
       sur les partitions 1 et 4.
   30. Démarrez avec la disquette de Boot de Linux.
   31. Continuez avec la disquette Linux Ramdisk (Root).
   32. Quand vous êtes loggé en root et que l'invite # est affichée,
       tapez ``fdisk'' et appuyez sur entrée.
   33. Supprimez la dernière partition (celle qui a été créée à l'étape
       18).
   34. Ajoutez une partition de 16Mo et déclarez-la comme Linux Swap.
       (17Mo)
   35. Ajoutez une dernière partition avec les cylindres restant sur le
       disque et déclarez-la avec le type Linux native. (198Mo)
   36. Ecrivez les changements sur le secteur de démarrage et redémarrez.
   37. Quand vous avez l'invite # à nouveau, lancez setup.
   38. Installez Linux sur la dernière partition.
   39. Quand vous installez LILO, assurez-vous de l'installer sur la
       racine de la dernière partition (PAS sur le MBR, sinon vous
       détruiriez tout le travail fait dans ce HOWTO). Ajoutez seulement
       la dernière partition à LILO et positionnez le timer à zéro. En
       faisant cela, lorsque vous sélectionnez Linux à partir du
       gestionnaire de démarrage d'OS/2, LILO sera activé et démarrera
       Linux sur le disque logique de la partition étendue. Comme Linux
       est la seule partition que nous voulons activer à partir de LILO,
       nous n'avons pas besoin de timer (excepté si vous avez plus d'un
       noyau à charger. Dans ce cas, vous devriez placer le timer à plus
       de 0 seconde).
   40. Activez la partition de swap Linux (référez-vous au manuel
       d'installation et de démarrage de Linux de Matt Welsh pour cela).
   41. Démarrez OS/2.
   42. Exécutez FDISK.
   43. Ajoutez Linux au gestionnaire d'amorçage en utilisant le type de
       partition Linux NATIVE (type 83 _et non_ 82 !).

   Votre écran FDISK devrait maintenant ressembler à ceci (ou à quelque
   chose comme ceci) :
       ______________________________________________________________


                               FDISK

Disk 1
___________________________________________________________________________

Partition Information
Name            Status          Access          FS Type         MBytes
___________________________________________________________________________

MSDOS           Bootable        C: Primary      FAT              11
WIN 95          Bootable         : Primary      FAT             350
                Startable        : Primary      BOOT MANAGER      2
                None            D: Logical      FAT             511
OS/2            Bootable        E: Logical      HPFS            127
                None             : Logical      Type 82          17
Linux           Bootable         : Logical      Type 83         198
       ______________________________________________________________

   ...Et voilà, c'est fini !

   Envoyez-moi vos commentaires/suggestions/problèmes (en dernier
   ressort, s'il vous plaît!) à l'adresse électronique suivante :
   r3mdh@raex.com.

   Mike Harlan, 11 NOV 1997
