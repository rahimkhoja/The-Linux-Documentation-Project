<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Kerberos Infrastructure HOWTO</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"></HEAD
><BODY
CLASS="article"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="title"
><A
NAME="AEN2"
>Kerberos Infrastructure HOWTO</A
></H1
><H3
CLASS="author"
><A
NAME="AEN4"
>V. Alex Brennen</A
></H3
><DIV
CLASS="affiliation"
><DIV
CLASS="address"
><P
CLASS="address"
><CODE
CLASS="email"
>&#60;<A
HREF="mailto:vab@cryptnet.net"
>vab@cryptnet.net</A
>&#62;</CODE
></P
></DIV
></DIV
><P
CLASS="pubdate"
>2004-05-29<BR></P
><DIV
CLASS="revhistory"
><TABLE
WIDTH="100%"
BORDER="0"
><TR
><TH
ALIGN="LEFT"
VALIGN="TOP"
COLSPAN="3"
><B
>Diario delle Revisioni</B
></TH
></TR
><TR
><TD
ALIGN="LEFT"
>Revisione 2.0.0</TD
><TD
ALIGN="LEFT"
>2004-05-28</TD
><TD
ALIGN="LEFT"
>Revisionato da: VAB</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
>Conversion to DocBook XML. General Content Updates,
		including incorporation of Technical and Metadata/Markup Reviews.</TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revisione 1.0.3</TD
><TD
ALIGN="LEFT"
>2003-04-01</TD
><TD
ALIGN="LEFT"
>Revisionato da: VAB</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
>Minor Updates, Minor Corrections, Additional links added.</TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revisione 1.0.2</TD
><TD
ALIGN="LEFT"
>2002-09-13</TD
><TD
ALIGN="LEFT"
>Revisionato da: VAB</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
>Minor Updates, Minor Corrections, Added 8.6, Additional links added.</TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revisione 1.0.1</TD
><TD
ALIGN="LEFT"
>2002-07-15</TD
><TD
ALIGN="LEFT"
>Revisionato da: VAB</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
>Minor Updates, Fixes.</TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revisione 1.0.0</TD
><TD
ALIGN="LEFT"
>2002-06-13</TD
><TD
ALIGN="LEFT"
>Revisionato da: VAB</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
>Initial Release.</TD
></TR
></TABLE
></DIV
><DIV
><DIV
CLASS="abstract"
><P
></P
><A
NAME="AEN45"
></A
><P
>Questo documento descrive il progetto e la configurazione di una infrastruttura Kerberos per la gestione dell'autenticazione su GNU/Linux. Illustra in dettaglio i passi da seguire, secondo le buone prassi, per installare un server o un software basato su Kerberos e per effettuare la conversione dei sistemi preesistenti; risponde inoltre alle domande più frequenti.
</P
><P
>&#13;Traduzione di Lorenzo Vaina 
<SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>work [at] vaina [dot] it</I
></SPAN
>
</P
><P
>&#13;Revisione della traduzione a cura di Marco Curreli
<SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>marcocurreli [at] tiscali [dot] it</I
></SPAN
>
</P
><P
></P
></DIV
></DIV
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Sommario</B
></DT
><DT
>1. <A
HREF="#about"
>A proposito di questo documento</A
></DT
><DD
><DL
><DT
>1.1. <A
HREF="#general"
>Informazioni generali</A
></DT
><DT
>1.2. <A
HREF="#translations"
>Traduzioni</A
></DT
><DT
>1.3. <A
HREF="#credits"
>Contributi e ringraziamenti</A
></DT
><DT
>1.4. <A
HREF="#feedback"
>Feedback</A
></DT
></DL
></DD
><DT
>2. <A
HREF="#overview"
>Una vista di insieme dell'infrastruttura di Kerberos</A
></DT
><DD
><DL
><DT
>2.1. <A
HREF="#intro"
>Introduzione a Kerberos</A
></DT
><DT
>2.2. <A
HREF="#benefits"
>I benefici di Kerberos</A
></DT
><DT
>2.3. <A
HREF="#howitworks"
>Come funziona Kerberos</A
></DT
><DT
>2.4. <A
HREF="#compromise"
>Compromissione dell'infrastruttura Kerberos</A
></DT
></DL
></DD
><DT
>3. <A
HREF="#install"
>Installazione e configurazione</A
></DT
><DD
><DL
><DT
>3.1. <A
HREF="#machine-configure"
>Descrizione generale della configurazione della macchina</A
></DT
><DT
>3.2. <A
HREF="#hardware"
>Hardware</A
></DT
><DT
>3.3. <A
HREF="#gnulinux-install"
>Installazione di GNU Linux</A
></DT
><DT
>3.4. <A
HREF="#realm"
>La scelta del realm</A
></DT
><DT
>3.5. <A
HREF="#configure"
>Configurazione del software Kerberos</A
></DT
><DT
>3.6. <A
HREF="#principal-creation"
>Creazione dei principal</A
></DT
></DL
></DD
><DT
>4. <A
HREF="#time-sync"
>Sincronizzazione del tempo</A
></DT
><DD
><DL
><DT
>4.1. <A
HREF="#time-sync-importance"
>L'importanza della sincronia temporale</A
></DT
><DT
>4.2. <A
HREF="#intro-ntp"
>Introduzione a NTP</A
></DT
><DT
>4.3. <A
HREF="#ntp-install"
>Installazione e configurazione di NTP</A
></DT
></DL
></DD
><DT
>5. <A
HREF="#server-replication"
>Replica del server Kerberos</A
></DT
><DD
><DL
><DT
>5.1. <A
HREF="#replication"
>Descrizione della replica</A
></DT
><DT
>5.2. <A
HREF="#implementation"
>Implementazione</A
></DT
><DT
>5.3. <A
HREF="#maintain"
>Manutenzione</A
></DT
></DL
></DD
><DT
>6. <A
HREF="#client-configure"
>Configurazione dei client</A
></DT
><DD
><DL
><DT
>6.1. <A
HREF="#client"
>Configurazione generale dei client GNU Linux</A
></DT
><DT
>6.2. <A
HREF="#pam"
>PAM</A
></DT
><DT
>6.3. <A
HREF="#apache"
>Il server web Apache</A
></DT
><DT
>6.4. <A
HREF="#microsoft"
>Microsoft Windows</A
></DT
></DL
></DD
><DT
>7. <A
HREF="#programming"
>La programmazione con Kerberos</A
></DT
><DD
><DL
><DT
>7.1. <A
HREF="#api"
>L'API di Kerberos</A
></DT
></DL
></DD
><DT
>A. <A
HREF="#sources"
>Fonti di approfondimento</A
></DT
><DD
><DL
><DT
>A.1. <A
HREF="#links"
>Collegamenti a documenti pertinenti</A
></DT
><DT
>A.2. <A
HREF="#websites"
>Siti web di interesse</A
></DT
><DT
>A.3. <A
HREF="#rfc"
>RFC sull'argomento</A
></DT
><DT
>A.4. <A
HREF="#other-ref"
>Altri riferimenti</A
></DT
><DT
>A.5. <A
HREF="#resources"
>Risorse aggiuntive</A
></DT
><DT
>A.6. <A
HREF="#companies"
>Imprese che forniscono consulenza specializzata su Kerberos</A
></DT
></DL
></DD
><DT
><A
HREF="#AEN481"
>Glossario dei termini</A
></DT
></DL
></DIV
><DIV
CLASS="section"
><H2
CLASS="section"
><A
NAME="about"
>1. A proposito di questo documento</A
></H2
><DIV
CLASS="section"
><H3
CLASS="section"
><A
NAME="general"
>1.1. Informazioni generali</A
></H3
><P
>&#13;Copyright (c) 2002-2004  <A
HREF="http://cryptnet.net/people/vab/"
TARGET="_top"
>V. Alex Brennen</A
> (<A
HREF="http://cryptnet.net/people/vab/"
TARGET="_top"
>VAB</A
>).
</P
><P
>&#13;Questo documento appartiene al pubblico dominio.
</P
><P
>&#13;Questo documento è pubblicato all'indirizzo: <A
HREF="http://cryptnet.net/fdp/admin/kerby-infra/en/kerby-infra.html"
TARGET="_top"
>http://cryptnet.net/fdp/admin/kerby-infra/en/kerby-infra.html</A
>
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="translations"
>1.2. Traduzioni</A
></H3
><P
>&#13;Al momento questo documento è disponibile nelle seguenti lingue:
</P
><P
></P
><UL
><LI
><P
>&#13;[<A
HREF="http://cryptnet.net/fdp/admin/kerby-infra/en/kerby-infra.html"
TARGET="_top"
>en</A
>] English
</P
></LI
><LI
><P
>&#13;[<A
HREF="http://www.pluto.it/ildp/howto/kerberos-infrastructure"
TARGET="_top"
>it</A
>] Italiano
</P
></LI
></UL
><P
>&#13;Se conoscete una traduzione o intendete tradurlo in un'altra lingua  <A
HREF="mailto:vab@cryptnet.net"
TARGET="_top"
>informatemi</A
> in modo che io possa distribuire la traduzione o riferirla con un link.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="credits"
>1.3. Contributi e ringraziamenti</A
></H3
><P
></P
><UL
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/people/vab/"
TARGET="_top"
>V. Alex Brennen</A
> (<A
HREF="http://cryptnet.net/people/vab/"
TARGET="_top"
>VAB</A
>) <CODE
CLASS="email"
>&#60;<A
HREF="mailto:vab (at) cryptnet.net"
>vab (at) cryptnet.net</A
>&#62;</CODE
> (Autore principale)
</P
></LI
><LI
><P
>&#13;<A
HREF="http://kolya.net/"
TARGET="_top"
>Nickolai Zeldovich</A
> <CODE
CLASS="email"
>&#60;<A
HREF="mailto:kolya (at) zepa.net"
>kolya (at) zepa.net</A
>&#62;</CODE
> (Suggerimenti e correzioni tecniche)
</P
></LI
></UL
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="feedback"
>1.4. Feedback</A
></H3
><P
>&#13;Per favore inviate le vostre aggiunte, commenti, correzioni e critiche a questo indirizzo di posta elettronica: <CODE
CLASS="email"
>&#60;<A
HREF="mailto:vab@cryptnet.net"
>vab@cryptnet.net</A
>&#62;</CODE
>.
</P
></DIV
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="overview"
>2. Una vista di insieme dell'infrastruttura di Kerberos</A
></H2
><DIV
CLASS="section"
><H3
CLASS="section"
><A
NAME="intro"
>2.1. Introduzione a Kerberos</A
></H3
><P
>&#13;Kerberos è un sistema di autenticazione sviluppato dal MIT nell'ambito del progetto Athena. Kerberos usa la crittografia e una terza parte fidata, un arbitro, per eseguire l'autenticazione in maniera sicura attraverso una rete non sicura. In particolare Kerberos usa dei ticket cifrati per evitare di trasmettere le password come testo in chiaro attraverso la rete; Kerberos si basa sul protocollo di Needham e Schroeder.
</P
><P
>&#13;Adesso sono in uso due versioni di kerberos: la 4 e la 5. Le versioni dalla 1 alla 3 erano versioni interne di sviluppo e non sono mai state pubblicate; la versione 4 ha alcune lacune di sicurezza a non dovrebbe più essere usata. Questo documento tratta soltanto di Kerberos 5, definito nel <A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1510.txt"
TARGET="_top"
>RFC1510</A
>.
</P
><P
>&#13;La locuzione Infrastruttura Kerberos si riferisce alla configurazione del software, del server e del client che permettono a un amministratore di usare il protocollo Kerberos per realizzare l'autenticazione sulla rete.
Precisamente, l'infrastruttura kerberos consiste nel software Kerberos stesso, in alcuni server di autenticazione ridondanti posti in sicurezza, in un deposito centralizzato di account e password e nei sistemi configurati per usare Kerberos come protocollo di autenticazione.
Questo documento permetterà di apprendere i passi necessari per installare, configurare e distribuire una tale infrastruttura.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="benefits"
>2.2. I benefici di Kerberos</A
></H3
><P
>&#13;Chi non ha confidenza col protocollo kerberos potrebbe non aver chiaro quali siano i benefici che comporta distribuirlo sulla rete; comunque tutti gli amministratori hanno confidenza con i problemi che Kerberos dovrebbe mitigare. Alcuni di questi problemi sono l'intercettazione della password in transito sulla rete (sniffing), la lettura abusiva del file o del database delle password (stealing), e gli sforzi che si devono sostenere per mantenere un vasto numero di database degli account.
</P
><P
>&#13;Un' infrastruttura kerberos distribuita in modo appropriato costituisce un buon punto di partenza per la soluzione dei problemi cui si è accennato e aumenta la sicurezza dell'organizzazione. L'uso di Kerberos evita che le password siano trasmesse in chiaro sulla rete; inoltre il sistema centralizza le informazioni sulle credenziali semplificandone la gestione e la manutenzione. Infine l'utilizzo di Kerberos evita di dover conservare le password localmente sulla macchina, riducendo la probabilità che la compromissione di una singola macchina comporti ulteriori violazioni.
</P
><P
>&#13;Riassumendo, in una grande impresa i benefici di Kerberos si traduranno in minori costi amministrativi attraverso una gestione più semplice di account e password e attraverso il miglioramento nella sicurezza della rete. In un ambiente più piccolo i benefici più evidenti sono costituiti dalla scalabilità dell'infrastruttura di autenticazione e dal miglioramento della sicurezza della rete.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="howitworks"
>2.3. Come funziona Kerberos</A
></H3
><P
>&#13;Il protocollo di autenticazione Kerberos usa un segreto condiviso e una terza parte fidata, con ruolo di arbitro, per convalidare l'identità dei client, che possono essere utenti, server o programmi. La terza parte fidata è un server chiamato Key Distribution Center (KDC) che esegue i dèmoni Kerberos. Il segreto condiviso è la password dell'utente trasformata in chiave crittografica; per i server e i sistemi software è generata una chiave casuale.
</P
><P
>&#13;In Kerberos gli utenti sono detti "principal"; il KDC conserva un database dei principal e delle chiavi segrete che essi usano per autenticarsi. In Kerberos la conoscenza della chiave segreta è considerata una valida dimostrazione di identità, perciò il server Kerberos è affidabile per autenticare ogni client nei confronti di ogni altro client. Con Kerberos l'autenticazione è ottentuta senza trasmettere alcuna password in chiaro attraverso la rete. Nel seguito sarà spiegata la corrispondenza fra il protocollo Kerberos e il software Kerberos in GNU Linux.
</P
><P
>&#13;Il KDC esegue i due importanti dèmoni Kerberos <SPAN
CLASS="application"
>kadmind</SPAN
> e <SPAN
CLASS="application"
>krb5kdc</SPAN
>. Una convenzione di denominazione in GNU Linux prevede che i processi il cui nome inizia per <SPAN
CLASS="QUOTE"
>"k"</SPAN
> siano attinenti al kernel o eseguiti nello spazio del kernel; invece <SPAN
CLASS="application"
>krb5kdc</SPAN
> e <SPAN
CLASS="application"
>kadmind</SPAN
> sono eseguiti in spazio utente.
</P
><P
>&#13;<SPAN
CLASS="application"
>kadmind</SPAN
> è il demone amministrativo di Kerberos; <SPAN
CLASS="application"
>kadmind</SPAN
> si usa attraverso il programma <SPAN
CLASS="application"
>kadmin</SPAN
> per la manutenzione del database dei principal e la configurazione dei criteri.  Se si sceglie di non permettere il login remoto tramite <SPAN
CLASS="application"
>ssh</SPAN
> sulla macchina Kerberos, <SPAN
CLASS="application"
>kadmin</SPAN
> consente l'amministrazione remota dei componenti Kerberos del server.
</P
><P
>&#13;<SPAN
CLASS="application"
>krb5kdc</SPAN
> è la bestia da soma del server Kerberos, vestendo il ruolo di terza parte fidata nel processo di autenticazione. Quando un utente vuole autenticarsi presso un sistema o un servizio, chiede un ticket al KDC. Un ticket è un datagramma che contiene l'identità del client, una chiave di sessione, una marcatura oraria e altre indicazioni; il datagramma è cifrato con la chiave segreta del server.
</P
><P
>&#13;Descrivendo il processo più in dettaglio, esso inizia con la richiesta di autenticazione che è trasmessa al demone <SPAN
CLASS="application"
>krb5kdc</SPAN
>.  Quest'ultimo, ricevuta la richiesta, cerca il client, cioè il principal, nel database dei principal per autenticarlo; legge la chiave segreta del client nel database e cifra un ticket speciale detto Ticket Granting Ticket (TGT), che invia al client. Il client riceve il TGT cifrato che contiene una chiave di sessione; se il client conosce la password (la chiave segreta che è conservata nel database dei principal) può decifrare il TGT, quindi lo cifra con la chiave di sessione, che è contenuta nel TGT stesso, per presentarlo a un Ticket Granting Service (TGS). Il TGS rilascia un ulteriore Ticket che consentirà al client di ottenere l'autenticazione presso uno specifico sistema o servizio.
</P
><P
>&#13;L'autenticazione sicura si realizza tramite l'uso di ticket cifrati che possono essere decifrati soltanto se il client conosce la chiave segreta. Il ticket contiene informazioni sull'orario per prevenire attacchi di replica, che consistono in rappresentazioni fraudolente di un ticket rilasciato precedentemente, per ottenere un accesso illecito.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="compromise"
>2.4. Compromissione dell'infrastruttura Kerberos</A
></H3
><P
>&#13;Il primo modo in cui un aggressore può tentare di compromettere un'infrastruttura Kerberos è attaccando il server Kerberos; se l'aggressore riuscisse a ottenere un accesso di root al KDC egli avrebbe accesso al database delle password cifrate dei principal. In questo modo l'aggressore potrebbe accedere anche al software Kerberos e ai file di configurazione e modificarli per fare in modo che il sistema consenta delle autenticazioni che non dovrebbero avere successo.
</P
><P
>&#13;Tra gli altri metodi per attaccare l'infrastruttura di Kerberos vanno citati gli attacchi di replica (replay attack) e i tentativi di indovinare la password (password guessing attack). Un attacco di replica si esplica intercettando o acquisendo altrimenti un ticket Kerberos e utilizzandolo fraudolentemente per tentare di ottenere l'autenticazione. Per provare a indovinare la password si possono intercettare dei ticket Kerberos sulla rete per decifrarli mediante un attacco di forza bruta.
</P
><P
>&#13;Un aggressore può sfruttare le vulnerabilità del software vetusto ancora presente nell'infrastruttura; per esempio sono noti parecchi problemi con la versione 4 di Kerberos il più importante dei quali è una fondamentale debolezza nel protocollo usato per la crittografia. Il progetto di Kerberos versione 4 contempla l'uso di DES in modalità normale che permette a un aggressore di intercettare e modificare il testo cifrato del ticket senza lasciare tracce. Per prevenire questi attacchi Kerberos è stato modificato nella versione 5 che usa triple DES in modalità Cipher Block Chaining (CBC).
</P
><P
>&#13;Trattando della robustezza della versione 4 di Kerberos è importante notare anche che parecchie implementazioni soffrono di vulnerabilità di superamento del buffer (buffer overflow). Le implementazioni di riferimento di Kerberos versione 5 hanno riparato le vulnerabilità di superamento del buffer presenti nella versione 4 ma le distribuzioni della versione 5 generalmente forniscono programmi che consentono la compatibilità all'indietro e supportano le applicazioni preesistenti progettate per Kerberos 4; si ritiene che il codice compatibile presente nella versione 5 sia ancora vulnerabile agli attacchi di buffer overflow.
</P
><P
>&#13;Quindi, visti i problemi del protocollo della versione 4 e le potenziali vulnerabilità di superamento del buffer, è meglio non supportare né usare Kerberos versione 4.
</P
><P
>&#13;Riassumendo, da questa descrizione su come sia possibile compromettere un'infrastruttura Kerberos, si comprende che la sicurezza dello stesso server Kerberos è un'esigenza prioritaria; bisogna poi eseguire software Kerberos aggiornato e restare vigili scegliendo buone password e predisponendo buoni criteri per le password.
</P
></DIV
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="install"
>3. Installazione e configurazione</A
></H2
><DIV
CLASS="section"
><H3
CLASS="section"
><A
NAME="machine-configure"
>3.1. Descrizione generale della configurazione della macchina</A
></H3
><P
>&#13;Questa sezione del documento descrive l'installazione e la configurazione delle macchine e del software che svolge il ruolo di KDC. È possibile intervenire con aggiustamenti sulle configurazioni suggerite ma saranno presentati alcuni punti chiave che è importante tenere a mente quando si configura il KDC e anche se si sceglie di praticare una strategia di configurazione alternativa è necessario aver compreso il materiale che viene presentato quì.
</P
><P
>&#13;Le macchine eseguono il demone Kerberos e conservano le password e le informazioni sui criteri, perciò è molto importante per la salvaguardia della rete che questi server siano messi in sicurezza. Bisognerà prendere ogni misura possibile per scongiurare la compromissione di questi server; le raccomandazioni per la sicurezza contenute in questa sezione rivestono fondamentale importanza.
</P
><P
>&#13;La raccomandazione principale è di usare macchine dedicate per erogare il servizio KDC di kerberos; l'hardware dovrà essere inaccessibile alle minacce materiali e anche il sistema GNU Linux andrà rinforzato il più possibile. Dalla compromissione del KDC deriverebbe la compromissione dell'intera infrastruttura Kerberos.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="hardware"
>3.2. Hardware</A
></H3
><P
>&#13;Il servizio Kerberos non ha grosse richieste riguardo all'hardware e ha capacità di ridondanza, quindi l'hardware del server può essere esiguo. Per i server Kerberos che ho distribuito ho usato macchine con un processore Pentium III e due dischi in RAID 1 hardware, sufficienti per svolgere da quaranta a centomila autenticazioni al giorno. Anche se il server può essere dotato di schede di rete ridondanti, bisogna evitare di tenerle attive entrambe contemporaneamente perché Kerberos scrive l'indirizzo IP del KDC nei ticket e se durante il processo di autenticazione il client contatta il KDC attraverso interfacce multiple possono insorgere difficoltà.
</P
><P
>&#13;È importante evidenziare che il servizio Kerberos andrebbe eseguito su hardware dedicato. Riservare una macchina a Kerberos significa che soltanto gli amministratori di Kerberos avranno bisogno di accedere a quella macchina e che sulla macchina non saranno in esecuzione altri servizi, salvo probabilmente SSH. Tutte le password degli utenti saranno conservate presso i server Kerberos, quindi sarà bene limitare il più possibile l'accesso fisico alle macchine interessate; usando hardware riservato a Kerberos sarà più semplice adempiere a questo requisito, magari chiudendo il server con la sua console in un proprio armadio.
</P
><P
>&#13;Per approfittare della capacità nativa di Kerberos di fornire ridondanza bisogna avere almeno due macchine che funzionano da KDC. Kerberos è progettato per essere distribuito con un server principale (master) e uno o più server secondari (slave); non c'è limite al numero di secondari.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="gnulinux-install"
>3.3. Installazione di GNU Linux</A
></H3
><P
>&#13;Installando GNU Linux su server dedicati all'esecuzione dei servizi kerberos si percorreranno ulteriori passi per garantirne la sicurezza.
</P
><P
>&#13;Per prima cosa si installerà soltanto il software assolutamente necessario per il servizio Kerberos, costituito dal sistema operativo di base e dai pacchetti Kerberos, escludendo X e qualunque applicazione grafica. SSH è opzionale e andrà installato se si desidera poter amministrare i server a distanza; del resto i server saranno parecchio più sicuri se si permetterà di accedervi soltanto mediante il terminale collegato direttamente ad essi.
</P
><P
>&#13;In un sistema GNU Linux basato su Fedora Core, il servizio kerberos è fornito dai pacchetti:
<PRE
CLASS="screen"
>&#13;krb5-server
krb5-libs
</PRE
>
</P
><P
>&#13;La documentazione e le librerie di sviluppo non andranno installate sul KDC perché non si intende usare questa macchina per altre attività che non siano l'espletamento del servizio KDC.
</P
><P
>&#13;Nel passo successivo ci si accerterà che non vi siano porte aperte oltre a quelle necessarie e che tutti gli aggiornamenti di sicurezza siano stati applicati. Il procedimento per controllare quali aggiornamenti di sicurezza vanno applicati dipende dal programma di gestione dei pacchetti in uso. Per determinare su quali porte la macchina è in ascolto si può usare il comando <SPAN
CLASS="application"
>netstat</SPAN
>; per esempio su una macchina che ha in esecuzione soltanto ssh, si leggerà:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;bash$ netstat -an | grep -i listen | less
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN
</PRE
>
</P
><P
>&#13;Infine si dovrà configurare il server in modo che possano accedervi soltanto i server che devono comunicare con lui per esigenze di autenticazione, editando i file <TT
CLASS="filename"
>/etc/hosts.allow</TT
> and <TT
CLASS="filename"
>/etc/hosts.deny</TT
> insieme al file <TT
CLASS="filename"
>iptables</TT
>.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="realm"
>3.4. La scelta del realm</A
></H3
><P
>&#13;I nomi dei realm [domini di protezione] sono sensibili alle maiuscole e devono esere unici sulla rete; è buona pratica usare come nome del realm il nome del dominio di secondo livello scritto in lettere maiuscole. Se si sta configurando Kerberos soltanto per una sottorete anziché per la rete intera, si potrebbe usare un nome di dominio figlio da far corrispondere alla sottorete.
</P
><P
>&#13;Quando si sceglie la topologia dei realm si deve prendere in considerazione l'assetto complessivo dell'organizzazione; se si hanno uffici remoti o sottogruppi indipendenti è bene che essi appartengano a un realm separato. La topologia dei realm di Kerberos deve riflettere la topologia del sistema di gestione e non la struttura fisica della rete.
</P
><P
>&#13;Infine si dovrà tener presente l'esistenza di sistemi preesistenti, come distribuzioni precedenti di Kerberos o raggruppamenti di rete che si intende mantenere (per esempio domini di Windows NT).
</P
><P
>&#13;Se si installa Kerberos in una rete che ne ospita già una distribuzione, nella rete globale o in una sottorete, bisogna evitare una collisione di nomi. Il caso più comune in cui succede di distribuire kerberos in un ambiente in cui è già stato installato precedentemente è dove esiste un cluster IBM SP; la soluzione migliore è creare appositamente per il cluster SP un realm con un nome di dominio almeno di terzo livello e usare un nome di dominio di secondo livello per il realm Kerberos principale.
</P
><P
>&#13;In questo documento si utilizzerà un esempio che aiuterà a illustrare il disegno e la configurazione di un'infrastruttura. Soggetto dell'esempio sarà una mitica università fondata per educare le persone ai contenuti liberi e per compiere ricerche sull'argomento, l'Università GNU di Dublino in Irlanda. L'esempio comprende due server Kerberos usati per autenticare gli studenti e il corpo docente. Il nome di dominio dell'università è gnud.ie quindi per il realm Kerberos si userà GNUD.IE.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="configure"
>3.5. Configurazione del software Kerberos</A
></H3
><P
>&#13;Adesso è necessario configurare Kerberos, creare un amministratore, determinare un criterio di sicurezza e inizializzare il database dei principal di Kerberos.
</P
><P
>&#13;Il primo passaggio consiste nell'editare il file di configurazione  <TT
CLASS="filename"
>/etc/krb5.conf</TT
>. In questo file si imposta il realm, si estende la definizione del realm specificando i server kerberos e infine si imposta il dominio del realm. Nell'esempio il contenuto del file è il seguente:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;default_realm = GNUD.IE

[realms]
 GNUD.IE = {
  kdc = kerberos1.gnud.ie:88
  kdc = kerberos2.gnud.ie:88
  admin_server = kerberos1.gnud.ie:749
  default_domain = gnud.ie
 }

[domain_realm]
 .gnud.ie = GNUD.IE
 gnud.ie = GNUD.IE
</PRE
>
</P
><P
>&#13;Il database di Kerberos si crea e inizializza con il comando:
<PRE
CLASS="screen"
>&#13;{Kerberos1}bash# /usr/Kerberos/sbin/kdb5_util create -s
</PRE
>
</P
><P
>&#13;Il flag <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>-s</I
></SPAN
> fa in modo che il KDC crei un file riservato per autenticare sé stesso; si usa il flag <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>-r</I
></SPAN
> per specificare un realm. Quando si crea un nuovo database è necessario specificare il realm soltanto se nel file <TT
CLASS="filename"
>krb5.conf</TT
> sono definiti più realm.
</P
><P
>&#13;A questo punto Kerberos domanderà di predisporre una master password per il database; è molto importante non dimenticarla. Non sarà possibile compiere alcuna azione amministrativa sul server se non si ricorderà la master password.
</P
><P
>&#13;Ora è necessario editare il file delle acl [access control list] sul KDC per concedere l'accesso come amministratore. Normalmente questo file si trova in <TT
CLASS="filename"
>/var/Kerberos/krb5kdc/kadm5.acl</TT
>. Può essere necessario specificarne la posizione nel file <TT
CLASS="filename"
>kdc.conf</TT
>, il cui percorso è precisato nel file <TT
CLASS="filename"
>/etc/krb5.conf</TT
> ed ha come valore predefinito <TT
CLASS="filename"
>/var/Kerberos/krb5kdc/kdc.conf</TT
>. Considerando l'esempio dell'Università GNU di Dublino si dovrà modificare il file delle acl perché contenga la riga:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;*/admin@GNUD.IE     *
</PRE
>
</P
><P
>&#13;Questa impostazione significa che a ogni account che termina con un /admin nel realm <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>GNUD.IE</I
></SPAN
> sono concessi tutti i diritti d'accesso.
</P
><P
>&#13;Una volta impostato l'accesso per gli utenti amministratori bisogna creare tali utenti; questo si fa utilizzando il comando <SPAN
CLASS="application"
>kadmin.local</SPAN
>, impartito da una shell di root sul KDC e usando il suo sottocomando <SPAN
CLASS="application"
>addprinc</SPAN
>. Di solito il nome dell'account amministrativo è <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>admin</I
></SPAN
>; nell'esempio della Università GNU di Dublino è scritto come:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;{Kerberos1}bash# /usr/Kerberos/sbin/kadmin.local -q "addprinc admin/admin"
</PRE
>
</P
><P
>&#13;Sul server andranno eseguiti i dèmoni  <SPAN
CLASS="application"
>krb5kdc</SPAN
> e <SPAN
CLASS="application"
>kadmin</SPAN
>. Se è necessario potrà essere eseguito anche <SPAN
CLASS="application"
>krb524</SPAN
> per fornire la compatibilità con i client Kerberos 4. Tuttavia prima di far partire <SPAN
CLASS="application"
>krb524</SPAN
> si rammenti l'avvertimento riguardante le debolezze nella sicurezza di Kerberos 4 e ci si accerti di avere davvero bisogno di questa funzionalità. Sui KDC si possono configurare i dèmoni <SPAN
CLASS="application"
>krb5kdc</SPAN
> e <SPAN
CLASS="application"
>kadmin</SPAN
> per avviarsi automaticamente, tramite il comando <SPAN
CLASS="application"
>chkconfig</SPAN
>.
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;{Kerberos1}bash# /sbin/chkconfig krb5kdc on
{Kerberos1}bash# /sbin/chkconfig kadmin on
</PRE
>
</P
><P
>&#13;Alternativamente si possono avviare manualmente, impartendo i comandi:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;{Kerberos1}bash# /etc/rc.d/init.d/krb5kdc start
{Kerberos1}bash# /etc/rc.d/init.d/kadmin start
</PRE
>
</P
><P
>&#13;Questo è sufficiente per ottenere un KDC funzionante.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="principal-creation"
>3.6. Creazione dei principal</A
></H3
><P
>&#13;Si crea un principal di Kerberos per un utente con il comando:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;{Kerberos1}bash# kadmin.local
{Kerberos1}kadmin.local: addprinc &#60;username&#62;
</PRE
>
</P
><P
>&#13;Se Kerberos deve supportare un vasto numero di account, si può scrivere uno script per creare i principal in massa.
</P
></DIV
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="time-sync"
>4. Sincronizzazione del tempo</A
></H2
><DIV
CLASS="section"
><H3
CLASS="section"
><A
NAME="time-sync-importance"
>4.1. L'importanza della sincronia temporale</A
></H3
><P
>&#13;La sicurezza di Kerberos è basata anche sui time stamp dei ticket perciò è d'importanza critica che gli orologi dei sever kerberos siano regolati con accuratezza. Come è stato discusso nell'introduzione a kerberos, i ticket hanno una scadenza breve per prevenire attacchi di forza bruta e attacchi di replica.
</P
><P
>&#13;Permettendo agli orologi di subire scostamenti si rende la rete vulnerabile a questi attacchi. A causa dell'importanza della sincronia degli orologi nella sicurezza del protocollo Kerberos, se gli orologi non sono sincronizzati entro un ragionevole intervallo Kerberos presenta errori fatali e smette di funzionare. I client che tentino di autenticarsi da una macchina con un orologio non accurato falliranno il tentativo di autenticazione presso il KDC a causa della differenza di ora con il suo orologio.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="intro-ntp"
>4.2. Introduzione a NTP</A
></H3
><P
>&#13;Per sincronizzare l'orario fra i server è disponibile il protocollo NTP (Network Time Protocol); esistono molti server NTP pubblici utilizzabili per la sincronizzazione. NTP può sincronizzare gli orologi dei client al millisecondo sulla LAN ed entro decine di millisecondi attraverso una WAN. I server NTP sono divisi in strati (stratum). I server NTP primari sono classificati come stratum 1; essi non devono essere usati per sincronizzare le macchine perché sono in numero esiguo. I server pubblici dello stratum 2 sono disponibili per la sinconizzazione dei client e a loro volta si sincronizzano con i server pubblici stratum 1. Si imposteranno i server Kerberos per interrogare tre server stratum 2 usando NTP. <A
HREF="http://support.ntp.org/bin/view/Servers/StratumTwoTimeServers"
TARGET="_top"
>Questa</A
> è una lista di server pubblici dello stratum 2 [aggiornato dal traduttore].
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="ntp-install"
>4.3. Installazione e configurazione di NTP</A
></H3
><P
>&#13;Per abilitare NTP in GNU Linux è necessario installare il pacchetto NTP ed editare il file di configurazione, che per impostazione predefinita è <TT
CLASS="filename"
>/etc/ntp.conf</TT
>. I valori della configurazione di default sono accettabili; bisogna soltanto aggiungere i server che si intende usare per sincronizzare l'orario. Non è necessario usare l'autenticazione ma si può farlo per aumentare la sicurezza; andrà usata se si utilizzano i server NTP della LAN. Quì c'è un esempio di file di configurazione per l'Università GNU di Dublino: <TT
CLASS="filename"
><A
HREF="http://cryptnet.net/fdp/admin/kerby-infra/en/ntp.conf"
TARGET="_top"
>ntp.conf</A
></TT
>. 
</P
><P
>&#13;Per ottenere l'effettiva sincronizzazione si imposta un job di cron:
<PRE
CLASS="screen"
>&#13;30 * * * * /usr/sbin/ntpdate -s
</PRE
>
</P
><P
>&#13;Se i sistemi si trovano dietro un firewall si userà <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>-su</I
></SPAN
> invece che soltanto <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>-s</I
></SPAN
>.  L'argomento <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>-u</I
></SPAN
> indica a ntpdate di usare porte non privilegiate per la connessione in uscita ai server  stratum 2.
</P
></DIV
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="server-replication"
>5. Replica del server Kerberos</A
></H2
><DIV
CLASS="section"
><H3
CLASS="section"
><A
NAME="replication"
>5.1. Descrizione della replica</A
></H3
><P
>&#13;Kerberos è stato progettato per permettere l'implementazione di un cluster di replica in configurazione master e slave. Un cluster Kerberos può consistere in qualunque numero di host; si raccomanda di schierarne almeno due: un master che funziona come server principale e almeno uno slave che resta disponibile come backup del master. I server master e slave sono anche detti rispettivamente server primario e server secondario.
</P
><P
>&#13;Kerberos conserva tutte le sue informazioni, relative agli account e ai criteri, in database applicativi; la distribuzione del software Kerberos comprende programmi per replicare, o copiare, questi dati sugli altri server.
</P
><P
>&#13;Le applicazioni client Kerberos sono progettate per tentare l'autenticazione sui server secondari se il server primario è indisponibile, quindi in caso di guasto non è necessario alcun provvedimento aggiuntivo per spostare il servizio di autenticazione di Kerberos sul server di backup. Invece le funzioni di amministrazione di Kerberos non sono interessate dal failover automatico.
</P
><P
>&#13;In caso di guasto del server primario, <SPAN
CLASS="application"
>kadmind</SPAN
> diventa indisponibile, quindi le funzioni di amministrazione non saranno utilizzabili finché il server primario non sarà riparato o sostituito. In particolare durante un guasto al server primario non si potranno effettuare la gestione dei principal, la creazione e la sostituzione delle chiavi.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="implementation"
>5.2. Implementazione</A
></H3
><P
>&#13;Per avviare la replica si impartisce il comando 
<SPAN
CLASS="application"
>kprop</SPAN
> sul master KDC; si può anche pianificarne l'esecuzione come job di cron per mantenere il database dei principal sincronizzato fra i server.
</P
><P
>&#13;Nell'impostazione della replica innanzitutto si configurano le ACL per 
 <SPAN
CLASS="application"
>kpropd</SPAN
>; il file delle ACL di <SPAN
CLASS="application"
>kpropd</SPAN
> per impostazione predefinita si trova nel percorso: <TT
CLASS="filename"
>/var/Kerberos/krb5kdc/kpropd.acl</TT
>. Nell'esempio esso conterrà le righe:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;host/kerberos1.gnud.ie@GNUD.IE
host/kerberos2.gnud.ie@GNUD.IE
</PRE
>
</P
><P
>&#13;Il file <TT
CLASS="filename"
>kpropd.acl</TT
> può esistere soltanto sui server Kerberos secondari; nei sistemi GNU Linux derivati da Fedora, <SPAN
CLASS="application"
>kadmin</SPAN
> non viene eseguito su un server Kerberos su cui sia presente il file <TT
CLASS="filename"
>/var/Kerberos/krb5kdc/kpropd.acl</TT
>.
</P
><P
>&#13;Dopo di questo si devono creare le chiavi di host per i server Kerberos master e slave:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;{Kerberos1}bash# kadmin.local
{Kerberos1}kadmin.local:  addprinc -randkey host/kerberos1.gnud.ie
{Kerberos1}kadmin.local:  addprinc -randkey host/kerberos2.gnud.ie
</PRE
>
</P
><P
>&#13;Le chiavi devono essere estratte nel file keytab: si tratta di un portachiavi che contiene le chiavi crittografiche che servono per autenticarsi presso il KDC. L'estrazione delle chiavi nel keytab si ottiene con il sottocomando <SPAN
CLASS="application"
>ktadd</SPAN
>:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;{Kerberos1}kadmin.local:  ktadd host/kerberos1.gnud.ie
{Kerberos1}kadmin.local:  ktadd host/kerberos2.gnud.ie
</PRE
>
</P
><P
>&#13;Infine sarà necessario copiare il keytab sul server slave in modo che questo abbia le chiavi necessarie per procedere all'autenticazione.
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;{Kerberos2}bash# scp root@kerberos1.gnud.ie:/etc/krb5.keytab /etc
</PRE
>
</P
><P
>&#13;Questa linea inserita nel crontab del master server Kerberos sincronizza i database dei principal ogni quindici minuti:
<PRE
CLASS="screen"
>&#13;15 * * * * /usr/local/bin/krb5prop.sh
</PRE
>
</P
><P
>&#13;Questo è il contenuto dello script <TT
CLASS="filename"
>krb5prop.sh</TT
>:
<PRE
CLASS="screen"
>&#13;#!/bin/sh

/usr/Kerberos/sbin/kdb5_util dump /var/Kerberos/krb5kdc/slave_datatrans

/usr/Kerberos/sbin/kprop -f /var/Kerberos/krb5kdc/slave_datatrans kerberos2.gnud.ie &#62; /dev/null
</PRE
>
</P
><P
>&#13;Questo comando, impartito manualmente, restituisce qualcosa di simile a quel che segue:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;{Kerberos1}bash# /usr/Kerberos/sbin/kdb5_util dump /var/Kerberos/krb5kdc/slave_datatrans
{Kerberos1}bash# /usr/Kerberos/sbin/kprop -d -f /var/Kerberos/krb5kdc/slave_datatrans kerberos2.gnud.ie
3234 bytes sent.
Database propagation to kerberos2.gnud.ie: SUCCEEDED
{Kerberos1}bash#
</PRE
>
</P
><P
>&#13;Il server slave sincronizzerà il database dei principal con il server master.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="maintain"
>5.3. Manutenzione</A
></H3
><P
>&#13;Una volta che siano stati impostati i job di cron, la propagazione dei principal sarà automatica e non richiederà alcuna manutenzione; al momento di un guasto del KDC primario non sarà necessario un intervento umano, a meno che il guasto non duri molto tempo.
</P
></DIV
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="client-configure"
>6. Configurazione dei client</A
></H2
><DIV
CLASS="section"
><H3
CLASS="section"
><A
NAME="client"
>6.1. Configurazione generale dei client GNU Linux</A
></H3
><P
>&#13;Le distribuzioni di Kerberos per GNU Linux comprendono un pacchetto client che contiene tutto il software e i file di configurazione necessari per configurare una macchina GNU Linux capace di effettuare l'autenticazione Kerberos su un KDC. Nei sistemi basati su Fedora e suoi derivati si tratta del pacchetto <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>krb5-workstation</I
></SPAN
>. Perché il sistema possa usare Kerberos per l'autenticazione, anche con l'utilizzo delle applicazioni compatibili, Kerberos deve essere configurato su di esso.
</P
><P
>&#13;La configurazione consiste nell'editare il file <TT
CLASS="filename"
>/etc/krb5.conf</TT
>, dove si specifica il realm, i KDC, il server amministrativo, il logging, il dominio predefinito, e le informazioni sul KDC; andrà modificato anche il file <TT
CLASS="filename"
>kdc.conf</TT
>, la posizione del quale può essere specificata nel file <TT
CLASS="filename"
>krb5.conf</TT
>; il percorso predefinito è <TT
CLASS="filename"
>/var/Kerberos/krb5kdc/kdc.conf</TT
>. Il file <TT
CLASS="filename"
>kdc.conf</TT
> contiene informazioni sul criterio dell'algoritmo di crittografia applicato nel realm.
</P
><P
>&#13;Sul sistema che si vuole abilitare a effettuare l'autenticazione con Kerberos si devono immettere le medesime informazioni di configurazione che sono state scritte nel file <TT
CLASS="filename"
>/etc/krb5.conf</TT
> del KDC. Si consultino anche i file di configurazione di esempio per l'università GNU di Dublino: <TT
CLASS="filename"
><A
HREF="http://cryptnet.net/fdp/admin/kerby-infra/en/krb5.conf"
TARGET="_top"
>krb5.conf</A
></TT
> e
<TT
CLASS="filename"
><A
HREF="http://cryptnet.net/fdp/admin/kerby-infra/en/kdc.conf"
TARGET="_top"
>kdc.conf</A
></TT
>.
</P
><P
>&#13;A questo punto è possibile provare l'autenticazione di Kerberos, usando il comando <SPAN
CLASS="application"
>kinit</SPAN
>:
<PRE
CLASS="screen"
>&#13;bash$ kinit &#60;username&#62;
</PRE
>
</P
><P
>&#13;Se l'autenticazione non riesce si può cercare una descrizione della causa del fallimento nei file del registro di sistema del client e nel file log di KDC nel KDC su cui si tenta di autenticarsi. Durante l'indagine sui problemi di autenticazione può essere d'aiuto avere un terminale aperto che esegue il comando <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>tail -f</I
></SPAN
> sul file log di KDC. Nell'esempio di <TT
CLASS="filename"
>krb5.conf</TT
> la posizione del
file di registro del KDC è <TT
CLASS="filename"
>/var/log/Kerberos/krb5kdc.log</TT
>.
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="pam"
>6.2. PAM</A
></H3
><P
>&#13;La tecnologia PAM, o moduli di autenticazione inseribili (Pluggable Authentication Modules), che è inclusa in molte distribuzioni di GNU Linux, si integra con Kerberos tramite il modulo <SPAN
CLASS="application"
>pam_krb5</SPAN
>. Per utilizzare l'autenticazione Kerberos con PAM si deve installare il modulo <SPAN
CLASS="application"
>pam_krb5</SPAN
> e modificare i file di configurazione di PAM.
</P
><P
>&#13;Con il modulo <SPAN
CLASS="application"
>pam_krb5</SPAN
> vengono installati dei file di configurazione esemplificativi, che si trovano in <TT
CLASS="filename"
>/usr/share/doc/pam_krb5-1.55/pam.d</TT
>. La modifica fondamentale che è necessario inserire per permettere ai servizi controllati da PAM di autenticarsi con Kerberos è di questo tipo:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;auth       required     /lib/security/pam_krb5.so use_first_pass
</PRE
>
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="apache"
>6.3. Il server web Apache</A
></H3
><P
>&#13;Si può utilizzare Kerberos come meccanismo di autenticazione per il server web Apache; tale funzionalità è fornita dal modulo <SPAN
CLASS="application"
>mod_auth_kerb</SPAN
>, mediante il quale è possibile impostare Kerberos come tipo di autenticazione per le occorrenze del controllo di accesso nel file <TT
CLASS="filename"
>httpd.conf</TT
>. Si noti che questo non è il meccanismo di autenticazione ideale quando si usa kerberos, perché i ticket sono conservati nel server web anziché nella macchina client; peraltro se la finalità è di implementare una soluzione di accesso a un solo stadio o di consolidare gli account questa soluzione è praticabile. <SPAN
CLASS="application"
>mod_auth_kerb</SPAN
> può supportare Kerberos 4 ma questo documento non ne tratta, in considerazione delle debolezze nella sicurezza della versione 4 del protocollo.
</P
><P
>&#13;Il sito di <SPAN
CLASS="application"
>mod_auth_kerb</SPAN
> si trova all'indirizzo <A
HREF="http://modauthkerb.sourceforge.net/"
TARGET="_top"
>http://modauthkerb.sourceforge.net/</A
>. Si raccomanda di usare il protocollo HTTPS per l'accesso ai siti che usano <SPAN
CLASS="application"
>mod_auth_kerb</SPAN
>, perché esso usa l'autenticazione di base che trasmette i dati in codifica base64 ed è semplice tradurli in testo in chiaro. È importante che le credenziali di autenticazione siano cifrate con SSL per garantire che il nome utente e la password siano protette mentre sono trasmesse al server web.
</P
><P
>&#13;Si riportano i passaggi necessari per compilare Apache con il modulo <SPAN
CLASS="application"
>mod_auth_krb</SPAN
>.
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;bash$ export 'LIBS=-L/usr/Kerberos/lib -lkrb5 -lcrypto -lcom_err'
bash$ export 'CFLAGS=-DKRB5 -DKRB_DEF_REALM=\\\"GNUD.IE\\\"'
bash$ export 'INCLUDES=-I/usr/Kerberos/include'
bash$ mkdir apache_x.x.x/src/modules/kerberos
bash$ cp mod_auth_kerb-x.x.x.c apache_x.x.x/src/modules/kerberos
bash$ ./configure --prefix=/home/httpd --add-module=src/modules/Kerberos/mod_auth_kerb.c
bash$ make
bash$ make install
</PRE
>
</P
><P
>&#13;È consigliabile collaudare Apache per verificarne il buon funzionamento; quando si dispone di una copia sicuramente funzionante di Apache con SSL abilitato, si può modificare il file <TT
CLASS="filename"
>httpd.conf</TT
> per fornire l'autenticazione kerberos per una directory.
</P
><P
>&#13;Il frammento che segue è un esempio che abilita l'autenticazione Kerberos 5 per una directory attraverso il modulo mod_auth_kerb:
<PRE
CLASS="screen"
>&#13;&#60;Directory "/home/httpd/htdocs/content"&#62;
   AllowOverride None
   AuthType KerberosV5
   AuthName "Kerberos Login"
   KrbAuthRealm GNUD.IE
   require valid-user
&#60;/Directory&#62;
</PRE
>
</P
></DIV
><DIV
CLASS="section"
><HR><H3
CLASS="section"
><A
NAME="microsoft"
>6.4. Microsoft Windows</A
></H3
><P
>&#13;La compatibilità fra lo standard Kerberos del MIT e la versione Microsoft è limitata, a causa della imperfetta implementazione dello standard Kerberos da parte di Microsoft. <A
HREF="http://www.microsoft.com/windows2000/techinfo/planning/security/kerbsteps.asp"
TARGET="_top"
>Quì</A
> è disponibile un documento pubblicato da Microsoft che descrive in che modo e con che limiti la versione viziata di Kerberos prodotta da Microsoft può operare insieme con quella standard. 
</P
></DIV
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="programming"
>7. La programmazione con Kerberos</A
></H2
><DIV
CLASS="section"
><H3
CLASS="section"
><A
NAME="api"
>7.1. L'API di Kerberos</A
></H3
><P
>&#13;Le librerie di sviluppo di Kerberos permettono di abilitare qualsiasi applicazione all'autenticazione con Kerberos. Sono due le librerie principali, una di uso generale usata per la semplice autenticazione e una libreria di amministrazione utile per svolgere funzioni amministrative quali le operazioni sui principal. Nei sistemi GNU Linux derivati da Fedora, il pacchetto rpm <TT
CLASS="filename"
>krb5-devel</TT
> contiene le librerie di sviluppo e la documentazione. Una descrizione dell'API per queste librerie si trova nella documentazione di kerberos, inclusa nella maggior parte delle distribuzioni; nei derivati di Fedora si installa nel percorso: <TT
CLASS="filename"
>/usr/share/doc/krb5-devel-1.2.2/api</TT
>.
</P
><P
>&#13;La documentazione è nel formato LaTeX; per consultarla si devono generare da essa i file dvi che poi possono leggersi con il programma <SPAN
CLASS="application"
>xdvi</SPAN
>. Per far ciò si usano i comandi:
</P
><P
>&#13;<PRE
CLASS="screen"
>&#13;bash$ cd /usr/share/doc/krb5-devel-x.x.x/api/
bash$ su
bash# make
bash# (^d)
bash$ xdvi library.dvi
</PRE
>
</P
></DIV
></DIV
><DIV
CLASS="appendix"
><HR><H1
CLASS="appendix"
><A
NAME="sources"
>A. Fonti di approfondimento</A
></H1
><DIV
CLASS="section"
><H2
CLASS="section"
><A
NAME="links"
>A.1. Collegamenti a documenti pertinenti</A
></H2
><P
></P
><UL
><LI
><P
>&#13;<A
HREF="http://web.mit.edu/kerberos/www/krb5-1.2/krb5-1.2.6/doc/install_toc.html"
TARGET="_top"
>Kerberos V5 Installation Guide</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://web.mit.edu/kerberos/www/krb5-1.2/krb5-1.2.6/doc/user-guide_toc.html"
TARGET="_top"
>Kerberos V5 UNIX User's Guide</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://web.mit.edu/kerberos/www/krb5-1.2/krb5-1.2.6/doc/admin_toc.html"
TARGET="_top"
>Kerberos V5 System Administrator's Guide</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://web.mit.edu/kerberos/www/krb5-1.2/krb5-1.2.6/doc/krb425_toc.html"
TARGET="_top"
>Upgrading to Kerberos V5 from Kerberos V4</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.nrl.navy.mil/CCS/people/kenh/kerberos-faq.html"
TARGET="_top"
>Kerberos FAQ</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://web.mit.edu/kerberos/www/dialogue.html"
TARGET="_top"
>Designing an Authentication System: a Dialog in Four Scenes</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.ornl.gov/~jar/HowToKerb.html"
TARGET="_top"
>How To Kerberize Your Site</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.isi.edu/gost/brian/security/kerberos.html"
TARGET="_top"
>The Moron's Guide to Kerberos</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.angelfire.com/hi/plutonic/afs-faq.html"
TARGET="_top"
>AFS FAQ</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/docs/krb5api.html"
TARGET="_top"
>The Kerberos 5 API</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/docs/krb5adm_api.html"
TARGET="_top"
>The Kerberos 5 Admin API</A
>
</P
></LI
></UL
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="websites"
>A.2. Siti web di interesse</A
></H2
><P
></P
><UL
><LI
><P
>&#13;<A
HREF="http://web.mit.edu/kerberos/www/"
TARGET="_top"
>MIT Kerberos Website</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.ntp.org/"
TARGET="_top"
>The NTP Distribution Website</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.eecis.udel.edu/~mills/ntp/clock2b.html"
TARGET="_top"
>List of Public Stratum 2 NTP Servers</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.openafs.org/"
TARGET="_top"
>OpenAFS Website</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.pdc.kth.se/heimdal/"
TARGET="_top"
>Heimdal Kerberos Website</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.crypto-publish.org/"
TARGET="_top"
>The Crypto Publishing Project</A
> (Unrestricted source for Kerberos source code)
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.cosic.esat.kuleuven.ac.be/sesame/"
TARGET="_top"
>SESAME</A
> (Secure European System for Applications in a Multi-vendor Environment)
</P
></LI
></UL
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="rfc"
>A.3. RFC sull'argomento</A
></H2
><P
></P
><UL
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc2744.txt"
TARGET="_top"
>RFC2744: Generic Security Service API Version 2: C-bindings</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc2743.txt"
TARGET="_top"
>RFC2743: Generic Security Service Application Program Interface, Version 2 Update 1</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc2712.txt"
TARGET="_top"
>RFC2712: Addition of Kerberos Cipher Suites to Transport Layer Security (TLS)</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc2078.txt"
TARGET="_top"
>RFC2078: Generic Security Service Application Program Interface, Version 2</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1964.txt"
TARGET="_top"
>RFC1964: The Kerberos Version 5 GSS-API Mechanism</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1510.txt"
TARGET="_top"
>RFC1510: The Kerberos Network Authentication Service (V5)</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1509.txt"
TARGET="_top"
>RFC1509: Generic Security Service API : C-bindings</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1508.txt"
TARGET="_top"
>RFC1508: Generic Security Service Application Program Interface</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1411.txt"
TARGET="_top"
>RFC1411: Telnet Authentication: Kerberos Version 4</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1305.txt"
TARGET="_top"
>RFC1305: Network Time Protocol (Version 3) Specification, Implementation and Analysis</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1119.txt"
TARGET="_top"
>RFC1119: Network Time Protocol (Version 2) Specification and Implementation</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1059.txt"
TARGET="_top"
>RFC1059: Network Time Protocol (Version 1) Specification and Implementation</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://cryptnet.net/mirrors/rfcs/rfc958.txt"
TARGET="_top"
>RFC958: Network Time Protocol (NTP)</A
>
</P
></LI
></UL
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="other-ref"
>A.4. Altri riferimenti</A
></H2
><P
></P
><UL
><LI
><P
>&#13;[<SPAN
CLASS="citation"
>Applied Cryptography</SPAN
>] Second Edition, Bruce Schneier [<A
HREF="http://www.amazon.com/exec/obidos/tg/detail/-/0471117099/qid%3D1085516723/sr%3D11-1/ref%3Dsr%5F11%5F1/103-3431487-6727030?v=glance"
TARGET="_top"
>ISBN: 0-471-11709-9</A
>]
</P
></LI
></UL
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="resources"
>A.5. Risorse aggiuntive</A
></H2
><P
></P
><UL
><LI
><P
>&#13;<A
HREF="http://mailman.mit.edu/mailman/listinfo/kerberos"
TARGET="_top"
>The Kerberos Authentication System Mailing List</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://mailman.mit.edu/pipermail/kerberos/"
TARGET="_top"
>The Kerberos Authentication System Mailing List Archives</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="news:comp.protocols.kerberos"
TARGET="_top"
>comp.protocols.kerberos</A
> UseNet Newsgroup
</P
></LI
></UL
></DIV
><DIV
CLASS="section"
><HR><H2
CLASS="section"
><A
NAME="companies"
>A.6. Imprese che forniscono consulenza specializzata su Kerberos</A
></H2
><P
></P
><UL
><LI
><P
>&#13;<A
HREF="http://www.cybersafe.ltd.uk/"
TARGET="_top"
>Cybersafe, Ltd.</A
>
</P
></LI
><LI
><P
>&#13;<A
HREF="http://www.e-techservices.com/solutions/kerberos/"
TARGET="_top"
>e-TechServices.com, Inc.</A
> IBM Business Partner
</P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="GLOSSARY"
><H1
><A
NAME="AEN481"
></A
>Glossario dei termini</H1
><DL
><DT
><B
>ASN.1</B
></DT
><DD
><P
>&#13;Abstract Syntax Notation One [notazione sintattica astratta uno]. ASN.1 è una notazione usata per descrivere messaggi, come sequenze di componenti. ASN.1 è utilizzata per rappresentare il contenuto dei datagrammi di Kerberos; la sua conoscenza è utile soltanto agli sviluppatori di applicativi.
</P
></DD
><DT
><B
>Authenticator</B
></DT
><DD
><P
>&#13;Un record che contiene informazioni che possono essere esibite nell'evidenza che sono state generate di recente usando la chiave di sessione nota soltanto al client e al server. (Definizione da <A
HREF="http://cryptnet.net/mirrors/rfcs/rfc1510.txt"
TARGET="_top"
>RFC1510</A
>)
</P
></DD
><DT
><B
>Credenziali</B
></DT
><DD
><P
>&#13;Un ticket per il server e una chiave di sessione che è utilizzata per autenticare il principal.
</P
></DD
><DT
><B
>Cross-Realm Authentication [autenticazione trasversale ai realm]</B
></DT
><DD
><P
>&#13;Kerberos può consentire a un KDC di un realm di autenticare un principal in un altro realm se esiste un segreto condiviso da entrambi i realm; questa autenticazione tra i realm è detta cross-realm authentication.
</P
></DD
><DT
><B
>Data Encryption Standard [DES]</B
></DT
><DD
><P
>&#13;Un algoritmo di cifratura che è stato l'algoritmo ufficiale del Governo degli Stati Uniti, sviluppato dall'IBM con la collaborazione della NSA. L'algoritmo è un cifrario a blocchi fissi di sedici caratteri che usa un blocco di 64 bit e una chiave di 56 bit.
</P
></DD
><DT
><B
>Forwardable Ticket [Ticket inoltrabile]</B
></DT
><DD
><P
>&#13;Un ticket concesso dal KDC che consente agli utenti di richiedere ticket addizionali con indirizzi IP differenti; in pratica si tratta di un TGT che permette ai principal autenticati di ottentere ticket validi per altre macchine aggiuntive.
</P
></DD
><DT
><B
>Generic Security Services Application Programming Interface [GSS-API]</B
></DT
><DD
><P
>&#13;Un insieme di associazioni del linguaggio C che fornisce servizi di sicurezza alla funzione chiamante; l'API può essere implementata su vari sistemi di crittografia, fra i quali Kerberos.
</P
></DD
><DT
><B
>Key Distribution Center [KDC]</B
></DT
><DD
><P
>&#13;La macchina e il software che riveste il ruolo di arbitro di fiducia nel protocollo Kerberos.
</P
></DD
><DT
><B
>Kerberos</B
></DT
><DD
><P
>&#13;Un protocollo di autenticazione che si appoggia a una terza parte fidata (arbitro) per l'autenticazione dei client in una rete TCP IP. Il protocollo è stato progettato in modo che sulla rete siano trasmessi ticket cifrati anziché password in chiaro, garantendo l'autenticazione sicura attraverso la rete.
</P
></DD
><DT
><B
>Kerberize</B
></DT
><DD
><P
>&#13;[Neologismo americano che si è preferito tradurre con circumlocuzioni, essendo poco in uso l'omologo italiano. - NdT]
(verbo transitivo) L'azione di modificare un sistema, un servizio o un programma in maniera che utilizzi Kerberos per l'autenticazione.
(aggettivo kerberized) Un sistema, servizio o programma che supporta l'autenticazione attraverso Kerberos.
</P
></DD
><DT
><B
>Network Time Protocol [NTP]</B
></DT
><DD
><P
>&#13;Un protocollo usato per sincronizzare gli orologi dei computer e dei router in internet.
</P
></DD
><DT
><B
>Postdatable ticket [Ticket postdatato]</B
></DT
><DD
><P
>&#13;In Kerberos 5, un ticket che non è valido inizialmente e che lo diventerà in futuro; i ticket Kerberos normali sono validi dal momento della richiesta a quello della scadenza.
</P
></DD
><DT
><B
>Preauthentication</B
></DT
><DD
><P
>&#13;Autenticazione aggiuntiva che ha luogo prima che un KDC conceda un TGT a un principal; un esempio può essere la soddisfazione dei requisiti di un sistema biometrico.
</P
></DD
><DT
><B
>Principal</B
></DT
><DD
><P
>&#13;Un utente o server per il quale il KDC conserva una chiave segreta nel proprio database.
</P
></DD
><DT
><B
>Proxiable Ticket [Ticket per procura]</B
></DT
><DD
><P
>&#13;In Kerberos 5, un ticket che permette di richiedere un TGT per un indirizzo IP alternativo.
</P
></DD
><DT
><B
>Realm</B
></DT
><DD
><P
>&#13;L'ambito della distribuzione di Kerberos; precisamente, il dominio dell'organizzazione per cui il KDC è considerato di fiducia e può autenticare i principal.
</P
></DD
><DT
><B
>Renewable Ticket [Ticket Rinnovabile]</B
></DT
><DD
><P
>&#13;In Kerberos 5, un ticket con una durata di rinnovo in aggiunta alla durata ordinaria del ticket. I ticket rinnovabili possono essere usati per acquisire ulteriori ticket dal KDC finché sono validi; i ticket rinnovati possono essere richiesti fino alla scadenza di rinnovo del ticket rinnovabile originario.
</P
></DD
><DT
><B
>Salt</B
></DT
><DD
><P
>&#13;Un seme usato nella cifratura delle password per aumentare il numero dei risultati che è possibile ottenere come testo cifrato a partire dallo stesso testo in chiaro; l'uso del seme è una misura che protegge le password cifrate dagli attacchi del dizionario.
</P
></DD
><DT
><B
>Stash File</B
></DT
><DD
><P
>&#13;Il file dove sono conservate le chiavi segrete.
</P
></DD
><DT
><B
>Ticket</B
></DT
><DD
><P
>&#13;Un messaggio formato dall'identità del client, una chiave di sessione, un riferimento temporale e altre informazioni, tutte cifrate con la chiave segreta del server; è usato per costruire il procedimento di autenticazione.
</P
></DD
><DT
><B
>Ticket Granting Service [TGS]</B
></DT
><DD
><P
>&#13;Un servizio che è autorizzato e organizzato per rilasciare ticket ai client dopo che essi hanno ricevuto un Ticket Granting Ticket (TGT).
</P
></DD
><DT
><B
>Ticket Granting Ticket [TGT]</B
></DT
><DD
><P
>&#13;Un ticket contentente una chiave di sessione utilizzabile per la comunicazione fra i client e il KDC.
</P
></DD
><DT
><B
>Transitive Cross-Realm Authentication</B
></DT
><DD
><P
>&#13;In Kerberos 5, la possibilità di formare una catena di fiducia attraverso i realm in modo che se un principal nel realm X ha bisogno di autenticare un principal nel realm Z, non è necessario che il KDC del realm X condivida un segreto con il realm Z, se entrambi condividono un segreto con il realm Y; quest'ultimo funge da intermediario nel percorso di fiducia.
</P
></DD
><DT
><B
>Triple DES</B
></DT
><DD
><P
>&#13;Una variante di DES che cifra i dati tre volte con DES, usando due chiavi differenti.
</P
></DD
></DL
></DIV
></DIV
></BODY
></HTML
>