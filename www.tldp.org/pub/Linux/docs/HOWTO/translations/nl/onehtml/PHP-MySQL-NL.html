<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>PHP / MySQL HOWTO</TITLE>


</HEAD>
<BODY>
<H1>PHP / MySQL HOWTO</H1>

<H2>Auteur: Hans Wolters, hans@linux.gelrevision.nl</H2>v1.03, 6 maart 2000
<P><HR>
<EM>Deze howto geeft uitleg over de installatie en het gebruik van PHP4, samen met MySQL.</EM>
<HR>
<H2><A NAME="s1">1. Over deze FAQ</A></H2>

<H2>1.1 Historie.</H2>

<P>
<P>Deze FAQ is ontstaan naar aanleiding van de vele vragen die 
regelmatig in de nieuwsgroep 
<A HREF="news://nl.internet.ontwerp">nl.internet.ontwerp</A> worden gesteld. Zodra de FAQ van 
Kristian Koehntopp 
<A HREF="http://www.koehntopp.de/php/faq-single.html">Kristian Koehntopp</A> ook aan de Open Publication License voldoet 
zal er een samenwerking volgen waarbij vooral moet worden gedacht aan het 
uitwisselen van tips, nieuwtjes, etc.
<H2>1.2 Copyright.</H2>

<P>Deze FAQ valt sinds 22 maart 2000 onder de Open Publication License. 
Je kan hem bekijken op de volgende url:
<A HREF="http://www.opencontent.org/openpub/">http://www.opencontent.org/openpub/</A><H2>1.3 Kan je helpen met deze FAQ?</H2>

<P>
<P>Ja natuurlijk, graag zelfs. Op dit moment heb ik de FAQ nog niet op een
CVS account staan maar zodra dat het geval zal zijn zal dat hier worden
vermeld.
<H2>1.4 Waar kan je de nieuwste versie vinden van deze FAQ?</H2>

<P>
<P>De nieuwste versie zal binnenkort zijn te vinden op 2 sites in 
Nederland, te weten:
<P>
<UL>
<LI>
<A HREF="http://linux.gelrevision.nl">Gelre Linux Support Site</A></LI>
<LI>
<A HREF="http://nl.linux.org">NL.Linux.org</A></LI>
</UL>
<H2>1.5 Bronnen.</H2>

<P>
<P>PHP:
<P>
<UL>
<LI>
<A HREF="http://www.php.net/">http://www.php.net</A>.</LI>
<LI>
<A HREF="http://www.zend.org/">http://www.zend.org</A>.</LI>
</UL>
<P>MySQL:
<UL>
<LI>
<A HREF="http://www.mysql.org/">http://www.mysql.org</A>.</LI>
</UL>
<P>
<H2><A NAME="s2">2. PHP. Wat is het, wat kan het?</A></H2>

<H2>2.1 Wat is PHP.</H2>

<P>
<P>PHP is een server side script taal dat op allerlei manieren kan worden 
ingezet. Het is voor de gemiddelde persoon vrij snel op te pikken. 
Mensen die al enige/veel programmeer/scripting ervaring hebben zullen zeer 
snel in staat zijn om een webapplicatie er mee te maken. PHP is ook als CGI 
parser in te zetten.
<H2>2.2 Waar kan je PHP voor gebruiken.</H2>

<P>PHP is voor vele doeleinden geschikt. Het beste komt het tot zijn recht
als je het inzet voor <EM>dynamische</EM> websites. Hierbij kan je denken 
aan:
<P>
<UL>
<LI> Gastenboeken.</LI>
<LI> Forums.</LI>
<LI> Frontends voor zoekmachines.</LI>
<LI> Webshops.</LI>
</UL>
<P>Eigenlijk is dit maar een kleine greep van wat er mogelijk is. De 
grote kracht van PHP is eigenlijk het feit dat je support kan 
meecompileren voor een groot aantal database(servers).
<H2>2.3 Waar kan je hulp krijgen?</H2>

<P>Het is de bedoeling dat deze FAQ zal uitgroeien tot een document 
waarin je veel antwoorden zal kunnen terugvinden. Naast deze FAQ zijn er een 
aantal plekken op het internet waar je informatie kan terug vinden.
<H3>WWW</H3>

<P>
<P>Engelstalige websites.
<P>
<UL>
<LI> 
<A HREF="http://www.php.net/">http://www.php.net</A></LI>
<LI> 
<A HREF="http://www.zend.org/">http://www.zend.org</A></LI>
<LI> 
<A HREF="http://www.phpbuilder.com/">http://www.phpbuilder.com/</A></LI>
<LI> 
<A HREF="http://www.weberdev.com/">http://www.weberdev.com</A></LI>
<LI> 
<A HREF="http://www.phpwizard.net/">http://www.phpwizard.net</A></LI>
<LI> 
<A HREF="http://www.devshed.com/Server_Side/PHP/">http://www.devshed.com/Server_Side/PHP/</A></LI>
<LI> 
<A HREF="http://px.sklar.com/">http://px.sklar.com</A></LI>
</UL>
<H3>Online handleidingen PHP.</H3>

<P>
<UL>
<LI> 
<A HREF="http://www.zend.org/manual/">http://www.zend.org/manual/</A></LI>
<LI> 
<A HREF="http://www.php.net/manual/">http://www.php.net/manual/</A></LI>
</UL>
<H3>Downloaden offline handleidingen PHP.</H3>

<P>
<UL>
<LI> 
<A HREF="http://www.php.net/docs.php3">http://www.php.net/docs.php3</A></LI>
</UL>
<H3>Usenet.</H3>

<P>Naast de hierboven genoemde websites kan je ook terecht op usenet. Op 
usenet is er op dit ogenblik maar 1 nieuwsgroep waar je terecht kan 
met je vragen. Het is de Duitstalige nieuwsgroep 
<A HREF="news://de.comp.lang.php/">news://de.comp.lang.php/</A>.
De mensen beantwoorden niet alleen Duitstalige vragen.
<P>Naast die Duitstalige nieuwsgroep kan je met je vragen ook terecht bij 
de Nederlandstalige nieuwsgroep
<A HREF="news://nl.internet.ontwerp/">news://nl.internet.ontwerp</A>.
<H3>Irc.</H3>

<P>Er is een Engelstalig php kanaal op irc (#php) maar daar is een ban op 
alle mensen gezet die uit Nederland komen. Zelf is het me niet gelukt om 
met de operaters in contact te treden en te vragen wat er aan de hand is.
<P>
<P>
<H2><A NAME="s3">3. De installatie van PHP</A></H2>

<H2>3.1 Voorwoord.</H2>

<P>
<P>Bij het samenstellen van de FAQ ben ik uitgegaan van PHP4.0 (Beta4). 
Dit aangezien de verwachting is dat PHP4 binnenkort overal in gebruik 
zal worden genomen.
<H2>3.2 Downloaden.</H2>

<P>Op dit moment staat PHP4 nog niet op een mirror in Nederland. Je kan 
de nieuwste versie downloaden vanaf.
<P>
<A HREF="http://www.php.net/version4/downloads.php">http://www.php.net/version4/downloads.php</A><H2>3.3 Installatie.</H2>

<P>Voor het installeren van PHP4.0 ben ik uitgegaan van de volgende 
configuratie.
<P>
<UL>
<LI>Apache 1.3.9</LI>
<LI>mysql  Ver 9.33 Distrib 3.23.1-alpha, for pc-linux-gnu (i686)</LI>
</UL>
<P>Deze configuratie heb ik op een Red Hat 6.0 distributie draaien maar 
dit mag op zich niets uitmaken. Mocht je MySQL en Apache via een package 
system zoals rpm hebben ge&iuml;nstalleerd zorg er dan voor dat je ook de
development packages laat installeren.
<H3>Uitpakken van de source code.</H3>

<P>Zorg dat je een directory hebt waar je php kan compileren en pak de 
source uit op de volgende manier en ga naar de directory die is aangemaakt:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$tar -zxf php*.tar.gz
$cd php-4.0b4pl1
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Controleer of apxs op je machine aanwezig is. Dit kan met locate 
danwel whereis. Deze locatie heb je nodig om als parameter mee te
geven aan het configure script.
<P>Aan configure script kan je een heleboel opties mee geven. Deze opties 
kan je bekijken door het volgende in te typen:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ ./configure --help | less
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Om PHP te installeren met de opties die wij nodig hebben (MySQL) heb je
in ieder geval de volgende opties nodig:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ ./configure --with-apxs=/path/apxs --with-mysql --enable-track-vars 
--enable-trans-id
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Als het script klaar is is het tijd om de module te maken:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ make
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Hierna moet je als root de module installeren:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$ su
(Geef je wachtwoord op)
# make install
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Het script heeft als het goed is alle opties in de configuratie 
bestanden van Apache aangepast en de php.ini op de juiste plek gezet. 
Maak een bestandje aan waarin je de volgende code zet:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?phpinfo()?>
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Plaats dit bestand in de root van de apache server en roep het op via 
de browser. Let op dat PHP4.0 de bestanden ziet met een extensie 
<EM>.php</EM>. Als alles goed is gegaan dan zie je een informatie scherm 
waarin alle opties van PHP zichtbaar worden.
<H2>3.4 Install helpers.</H2>

<P>
<P>Op 
<A HREF="http://prometheus.zerodivide.net/apache_kit/about/">http://prometheus.zerodivide.net/apache_kit/about/</A>
kan je een Apache Compile Kit downloaden die het zware werk voor je 
doet. Op dit moment heb ik er nog geen ervaring mee opgedaan. Volgens de 
website werkt het i.i.g. met Apache 1.3.12 en PHP3/4 (t/m Beta3).
<P>Tip van Alfred Munnikes.
<P>
<H2><A NAME="s4">4. PHP en MySQL.</A></H2>

<H2>4.1 Wat is MySQL.</H2>

<P>MySQL is een Client/Server SQL database server. Het is voornamelijk 
gericht op snelheid. Veel mensen maken de vergissing dat je alleen 
kleine databases kan gebruiken met MySQL. Dit is echter afhankelijk 
van andere factoren (mogelijkheden voor transakties, e.d.). 
<P>Zelf heb ik tot volle tevredenheid gewerkt met aanzienlijke databases 
(600.000 records). 
<H2>4.2 Waar kan ik meer leren over SQL.</H2>

<P>
<UL>
<LI> 
<A HREF="http://www.mysql.org/Manual_chapter/manual_Tutorial.html#Tutorial">http://www.mysql.org/Manual_chapter/manual_Tutorial.html#Tutorial</A></LI>
<LI> 
<A HREF="http://www.self-evident.com/sql/index.htm">http://www.self-evident.com/sql/index.htm</A></LI>
</UL>
<H2>4.3 Hoe benader je een MySQL database vanuit PHP.</H2>

<P>Voor het benaderen van een MySQL server zijn er twee mogelijkheden. Je
kan een default server opgeven in je <EM>php.ini</EM> en je kan het 
rechtstreeks vanuit de code regelen. Die eerste optie heeft als groot 
nadeel dat mensen die php scripts op dezelfde server kunnen draaien zeer 
snel het wachtwoord uit de configuratie kunnen ophalen.
<P>Om contact te leggen naar een MySQL server heb je de volgende drie 
gegevens nodig:
<P>
<UL>
<LI> De hostnaam.</LI>
<LI> De gebruikersnaam.</LI>
<LI> Het wachtwoord.</LI>
</UL>
<P>De functie om de connectie op te bouwen is
<A HREF="http://www.php.net/manual/function.mysql-connect.php3">mysql-connect</A>:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
mysql_connect("servernaam","user","wachtwoord");
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Als er een connectie naar de database server tot stand is gebracht 
moet je de database selecteren die je wilt gebruiken. Daarvoor gebruik 
je de 
<A HREF="http://www.php.net/manual/function.mysql-select-db.php3">mysql-select-db</A> functie. Ook controleer je of het is gelukt om 
die database te selecteren:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
mysql_select_db("databasenaam") or die ("Verdorie, kan de database 
niet openen");
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<H2>4.4 Hoe zie je welke tabellen er op een MySQL server staan?.</H2>

<P>Afhankelijk van de rechten die de gebruiker heeft kan hij/zij toegang 
hebben tot meerdere tabellen. Deze tabellen zijn op te vragen met de 
<A HREF="http://www.php.net/manual/function.mysql-list-tables.php3">mysql-list-tables</A> functie:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php

/*
Connectie naar de database
*/
mysql_connect( "server", "inlognaam", "wachtwoord");

/*
Uit welke database wil je de tabellen ophalen.
*/
$tabellen = mysql_list_tables( "database");

/*
Tellertje en loop om de tabellen te tonen.
*/
$i=0;
while ($i &lt; mysql_num_rows($tabellen)){
    $t_name[$i] = mysql_tablename ($tabellen, $i);
    echo $t_name[$i]. "&lt;br>";
    $i++;
}    
?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<H2>4.5 Hoe kijk je welke velden er in een tabel staan?</H2>

<P>
<P>Elke MySQL tabel zal verschillende velden bevatten. Om deze velden op 
te halen pas je de de volgende code toe:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
/*
Connectie opzetten.
*/
mysql_connect( "server", "inlognaam", "wachtwoord");

/*
Geef de database en de tabelnaam op bij de functie mysql-list-fields
*/
$fields = mysql_listfields( "database", "tabel");

/*
Kijk hoeveel velden er totaal zijn en zet de teller $i op 0.
*/
$field_num = mysql_num_fields($fields);
$i=0;

/*
Toon het totaal aantal velden ($field_num) in de browser.
*/
echo $field_num .  " veld(en) gevonden&lt;br&gt;\n";

/*
Zet een html tabel op en toon de veldtypes, veldnamen en
de veldlengte van die velden in een loop.
*/
echo  "&lt;table width=\"90%\" border=1&gt;&lt;tr&gt;&lt;td&gt;";
echo 
"Naam&lt;/td&gt;&lt;td&gt;VeldType&lt;/td&gt;&lt;td&gt;Lengte&lt;/td&gt;&lt;td&gt;Vlag&lt;/td&gt;&lt;/tr&gt;";
while ($i &lt; $field_num){
    
        $type  = mysql_field_type  ($fields, $i);
        $name  = mysql_field_name  ($fields, $i);
        $len   = mysql_field_len   ($fields, $i);
        $flags = mysql_field_flags ($fields, $i);
    
    echo  "&lt;tr&gt;&lt;td&gt;";
    echo $name. "&lt;/td&gt;&lt;td&gt;".$type. 
"&lt;/td&gt;&lt;td&gt;".$len. "&lt;/td&gt;&lt;td&gt;".$flags. 
"&lt;/td&gt;&lt;/tr&gt;";    
    $i++;
}
echo  "&lt;/table&gt;";
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<H2>4.6 Hoe maak je backslashes onzichtbaar in data?</H2>

<P>Als je via een html form gegevens laat invoeren in de database kan het 
gebeuren dat mensen gebruik maken van (o.a.) single en double quotes. Als 
je geen gebruik maakt van de functie <EM>stripslashes()</EM> bij het uitlezen 
van die data krijg je voor iedere quote een \' te zien in plaats van het 
normale quote teken. 
<H2>4.7 Kan je binaire data opslaan in MySQL?</H2>

<P>Het is mogelijk om (b.v.) plaatjes op te slaan in MySQL. Of het slim 
is is een andere vraag. Veel beter is het om de plaatjes een logische 
benaming te geven (product_id) en een kleine functie in je code te zetten 
die kijkt of een bepaald plaatje in een bepaalde directory 
aanwezig is. Dit heeft als voordeel dat je zelfs de url naar die 
plaatjes niet in de database hoeft op te slaan.
<P>Om te kijken of het plaatje aanwezig is maak je gebruik van de 
<EM>file_exists()</EM> functie:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php
        /*
        Zet een connectie naar de database op en voer de gewenste 
        query uit.Je kan dan een variabele aanmaken ($product_id) 
        waarin je het gewenste recordnr van het product dumpt. Daarna 
        voer je de volgende check uit.
        */
        
        if (file_exists("/path/$product_id.jpg")){
                echo "&lt;img src=\"/path/$product_id\" border=0 
                alt=\"$row[product_omschrijving]\">;
        }
?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<H2>4.8 Hoe kan je X records per pagina tonen?</H2>

<P>Hiervoor moet je de limit functie gebruiken. Voorbeeld:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php

        /*
        Connectie is al gemaakt. Via de parameter $start weten we op 
        welke plek in de resultset we de limit moeten laten starten, als 
        $start leeg is weten we dat we op 0 moeten beginnen. $view is het 
        totaal aantal records dat we willen tonen
        */
        
        $view = 5;
        
        $query = "SELECT * FROM tabela WHERE conditie = 'blauw'";
        $result = mysql("database", $query);
        
        /*
        Om te weten hoeveel records er in de resultset zitten vragen 
        we eerst het aantal rijen op.
        */
        $total = mysql_num_rows($result);
        
        /*
        We weten nu dat er bijvoorbeeld 45 records in zitten. We vullen
        dan de query aan met de limitfunctie zodat we de volgende X 
        records kunnen opvragen. 
        */
        $query .= " limit $start, $view";
        
        /*
        We runnen de query nog een keer.
        */
        $result = mysql("database", $query);
        
        /*
        We hebben nu een resultset met 5 records die beginnen op 
        $start. Je kan het tonen door een simpele lus. 
        */
        while ($row=mysql_fetch_array($result)){
        
                echo $row[veldnaam];
                
        }
        

?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Als laatste zou je dan nog een volgende/vorige pagina functie kunnen 
bouwen door naar het totaal aantal records te kunnen kijken in samenhang 
met de $start en $view.
<H2>4.9 Kant en klare oplossingen voor PHP (en MySQL).</H2>

<P>Er zijn op het internet diverse kant en klare oplossingen te vinden. Men hoeft
alleen de configuratie aan te passen en de scripts te installeren.
<H3>Database onderhoud.</H3>

<P>
<UL>
<LI> 
<A HREF="http://modems.rosenet.net/FaceMySQL/">http://modems.rosenet.net/FaceMySQL/</A></LI>
<LI> 
<A HREF="http://www.htmlwizard.net/phpMyAdmin/">http://www.htmlwizard.net/phpMyAdmin/</A></LI>
</UL>
<H3>Zoeken.</H3>

<P>
<UL>
<LI> 
<A HREF="http://mysearch.udm.net/">http://mysearch.udm.net/</A></LI>
</UL>
<H3>Forum.</H3>

<P>
<UL>
<LI> 
<A HREF="http://fumanchi.tabu.uni-bonn.de/forum/">http://fumanchi.tabu.uni-bonn.de/forum/</A></LI>
<LI> 
<A HREF="http://www.neoqst.com/public/neoboard/neoboard.html">http://www.neoqst.com/public/neoboard/neoboard.html</A></LI>
<LI> 
<A HREF="http://www.phunkbros.dk/products.html">http://www.phunkbros.dk/products.html</A></LI>
<LI> 
<A HREF="http://www.phorum.org/">http://www.phorum.org/</A></LI>
<LI> 
<A HREF="http://w-agora.araxe.fr/">http://w-agora.araxe.fr/</A></LI>
</UL>
<H3>Gastenboek.</H3>

<P>
<UL>
<LI> 
<A HREF="http://mygb.php-homepage.de/">http://mygb.php-homepage.de/</A></LI>
</UL>
<H3>E-Commerce oplossingen.</H3>

<P>
<UL>
<LI> 
<A HREF="http://www.fishcart.org/">http://www.fishcart.org/</A></LI>
<LI> 
<A HREF="http://www.w3-concept.net/">http://www.w3-concept.net/</A></LI>
<LI> 
<A HREF="http://modems.rosenet.net/MyCart/">http://modems.rosenet.net/MyCart/</A></LI>
<LI> 
<A HREF="http://www.phpauction.org/">http://www.phpauction.org/</A></LI>
<LI> 
<A HREF="http://phpshop.sourceforge.net/">http://phpshop.sourceforge.net/</A></LI>
</UL>
<P>
<P>
<H2><A NAME="s5">5. Sessions in PHP.</A></H2>

<H2>5.1 Wat is een session.</H2>

<P>Sessions maken het mogelijk om variabelen te gebruiken binnen een hele 
website. Op het moment dat een bezoeker een site bezoekt kan je een sessie id
opvragen. Zo'n id is een uniek nummer. Het unieke nr komt te vervallen op het
moment dat de bezoeker de browser zal afsluiten. Je kan met sessions werken 
via een <EM>cookie</EM> of via de  session_id in de url. De onderstaande 
voorbeelden gaan uit van een cookie.
<H2>5.2 Session variabelen meegeven en opvragen.</H2>

<P>
<P>Om variabelen mee te geven in een session moet je eerst de variabele 
de gewenste waarde geven. Daarna moet je die sessie nog een keer 
registreren:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php
                /*
                Session starten.
                */
                session_start();
                
                /* 
                Zet de waarde in de variabele.
                */
                $log = "Dit is de waarde die ik wil meegeven";
                
                /*
                Registreer de session
                */
                session_register("log");
        
?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>PHP maakt aan de hand van de bovenstaande code een bestandje aan in de 
/tmp directory met als bestandsnaam het session_id. In het bestand worden 
alle variabelen opgeslagen. Hierna kan je in elke willekeurige php pagina 
(zolang die session nog intact is) de waarde $log opvragen:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php
        
    session_start();
    session_register("log");
    echo $log;
        
?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>
<H2><A NAME="s6">6. Strings in PHP.</A></H2>

<H2>6.1 String weergeven in PHP.</H2>

<H3>Echo</H3>

<P>Echo is geen functie maar een commando, je gebruikt het om strings waarmee je
geen aparte bewerkingen hoeft uit te voeren op het scherm te zetten:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php
        echo "Hello World";
?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<H3>Print</H3>

<P>Met print heb je iets meer mogelijkheden dan met echo. Zo kan je 
bijvoorbeeld op meerdere regels printen zonder gebruik te maken van 
&lt;br&gt; en/of 
"\n".
<H3>Printf</H3>

<P>Printf geeft je de mogelijkheid om een <EM>formatted output</EM> te 
genereren.
<H2>6.2 String samenvoegen (concat).</H2>

<P>Voor het samenvoegen van string gebruik je een . (eventueel in 
combinatie met een = teken):
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php
        
        $a = "foo";
        $b = "bar";
        $c = $a . $b;
        
        /*
        Gebruik van het = teken.
        */
        
        $a = "foo";
        $a .= " bar";
        
?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<H2>6.3 Gedeelte van een string vervangen.</H2>

<P>Je kan heel snel een gedeelte van een string vervangen. Je gebruikt 
daarvoor de ereg_replace() functie voor:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php
        
        $a =  "Dit is de orginele string";
        $b =  ereg_replace( " is", " was", $a );

?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>
<H2><A NAME="s7">7. PHP code opnemen in je bestanden.</A></H2>

<H2>7.1 Hoe kan ik PHP opnemen in mijn html bestanden.</H2>

<P>Afhankelijk van de http server waarop PHP staat zijn er diverse 
manieren om php code op te nemen in je bestanden. In de meeste gevallen 
zullen de bestanden een aparte extensie hebben. Dit kan afhankelijk van 
de PHP versie vari&euml;ren in o.a. <EM>phtml</EM>, <EM>php3</EM> en <EM>php</EM>.
<P>De code kan op elke willekeurige plek in een bestand worden opgenomen. 
Dit doe je d.m.v. openings en sluit tags:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php
/*
Hiertussen kan je de php code opnemen.
*/
?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Het is gebruikelijk om commentaar regels op te nemen in de C 
programmeer <EM>style</EM>. Normaal gesproken neem je geen code op in 
een document als het onzinnig is om het door php te laten parsen. 
Dit doe je dan gewoon in html.
<H2>7.2 Bestanden includen.</H2>

<P>Het is mogelijk om bestanden te includen. Dit is vooral handig als je 
code schrijft die je in meerdere bestanden wilt aanroepen. Op die manier 
kan je de code overzichtelijk houden. Je kan hiervoor het <EM>include</EM> 
of het <EM>require</EM> commando gebruiken. Het grote verschil tussen deze twee 
commando's zit hem hierin dat het <EM>include</EM> commando waarden kan teruggeven. 
Om een bestand te includen ga je als volgt te werk:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
&lt;?php
        include ("/path/bestand.php");
?&gt;
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Je kan in de <EM>php.ini</EM> een default plek aangeven voor bestanden die 
je wilt includen zodat je alleen de bestandsnaam hoeft aan te roepen. Je 
kan ze natuurlijk ook op een logische plek op de webserver neerzetten. Zorg 
in dat laatste geval wel dat je de bestanden een extensie geeft die wordt 
<EM>geparsed</EM> door de PHP interpreter zodat mensen niet de inhoud van 
die bestanden kunnen lezen. Ook is het verstandig om een disallow op te 
nemen voor zo'n directory in je robots.txt zodat de bestanden niet worden 
ge&iuml;ndexeerd door zoekmachines.
<P>
<P>
<H2><A NAME="s8">8. PHP error's en bugs.</A></H2>

<H2>8.1 Ik krijg de melding "Call to unsupported or undefined function: mysql_connect()".</H2>

<P>Als je gebruik maakt van de standaard packages voor het installeren 
van PHP dan zit daar vaak geen support voor MySQL bij in. Je zult de 
source zelf moeten compileren.
<H2>8.2 Mail functie werkt niet onder PHP4.</H2>

<P>Er zit een vervelende bug in de PHP4 (beta4) configuratie. In de php.ini
kan je het <EM>path</EM> aangeven naar sendmail. Standaard is die regel leeg in 
de eerdere versies. Als je het leeg laat in de php.ini kan PHP het <EM>path</EM>
niet vinden. De oplossing is heel eenvoudig. Zet een ; voor de regel, 
PHP gebruikt dan de default instellingen.
<P>
<H2><A NAME="s9">9. MySQL.</A></H2>

<H2>9.1 SQL.</H2>

<P>Om gegevens te bewerken, verwijderen en op te vragen uit MySQL maak je gebruik van 
SQL, oftwel <EM>Structured Query Language</EM>. Dit is een taal die in veel 
database(servers) voor handen is. De SQL die gebruikt wordt zal verschillen per 
databaseserver.
<H2>9.2 Gegevens selecteren en opvragen in MySQL.</H2>

<P>Om gegevens op te vragen in MySQL maak je gebruik van het SELECT statement. In 
combinatie met een paar eventuele voorwaardes kan je precies de gegevens
opvragen die je nodig hebt. We gaan nu even uit van een database met twee
tabellen. Samen vormen ze een database waarin links en omschrijvingen van
programma's staan. De database naam is internet en de tabelnamen zijn
link_soort en links:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$mysql -u guest -p internet
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 19 to server version: 3.23.1-alpha

Type 'help' for help.

mysql> 
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>We kunnen nu eerst eens gaan bekijken welke velden er in de tabellen
staan:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
mysql> show fields from links;
+------------+--------------+------+-----+---------+----------------+----------------------+
| Field      | Type         | Null | Key | Default | Extra          | Privileges           |
+------------+--------------+------+-----+---------+----------------+----------------------+
| id         | int(11)      |      | PRI | NULL    | auto_increment | select,insert,update |
| url        | varchar(255) |      | MUL |         |                | select,insert,update |
| url_naam   | varchar(255) | YES  |     | NULL    |                | select,insert,update |
| license    | varchar(60)  | YES  |     | NULL    |                | select,insert,update |
| discript   | tinyblob     | YES  |     | NULL    |                | select,insert,update |
| link_soort | int(11)      |      |     | 0       |                | select,insert,update |
+------------+--------------+------+-----+---------+----------------+----------------------+

mysql> show fields from link_soort;
+-------+-------------+------+-----+---------+----------------+----------------------+
| Field | Type        | Null | Key | Default | Extra          | Privileges           |
+-------+-------------+------+-----+---------+----------------+----------------------+
| id    | int(11)     |      | PRI | NULL    | auto_increment | select,insert,update |
| naam  | varchar(50) | YES  |     | NULL    |                | select,insert,update |
+-------+-------------+------+-----+---------+----------------+----------------------+
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Op die manier krijg je een overzicht van de velden, rechten en veldtypes 
die er in de database staan. Om nu alle velden uit de link_soort tabel te
selecteren gebruik je de volgende code:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
mysql> select * from link_soort;
+----+---------------------------+
| id | naam                      |
+----+---------------------------+
| 33 | security_sites            |
| 31 | w-managers                |
| 32 | wm-tools                  |

.................
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Je ziet dat er een hele rij gegevens te voorschijn komen die bestaan uit
een id en een naam. Als je nu alleen wilt weten hoeveel records er in die
tabel staan dan kan je dat opvragen met COUNT:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
mysql> select count(id) from link_soort;
+-----------+
| count(id) |
+-----------+
|        51 |
+-----------+
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Als je nu gegevens wilt toevoegen aan deze tabel dan kan je dat met het
INSERT commando doen. Bij het opvragen van de tabel gegevens heb je kunnen
zien dat het veld id een veld is dat de eigenschap <EM>auto_increment</EM> heeft.
Je hoeft in dat geval dus geen eigenlijke waarde mee te geven voor dat veld
als je een nieuw record wilt invoeren. Je gebruikt in dat geval de null
waarde. MySQL zal zelf bekijken welk nummer er zal worden gebruikt voor het
id:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
mysql> insert into link_soort values (null, 'test');
Query OK, 1 row affected (0.13 sec)
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Om het record te verwijderen kan je DELETE gebruiken. In dit voorbeeld zou
het niet kunnen aangezien de gebruiker geen rechten heeft om records te
verwijderen maar de syntax die iemand met voldoende rechten moet gebruiken
is de volgende:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
mysql> DELETE FROM link_soort WHERE naam = 'test';  
Query OK, 1 row affected (0.02 sec)
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<H2>9.3 De site bezoeker toegang geven tot een database.</H2>

<P>Om site bezoekers gegevens uit een database te kunnen laten opvragen moet je 
bepaalde rechten toekennen. Dit is het snelste te realiseren in de mysql 
monitor. We gebruiken hiervoor het GRANT statement:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4 to server version: 3.23.1-alpha

Type 'help' for help.

mysql> use mysql
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> 
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Je kan ook gelijk vanaf de prompt de database selecteren die je wilt
gebruiken, je doet dit vanaf de prompt door mysql aan te roepen met als
argument de database die je wilt gebruiken:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
$mysql mysql
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Je kan de gebruiker verschillende rechten toekennen. De meest voorkomende
rechten zijn SELECT, INSERT en UPDATE. Dit doe je op de volgende manier:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
GRANT SELECT, INSERT ON gb.gb TO guest@localhost IDENTIFIED BY 'hallo'; 
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>We hebben de gebruiker guest nu rechten gegeven om records toe te voegen en
te selecteren in de gb database waarbij hij alleen rechten heeft in de tabel
gb. Dit alles kan alleen op de machine waarop MySQL staat. Het wachtwoord voor
die gebruiker is hallo.
<P>Mocht je de gebruiker nu ook UPDATE rechten willen geven en hij moet alles
vanaf een andere machine kunnen doen dan gebruik je het volgende:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
GRANT SELECT, INSERT, UPDATE ON gb.gb TO guest@domeinnaam IDENTIFIED BY 'hallo'; 
</PRE>
<HR>
</CODE></BLOCKQUOTE>
<P>Mocht de database gb uit diverse tabellen bestaan waarop de gebruiker
allemaal moet kunnen lezen, schrijven en aanpassen dan gebruik je de volgende
syntax:
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
GRANT SELECT, INSERT, UPDATE ON gb.* TO guest@domeinnaam IDENTIFIED BY 'hallo'; 
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</BODY>
</HTML>
