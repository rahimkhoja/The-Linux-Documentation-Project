<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>MS Outlook naar Unix Mailbox Conversie mini HOWTO</TITLE>


</HEAD>
<BODY>
<H1>MS Outlook naar Unix Mailbox Conversie mini HOWTO</H1>

<H2>Greg Lindahl, <CODE>lindahl@pbm.com</CODE>, <BR>
Vertaald door: Ellen Bokhorst, <CODE>bokkie@nl.linux.org</CODE></H2>v1.2.2, 03-01-2002
<P><HR>
<EM>In deze minihowto wordt uitgelegd hoe oude email uit Microsoft Outlook
(niet Outlook Express!) kan worden geconverteerd naar typische Unix
bestandsformaten.</EM>
<HR>
<H2><A NAME="s1">1. Introductie</A></H2>

<P>Ondanks dat er verscheidene programma's bestaan om formaten zoals
Microsoft Outlook Express naar Unix formaat te converteren, staat
gebruikers van Outlook een grotere uitdaging te wachten.
Een conversiemethode is het gebruik van Mozilla Mail onder Windows;
een andere beslaat een wat gecompliceerde methode. Beiden worden in deze
minihowto uitgelegd.
<P>Het databaseformaat dat Outlook gebruikt voor een .PST bestand, genaamd
Jet, is gedocumenteerd op:
<P>
<A HREF="http://msdn.microsoft.com/library/techart/olexcoutlk.htm">http://msdn.microsoft.com/library/techart/olexcoutlk.htm</A><H2>1.1 Copyright</H2>

<P>
<P>Copyright (c) 2001-2002 door Greg Lindahl
<P>
<P>Het is toegestaan dit document te distribueren en/of wijzigen onder
de voorwaarden van de GNU Free Documentation License, Versie 1.1 of
enige latere versie gepubliceerd door de Free Software Foundation;
zonder Invariant Sections, zonder Front-Cover teksten, en zonder
Back-Cover teksten. Een kopie van de licentie is te vinden op:
<P>
<A HREF="http://www.gnu.org/copyleft/fdl.html">http://www.gnu.org/copyleft/fdl.html</A><P>Ik verzoek je correcties en/of opmerkingen door te sturen naar de
beheerder van dit document. Als je overweegt een afgeleide werk anders
dan een vertaling te maken, verzoek ik je deze plannen te bespreken
met de huidige beheerder.
<H2>1.2 Disclaimer</H2>

<P>Gebruik de informatie in dit document op eigen risico. Ik verwerp enige
potenti&euml;le aansprakelijkheid voor de inhoud van dit document.
Gebruik van de concepten, voorbeelden en/of andere inhoud van dit document
is geheel op eigen risico.
<P>Alle copyrights zijn in handen van hun eigenaren, tenzij specifiek
anders vermeld. Gebruik van een term in dit document zou niet moeten
worden aangemerkt als van invloed op de geldigheid van enig handelsmerk
of servermerk.
<P>Het benoemen van bepaalde producten of merken zouden niet moeten worden
aangemerkt als onderschrijvingen.
<P>Het wordt je ten zeerste aanbevolen een backup van je systeem te maken
alvorens grote installaties uit te voeren en regelmatig een backup van
je systeem te maken.
<P>Plaats je kat niet in de magnetron.
<H2>1.3 Nieuws</H2>

<P>1.01: Kleine typfout gecorrigeerd in inetd/xinetd opstartinstructies.
<P>1.1: Informatie toegevoegd over Kmailcvt, Mozilla, en hoe je
Outlook zover krijgt dat het communiceert met IMAP-server als het zich
in Exchange modus bevindt.
<P>1.2: Details toegevoegd over het gebruik van Mozilla om dezelfde taak
uit te voeren
<P>1.2.1: Opmaakfout gecorrigeerd.
<P>1.2.2: Gelicentieerd onder de GFDL, meer kleine typcorrecties.
<H2>1.4 Andere manieren om dit te doen</H2>

<P>Een lijst met conversie-utility's, waarvan veel commercieel, is te vinden op:
<P>
<A HREF="http://www.emailman.com/conversion/index.html">http://www.emailman.com/conversion/index.html</A><P>
<P>Ik heb ooit beweerd dat het programma Kmailcvt nu naar Outlook mailboxen
converteert. Ik ben er echter niet 100% zeker van of deze bewering waar
is. Kmailcvt converteert beslist naar Outlook Express mailboxen, maar deze
zijn totaal anders dan de Outlook mailboxen. Dus mocht je hier achter
komen, laat me dit dan alsjeblieft weten.
<H2><A NAME="s2">2. Converteren met behulp van Mozilla Mail</A></H2>

<P>
<P>Ik heb ook gehoord dat Mozilla Mail onder Windows Outlook mailboxen
kan converteren. Ik vond de documentatie op de website van de
Ximian Evolution. Ik heb dit niet uitgeprobeerd, omdat ik geen
Windows machine meer heb. Maar dit is wat ze zeggen te doen:
<P>Start Mozilla Mail
<P>Ga naar "File > Import" en selecteer dat je mail vanuit Outlook wenst
te importeren. Wanneer dat klaar is, ben je er al bijna.
<P>Ik geloof dat Mozilla al zijn mailboxen in Unix mbox formaat bestanden
opslaat, zelfs onder Windows. Dus het enige wat je hoeft te doen is die
bestanden naar je Linux box transporteren. Je kunt ze vinden in:
<P>C:/windows/Application Data/Mozilla/Profiles/default/XXX/Mail/imported.mail/, 
waar XXX uit een of andere verzameling cijfers bestaat.
Zijn er meerdere gebruikers op je
Windows machine, dan zal in plaats daarvan je gebruikersnaam "default" zijn.
<P>Zoals ik al eerder aangaf, heb ik deze methode nooit geprobeerd, dus ik
weet niet hoe goed het werkt. In het bijzonder, zijn de onderwerpen die
ter sprake kwamen in sectie 3.4 ook van toepassing op deze conversiemethode.
<P>Tussen twee haakjes, de reden dat Mozilla alleen Outlook mailboxen onder
Windows kan lezen komt doordat het een Microsoft DLL aanroept om dit te doen.
<H2><A NAME="s3">3. Converteren met behulp van IMAP</A></H2>

<H2>3.1 Voorbereiding</H2>

<P>Wees er allereerst heel zeker van dat je het op deze wijze wilt doen.
In het bijzonder wordt in sectie 2 uitgelegd hoe Netscape Mail onder Windows
kan worden gebruikt om de conversie uit te voeren. Dat is makkelijker dan
deze methode.
<P>Wanneer je besluit het op deze wijze te doen, zorg dan dat je kopie van
Outlook met IMAP servers kan communiceren. Toen ik deze HOWTO voor de eerste
keer schreef, veronderstelde ik dat Outlook Outlook was. Niets daarvan.
Als je Outlook in Corporate/Workgroups modus gebruikt (welk communiceert met
Exchange) in plaats van in de Internet modus (welke communiceert met POP/IMAP
servers), dan moet je van modus wisselen.
<P>Als test om te zien of alles goed is, bekijk je het "Tools" menu van
Outlook en kijkt of er een "Accounts" item voorkomt. Als dit er is, dan
is alles in orde en kun je verder gaan met sectie 3.2. Als het niet
voorkomt, lees je verder.
<P>Het wijzigen van de modi is niet zo alledaags, maar een behulpzame
lezer (Matt Huyck) stuurde de volgende instructies op, welke er gevaarlijk
uitzien en die ik niet heb getest:
<P>Selecteer "Options..." vanuit het "Tools" menu, en ga dan naar de "Mail
Services" tab in het resulterende Options dialoogvenster. Onderaand die
tab vind je een knop met het label "Reconfigure Mail Support..."
Klik hier op.  Er verschijnt een nieuw venster met in de titelbalk
"Outlook 2000 Startup" en een "E-mail Service Options" koptekst.  
Er zijn twee relevante keuzerondjes: "Internet
Only" en "Corporate or Workgroup".  Wijzig dit in "Internet Only"
en klik op "Next >".  Er wordt je dan een venster met zeer lang bericht 
voorgeschoteld wat je zorgvuldig moet lezen, omdat je een zeer belangrijke
(maar onomkeerbare) wijziging in de Exchange clientconfiguratie gaat maken.
Alhoewel dit niet expliciet wordt aangegeven, zorg je ervoor dat je een kopie
hebt van de Microsoft Office installatie CD voordat je op "Yes" klikt.
Klik op "Yes" en laat Outlook een paar seconden zijn werk doen totdat het
daar volledig mee klaar is. Open Outlook weer. Hier wordt je wellicht
gevraagd om de installatie-CD. Als de herconfiguratie voltooid is, ben
je zover om met stap 3.2 van de HOWTO verder te gaan.
<P>Om terug te keren naar de oorspronkelijke Outlook configuratie, volg je
dezelfde aanwijzingen, maar je zult uiteraard op het *andere*
keuzerondje klikken.
<P>Een ander verschil is, als je gebruik maakt van Exchange. Zoals je al
aangaf in sectie 3.4, blijft de oorspronkelijke 'From ' regel" niet
behouden. Voor Exchange gebruikers echter geldt de opmerking
"Gelukkkig heb je die informatie niet echt nodig" niet helemaal. De
"From" header die ontbreekt is het enige met de identiteit van de 
zender in berichten die werden verzonden op een interne Exchange server,
d.w.z. berichten die nergens via een Internet gateway gingen.
Ik heb mijn "From" headers behouden door kopie&euml;n van mijn mailfolders
als tekstbestanden op te slaan via de "Import and Export..." opdracht
uit het "File" menu. Ik ben van plan wat Perl/Grep code te schrijven waarmee
die "From" headers weer in mijn Linux mbox bestanden zullen worden gevoegd.
Als ik dat werkend krijg, zal ik je dat nog laten weten.
<H2>3.2 Installeer (tijdelijk!) een IMAP-server op je Linux box</H2>

<P>De installatie varieert per Linux-distributie, dus zal ik als voorbeeld
RedHat 7.0 nemen. Ten eerste moet je het juiste package installeren, wat
gewoonlijk 'imap' wordt genoemd.
<BLOCKQUOTE><CODE>
<PRE>
 cd /home/redhat-7.0-cd/RedHat/RPMS
 rpm -i imap*
</PRE>
</CODE></BLOCKQUOTE>
<P>
<P>In werkelijkheid moest ik ook het package xinetd package installeren,
aangezien ik een "werkstation" installatie had; rpm gaf een foutmelding
die me aangaf dat ik dit moest doen. En natuurlijk bevond deze zich op
de tweede CD van RedHat 7.0. Debian gebruikers die gebruik maken van
"apt-get" hoeven zich over dergelijke zaken geen zorgen te maken.
<P>Vervolgens moeten we de imap-server activeren. Dit wordt gewoonlijk bestuurd
door een regel in het bestand <CODE>/etc/inetd.conf</CODE>:
<BLOCKQUOTE><CODE>
<PRE>
 #imap    stream  tcp     nowait  root    /usr/sbin/tcpd        /usr/sbin/imapd
</PRE>
</CODE></BLOCKQUOTE>
<P>Voor de bovenstaande regel staat een commentaarteken; verwijder het # teken.
Onder RedHat 7.0 en latere systemen met xinetd, pas je in plaats daarvan
<CODE>/etc/xinetd.d/imap</CODE> aan, wijzig "disable=yes" in "disable=no".
<P>Herstart dan inetd of xinetd met:
<BLOCKQUOTE><CODE>
<PRE>
 /etc/rc.d/init.d/inetd restart
</PRE>
</CODE></BLOCKQUOTE>
<P>of
<BLOCKQUOTE><CODE>
<PRE>
 /etc/rc.d/init.d/xinetd restart
</PRE>
</CODE></BLOCKQUOTE>
<P>Reboot als al het andere niet lukt.
<P>Je wilt de IMAP-server niet voor zolang geactiveerd laten.
Deze server draait als root en bevatte in het verleden beveiligingsfouten. 
Daarom zou je het niet geactiveerd moeten laten, tenzij je het permanent
wilt gebruiken. We zullen deze server in stap 4 deactiveren.
<P>Om Outlook met deze IMAP-server te kunnen verbinden, moet je de naam of
het IP-adres van de Linux box weten.
<H2>3.3 Verbind de Outlook client met de server</H2>

<P>Om al onze email naar de server te kunnen kopi&euml;ren moeten we
je Outlook client in kennis stellen van deze nieuwe server. Selecteer
"Accounts..." uit het menu "Tools", en voeg ("Add") dan een nieuw
account "Mail..." toe. De belangrijkste items zijn dat de server
gebruik maakt van IMAP om de email te downloaden, dat de inkomende
mailserver de naam of het IP-adres is van je Linux-box uit sectie 3.2, en
de de gebruikersnaam en het wachtwoord zouden gelijk moeten zijn aan
je gebruikersnaam en het wachtwoord op de Linux-box.
(Zoals gewoonlijk is het geen goed idee onder
Linux voor dit doel het root account te gebruiken.)
<P>Zodra je "Finish" hebt geselecteerd, stel je deze nieuwe account in als
default door het op te laten lichten en te klikken op "Set as Default".
Als het goed is, zal Outlook een verbinding maken met je IMAP-server
en de naam van je IMAP-server zou onderaan
je folderlijst moeten verschijnen. Klik erop; als het goed is zul je
een Inbox folder te zien moeten krijgen.
(als /var/mail/jegebruikersnaam niet op je Linux-box voorkomt, zul je
geen berichten naar je INBOX kunnen slepen en neerzetten... en de
foutmelding zal verwarrend zijn. Echter dat is niet wat we zullen
gaan doen.)
<H2>3.4 Kopieer je email</H2>

<P>Je kunt nu door middel van slepen en neerzetten gehele folders met email 
vanuit Outlook naar de IMAP servernaam overbrengen. De email zal nu inclusief 
alle bijlagen naar de Linux box worden gekopieerd. Helaas wordt het ook 
onmiddellijk uit Outlook verwijderd. Items kopie&euml;ren zonder ze te
verwijderen doe je door met de rechtermuisknop op de foldernaam te
klikken en de "Copy" optie te selecteren. Kies als bestemming de
Linux server die onderaan de lijst staat vermeld.
<P>Het leven is echter niet zo eenvoudig. Outlook ondersteunt folders binnen
folders waarin ook berichten voorkomen. De Linux IMAP-server
biedt hier geen ondersteuning voor; een folder is of een regulier bestand
met berichten, of een directory met subdirectory's en bestanden. Dus
als je onder Outlook folders hebt met zowel berichten als subfolders.
dan kun je de gehele structuur niet naar de Linux IMAP-server kopi&euml;ren.
Een andere incompatibiliteit met de Linux IMAP-server is dat je het vantevoren
moet vertellen of een nieuwe folder subfolders of berichten zal bevatten.
Dit doe je door een slash (<CODE>/</CODE> toe te voegen aan de naam van de
folder wanneer je deze aanmaakt. Deze slash verdwijnt weer als de folder
eenmaal is aangemaakt.
<P>Dus om een structuur met folders naar de Linux IMAP-server te kunnen 
kopi&euml;ren, moet je eerst een replica van de structuur van je bestaande 
folders op de Linux IMAP-server aanmaken. Let op welke van de bestaande
folders zowel subfolders als berichten bevatten als je dit aan het doen bent.
Je zult die berichten naar elders moeten verplaatsen.
Zodra je de gehele structuur hebt aangemaakt, kopieer of verplaats je
de groepen folders naar de Linux IMAP-server.
<P>Een laatste op te merken incompatibiliteit is dat de Linux IMAP server
geen folders toestaat met slashes (/) in de naam. Je zult dergelijke
folders moeten hernoemen voordat je ze kopieert of verplaatst.
<P>Op de Linux box, verschijnen folders als bestanden en directory's in je
homedirectory. Het formaat van deze bestanden is gelijk aan het 
gebruikelijke Unix mailformaat, wat de meeste Unix/Linux mailtools
direct gebruiken of waarvan/waarnaar ze kunnen converteren.
Bestanden met bijlagen hebben MIME bijlagen; tevens is er nog een
extra bericht per folder, dit is een (nutteloze) header.
<P>(Een deel van de gegevens welke niet behouden blijft, is de oorspronkelijke
"From" regel, waarin het envelope adres van de email staat. Gelukkig heb
je die informatie niet echt nodig.)
<H2>3.5 De-installeer IMAP van je Linux box</H2>

<P>Zodra je al je email hebt getransporteerd, wil je wellicht de IMAP-server
van je Linux box deinstalleren, om de eerder genoemde beveiligingsredenen.
Hiermee zijn dezelfde 2 stappen gemoeid als die je nam bij het installeren
van de server:
<OL>
<LI> Verwijder de RPM's:
<BLOCKQUOTE><CODE>
<PRE>
  rpm -e imap
</PRE>
</CODE></BLOCKQUOTE>
</LI>
<LI> Verwijder de regel in <CODE>/etc/inetd.conf</CODE> of 
<CODE>/etc/xinetd.d/imap</CODE></LI>
<LI> Herstart inetd of xinetd, of reboot.</LI>
</OL>
<P>
<P>Dat is dat! Je hebt weer een stap genomen richting een Microsoft vrije
levensstijl.
</BODY>
</HTML>
