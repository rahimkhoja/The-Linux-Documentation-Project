<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>NT OS Loader + Linux mini-HOWTO</TITLE>


</HEAD>
<BODY>
<H1>NT OS Loader + Linux mini-HOWTO</H1>

<H2>Bernd Reichert, &lt;reichert@dial.eunet.ch&gt;,
Vertaald door Ellen Bokhorst, &lt;bokkie@nl.linux.org&gt;</H2>v1.11, 2 September 1997
<P><HR>
<EM>Dit document beschrijft het gebruik van de Windows NT bootloader om Linux
op te starten. Deze procedures zijn getest met Windows NT 4.0 WS en
Linux 2.0.</EM>
<HR>
<H2><A NAME="s1">1. Hoe werkt de NT OS Loader</A></H2>

<P>De NT OS loader verwacht dat de bootsector van de andere besturingssystemen 
beschikbaar is als een bestand. Het leest dit bestand en
start het geselecteerde besturingssysteem,
b.v. Windows NT in verschillende Modes of enig ander OS.
<H2><A NAME="s2">2. Tips voor het installeren van Windows NT en Linux op hetzelfde Systeem</A></H2>

<H2>2.1 Windows NT installatie</H2>

<P>Probeer eerst Windows NT te installeren. 
Als je NTFS voor je Windows NT-partitie wilt gebruiken, houd dan in
gedachten dat de huidige productieversie van Linux de NTFS-partities niet
kan benaderen.
Een alpha-driver die NTFS-Partities kan lezen is beschikbaar bij
<CODE>http://www.informatik.hu-berlin.de/~loewis/ntfs</CODE>.
Je kunt een aparte FAT-Partitie aanmaken om gegevens uit te wisselen
of je moet DOS-geformatteerde diskettes gebruiken.
<H2>2.2 Partitioneren</H2>

<P>Een andere Mini-howto raadt aan om niet de #Disk Administrator" van NT te
gebruiken voor het aanmaken van de Linux swap- en rootpartities. 
Het volstaat hier om te vrije ruimte te bekijken.
Ik raad je ook aan om op een later tijdstip de fdisk van Linux te gebruiken.
<H2>2.3 Linux installatie</H2>

<P>Boot linux nu vanaf diskettes, maak de swap- en root-partitie aan.
Fdisk gaat ervan uit dat de ntfs-partitie een HPFS-partitie is.
Dit is normaal.
Boot nogmaals vanaf diskettes en installeer Linux zoals je dat wilt.
<P>Voor het geval de installatie-procedure voorstelt om de gevonden
HPFS partitie te mounten: Negeer dit dan.
<H2>2.4 Lilo</H2>

<P>Als je bij de Lilo-sectie aankomt, geef je Linux-root-partitie dan op
als je boot-device omdat Windows NT de eigenaar is van de Master Boot 
Record (MBR) van je harddisk. Dit betekent dat de root-entry en
de boot-entry in je <CODE>/etc/lilo.conf</CODE> dezelfde waarde hebben.
Als je een IDE-harddisk hebt en je Linux-partitie is de tweede partitie
ziet het boot-gedeelte in <CODE>/etc/lilo.conf</CODE> er ongeveer zo uit:
<P>
<BLOCKQUOTE><CODE>
<PRE>
boot=/dev/hda2
</PRE>
</CODE></BLOCKQUOTE>
<P>Als je twee disks hebt en Linux komt voor op de eerste partitie
van je tweede disk, dan ziet het boot-gedeelte in <CODE>/etc/lilo.conf</CODE>
er ongeveer als volgt uit:
<P>
<BLOCKQUOTE><CODE>
<PRE>
boot=/dev/hdb1
</PRE>
</CODE></BLOCKQUOTE>
<P>Start lilo op met een kernel die overeenkomt met je systeem.
Controleer de kernel door eerst vanaf een diskette op te starten als je
niet zeker van je zaak bent.
<P>Als je Windows NT nu niet kunt booten, heb je een probleem.
Ik hoop dat je onlangs een repair-disk hebt aangemaakt.
<H2><A NAME="s3">3. Bootpart</A></H2>

<P>Er bestaat een NT-programma met de naam bootpart geschreven door G. Vollant 
die de taken in de volgende twee punten voor je kan doen.
Bootpart is beschikbaar bij
<CODE>http://ourworld.compuserve.com/homepages/gvollant/bootpart.htm</CODE>.
<P>Gebruik de procedures zoals beschreven in punt 5 en 6, als
je wilt weten hoe de dingen met elkaar samenwerken.
<H2><A NAME="s4">4. Het Linux-deel van het werk</A></H2>

<P>Je moet vanaf diskettes booten totdat het NT-deel is aangepast.
<P>Nu moet je de bootsector vanaf je Linux-root-Partitie onttrekken.
Met /dev/hda2 als je linux-partitie, is het dd-commando:
<P>
<BLOCKQUOTE><CODE>
<PRE>
# dd if=/dev/hda2 of=/bootsect.lnx bs=512 count=1
</PRE>
</CODE></BLOCKQUOTE>
<P>Er is iets niet in orde als je bootsect.lnx groter is dan 512 bytes.
<P>Kopieer nu het bestand bootsect.lnx naar een DOS-geformatteerde diskette
als dit je manier is om bestanden naar de NTFS-Windows-partitie over te
brengen.
<P>Je kunt het kopie&euml;ren met
<P>
<BLOCKQUOTE><CODE>
<PRE>
# mcopy /bootsect.lnx a:
</PRE>
</CODE></BLOCKQUOTE>
<P>of met
<P>
<BLOCKQUOTE><CODE>
<PRE>
# mount -t msdos /dev/fd0 /mnt
# copy /bootsect.lnx /mnt
# umount /mnt
</PRE>
</CODE></BLOCKQUOTE>
<H2><A NAME="s5">5. Het Windows NT gedeelte van het werk</A></H2>

<P>Kopieer het bestand vanaf de diskette naar <CODE>C:\\bootsect.lnx</CODE>. 
Ik vertel je niet hoe je dat doet.
<P>Wat lilo.conf voor Linux is, is <CODE>c:\\boot.ini</CODE> voor Windows NT.
Verwijder het systeem- en het alleen-lezen-kenmerk voordat je het kunt
wijzigen met:
<P>
<BLOCKQUOTE><CODE>
<PRE>
C:\attrib -s -r c:\boot.ini 
</PRE>
</CODE></BLOCKQUOTE>
<P>Wijzig nu als volgt het bestand boot.ini met een editor, bijvoorbeeld
met notepad:
<P>
<BLOCKQUOTE><CODE>
<PRE>
[boot loader]
timeout=30
default=multi(0)disk(0)rdisk(0)partition(1)\WINNT
[operating systems]
multi(0)disk(0)rdisk(0)partition(1)\WINNT="Windows NT Workstation ... 
multi(0)disk(0)rdisk(0)partition(1)\WINNT="Windows NT Workstation ...
C:\BOOTSECT.LNX="Linux"
</PRE>
</CODE></BLOCKQUOTE>
<P>Alleen de laatste regel is in dit voorbeeld toegevoegd.
Herstel de kenmerken, nadat je <CODE>boot.ini</CODE> hebt opgeslagen, met: 
<P>
<BLOCKQUOTE><CODE>
<PRE>
C:\attrib +s +r c:\boot.ini 
</PRE>
</CODE></BLOCKQUOTE>
<P>Na het afsluiten en weer opnieuw opstarten van Windows NT zou je het
volgende te zien moeten krijgen:
<P>
<BLOCKQUOTE><CODE>
<PRE>
  OS Loader V4.00
 
  Please select the operating system to start:

  Windows NT Workstation Version 4.0
  Windows NT Workstation Version 4.0 [VGA mode]
  Linux

Selecteer Linux en zie

  LILO loading zImage ....
</PRE>
</CODE></BLOCKQUOTE>
<H2><A NAME="s6">6. Doe het nogeens</A></H2>

<P>Iedere keer als de bootsector van je linux-partitie is aangepast, moet
er een nieuwe kopie van bootsect.lnx naar
<CODE>C:\BOOTSECT.LNX</CODE> worden overgezet.
Dit gebeurt bijvoorbeeld als je een nieuwe kernel met lilo installeert.
Zoals je kunt zien is een dergelijk systeem niet ideaal voor het testen
van experimentele kernels.
<H2><A NAME="s7">7. Probleemoplossing</A></H2>

<P>Als iets niet naar verwachting werkte, controleer de opstartbaarheid met
een diskette.
Met <CODE>/dev/hdb1</CODE> als je Linux-partitie, staan de volgende
gegevens in <CODE>/etc/lilo.conf</CODE>:
<P>
<BLOCKQUOTE><CODE>
<PRE>
root=/dev/hdb1
boot=/dev/fd0
</PRE>
</CODE></BLOCKQUOTE>
<P>Start lilo op met een diskette in de drive. 
Probeer nu vanaf de diskette te booten.
Als Linux op <CODE>/dev/hdb1</CODE> niet kan worden gestart,
zal het met de NT OS loader ook niet lukken om op te starten.
Als je een boel <CODE>01 01 01 01</CODE> ziet, is je root-disk niet toegankelijk.
Controleer of al je disks in de bios bekend zijn.
<P>Als de diskette je Linux-partitie boot, je kunt je boot-sector
onttrekken voor de NT OS loader met: 
<P>
<BLOCKQUOTE><CODE>
<PRE>
# dd if=/dev/fd0 of=/bootsect.lnx bs=512 count=1
</PRE>
</CODE></BLOCKQUOTE>
<P>Je kunt deze diskette bewaren als je rescue-diskette, voor het geval
je Windows NT installatie het begeeft.
<H2><A NAME="s8">8. Referenties</A></H2>

<P>
<UL>
<LI>De Linux+WindowsNT mini-HOWTO</LI>
<LI>De FAQ voor FreeBSD 2.X</LI>
</UL>
<H2><A NAME="s9">9. Erkennningen</A></H2>

<P>
<UL>
<LI>Met dank aan Xiaoming Yi &lt;z3c20@ttacs.ttu.edu&gt; voor de tip dat
de procedures ook met andere dan de eerste disks werken.</LI>
<LI>Met dank aan Frank Dennler &lt;Frank.Dennler@zkb.ch&gt; voor de
diskette-truuk.</LI>
</UL>
<H2><A NAME="s10">10. Feedback</A></H2>

<P>Commentaar is welkom.
</BODY>
</HTML>
