<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>Besparen van Ruimte mini-HOWTO</TITLE>


</HEAD>
<BODY>
<H1>Besparen van Ruimte mini-HOWTO</H1>

<H2>Door Guido Gonzato,
<A HREF="mailto:guido@ibogeo.df.unibo.it">mailto:guido@ibogeo.df.unibo.it</A>,<BR>
Vertaald door: Ellen Bokhorst 
<A HREF="mailto:bokkie@nl.linux.org">mailto:bokkie@nl.linux.org</A></H2>v1.0.1, 7 april 1999
<P><HR>
<EM>Deze mini-HOWTO geeft je aanwijzingen je Linux-installatie in zo min
mogelijk ruimte te persen. Het is vooral gericht op gebruikers van een notebook.</EM>
<HR>
<H2><A NAME="s1">1. Introductie</A></H2>

<P>
<P>Ik heb een notebook waarop ik Linux heb ge&iuml;nstalleerd, naast Windows 95
wat was voorge&iuml;nstalleerd. Ik perste de Windows-partitie samen tot
500 Mb, om ruimte te maken voor een 240 Mb partitie voor Linux.
De laatste partitie kan klein lijken, ik heb het echter voor elkaar gekregen
om er een tamelijk compleet Linux Systeem op te installeren, gebaseerd op
Red Hat 4.1 en wat magic om zoveel mogelijk ruimte te besparen.
<P>Als je om ruimte verlegen zit, zullen de te vinden aanwijzingen in de 
volgende secties een aanmerkelijke hoeveelheid harddiskruimte vrijmaken.
De enige waarschuwing die ik je geef is: 
geef mij niet de schuld als er iets verkeerd gaat! We zullen gebruik gaan
maken van een paar programma's die voor mij prima werkte, maar die
inherent gevaarlijk zijn. Je bent gewaarschuwd.
<H2><A NAME="s2">2. Software benodigdheden</A></H2>

<P>
<P>Je hebt nodig:
<P>
<UL>
<LI> een volledig werkend Linux-systeem (elke versie zou Ok moeten zijn):</LI>
<LI> het algemene <CODE>gzip</CODE> compressie utility, of als alternatief <CODE>bzip2</CODE>
dat je kunt vinden op
<A HREF="ftp://sunsite.unc.edu:/pub/Linux/utils/compress">ftp://sunsite.unc.edu:/pub/Linux/utils/compress</A>; 
deze tool comprimeert beter dan <CODE>gzip</CODE>, maar het is ook wat langzamer 
en slurpt een hoop geheugen op;</LI>
<LI> de <CODE>upx</CODE> uitvoerbare compressor, waarvan de home-page te vinden
is op 
<A HREF="http://cdata.tvnet.hu/~ml/upx.html">http://cdata.tvnet.hu/~ml/upx.html</A> en 
<A HREF="http://wildsau.idv.uni-linz.ac.at/mfx/upx.html">http://wildsau.idv.uni-linz.ac.at/mfx/upx.html</A>;</LI>
<LI> het <CODE>zlibc</CODE> package, beschikbaar op 
<A HREF="ftp://sunsite.unc.edu:/pub/Linux/libs/compression">ftp://sunsite.unc.edu:/pub/Linux/libs/compression</A>. Het wordt
<CODE>zlibc-X.X.tar.gz</CODE> genoemd, waar <CODE>X.X</CODE> voor de laatste versie staat.</LI>
</UL>
<P>Er zijn andere uitvoerbare compressors. &Eacute;&eacute;n daarvan is 
<CODE>gzexe</CODE> (vergeet het), terwijl <CODE>tcx</CODE> waarschijnlijk de beste was
voordat <CODE>upx</CODE> beschikbaar kwam; nog een ander is
<CODE>tzx</CODE>, in theorie beter dan <CODE>tcx</CODE>. Het geval is, dat het
alles verpestte toen ik het op een reserve PC uitprobeerde, alhoewel ik er
niet zeker van ben, of ik iets verkeerds deed.
Je kunt je maar beter bij <CODE>upx</CODE> houden: het is betrouwbaar,
effic&iuml;ent en erg handig.
<P>Er zijn kernel-patches beschikbaar die voorzien in een transparante
compressie van bestandssystemen a la Stacker, maar tijdens dit schrijven,
heeft geen daarvan nog de reputatie stabiel en betrouwbaar te zijn. 
Blijf het voor de zekerheid uit de weg.
<H2><A NAME="s3">3. De procedure</A></H2>

<H2>3.1 Verwijderen van de Kernel Sources</H2>

<P>De kernel-sources nemen meer dan 20 Mb in beslag, en misschien dat je
ze wilt verwijderen. Als dit zo is, raad ik je aan een nieuwe kernel te
compileren die voor eens en voor altijd aan je computer is aangepast.
Wees echter voorzichtig.
<P>Ik raad je <EM>niet</EM> aan je kernel-sources te verwijderen, tenzij je er zeker
van bent dat je computer juist is geconfigureerd.
Bovendien heb je de kernel #includes nodig om C-programma's te
compileren. Bedenk je tweemaal!
<P>Als je toch besluit dit te doen, verwijder dan <EM>niet</EM> de 
include/linux tree, tenzij je weet dat je nooit applicaties
op je computer zal compileren.
<H2>3.2 Ontdoen van Applicaties</H2>

<P>
<P>Neem nu de beslissing over welke applicaties je <EM>echt</EM> nodig hebt.
Een aantal kan overtollig blijken: ben je er bijvoorbeeld zeker van niet
zonder <CODE>emacs</CODE> te kunnen? Je zou in plaats daarvan <CODE>jed</CODE> kunnen gebruiken.
<P>Het is aan jou te beslissen wat je wilt behouden. Een aantal algemene punten:
<P>
<UL>
<LI> <CODE>gcc</CODE> is een tamelijke groot package. Het is nodig voor het
compileren van de kernel en alle applicaties waar geen voorgefabriceerde
binaire Linux-bestanden voor zijn. Het is uiteraard ook nodig als je je
eigen C of Fortran (met <CODE>f2c</CODE> of <CODE>g77</CODE>) programma's schrijft; overweeg
wat je nodig hebt voordat je het verwijdert.
Andere compilers zoals <CODE>lcc</CODE> zijn prima, maar niet tot aan het niveau
van <CODE>gcc</CODE>. Ik raad je aan het te houden;</LI>
<LI>X11 is afgrijselijk groot, maar het is fijn om te hebben. Als je
besluit het niet op te kunnen geven, probeer het dan met zo min mogelijk
af te kunnen: alleen de juiste X-server, &eacute;&eacute;n eenvoudige
window manager, &eacute;&eacute;n <CODE>xterm</CODE>, geen 100 dpi fonts, enzovoort;</LI>
<LI> TeX en de daarbij behorende packages zijn inderdaad erg groot. Het
opgeven van LaTeX en het houden op gewoon TeX bespaart een hoop ruimte;
het opgeven van X11-previewers, zoals
<CODE>xdvi</CODE> en <CODE>ghostview</CODE> is mogelijk als je <CODE>dvitty</CODE>,
<CODE>dvivga</CODE> en dergelijke gebruikt. Het elimineren van 
X11 dviware zou zelfs X11 overtollig maken;</LI>
<LI> spellen zijn nooit ``nodig''.</LI>
</UL>
<H2>3.3 Strippen van Binaire bestanden</H2>

<P>
<P>Laten we beginnen met het laten afnemen van de grootte van binaire bestanden.
Ga naar /usr/bin en geef het commando
<P>
<BLOCKQUOTE><CODE>
<PRE>
machine:/usr/bin# strip *
</PRE>
</CODE></BLOCKQUOTE>
<P>waarmee alle symbolen ingesloten in de binaire bestanden zullen worden
verwijderd. Herhaal deze stap in /usr/X11R6/bin/ en andere
directory's met uitvoerbare bestanden die je mogelijk hebt
(vergeet de binaire bestanden van TeX en <CODE>gcc</CODE> niet te lokaliseren),
maar voer het <EM>niet</EM> uit onder /sbin, /bin, of
/usr/sbin/ als je prijs stelt op je installatie!
<H2>3.4 Comprimeren met upx</H2>

<P>
<P>Installeer als eerste <CODE>upx</CODE> en lees de documentatie ervan. Ga dan naar
/usr/bin en voer 't uit met het commando <CODE>upx *</CODE>; het zal
alle uitvoerbare bestanden comprimeren, inclusief de suid bestanden
(<CODE>tcx</CODE> zou dit niet doen). Herhaal deze stap net als hierboven in andere
directory's.
<P>Denk eraan de uitvoerbare bestanden te comprimeren wanneer je een nieuw
package installeert!
<H2>3.5 Gzip</H2>

<P>
<P>Er zijn heel wat andere bestanden die voor eens en voor altijd kunnen
worden gecomprimeerd. Laten we eens beginnen met
/usr/doc/; ga naar deze directory en pas het volgende commando
toe:
<P>
<BLOCKQUOTE><CODE>
<PRE>
machine:/usr/doc# find . -type f -exec gzip -9 {} \; 2> /dev/null
</PRE>
</CODE></BLOCKQUOTE>
<P>Denk eraan de docs te comprimeren als je een nieuw package installeert!
<P>Herhaal deze stap in de directory met de documentatie voor TeX (op
mijn systeem, /usr/lib/texmf/texmf/doc/. Als je het echt
<EM>zeker weet</EM>, verwijder deze directory's dan voorgoed.
<P>Installeer nu <CODE>zlibc</CODE> en compileer het. Als je systeem net als dat
van mij is, dan zal het compilatie-proces worden afgebroken en een melding
geven over een ontbrekend (static) libc.
Doet er niet toe: er zal een bestand genaamd <CODE>uncompress.o</CODE> te vinden zijn,
dat is wat ik nodig had. Verplaats het naar /usr/local/lib/ en
voeg deze regel toe aan /etc/profile:
<P>
<BLOCKQUOTE><CODE>
<PRE>
export LD_ELF_PRELOAD=/usr/local/lib/uncompress.o
</PRE>
</CODE></BLOCKQUOTE>
<P>Nu kun je met <CODE>gzip</CODE> niet alleen documentatie comprimeren, maar
ook gegevenbestanden:
de applicaties waarmee ze worden gebruikt, zullen ze niettemin kunnen
gebruiken. In theorie zou de truc bij de meeste applicaties moeten kunnen
werken, maar in praktijk kan de mate van succes vari&euml;ren. De mijne
was niet bepaald indrukwekkend.
<H2><A NAME="s4">4. Een Voorbeeld uit het Echte Leven</A></H2>

<P>
<P>Dit kreeg ik toen ik de bovenstaande procedure op &eacute;&eacute;n van
mijn computers toepaste.
Voor de behandeling, rapporteerde <CODE>df</CODE> dat ik 398,798 1024--blokken
in gebruik had:
<P>
<UL>
<LI>Ik verwijderde niet de kernel-sources en kernel-headers;</LI>
<LI>Ik de-installeerde verscheidene applicaties en alle spellen, maar
ik liet X11, X11 development, C en Fortran development, Tcl/Tk, network-tools, 
en een paar andere standaardapplicaties achter. <CODE>df</CODE> rapporteerde 244,668 
gebruikte blokken;</LI>
<LI>Ik paste <CODE>upx</CODE> toe op /usr/bin, 
/usr/X11R6/bin, /usr/lib/texmf/bin/i586-linux, 
en /usr/lib/gcc-lib/i386-linux/2.7.2.1. 226,270 gebruikte blokken;</LI>
<LI>Ik comprimeerde de documentatie onder /usr/doc en
/usr/lib/texmf/texmf/doc: 198,745 gebruikte blokken.</LI>
</UL>
<P>Samenvattend startte ik met 398,798 blokken en eindigde met 198,745. 
Bedenk je eens wat je in die 200.000 vrijgekomen blokken kunt stoppen!
Ik zou zelfs meer kunnen hebben bespaard, als ik <CODE>bzip2</CODE> had gebruikt
in plaats van <CODE>gzip</CODE>.
<P>Gemiddeld zal je zo ongeveer 20 Mb besparen als je vanaf het begin zorgvuldig
te werk gaat en alleen de benodigde applicaties installeert, uitvoerbare
bestanden en documenten comprimeert. Voor een notebook kan dit voldoende
zijn om 't mee te redden.
<H2><A NAME="s5">5. Het Einde</A></H2>

<H2>5.1 Copyright</H2>

<P>
<P>Tenzij anders vastgesteld, vallen Linux HOWTO documenten onder het copyright
van de respectieve auteurs. Linux HOWTO documenten mogen geheel of gedeeltelijk
via elke fysiek of elektronisch medium worden gereproduceerd en gedistribueerd,
zolang deze copyrightmelding behouden blijft op alle kopie&euml;n. 
Commerci&euml;le herdistributie is toegestaan en wordt aangemoedigd; de auteur
zou echter graag in kennis worden gesteld van een dergelijke distributie.
<P>Alle vertalingen, afgeleide werken, of verzamelde werken waarin 
Linux HOWTO documenten zijn verenigd moeten van deze copyright-melding
zijn voorzien. Dat wil zeggen dat je geen afgeleide werken van een
HOWTO mag produceren en aanvullende beperkingen mag opleggen op de
distributie ervan. Uitzonderingen op deze regels worden onder bepaalde
condities verleend; neem alsjeblieft contact op met de Linux HOWTO
co&ouml;rdinator via het hieronder gegeven adres.
<P>In het kort, we willen verspreiding van deze informatie zoveel mogelijk
aanmoedigen via zo veel mogelijk kanalen. We willen echter het copyright
op deze HOWTO documenten blijven behouden, en zouden graag in kennis worden
gesteld van plannen om deze HOWTO's opnieuw te distribueren.
<P>Neem alsjeblieft voor vragen contact op met Tim Bynam, de Linux HOWTO
co&ouml;rdinator, op tjbinum@sunsite.unc.edu via email.
<H2>5.2 Disclaimer</H2>

<P>
<P>``Saving Space mini-HOWTO'' werd geschreven door Guido Gonzato,
<A HREF="REMOVE_MEguido@ibogeo.df.unibo.it">REMOVE_MEguido@ibogeo.df.unibo.it</A>.
<P>Dit document onder voorwaarde ``zoals 't er staat''. Ik heb veel moeite
gedaan om dit zo accuraat mogelijk te beschrijven, maar je gebruikt de
informatie hieruit op eigen risico. In geen enkel geval zal ik aansprakelijk
kunnen worden gesteld voor schade die voortkomt uit het gebruik van dit
document.
<P>Feedback is welkom. Voor alle verzoeken, suggestie, flames, enz., kun je
gerust contact met me opnemen.
<P>Veel plezier met Linux en 't leven.
<P>Guido   <CODE>=8-)</CODE>
</BODY>
</HTML>
