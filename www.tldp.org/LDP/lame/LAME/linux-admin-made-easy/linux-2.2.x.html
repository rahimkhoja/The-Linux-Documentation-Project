<HTML
><HEAD
><TITLE
>Moving to the Linux 2.2.x Kernels</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.63
"><LINK
REL="HOME"
TITLE="Linux Administration Made Easy"
HREF="index.html"><LINK
REL="UP"
TITLE="Upgrading Linux and Other Applications"
HREF="upgrading-linux.html"><LINK
REL="PREVIOUS"
TITLE="Building a Custom Kernel"
HREF="kernel-custom.html"><LINK
REL="NEXT"
TITLE="Configuring the Apache Web Server"
HREF="apache-config.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Linux Administration Made Easy</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="kernel-custom.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 10. Upgrading Linux and Other Applications</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="apache-config.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="LINUX-2.2.X"
>10.7. Moving to the Linux 2.2.x Kernels</A
></H1
><P
>The Linux kernel 2.2.0 was released on January 25, 1999, bringing
with it many new features, performance enhancements, and hardware support.  
Any existing Linux system can be upgraded with one of these new kernels in
much the same fashion as described in <A
HREF="linux-kernel-upgrades.html"
>Section 10.4</A
> (with caveats).</P
><P
>This section will describe how to upgrade your Red Hat system to the
new kernels.  As Red Hat 6.0 (and above) already ships with the new kernel and
supporting packages by default, this section will only be useful to those
of you who are still using an earlier version, such as 5.2.  I will likely
remove this section from future versions of this document, once I believe a
majority of users have migrated to 6.0 and beyond.</P
><DIV
CLASS="WARNING"
><P
></P
><TABLE
CLASS="WARNING"
BORDER="1"
WIDTH="100%"
><TR
><TD
ALIGN="CENTER"
><B
>Warning</B
></TD
></TR
><TR
><TD
ALIGN="LEFT"
><P
>Warning!  If you decide to upgrade your older system to
support the new kernels, be advised that as the process involves a number
of package upgrades, it is possible that something will go horribly wrong.
As always, have recent backups available to you in case something goes
wrong.  If you don't have experience with upgrading files with RPM as well
as compiling kernels, perhaps you might wish to upgrade to Red Hat
6.1.</P
></TD
></TR
></TABLE
></DIV
><P
>You have the choice of upgrading to either a stock kernel as provided
by Red Hat, or upgrading by compiling a custom kernel.  I would recommend
getting things going with a stock kernel first, and then build a customized
kernel later as you normally would (see <A
HREF="kernel-upgrade.html"
>Section 10.5</A
> for
details.)</P
><P
>In order to use the latest kernel, it is first necessary to upgrade
to the newest utilities and libraries.  Red Hat has identified which
packages need to be upgraded to support the newest kernel, and have placed
the appropriate RPM files on their FTP site at <A
HREF="ftp://ftp.redhat.com/redhat/updates/5.2/kernel-2.2/i386/"
TARGET="_top"
>ftp://ftp.redhat.com/redhat/updates/5.2/kernel-2.2/i386/</A
> (for Red Hat
5.2 users on the i386 platform).</P
><P
>A very good web page, detailing the appropriate system tools that
are necessary for moving to 2.2.x is available at <A
HREF="http://www-stu.calvin.edu/~clug/users/jnieho38/goto22.html"
TARGET="_top"
>http://www-stu.calvin.edu/~clug/users/jnieho38/goto22.html</A
>; I will
attempt to summarize the information below (items marked with a leading
``<FONT
COLOR="RED"
>**</FONT
>'' indicate you will most likely need to
upgrade the item for Red Hat 5.2; items not indicated as such are
<EM
>probably</EM
> okay but probably worth checking).</P
><P
></P
><UL
COMPACT="COMPACT"
><LI
STYLE="list-style-type: Bullet"
><P
><FONT
COLOR="RED"
>**</FONT
> <EM
>initscripts-3.78-2.4 or
better</EM
> (Type ``<TT
CLASS="LITERAL"
>rpm -q initscripts</TT
>'' to check
your version)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><FONT
COLOR="RED"
>**</FONT
> <EM
>modutils-2.1.121 or
better</EM
> (Type ``<TT
CLASS="LITERAL"
>rpm -q modutils</TT
>'' to check your
version)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><FONT
COLOR="RED"
>**</FONT
> <EM
>mount-2.9-0 or better</EM
>
(Type ``<TT
CLASS="LITERAL"
>rpm -q mount</TT
>'' to check your
version)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>gcc-2.7.2.3 or better</EM
>
(``<TT
CLASS="LITERAL"
>rpm -q gcc</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>binutils-2.8.1.0.23 or better</EM
>
(``<TT
CLASS="LITERAL"
>rpm -q binutils</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>libc-5.4.46 or better</EM
> (Red Hat uses
the newer ``<EM
>glibc</EM
>''. Not needed.)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>glibc-2.0.7-6 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm -q
glibc</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>ld.so 1.9.9 or better</EM
> (``<TT
CLASS="LITERAL"
>ls -l
/lib/ld.so.*</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>libg++-2.7.2.8 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm
-q libg++</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>procps-1.2.9 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm -q
procps</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><FONT
COLOR="RED"
>**</FONT
> <EM
>procinfo-15 or better</EM
>
(``<TT
CLASS="LITERAL"
>rpm -q procinfo</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>psmisc-17 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm -q
psmisc</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><FONT
COLOR="RED"
>**</FONT
> <EM
>net-tools-1.50 or
better</EM
> (``<TT
CLASS="LITERAL"
>rpm -q net-tools</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>loadlin-1.6 or better</EM
> (Needed only if
you are booting Linux from DOS using Loadlin.  Not sure how to calculate
the version number; download the latest version to be
sure.)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>sh-utils-1.16 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm -q
sh-utils</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>autofs-3.1.1 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm -q
autofs</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>nfs-server2.2beta37 or better</EM
>
(``<TT
CLASS="LITERAL"
>rpm -q nfs-server</TT
>''; needed only if you are serving
NFS file shares.)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>bash-1.14.7 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm -q
bash</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>ncpfs-2.2.0 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm -q
ncpfs</TT
>''; needed only if you are mounting Novell file
systems.)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>kernel-pcmcia-cs-3.0.6 or better</EM
>
(``<TT
CLASS="LITERAL"
>rpm -q kernel-pcmcia-cs</TT
>''; needed only for laptops
which need PCMCIA card support.)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>ppp-2.3.5 or better</EM
> (``<TT
CLASS="LITERAL"
>rpm
-q ppp</TT
>''; needed only if you are connecting to the Internet
with a modem and PPP.)</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>dhcpcd-1.3.16-0 or better</EM
>
(``<TT
CLASS="LITERAL"
>rpm -q dhcpcd</TT
>''; needed only if you need a DHCP
client to connect to the Internet, such as with a cable
modem).</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><FONT
COLOR="RED"
>**</FONT
> <EM
>util-linux-2.9.0</EM
>
(``<TT
CLASS="LITERAL"
>rpm -q util-linux</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>setserial-2.1 or better</EM
>
(``<TT
CLASS="LITERAL"
>rpm -q setserial</TT
>'')</P
></LI
><LI
STYLE="list-style-type: Bullet"
><P
><EM
>ipfwadmin/ipchains</EM
> (Only needed if
you are doing IP firewalling; see the
``<EM
>IPCHAINS-HOWTO</EM
>'' guide at <A
HREF="http://isunix.it.iltu.edu/resources/ldp/HOWTO/IPCHAINS-HOWTO.html"
TARGET="_top"
>http://isunix.it.iltu.edu/resources/ldp/HOWTO/IPCHAINS-HOWTO.html</A
>.)</P
></LI
></UL
><P
>You should download and upgrade any packages using RPM as required
(see <A
HREF="using-rpm.html"
>Section 10.1</A
> for details on how to use RPM).</P
><DIV
CLASS="CAUTION"
><P
></P
><TABLE
CLASS="CAUTION"
BORDER="1"
WIDTH="100%"
><TR
><TD
ALIGN="CENTER"
><B
>Caution</B
></TD
></TR
><TR
><TD
ALIGN="LEFT"
><P
>Caution: Upgrading to the new ``<TT
CLASS="LITERAL"
>modutils</TT
>''
package will result in modules no longer functioning for the older 2.0.x
kernels!  Therefore, do not upgrade this package until you have installed
the new kernel in
``<TT
CLASS="LITERAL"
><TT
CLASS="FILENAME"
>/usr/src/linux</TT
></TT
>''.</P
></TD
></TR
></TABLE
></DIV
><P
>After bringing your system's tools up to date, you can install the
kernel sources.  You can find them on Red Hat's FTP site as well; I
recommend downloading the ones provided as updates for Red Hat 6.1, at
<A
HREF="ftp://ftp.redhat.com/redhat/updates/6.1/i386/"
TARGET="_top"
>ftp://ftp.redhat.com/redhat/updates/6.1/i386/</A
>.  To do so, type the
following:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><TT
CLASS="USERINPUT"
><B
>rpm -Uvh kernel-source*.rpm kernel-headers*.rpm</B
></TT
></PRE
></TD
></TR
></TABLE
><P
>Now that the new kernel sources have been installed, it should be
safe to upgrade your modutils package.  However, the new kernel no longer
uses the ``<TT
CLASS="LITERAL"
>kerneld</TT
>'' module for on-demand loading of
kernel modules. Therefore, you should disable this module before updating
modutils.  To disable kerneld and upgrade the modutils package, type the
following as <SPAN
CLASS="QUOTE"
>"root"</SPAN
>:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><TT
CLASS="USERINPUT"
><B
>/sbin/chkconfig kerneld off</B
></TT
>
<TT
CLASS="USERINPUT"
><B
>/etc/rc.d/init.d/kerneld stop</B
></TT
>
<TT
CLASS="USERINPUT"
><B
>rpm -Uvh modutils*.rpm</B
></TT
></PRE
></TD
></TR
></TABLE
><P
>You should now be able to configure, compile, and install your 2.2
kernel as you normally would (see <A
HREF="kernel-custom.html"
>Section 10.6</A
> for
details).  You may be surprised to see the dizzying amount of new
configuration settings available.  Take your time and read the help text
for any options you are unfamiliar with!</P
><P
>With any luck, the next time you boot your system you will be
running the latest and greatest Linux kernel version!</P
><P
>Much more detailed information on these procedures can be found on Red
Hat's web site at 
<A
HREF="http://www.redhat.com/corp/support/docs/kernel-2.2/kernel2.2-upgrade.html"
TARGET="_top"
>http://www.redhat.com/corp/support/docs/kernel-2.2/kernel2.2-upgrade.html</A
>.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="kernel-custom.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="apache-config.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Building a Custom Kernel</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="upgrading-linux.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Configuring the Apache Web Server</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>