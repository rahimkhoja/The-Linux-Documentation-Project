<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML
><HEAD
><TITLE
>Expanding a snapshot</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="EVMS User Guide"
HREF="index.html"><LINK
REL="UP"
TITLE="Creating snapshots"
HREF="evmscreatesnap.html"><LINK
REL="PREVIOUS"
TITLE="Reinitializing a snapshot"
HREF="x1717.html"><LINK
REL="NEXT"
TITLE="Deleting a snapshot"
HREF="x1843.html"></HEAD
><BODY
CLASS="sect1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>EVMS User Guide</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x1717.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 11. Creating snapshots</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x1843.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="AEN1775"
></A
>11.5. Expanding a snapshot</H1
><P
>&#13;As mentioned in <A
HREF="createactivsnap.html"
>Section 11.2</A
>, as data is 
copied from the original volume to the snapshot, the space available
for the snapshot might fill up, causing the snapshot to be invalidated.
This situation might cause your data backup to end prematurely, as the
snapshot volume begins returning I/O errors after it is invalidated.
</P
><P
>&#13;To solve this problem, EVMS now has the ability to expand the storage
space for a snapshot object while the snapshot volume is active and mounted.
This feature allows you to initially create a small snapshot object and expand
the object as necessary as the space begins to fill up.
</P
><P
>&#13;In order to expand the snapshot object, the underlying object must
be expandable.
Continuing the example from the previous sections, the object "snap" is
built on the LVM region <TT
CLASS="filename"
>lvm/Sample Container/Sample Region</TT
>.
When we refer to expanding the "snap" object, the region
<TT
CLASS="filename"
>lvm/Sample Container/Sample Region</TT
> is the 
object that actually gets
expanded, and the object "snap" simply makes use of the new space on
that region.
Thus, to have expandable snapshots, you will usually want to build
your snapshot objects on top of LVM regions that have extra freespace
available in their LVM container.  DriveLink objects and some disk
segments also work in certain situations.
</P
><P
>&#13;One notable quirk about expanding snapshots is that the snapshot
object and volume do not actually appear to expand after the operation
is complete.
Because the snapshot volume is supposed to be a frozen image of the original
volume, the snapshot volume always has the same size as the original,
even if the snapshot has been expanded.
However, you can verify that the snapshot object is using the
additional space by displaying the details for the snapshot object
and comparing the percent-full field before and after the expand operation.
</P
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="AEN1784"
></A
>11.5.1. Using the EVMS GUI or Ncurses</H2
><P
>To create the snapshot using the GUI or Ncurses, follow these steps:
	<P
></P
><OL
TYPE="1"
><LI
><P
>Select
		<SPAN
CLASS="guimenu"
>Actions</SPAN
>-&gt;<SPAN
CLASS="guimenuitem"
>Expand</SPAN
>-&gt;<SPAN
CLASS="guimenuitem"
>Volume</SPAN
>
		to see a list of EVMS feature objects.
		</P
></LI
><LI
><P
>Select the volume <SPAN
CLASS="guimenuitem"
>/dev/evms/snap</SPAN
>.</P
></LI
><LI
><P
>Click or activate <SPAN
CLASS="guibutton"
>Next</SPAN
>.</P
></LI
><LI
><P
>Select <SPAN
CLASS="guimenuitem"
>lvm/Sample Container/Sample Region</SPAN
>.
		This object is the object that will actually be expanded.	</P
></LI
><LI
><P
>Click or activate <SPAN
CLASS="guibutton"
>Next</SPAN
>.</P
></LI
><LI
><P
>Select the options for expanding the LVM region,
		including the amount of extra space to add to the region.
		</P
></LI
><LI
><P
>Click or activate <SPAN
CLASS="guibutton"
>Expand</SPAN
>.
		</P
></LI
></OL
></P
><P
>Alternatively, you can perform the same steps using the context sensitive menus.</P
><P
></P
><OL
TYPE="1"
><LI
><P
>From the <SPAN
CLASS="guilabel"
>Volumes</SPAN
> panel, right click (or press <B
CLASS="keycap"
>Enter</B
> on) 
<SPAN
CLASS="guimenuitem"
>/dev/evms/snap</SPAN
>.
</P
></LI
><LI
><P
>Select <SPAN
CLASS="guibutton"
>Expand</SPAN
> from the popup menu.</P
></LI
><LI
><P
>Click or activate <SPAN
CLASS="guibutton"
>Next</SPAN
>.</P
></LI
><LI
><P
>Select the region <SPAN
CLASS="guimenuitem"
>lvm/Sample Container/Sample Region</SPAN
>. This is the object that will
actually be expanded.</P
></LI
><LI
><P
>Click or activate <SPAN
CLASS="guibutton"
>Next</SPAN
>.</P
></LI
><LI
><P
>Select the options for expanding the LVM region, including the
amount of extra space to add to the region.</P
></LI
><LI
><P
>Click or activate <SPAN
CLASS="guibutton"
>Expand</SPAN
>.</P
></LI
></OL
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="AEN1835"
></A
>11.5.2. Using the CLI</H2
><P
>The CLI expands volumes by targeting the object to be
expanded.
The CLI automatically handles expanding the volume and other objects above the volume
in the volume stock.  As with a regular expand operation, the options are determined
by the plug-in that owns the object being expanded.</P
><P
>Issue the following command to determine the expand options for the
region <TT
CLASS="filename"
>lvm/Sample Container/Sample Region</TT
>:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="programlisting"
>query:region,region="lvm/Sample Container/Sample Region",lo</PRE
></FONT
></TD
></TR
></TABLE
><P
>The option to use for expanding this region is called "add_size."
Issue the following command to expand the snapshot by 100 MB:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="programlisting"
>expand:"lvm/Sample Container/Sample Region", add_size=100MB</PRE
></FONT
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x1717.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x1843.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Reinitializing a snapshot</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="evmscreatesnap.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Deleting a snapshot</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>