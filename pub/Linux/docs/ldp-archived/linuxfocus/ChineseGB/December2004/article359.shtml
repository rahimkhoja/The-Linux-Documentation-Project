<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
 <META http-equiv="Content-Type" content="text/html; charset=gb2312">
 <META NAME="GENERATOR" CONTENT="lfparser_2.51">
 <META NAME="LFCATEGORY" CONTENT="Hardware">
 <link rel="icon" href="../../common/images/lf-16.png" type="image/png">
 <TITLE>lf359, Hardware: Fn-F12: 让IBM Thinkpad T20笔记本电脑休眠</TITLE>
<style type="text/css">
<!--
 td.top {font-family: Arial,Geneva,Verdana,Helvetica,sans-serif; font-size:12 }
 pre { font-family:monospace,Courier }
 pre.code { font-family:monospace,Courier;background-color:#aedbe8; }
 p.cl { color:#EE9500 }
 table.left { margin-right:0.3cm }
 a.nodec { text-decoration:none }
 p.trans { font-size:8pt; text-align:right }
 p.clbox { width:50%; alignment:center; background-color:#FFD700; 
           border-style:none; border-width:medium; border-color:#FFD700; 
           padding:0.5cm;  text-align:center }
 p.code { width:80%; alignment:center; background-color:#aedbe8; 
          border-style:none; border-width:medium; border-color:#aedbe8; 
          padding:0.1cm;  text-align:left }
 p.foot { background-color:#AAAAAA; color:#FFFFFF; border-style:none; 
          border-width:medium; border-color:#AAAAAA; padding:0.5cm ; 
          margin-top:0.1cm; margin-right:1cm; margin-left:1cm; 
          text-align:center }
 div.tbbutton {
   background: #ddd;
   border-right: 1px solid #aaa;
   border-bottom: 1px solid #aaa;
   margin: 2px 5px 2px 5px;
   text-align: center;
   width: 20em;
   line-height: 1.2em;
   padding: 2px;
   font-size: 12px;
   white-space: nowrap;
   color: #555;
 }
 div.bbutton {
   background: #ddd;
   border-right: 1px solid #aaa;
   border-bottom: 1px solid #aaa;
   float: left;
   margin: 2px 5px 2px 5px;
   text-align: center;
   line-height: 1.2em;
   padding: 2px;
   font-size: 12px;
   white-space: nowrap;
   color: #555;
 }
-->
</style>
 
</HEAD>
<BODY bgcolor="#ffffff" text="#000000">
 <!-- this is generated html code. NEVER use this file for your
 translation work. Instead get the file with the same article number
 and .meta.shtml in its name. Translate this meta file and then
 use lfparser program to generate the final article -->
 <!-- lfparser can be obtained from http://main.linuxfocus.org/~guido/dev/lfparser.html -->

<!-- this is used by a number of tools:
 =LF=AUTHOR: Jan Alonzo
 =LF=CAT___: Hardware
 =LF=TITLE_: Fn-F12: 让IBM Thinkpad T20笔记本电脑休眠
 =LF=NUMBER: 359
 =LF=ANAME_: article359.shtml
 =LF=PARSER: 2.51
 -->

<!-- 2pdaIgnoreStart -->

<!-- start navegation bar, current, style=2 -->
 <!-- top navegation bar -->
 <TABLE summary="topbar_1" cellspacing="0" cellpadding="0" border="0" align="center" width="90%">
   <TR bgcolor="#2e2292">
     <TD class="top"><TABLE summary="topbar_1_logo" cellspacing="0" cellpadding="0" border="0" width=
       "100%">
         <TR><TD width="319"><a href="../../index.shtml"><IMG src="../../common/images/logolftop_319x45.gif"
           alt="[LinuxFocus-icon]" width="319" height="45" align="left" 
           border="0"></a></TD>

           <TD class="top">
             <TABLE summary="topbar_1_links" width="100%">
               <TR align="right">
                 <TD class="top">
                 
                 <A class="nodec" href="../../index.shtml"><FONT color=
                 "#DDDDDD" size="2">&lt;--</FONT></A> &nbsp;| 
                 <A class="nodec" href="../map.html"><FONT color=
                 "#DDDDDD" size="2">站点地图</FONT></A> &nbsp;| 
                 <A class="nodec" href="../indice.html"><FONT color=
                 "#DDDDDD" size="2">索引</FONT></A> &nbsp;| 
                 <A class="nodec" href="../Search/index.shtml"><FONT color=
                 "#DDDDDD" size="2">搜索</FONT></A> </TD>
                 
               </TR>

               <TR align="right">
                 <TD class="top">
                   <HR width="100%" noshade size="1">
                 </TD>
               </TR>
             </TABLE>
           </TD>
         </TR>
       </TABLE>
     </TD>
   </TR>
 </TABLE>
 <!-- end top navegation bar -->
 <!-- blue bar -->
 <TABLE summary="topbar_2" cellspacing="0" cellpadding="0" border="0" align="center"
 width="90%">
   <TR bgcolor="#00ffff">
     <TD><IMG src="../../common/images/transpix.gif" width="1" height=
     "2" alt=""></TD>
   </TR>
 </TABLE>
 <!-- end blue bar -->
 <!-- bottom navegation bar -->
 <TABLE summary="topbar_3" cellspacing="0" cellpadding="0" border="0" align="center"
 width="94%">
   <TR bgcolor="#000000">
     <TD>
       <TABLE summary="topbar_3_links" cellspacing="0" cellpadding="1" border="0" width=
       "100%">
         <TR align="center">
           <TD WIDTH="20%"><A class="nodec" href="../News/index.shtml"><FONT color=
           "#FFFFFF">新闻</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../Archives/"><FONT color=
           "#FFFFFF">过往期刊</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../Links/index.shtml"><FONT color=
           "#FFFFFF">链接</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../aboutus.html"><FONT color=
           "#FFFFFF">关于LF</FONT></A> </TD>
         </TR>
       </TABLE>
     </TD>
   </TR>
 </TABLE>
 <!-- end bottom navegation bar -->
<!-- stop navegation bar -->

<!-- SSI_INFO -->

<!-- tr_staticssi include virtual -->
<!-- tr_staticssi exec cmd -->
<!-- addedByLfdynahead ver 1.5 --><TABLE ALIGN="right" border=0><TR><TD ALIGN="right"><FONT SIZE="-1" FACE="Arial,Helvetica">This document is available in: <A href="../../English/December2004/article359.shtml">English</a> &nbsp;<A href="../../ChineseGB/December2004/article359.shtml">ChineseGB</a> &nbsp;<A href="../../Deutsch/December2004/article359.shtml">Deutsch</a> &nbsp;<A href="../../Francais/December2004/article359.shtml">Francais</a> &nbsp;<A href="../../Polish/December2004/article359.shtml">Polish</a> &nbsp;</FONT></TD></TR></TABLE><br>
 


<!-- SSI_INFO STOP -->
<!-- 2pdaIgnoreStop -->

<!-- SHORT_BIO_ABOUT_THE_AUTHOR_AND_INDEX_START -->
<TABLE ALIGN="LEFT" BORDER="0" WIDTH="195" summary="about the author" class="left">
<TR>
<TD>

<img src="../../common/images2/JanAlonzo.jpg" alt="[Photo of the Author]" width="150" height="155">
<BR>by  Jan Alonzo <a href="http://www.unpluggable.com/"><font size="1">(homepage)</font></a>
<BR><BR>
<I>关于作者:</I><BR>
<!-- aboutauthor_start -->
<p>Jan在他的IBM T20上运行的GNU/Debian</p>
<!-- aboutauthor_stop -->
<!-- TRANSLATED_TO gb -->
<!-- TRANSLATED_TO_STOP -->
<!-- INDEX_START -->
<BR><i>目录</i>:
<UL>
  <LI><A HREF="#359lfindex0">需要的软件</A></LI>
  <LI><A HREF="#359lfindex1">创建DOS分区</A></LI>
  <LI><A HREF="#359lfindex2">格式化这个分区</A></LI>
  <LI><A HREF="#359lfindex3">创建"休眠文件"</A></LI>
  <LI><A HREF="#359lfindex4">声音</A></LI>
  <LI><A HREF="#359lfindex5">测试</A></LI>
  <LI><A HREF="#359lfindex6">故障解决</A></LI>
  <LI><A HREF="http://cgi.linuxfocus.org/cgi-bin/lftalkback?anum=359">对这篇文章发表评论</A></LI>
</UL>

</TD></TR></TABLE>
<!-- INDEX_STOP -->
<!-- SHORT_BIO_ABOUT_THE_AUTHOR_AND_INDEX_STOP -->
<!-- HEAD_OF_THE_ARTICLE_START -->
<br>&nbsp;
<table border="0"><tr><td>
<H2>Fn-F12: 让IBM Thinkpad T20笔记本电脑休眠</H2>
 <img src="../../common/images2/article359/t20.jpg" alt="t20" hspace="10" width="200" height="111">
<!-- ABSTRACT OF THE ARTICLE -->
<P><i>摘要</i>:
<P>
<!-- articleabstract_start -->

    这篇文章解释了如何在没有Windows安装的情况下使IBM Thinkpad T20休眠。这里介绍的方法应该对其他带有Phoenix BIOS的Thinkpad系列也是可以的，但是我只在T20上测试过。

    
<!-- articleabstract_stop -->

<br><!-- HR divider --><center><font color="#8282e0"><b>_________________ _________________ _________________</b></font></center><br>
</td></tr></table>
<!-- HEAD_OF_THE_ARTICLE_STOP -->
<!-- BODY_OF_THE_ARTICLE_START -->


    <A NAME="359lfindex0">&nbsp;</A>
<H2>需要的软件</H2>


    <p>为了使机器“休眠”，你需要安装以下的程序：</p>

<table><tr><td>
    <ul>
      <li>fdisk 或者 cfdisk 来对硬盘进行分区。</li>

      <li>dosfstools来创建FAT16的文件系统。</li>

      <li><a href=
      "http://samba.org/ftp/unpacked/junkcode/tphdisk.c">tphdisk.c
      (来自samba.org)</a> 来创建 <em>hibernate</em> 所需的文件
      (本地下载: <a href=
      "../../common/src2/article359/tphdisk.tar.gz">tphdisk.tar.gz。</a>)</li>
    </ul>
</td></tr></table>

    <p>fdisk通常是被一般的Linux所默认安装的， 而cfdisk则通常是<a href="http://www.debian.org">Debian</a>
    默认安装的。 tphdisk是由Andrew Tridgell专门为他的Thinkpad T20所写。</p>

    <A NAME="359lfindex1">&nbsp;</A>
<H2>创建DOS分区</H2>


    <p>首先，你必须确认你的硬盘上有一个空闲的<em>主分区</em>，这很重要，因为Thinkpad系列休眠只能使用“主”分区，而不能用扩展分区。如果有，那我们开工吧！</p>

    <p>分区大小划定原则“这个分区大小不能应该＝RAM（内存）的大小 + 显存的大小 + 为安全起见另需的大小”。如果你将升级你的内存，当然也要把未来的内存列入考虑范围，否则你有只得重新分区。</p>

    <p>创建好这个分区，将它设为“隐藏的Win95分区(Hidden
    Win95 (FAT16) LBA)”，它的分区号为"1E"。</p>
<pre class="code">
内存(RAM):     128 MB
显存(VGA RAM):   8 MB

休眠所需分区(Hibernation partion): 150 MB (安全起见)
</pre>

    <p>加多少额外大小的分区取决于你自己。如果有什么问题，可以参看<strong>故障解决</strong>。</p>

    <p>好，现在重启你的电脑。</p>

    <A NAME="359lfindex2">&nbsp;</A>
<H2>格式化这个分区</H2>


    <p>mkdosfs是dosfstools这个软件包 中的一部分。</p>
<pre class="code">
以 root 身份:

$ mkdosfs /dev/hdaX
</pre>

    <p>... hdaX 是你刚创建的那个分区(<em>创建DOS分区部分</em>).</p>

    <p>现在加载这个分区：</p>
<pre class="code">
$ mount /dev/hdaX /mnt/hibernate
</pre>

    <A NAME="359lfindex3">&nbsp;</A>
<H2>创建"休眠文件"</H2>


    <ol>
      <li>到<a href=
      "http://samba.org/ftp/unpacked/junkcode/tphdisk.c">http://samba.org/ftp/unpacked/junkcode/tphdisk.c</a>下载tphdisk，或者 本地下载： <a href=
      "../../common/src2/article359/tphdisk.tar.gz">tphdisk.tar.gz</a></li>

      <li>编译tphdisk。</li>

      <li>创建文件"save2dsk.bin".
      <strong>save2dsk.bin</strong>是"休眠文件"的文件名。不，它可不是可更改的文件名。</li>
    </ol>
<pre class="code">
$ gcc -o tphdisk tphdisk.c
$ ./tphdisk N &gt; /mnt/hibernate/save2dsk.bin

</pre>

    <p>... 其中:</p>

    <p><strong>N</strong> = 文件的大小。看看前面“分区大小划定原则”。</p>

    <p>重启你的计算机。</p>

    <A NAME="359lfindex4">&nbsp;</A>
<H2>声音</H2>

    现在已经知道 T20里的cs46xx声卡驱动在“挂起”或者“休眠”后不能重新正常工作。这意味着在“挂起”或者“休眠”结束后，你可以几乎正常的使用你的计算机，但是――你听不见任何声音了！如果你确实需要声音，目前的解决办法是：手动运行"/etc/init.d/alsasound restart"。 <br>
    更多有关解决这个“沉默的声卡”的问题的建议可参看<a href=
    "http://panopticon.csustan.edu/thood/tp600lnx.htm#secsnd">http://panopticon.csustan.edu/thood/tp600lnx.htm#secsnd</a>。

    <A NAME="359lfindex5">&nbsp;</A>
<H2>测试</H2>


    <ul>
      <li>按下 <strong>Fn-F12</strong>键。</li>
    </ul>

    <p>你的屏幕在几分钟之后应该变为一篇空白，然后Phoenix BIOS休眠管理程序会运行起来，开始将你内存文件全部拷到你刚创建的那个文件里：<br>
    </p>

    <center>
      <img src="../../common/images2/article359/t20-hibernate.jpg" alt="Phoenix BIOS hibernate" width="320" height="299">
    </center>
    <br>
    <br>


    <A NAME="359lfindex6">&nbsp;</A>
<H2>故障解决</H2>


    <ol>
      <li>在创建“休眠文件”时，出了一个错误："写文件失败(Write Failed)"!</li>
    </ol>

    <ul>
      <li>一定要给你的分区足够的空间，如果出错，可以试试将这个分区设大一点，也许这样能解决问题呢！</li>

      <li>你的 Thinkpad 应该用的是 Phoenix BIOS.<br>
      </li>
    </ul>

    <ol>
      <li>当我想试一试休眠时，系统死机了！</li>
    </ol>

    <ul>
      <li>看看你的“休眠分区”是否已经加载了.</li>

      <li>或者你的某一步操作出错！那么重新正确的来一遍吧。</li>
    </ul>

    <ol>
      <li>"系统不可用(System is invalid)"!</li>
    </ol>

    <ul>
      <li>或许你将你的分区错误的格式化为了其他类型的文件系统吧。
      (参看上面 <em>创建DOS分区</em>部分 )</li>

      <li>或者这个分区是一个逻辑分区。我可告诉过你必须是“主”分区！</li>
    </ul>
  



<!-- BODY_OF_THE_ARTICLE_STOP -->
<!-- 2pdaIgnoreStart -->
<A NAME="talkback">&nbsp;</a>
<h2>对这篇文章发表评论</h2>
每篇文章都有各自的反馈页面。在这个页面里，您可以提交评论，也可以查看其他读者的评论：
<center>
    <table width="250" border=0><tr><td>
    <div class="tbbutton"><A class="nodec" href="http://cgi.linuxfocus.org/cgi-bin/lftalkback?anum=359">&nbsp;反馈页面&nbsp;</a></div>
    </td></tr></table>
</center>

<br clear="all">
<HR size="2" noshade>
<table width="250" border=0><tr><td>
<div class="bbutton"><a class="nodec" href="../../index.shtml">&lt;--, LF 首页</a></div>
</td><td>
<div class="bbutton"><a class="nodec" href="index.shtml">Go to the index of this issue</a></div>
</td></tr></table>
<br clear="all">
<HR size="2" noshade>
<!-- ARTICLE FOOT -->
<CENTER><TABLE WIDTH="98%" summary="footer">
<TR><TD ALIGN=CENTER BGCOLOR="#bdc6d5" WIDTH="50%">
<A HREF="../../common/lfteam.html">主页由LinuxFocus编辑组维护</A>
<BR><FONT COLOR="#1111aa"><a href="../../common/copy.html">&copy; Jan Alonzo</a><br>&quot;some rights reserved&quot; see <a href="../../license/index.shtml">linuxfocus.org/license/</a><br><a href="http://www.linuxfocus.org">http://www.LinuxFocus.org</a></FONT>
</TD>
<TD BGCOLOR="#bdc6d5">
<!-- TRANSLATION INFO -->
<font size=2>翻译信息:</font>
<TABLE summary="translators">
  <tr><td><font size="2">en --&gt; -- : Jan Alonzo (<a href="http://www.unpluggable.com/"><font size="1">homepage</font></a>)</font></td></tr>
  <tr><td><font size="2">en --&gt; zh_CN: Wang Jun(Homepage) (<a href="http://littleone.go.nease.net"><font size="1">homepage</font></a>)</font></td></tr>
</TABLE>
</TD>
</TR></TABLE></CENTER>
<p><font size=1>2005-01-17, generated by lfparser version 2.51</font></p>
<!-- 2pdaIgnoreStop -->
</BODY>
</HTML>
