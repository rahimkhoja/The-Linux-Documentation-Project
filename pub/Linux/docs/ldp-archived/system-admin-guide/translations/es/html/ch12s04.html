<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Copias de respaldo simples</title><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="Guía Para Administradores de Sistemas GNU/Linux"><link rel="up" href="ch12.html" title="Capítulo 12. Copias de seguridad (Backups)"><link rel="prev" href="ch12s03.html" title="
Seleccionando la herramienta de backup"><link rel="next" href="ch12s05.html" title="
Copias de seguridad de múltiples niveles"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">
Copias de respaldo simples</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch12s03.html">Anterior</a> </td><th width="60%" align="center">Capítulo 12. Copias de seguridad (Backups)</th><td width="20%" align="right"> <a accesskey="n" href="ch12s05.html">Siguiente</a></td></tr></table><hr></div><div class="sect1" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2559410"></a>
Copias de respaldo simples</h2></div></div></div><p>

Un esquema simple de copias de seguridad es respaldar todo una única vez, y 
luego, copiar solamente los archivos que fueron modificados después de la copia inicial.
La primera copia se denomina <em class="glossterm">copia total (full
	backup)</em>, y las 
siguientes son <em class="glossterm">copias incrementales (incremental
	backups)</em>. Una copia total frecuentemente
necesita de mayor esfuerzo para ser generada, debido a que hay mas datos a escribir,
y eventualmente (o frecuentemente []) puede no caber en una única cinta, o cualquiera
que sea el medio utilizado.
De manera opuesta, recuperar información desde las copias
incrementales necesita muchas veces mas empeño que hacerlo desde una copia 
total. La recuperación puede ser optimizada si cada copia incremental se realiza 
con respecto a la copia total previa. De esta manera, las copias pueden 
necesitar un poquito mas de esfuerzo (y demorar mas también), pero nunca será
necesario recuperar mas que dos copias (una total y una incremental).</p><p>

En caso de que desee realizar copias todos los días y tenga seis cintas, puede utilizar 
la cinta 1 para la primera copia completa (digamos, un Viernes), y utiliza
las cintas 2 a 5 para las copias incrementales (Lunes a Jueves). El segundo Viernes,
realiza una nueva copia total en la cinta 6, y reinicia nuevamente el ciclo de copias incrementales
con las cintas 2 a 5. No es conveniente sobreescribir la cinta 1 hasta que una nueva
copia completa haya sido generada. Después del segundo Viernes, debe mantener la cinta 1
en otro lugar distinto al del resto. De esta manera, si el conjunto de cintas 2 a 6 
se dañan en un incendio, tiene al menos una copia completa en un lugar seguro (esta
copia tiene una semana de antigüedad, pero es mejor que nada).
Cuando 
necesite realizar la próxima copia total, utilice la cinta 1 y coloque la cinta 6
el el lugar seguro.</p><p>

En caso de que disponga con mas de 6 cintas, puede utilizar las cintas extras
para las copias completas. Y cada vez que realice una copia total utilizará la 
cinta mas antigua. De esta manera puede almacenar copias
completas de varias semanas previas, lo cual es útil en caso de que necesite
encontrar un archivo que ha sido borrado, o desea recuperar una vieja versión de
algún otro.</p><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2559501"></a>
Realizando copias de seguridad con tar</h3></div></div></div><p>

Una copia completa puede realizarse fácilmente con <span><strong class="command">tar</strong></span>:

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>tar --create --file /dev/ftape 
/usr/src</code></strong>
<code class="computeroutput">tar: Removing leading / from absolute path names in 
the archive</code>
<code class="prompt">#</code>
</pre><p>

El ejemplo anterior utiliza la versión GNU de <span><strong class="command">tar</strong></span> y sus nombres de opciones 
largos. La versión tradicional de <span><strong class="command">tar</strong></span> solo comprende opciones de un único caracter.
Además, la versión GNU puede manejar 
copias que no quepan completamente en una cinta (o medio utilizado), y con caminos de
directorios muy largos; no todas las versiones de tar pueden hacer eso. 
(GNU/Linux solo utiliza GNU <span><strong class="command">tar</strong></span>.)  </p><p>En caso de que la copia no quepa en una única cinta, es necesario activar la opción
<code class="option">--multi-volume</code> (<code class="option">-M</code>):

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>tar -cMf /dev/fd0H1440 
/usr/src</code></strong>
<code class="computeroutput">tar: Removing leading / from absolute path names in 
the archive
Prepare volume #2 for /dev/fd0H1440 and hit return:</code>
<code class="prompt">#</code>
</pre><p>


Observe que debe dar formato a todos los disquetes a utilizar antes de comenzar 
la copia de respaldo, o utilice otra ventana o terminal virtual y dele 
formato al disquete cuando <span><strong class="command">tar</strong></span> le solicite uno nuevo.</p><p>

Después de realizar una copia, debe verificar si todo se encuentra en correctas condiciones
utilizando la opción <code class="option">--compare</code> (<code class="option">-d</code>):

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>tar --compare --verbose -f 
/dev/ftape</code></strong>
<code class="computeroutput">usr/src/
usr/src/linux
usr/src/linux-1.2.10-includes/
....</code>
<code class="prompt">#</code>
</pre><p>


Si no verifica las copias, entonces no percibirá que las copias de respaldo no 
son útiles hasta que estas sean necesarias.</p><p>

Una copia de seguridad incremental puede ser realizada utilizando la opción 
<code class="option">--newer</code>
	(<code class="option">-N</code>) de <span><strong class="command">tar</strong></span>:

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>tar --create --newer '8 Sep 1995' 
--file /dev/ftape /usr/src 
--verbose</code></strong>
<code class="computeroutput">tar: Removing leading / from absolute path names in 
the archive
usr/src/
usr/src/linux-1.2.10-includes/
usr/src/linux-1.2.10-includes/include/
usr/src/linux-1.2.10-includes/include/linux/
usr/src/linux-1.2.10-includes/include/linux/modules/
usr/src/linux-1.2.10-includes/include/asm-generic/
usr/src/linux-1.2.10-includes/include/asm-i386/
usr/src/linux-1.2.10-includes/include/asm-mips/
usr/src/linux-1.2.10-includes/include/asm-alpha/
usr/src/linux-1.2.10-includes/include/asm-m68k/
usr/src/linux-1.2.10-includes/include/asm-sparc/
usr/src/patch-1.2.11.gz</code>
<code class="prompt">#</code>
</pre><p>


Desafortunadamente, <span><strong class="command">tar</strong></span> no puede conocer cuando la información en los inodos
de los archivos
ha cambiado, como por ejemplo, si sus permisos o nombre ha sido modificado. 
Puede solucionar este inconveniente utilizando <span><strong class="command">find</strong></span>, y comparar el estado del sistema de 
archivos actual con una lista de archivos que fueron respaldados previamente. Los 
scripts y programas que realizan esta tarea pueden ser encontrados en los sitios ftp de 
GNU/Linux.</p></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2559758"></a>
Recuperando archivos con <span><strong class="command">tar</strong></span></h3></div></div></div><p>

Debe utilizar la opción  <code class="option">--extract</code> (<code class="option">-x</code>) para recuperar archivos que fueron 
previamente respaldados con <span><strong class="command">tar</strong></span>:

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>tar --extract --same-permissions 
--verbose --file 
/dev/fd0H1440</code></strong>
<code class="computeroutput">usr/src/
usr/src/linux
usr/src/linux-1.2.10-includes/
usr/src/linux-1.2.10-includes/include/
usr/src/linux-1.2.10-includes/include/linux/
usr/src/linux-1.2.10-includes/include/linux/hdreg.h
usr/src/linux-1.2.10-includes/include/linux/kernel.h
...</code>
<code class="prompt">#</code>
</pre><p>


También puede extraer archivos y directorios específicos (los cuales incluyen 
todos sus archivos y subdirectorios). Basta con mencionarlos en la línea de comandos:

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>tar xpvf /dev/fd0H1440 
usr/src/linux-1.2.10-includes/include/linux/hdreg.h</code></strong>
<code class="computeroutput">usr/src/linux-1.2.10-includes/include/linux/hdreg.h</code>
<code class="prompt">#</code>
</pre><p>


Utilice la opción <code class="option">--list</code> (<code class="option">-t</code>) para conocer cuales son los archivos presentes en un 
volumen de backup:

</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>tar --list --file 
/dev/fd0H1440</code></strong>
<code class="computeroutput">usr/src/
usr/src/linux
usr/src/linux-1.2.10-includes/
usr/src/linux-1.2.10-includes/include/
usr/src/linux-1.2.10-includes/include/linux/
usr/src/linux-1.2.10-includes/include/linux/hdreg.h
usr/src/linux-1.2.10-includes/include/linux/kernel.h
...</code>
<code class="prompt">#</code>
</pre><p>


Note que <span><strong class="command">tar</strong></span> siempre lee el volumen de la copia de seguridad secuencialmente, 
lo que puede llegar a ser lento para grandes volúmenes. 
De cualquier manera, si utiliza medios secuenciales como cintas, no 
es posible el acceso aleatorio.</p><p> <span><strong class="command">tar</strong></span>
no maneja correctamente archivos eliminados. En caso de que se necesite recuperar un 
sistema de archivos desde una copia completa y otra incremental, y se han 
eliminado archivos entre las dos copias, estos archivos existirán luego de
la recuperación. Este tipo de casos puede llegar a ser un gran problema si los archivos 
tienen datos sensibles que no deberían existir más.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch12s03.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ch12.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ch12s05.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">
Seleccionando la herramienta de backup </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 
Copias de seguridad de múltiples niveles</td></tr></table></div></body></html>
