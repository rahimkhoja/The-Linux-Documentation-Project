<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>
            Guide du partage d'imprimante entre les systèmes Debian GNU/Linux 
            et Microsoft Windows
        </title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.64.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" lang="fr"><div class="titlepage"><div><div><h1 class="title"><a name="linux_windows_printing"></a>
            Guide du partage d'imprimante entre les systèmes Debian GNU/Linux 
            et Microsoft Windows
        </h1></div><div><div class="author"><h3 class="author"><span class="firstname">Ian</span> <span class="surname">Ward</span></h3><div class="affiliation"><div class="address"><p><br>
                    <tt class="email">&lt;<a href="mailto:ian%20CHEZ%20excess%20POINT%20org">ian CHEZ excess POINT org</a>&gt;</tt><br>
                </p></div></div></div></div><div><p class="othercredit"><span class="contrib">Adaptation française</span>: <span class="firstname">Vincent</span> <span class="surname">Chartier</span></p><div class="affiliation"><div class="address"><p><br>
                    <tt class="email">&lt;<a href="mailto:vchartier%20CHEZ%20kyxar%20POINT%20fr">vchartier CHEZ kyxar POINT fr</a>&gt;</tt><br>
                </p></div></div></div><div><p class="othercredit"><span class="contrib">Relecture de la version française</span>: <span class="firstname">Claude</span> <span class="surname">Thomassin</span></p><div class="affiliation"><div class="address"><p><br>
                    <tt class="email">&lt;<a href="mailto:cthomassin%20CHEZ%20waika9%20POINT%20com">cthomassin CHEZ waika9 POINT com</a>&gt;</tt><br>
                </p></div></div></div><div><p class="othercredit"><span class="contrib">Préparation de la publication de la v.f.</span>: <span class="firstname">Jean-Philippe</span> <span class="surname">Guérard</span></p><div class="affiliation"><div class="address"><p><br>
                    <tt class="email">&lt;<a href="mailto:jean%20TIRET%20philippe%20POINT%20guerard%20CHEZ%20tigreraye.org">jean TIRET philippe POINT guerard CHEZ tigreraye.org</a>&gt;</tt><br>
                </p></div></div></div><div><p class="releaseinfo">
            Version : 1.2.fr.1.0
        </p></div><div><p class="pubdate">2003-11-03</p></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="3"><b>Historique des versions</b></th></tr><tr><td align="left">Version 1.2.fr.1.0</td><td align="left">2003-11-03</td><td align="left">VCR, CT, JPG</td></tr><tr><td align="left" colspan="3">Première adaptation française</td></tr><tr><td align="left">Version 1.2</td><td align="left">2003-10-03</td><td align="left">IW</td></tr><tr><td align="left" colspan="3">
                    Note à propos de Woody et gs-esp, conflit avec la
                    commande « enable » de bash et une
                    correction pour les clients XP et 2000
                    (<span class="emphasis"><em>Note about woody and gs-esp,
                    conflict with bash's enable command and fix for
                    XP/2000 clients</em></span>)
                </td></tr><tr><td align="left">Version 1.1</td><td align="left">2003-06-26</td><td align="left">IW</td></tr><tr><td align="left" colspan="3">
                    Ajout de mots de passe pour les imprimantes Windows 
                    partagées, corrections (<span class="emphasis"><em>Added 
                    passwords on windows shared printers, 
                    Corrections</em></span>)
                </td></tr><tr><td align="left">Version 1.0</td><td align="left">2003-05-15</td><td align="left">TMM</td></tr><tr><td align="left" colspan="3">
                    Première publication, revue par le projet de 
                    documentation Linux
                    (<span class="emphasis"><em>Initial release, reviewed by
                    LDP</em></span>)
                </td></tr><tr><td align="left">Version 0.8</td><td align="left">2003-04-11</td><td align="left">IW</td></tr><tr><td align="left" colspan="3">
                    Converti à partir de LaTeX (<span class="emphasis"><em>converted 
                    from LaTeX</em></span>)
                </td></tr></table></div></div></div><div></div><hr></div><div class="toc"><p><b>Table des matières</b></p><dl><dt><span class="sect1"><a href="#introduction">1. Introduction</a></span></dt><dt><span class="sect1"><a href="#Comment_Demarrer">2. Comment démarrer</a></span></dt><dd><dl><dt><span class="sect2"><a href="#composantsimpressionlinux">2.1. Composants pour l'impression sous Linux</a></span></dt><dt><span class="sect2"><a href="#logiciels">2.2. Logiciels requis</a></span></dt><dt><span class="sect2"><a href="#config-impr-de-base">2.3. Configuration de l'imprimante locale avec CUPS</a></span></dt><dt><span class="sect2"><a href="#les-bases">2.4. Les bases de l'impression sous Linux</a></span></dt></dl></dd><dt><span class="sect1"><a href="#imprimer_vers_windows">3. Imprimer vers des PC sous Windows</a></span></dt><dd><dl><dt><span class="sect2"><a href="#connexion_a_windows">3.1. Connexion à Windows</a></span></dt><dt><span class="sect2"><a href="#config_cups_vers_windows">3.2. Configuration de CUPS</a></span></dt></dl></dd><dt><span class="sect1"><a href="#partager_avec_windows">4. Partager des imprimantes avec des PC sous Windows</a></span></dt><dd><dl><dt><span class="sect2"><a href="#les_bases_du_partage">4.1. Les bases du partage</a></span></dt><dt><span class="sect2"><a href="#configuration_du_partage_samba">4.2. Configuration de Samba</a></span></dt><dt><span class="sect2"><a href="#configuration_de_cups">4.3. Configuration de CUPS</a></span></dt></dl></dd><dt><span class="sect1"><a href="#depannage">5. Résolution de problèmes</a></span></dt><dd><dl><dt><span class="sect2"><a href="#echec_des_connexions">5.1. 
                Échec des connexions aux imprimantes sous Windows
            </a></span></dt><dt><span class="sect2"><a href="#autres_echecs">5.2. D'autres problèmes</a></span></dt></dl></dd><dt><span class="sect1"><a href="#licence">6. Licence &amp; droits d'utilisation</a></span></dt><dd><dl><dt><span class="sect2"><a href="#licence_vf">6.1. Droits d'utilisation (v.f.)</a></span></dt><dt><span class="sect2"><a href="#license">6.2. License</a></span></dt></dl></dd></dl></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="introduction"></a>1. Introduction</h2></div></div><div></div></div><p>
            <a href="http://www.debian.org" target="_top">Debian GNU/Linux</a>
            est une distribution Linux de premier choix dont la
            maintenance est assurée par des volontaires.
            Malheureusement, la configuration d'imprimantes sous Debian
            peut être difficile. De plus, il n'est pas facile de trouver
            des instructions simples expliquant comment configurer 
            des imprimantes partagées entre Windows et Linux en 
            utilisant les derniers outils. Ce guide a été écrit pour 
            résoudre ces deux problèmes.
        </p><p>
            Ce guide va vous expliquer comment utiliser les outils en
            ligne de commande pour configurer l'impression sur votre
            système Debian. Il vous expliquera comment envoyer des
            documents à partir de Linux vers des imprimantes Windows et
            comment partager des imprimantes sous Linux avec des PC sous
            Windows. Quelques exemples de dépannage vous seront aussi 
            fournis.
        </p><p>
            La dernière version originale de ce document est disponible 
            sur <a href="http://excess.org/docs/linux_windows_printing.html" target="_top">excess.org</a>. 
            Le code source en XML Docbook et les fichiers images EPS
            nécessaires à générer les différents formats de publication
            peuvent également être téléchargés sur <a href="http://excess.org/docs/src/" target="_top">excess.org</a>. 
            N'hésitez pas à envoyer (en anglais) des corrections ou 
            suggestions concernant la version originale de ce document à
            <tt class="email">&lt;<a href="mailto:ian%20CHEZ%20excess%20POINT%20org">ian CHEZ excess POINT org</a>&gt;</tt>.
        </p><p>
        
            La dernière version française de ce document est toujours
            disponible sur <a href="http://www.traduc.org/docs/howto/lecture/Debian-and-Windows-Shared-Printing.html" target="_top">traduc.org</a>. 
            Le code source en XML Docbook et les fichiers EPS du
            document original peuvent également être téléchargés sur
            <a href="http://ftp.traduc.org/doc-vf/HOWTO/telechargement/sgml/Debian-and-Windows-Shared-Printing.tar.gz" target="_top">traduc.org</a>. 
            N'hésitez pas à nous signaler les coquilles que vous pourrez
            trouver, et à nous envoyer vos corrections ou suggestions
            d'améliorations relatives à la version française de ce
            document à
            <tt class="email">&lt;<a href="mailto:vcr%20CHEZ%20kyxar%20POINT%20fr">vcr CHEZ kyxar POINT fr</a>&gt;</tt> ou à 
            <tt class="email">&lt;<a href="mailto:commentaires%20CHEZ%20traduc%20POINT%20org">commentaires CHEZ traduc POINT org</a>&gt;</tt>.

        </p></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Comment_Demarrer"></a>2. Comment démarrer</h2></div></div><div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="composantsimpressionlinux"></a>2.1. Composants pour l'impression sous Linux</h3></div></div><div></div></div><p>
                Les principaux composants que nous utiliserons
                sont :
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                CUPS
            </p><p>
                Le système commun d'impression UNIX (<a href="http://www.cups.org" target="_top"><span class="foreignphrase"><i class="foreignphrase">The Common UNIX
                Printing System</i></span></a>) est un système 
                de gestion des impressions et un ensemble de programmes 
                permettant d'utiliser et d'administrer les imprimantes.
            </p></li><li><p>
                Samba
            </p><p>
                <a href="http://www.samba.org" target="_top">Samba</a> est un
                logiciel permettant aux ordinateurs sous un autre 
                système que Windows de se comporter en réseau comme des 
                machines sous Windows. En effet, Samba met en 
                œuvre les protocoles de partage de fichiers et 
                d'imprimantes utilisés par Windows.
            </p></li><li><p>
                Pilotes d'imprimantes
            </p><p>
                <a href="http://www.linuxprinting.org" target="_top">LinuxPrinting.org</a>
                offre le plus grand choix de pilotes d'imprimantes et
                gère une base de données des imprimantes compatibles
                Linux. Vous devrez télécharger un pilote d'imprimante
                pour chaque modèle d'imprimante que vous voudrez
                utiliser sous Linux. Un pilote d'imprimante est
                constitué d'un fichier PPD et d'un filtre, ou bien 
                uniquement d'un fichier PPD dans le cas des imprimantes 
                compatibles PostScript.
            </p></li></ul></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="logiciels"></a>2.2. Logiciels requis</h3></div></div><div></div></div><p>
                Tous les programmes et les bibliothèques requis sont 
                inclus en standard dans l'archive Debian. Vous pouvez 
                télécharger et installer ces paquets en utilisant les 
                outils classiques de gestion des paquet de Debian. Ce 
                qui suit est une liste des paquets dont vous aurez 
                besoin :
            </p><div class="variablelist"><dl><dt><span class="term">cupsys</span></dt><dd><p>
                    Le serveur CUPS
                </p></dd><dt><span class="term">cupsys-bsd</span></dt><dd><p>
                    Les commandes BSD de CUPS
                </p></dd><dt><span class="term">cupsys-client</span></dt><dd><p>
                    Les programmes clients de CUPS
                </p></dd><dt><span class="term">foomatic-bin</span></dt><dd><p>
                    Les pilotes d'imprimante de LinuxPrinting.org
                </p></dd><dt><span class="term">samba</span></dt><dd><p>
                    Le serveur SMB et CIFS Samba pour UNIX
                </p></dd><dt><span class="term">smbclient</span></dt><dd><p>
                    Le client SMB et CIFS Samba pour UNIX
                </p></dd><dt><span class="term">gs-esp</span></dt><dd><p>
                    Le <a href="http://www.cups.org/ghostscript.php" target="_top">Ghostscript
                    ESP</a>
                </p><p>
                    Ce paquet n'est pas disponible dans la 
                    distribution Debian GNU/Linux 3.0 (aussi appelée 
                    woody), utilisez plutôt <i class="medialabel">gs</i>
                </p></dd><dt><span class="term">a2ps</span></dt><dd><p>
                    Le logiciel <a href="http://www.gnu.org/software/a2ps/" target="_top">A2PS</a> 
                    de GNU
                </p></dd></dl></div><p>
                Les commandes suivantes installeront ces logiciels :
            </p><pre class="programlisting">
apt-get update
apt-get install cupsys cupsys-bsd cupsys-client foomatic-bin \
                samba smbclient gs-esp a2ps
</pre><p>
                Des paquets additionnels peuvent être nécessaires pour
                certaines imprimantes spécifiques. Par exemple, le
                paquet <i class="medialabel">hpijs</i> doit être installé
                pour permettre le fonctionnement correct des imprimantes 
                InkJet de HP.
            </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="config-impr-de-base"></a>2.3. Configuration de l'imprimante locale avec CUPS</h3></div></div><div></div></div><p>
                La commande <span><b class="command">lpadmin</b></span> est utilisée pour
                configurer les imprimantes. L'exemple suivant illustre
                comment configurer une imprimante laser avec CUPS :
            </p><pre class="programlisting">
/usr/sbin/lpadmin -p Laser -v parallel:/dev/lp0 -P /root/laser.ppd
/usr/bin/enable Laser
/usr/sbin/accept Laser
/usr/sbin/lpadmin -d Laser
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
                L'interpréteur de commandes <span><b class="command">bash</b></span> a
                une commande intégrée appelée <span><b class="command">enable</b></span>.
                Les utilisateurs de <span><b class="command">bash</b></span> devront donc
                utiliser le chemin complet de la commande
                (<span><b class="command">/usr/bin/enable</b></span>) pour activer
                l'imprimante.
            </p></td></tr></table></div><p>
                La première commande crée une nouvelle imprimante
                appelée <tt class="literal">Laser</tt> qui est connectée au premier
                port parallèle et utilise le fichier PPD suivant :
                <tt class="filename">/root/laser.ppd</tt>.
            </p><p>
                <tt class="literal">Laser</tt> est alors activée et configurée pour
                accepter les tâches d'impression avec les commandes
                <span><b class="command">enable</b></span> et <span><b class="command">accept</b></span>.
            </p><p>
                La dernière commande configure <tt class="literal">Laser</tt> comme
                imprimante par défaut. Des informations plus détaillées
                concernant la configuration d'imprimante sont
                disponibles dans la documentation de CUPS.
            </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="les-bases"></a>2.4. Les bases de l'impression sous Linux</h3></div></div><div></div></div><div class="figure"><a name="printlocal"></a><p class="title"><b>Figure 1. Imprimer en local</b></p><div><img src="images/Debian-and-Windows-Shared-Printing/printing_basics.png" alt="Imprimer en local"></div></div><p>
                Les documents sont envoyés dans la file d'attente via la
                commande <span><b class="command">lpr</b></span> ou <span><b class="command">lp</b></span>
                suivie du nom de fichier. Vous pouvez voir la file
                d'attente et consulter le statut de l'imprimante avec
                les commandes <span><b class="command">lpstat -o</b></span> et
                <span><b class="command">lpstat -p</b></span>.  Pour annuler une
                impression, utilisez la commande
                <span><b class="command">cancel</b></span> ou <span><b class="command">lprm</b></span>
                suivie du numéro identifiant l'impression.
            </p><p>
                Le serveur d'impression CUPS est appelé
                <span><b class="command">cupsd</b></span>. Il convertit des documents
                vers le format PostScript, puis les convertit dans un
                format natif compréhensible par l'imprimante (voir le
                schéma de la <a href="#printlocal" title="Figure 1. Imprimer en local">Figure 1, « Imprimer en local »</a>). Les
                imprimantes qui ne comprennent pas le format PostScript
                utilisent un format tramé (de matrice de points ou
                <span class="foreignphrase"><i class="foreignphrase">bitmap</i></span>) pour les
                documents. Les formats tramés peuvent être beaucoup plus
                lourds que le PostScript original, et mettront plus de
                temps à être envoyés à l'imprimante.
            </p><p>
                Les filtres sont des programmes utilisés pour convertir
                des documents d'un format vers un autre. Le gestionnaire
                d'impression CUPS fera de son mieux pour trouver un
                filtre qui convienne pour les documents que vous lui
                fournirez. Si aucun filtre adapté n'est installé, vous
                recevrez un message d'erreur ressemblant à
                <tt class="computeroutput">lpr : impossible d'imprimer le
                fichier :
                client-erreur-format-document-non-supporté.</tt>
            </p><p>
                Beaucoup d'applications n'offrent pas de de filtres
                correspondant à leur format de documents. Les documents
                crées avec ces applications ne peuvent être imprimés
                que depuis l'application elle-même, à moins d'exporter 
                le document vers un format PostScript ou un autre format 
                standard.
            </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="imprimer_vers_windows"></a>3. Imprimer vers des PC sous Windows</h2></div></div><div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="connexion_a_windows"></a>3.1. Connexion à Windows</h3></div></div><div></div></div><div class="figure"><a name="impression_en_reseau"></a><p class="title"><b>Figure 2. L'impression en réseau</b></p><div><img src="images/Debian-and-Windows-Shared-Printing/to_windows.png" alt="L'impression en réseau"></div></div><p>
                SMB et CIFS sont les protocoles utilisés par Windows
                pour le partage de fichiers et d'imprimantes. Nous
                utiliserons Samba pour communiquer avec les PC sous
                Windows via ces protocoles. Avant de configurer CUPS,
                nous devons nous assurer que nous pouvons nous connecter
                aux PC sous Windows en utilisant la commande
                <span><b class="command">smbclient</b></span>, le client Samba pour les
                protocoles SMB et CIFS (voir le schéma de la <a href="#impression_en_reseau" title="Figure 2. L'impression en réseau">Figure 2, « L'impression en réseau »</a>).
            </p><p>
                Voici par exemple comment établir une nouvelle connexion 
                à un PC sous Windows :
            </p><pre class="programlisting">
/usr/bin/smbclient -L orange -U fred

added interface ip=10.6.7.234 bcast=10.6.7.255 nmask=255.255.255.0
Got a positive name query response from 10.6.7.8 ( 10.6.7.8 )
Password: (non affiché)

Sharename  Type  Comment
PRINTER$   Disk
JETDENCRE  Printer
TRUCS      Disk
IPC$       IPC    Remote Inter Process Communication 
</pre><p>
                La commande utilisée ci-dessus demande la liste des
                partages existant sur un PC sous Windows appelé
                <tt class="literal">orange</tt>, avec l'identifiant utilisateur
                <tt class="literal">fred</tt>. Le résultat de cette commande 
                montre une imprimante appelée <tt class="literal">JETDENCRE</tt>.
            </p><p>
                Si le service de nommage Windows n'est pas disponible, 
                vous devrez spécifier l'adresse IP du PC sous Windows 
                avec l'option <tt class="option">-I</tt> comme 
                ci-dessous :
            </p><pre class="programlisting">
/usr/bin/smbclient -I 10.6.7.8 -L orange -N
</pre><p>
                Pour de plus amples informations, consultez la
                documentation de Samba sur l'utilisation de
                <span><b class="command">smbclient</b></span>.
            </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="config_cups_vers_windows"></a>3.2. Configuration de CUPS</h3></div></div><div></div></div><p>
                Une fois que vous aurez trouvé votre imprimante Windows,
                vous pourrez configurer CUPS. Tout d'abord, vérifiez que
                votre installation de CUPS dispose de la compatibilité
                SMB en utilisant la commande suivante :
            </p><pre class="programlisting">
ls -l /usr/lib/cups/backend/smb
</pre><p>
                Si ce fichier n'existe pas, créez-le par la commande
                suivante :
            </p><pre class="programlisting">
ln -s `which smbspool` /usr/lib/cups/backend/smb
</pre><p>
                Ceci est un exemple de configuration de l'imprimante
                montrée plus haut :
            </p><pre class="programlisting">
/usr/sbin/lpadmin -p ImprimanteOrange \
                  -v smb://fred:mon_passe@orange/JETDENCE -P /root/jetdencre.ppd
/usr/bin/enable ImprimanteOrange
/usr/sbin/accept ImprimanteOrange
/usr/sbin/lpadmin -d ImprimanteOrange
</pre><p>
                Comme mentionné précédemment, bash dispose d'une commande
                intégrée appelée <span><b class="command">enable</b></span>, donc les
                utilisateurs de bash doivent utiliser le chemin complet
                de la commande (<span><b class="command">/usr/bin/enable</b></span>)
                lorsqu'ils souhaitent activer une imprimante.
            </p><p>
                La commande <span><b class="command">lpadmin</b></span> vous permet de
                configurer l'accès depuis Linux à une imprimante
                partagée sous Windows. Il suffit de lui indiquer comme
                paramètre unique le nom d'utilisateur, le mot de passe,
                le nom netbios et le nom de l'imprimante.
            </p><p>
                Regardez la <a href="#config-impr-de-base" title="2.3. Configuration de l'imprimante locale avec CUPS">Section 2.3, « Configuration de l'imprimante locale avec CUPS »</a> pour
                une explication plus approfondie des commandes utilisées
                ci-dessus. Si le service de nommage Windows n'est pas
                disponible, ajoutez l'option <tt class="option">-h</tt> suivie
                de l'adresse IP de la machine sous Windows à la première
                commande <span><b class="command">lpadmin</b></span> :
            </p><pre class="programlisting">
/usr/sbin/lpadmin -p ImprimanteOrange -h 10.6.7.8 \
                  -v smb://fred:mon_passe@orange/jetdencre -P /root/jetdencre.ppd
</pre><p>
                Votre imprimante est maintenant prête à être testée.
                Envoyez un fichier à l'imprimante avec la commande
                <span><b class="command">lp</b></span> suivie du nom de fichier, ou en
                imprimant la document à partir d'une application.
            </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="partager_avec_windows"></a>4. Partager des imprimantes avec des PC sous Windows</h2></div></div><div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="les_bases_du_partage"></a>4.1. Les bases du partage</h3></div></div><div></div></div><div class="figure"><a name="partage_d_imprimante"></a><p class="title"><b>Figure 3. Partage d'imprimante</b></p><div><img src="images/Debian-and-Windows-Shared-Printing/from_windows.png" alt="Partage d'imprimante"></div></div><p>
                Samba utilise les démons <span><b class="command">nmbd</b></span> et
                <span><b class="command">smbd</b></span> pour le partage de fichiers et
                d'imprimantes avec des PC sous Windows.
                <span><b class="command">nmbd</b></span> fonctionne comme un service de
                nommage Windows, en diffusant le nom de votre ordinateur
                aux autres PC sous Windows du réseau local.
                <span><b class="command">smbd</b></span> accepte les demandes de fichiers
                et d'impression en provenance de machines sous Windows
                (cf. <a href="#partage_d_imprimante" title="Figure 3. Partage d'imprimante">Figure 3, « Partage d'imprimante »</a>).
            </p><p>
                Vous aurez besoin de télécharger et d'installer sous 
                Windows les pilotes des imprimantes que vous partagerez 
                sous Linux. Vous pourrez en général trouver ces pilotes 
                sur les sites web de leurs constructeurs.
            </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="configuration_du_partage_samba"></a>4.2. Configuration de Samba</h3></div></div><div></div></div><p>
                Si vous autorisez un accès anonyme à votre imprimante,
                vous devrez créer un compte utilisateur pour les 
                impressions à distance :

            </p><pre class="programlisting">
/usr/sbin/adduser --system --disabled-password smbprint
</pre><p>
                Cette commande ajoute un utilisateur appelé
                <tt class="literal">smbprint</tt> sur votre système. Vérifiez
                qu'il y a assez d'espace disque dans <tt class="filename">/home/smbprint</tt>, le
                répertoire personnel de l'utilisateur
                <tt class="literal">smbprint</tt> pour stocker les fichiers en
                attente d'impression.
                
                Vérifiez que l'utilisateur <tt class="literal">smbprint</tt>
                ne dispose pas des droits de lecture ou de modification
                sur les fichiers et les répertoires sensibles.

                Si vous avez configuré CUPS pour restreindre
                l'impression à certains utilisateurs sur votre système,
                vous devrez autoriser l'utilisateur
                <tt class="literal">smbprint</tt> à accéder aux imprimantes
                que vous voulez partager.
            </p><p>
                Le fichier de configuration de Samba est
                <tt class="filename">/etc/samba/smb.conf</tt>. Ce qui suit
                est un exemple de configuration permettant d'utiliser
                CUPS avec l'utilisateur
                <tt class="literal">smbprint</tt> :

            </p><pre class="programlisting">
[global]
 printcap name = cups  
 printing = cups   
 security = share

[printers]   
 browseable = yes   
 printable = yes   
 public = yes   
 create mode = 0700   
 guest only = yes   
 use client driver = yes
 guest account = smbprint   
 path = /home/smbprint   
</pre><p>
                Veuillez noter que cette configuration va autoriser
                l'impression par toute personne pouvant établir une
                connexion réseau à votre ordinateur, ce qui n'est pas
                recommandé pour des machines situées sur des réseaux non
                sûrs. Ce qui est par exemple le cas des ordinateurs
                reliés directement à internet. Si vous devez mettre en
                place un contrôle d'accès, mettez
                <tt class="literal">security = user</tt> ou
                <tt class="literal">security = domain</tt> et lisez
                les pages de manuel de Samba pour de plus amples
                informations.
            </p><p>
                Une fois que vous aurez ajouté les réglages ci-dessus à
                votre fichier de configuration Samba, vous devez
                redémarrer Samba avec la commande :
            </p><pre class="programlisting">
/etc/init.d/samba restart
</pre></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="configuration_de_cups"></a>4.3. Configuration de CUPS</h3></div></div><div></div></div><p>
                Les pilotes d'imprimante Windows formatent leur sortie
                pour l'imprimante avant de l'envoyer au travers du
                réseau. Vous devrez configurer CUPS pour accepter la
                sortie pré-formatée en enlevant
                dé-commentant<sup>[<a name="id2497897" href="#ftn.id2497897">1</a>]</sup> la ligne ci-dessous du fichier
                <tt class="filename">/etc/cups/mime.convs</tt> :
            </p><pre class="programlisting">
application/octet-stream   application/vnd.cups-raw   0   -
</pre><p>
                Vous devrez aussi dé-commenter la ligne ci-dessous dans
                <tt class="filename">/etc/cups/mime.types</tt> :
            </p><pre class="programlisting">
application/octet-stream
</pre><p>
                Maintenant, vous devez configurer CUPS pour autoriser 
                les connexions en provenance des autres machines du 
                réseau. Ajoutez les lignes ci-dessous au fichier
                <tt class="filename">/etc/cups/cupsd.conf</tt> :
            </p><pre class="programlisting">
&lt;Location /printers&gt;
 AuthType None
 Order Deny,Allow
 Deny From None
 Allow From All
&lt;/Location&gt;
</pre><p>
                Comme dans la configuration de Samba, cette
                configuration autorise n'importe quelle machine à se
                connecter à vos imprimantes et n'est pas recommandée sur
                des réseaux non sécurisés. Pour apprendre comment
                configurer le contrôle d'accès de vos imprimantes, lisez
                la page de manuel du fichier
                <tt class="filename">cupsd.conf</tt> et la documentation de
                CUPS.
            </p><p>
                Finalement, redémarrez CUPS avec la commande
                suivante :
            </p><pre class="programlisting">
/etc/init.d/cupsys restart
</pre><p>
                Votre imprimante sous Linux devrait désormais être
                accessible par les PC sous Windows de votre réseau
                local. Suivez les étapes habituelles de configuration
                d'une imprimante réseau sur vos machines sous Windows et
                n'oubliez pas d'imprimer une page de test.
            </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="depannage"></a>5. Résolution de problèmes</h2></div></div><div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="echec_des_connexions"></a>5.1. 
                Échec des connexions aux imprimantes sous Windows
            </h3></div></div><div></div></div><p>
                Quand <span><b class="command">smbspool</b></span>, l'utilitaire
                correspondant à <span><b class="command">smbclient</b></span> utilisé par
                CUPS n'arrive pas à se connecter, il émet des messages
                d'erreur pleins d'humour mais pas très utiles. L'un de 
                ces messages est :
            </p><pre class="screen">
Impossible de se connecter à l'hôte Samba : Succès.
</pre><p>
                L'échec des connexions peut également se manifester par
                le blocage apparent des documents dans la file d'attente
                des imprimantes sous Windows.
            </p><p>
                Examinez les entrées les plus récentes du journal 
                des erreurs de CUPS avec la commande suivante :
            </p><pre class="programlisting">
/usr/bin/tail /var/log/cups/error_log
</pre><p>
                Si vous voyez un message ressemblant à
                <tt class="computeroutput">cli_connect() failed...</tt>
                c'est que <span><b class="command">smbspool</b></span> n'a pu trouver la
                machine Windows à laquelle vous essayez de vous
                connecter.
            </p><p>
                Vérifiez l'orthographe du nom de la machine sous
                Windows. Vérifiez aussi que la machine sous Windows est
                allumée et que sa connexion réseau fonctionne
                correctement. Assurez-vous que vous pouvez vous y
                connecter en utilisant <span><b class="command">smbclient</b></span>
                comme cela a été présenté dans la <a href="#connexion_a_windows" title="3.1. Connexion à Windows">Section 3.1, « Connexion à Windows »</a>.
            </p><p>
                Si vous voyez un message ressemblant à
                <tt class="computeroutput">SMB tree connect failed: ERRSRV -
                ERRinvnetname</tt> c'est que
                <span><b class="command">smbclient</b></span> est parvenu à se connecter
                à la machine sous Windows mais n'a pas pu se connecter à
                l'imprimante que vous avez indiqué. Vérifiez
                l'orthographe du nom de l'imprimante partagée en
                utilisant la commande <span><b class="command">smbclient</b></span> comme
                cela a été présenté dans la <a href="#connexion_a_windows" title="3.1. Connexion à Windows">Section 3.1, « Connexion à Windows »</a>.
            </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="autres_echecs"></a>5.2. D'autres problèmes</h3></div></div><div></div></div><p>
                Parmi les autres problèmes que vous pourrez rencontrer,
                il y a, par exemple, le fait d'être incapable d'imprimer
                vers une imprimante locale ou le fait de voir les
                travaux d'impression disparaître de la file d'attente
                sans s'être imprimés. Il se peut aussi que vous voyiez 
                des messages d'erreurs vagues tels que :
            </p><pre class="screen">
Child process 2384 exited with status 32.
</pre><p>
                Augmentez le niveau de détail du journal des erreurs
                (paramètre <tt class="literal">LogLevel</tt>) en lui donnant
                la valeur <tt class="literal">debug</tt>, ce qui vous
                permettra d'avoir plus d'informations sur ce qui s'est
                passé avant que l'impression échoue :
            </p><div class="orderedlist"><ol type="1"><li><p>
               Ouvrez le fichier de configuration principal de CUPS
               <tt class="filename">/etc/cups/cupsd.conf</tt> avec un éditeur
               de texte.
            </p></li><li><p>
               Changez la ligne qui contient <tt class="literal">LogLevel
               warn</tt> en <tt class="literal">LogLevel debug</tt>.
            </p></li><li><p>
               Sauvegardez le fichier de configuration et quittez
               l'éditeur de texte.
            </p></li><li><p>
               Relancez le serveur CUPS avec la commande suivante :
            </p><pre class="programlisting">
/etc/init.d/cupsys restart
</pre></li></ol></div><p>
                Vous pourrez consulter le fichier d'historique de CUPS
                avec la commande suivante  :
            </p><pre class="programlisting">
/usr/bin/tail -f /var/log/cups/error_log
</pre><p>
                Vous devriez voir une ligne disant
                <tt class="computeroutput">Scheduler shutting down due to
                SIGTERM</tt>. Cela indique que le serveur
                CUPS a été correctement arrêté.
            </p><p>
                Relancez votre travail d'impression et recherchez
                des messages intéressants pour le diagnostic du 
                problème.
            </p><p>
                Un exemple de message de débogage intéressant est :
            </p><pre class="screen">
GNU Ghostscript 7.05 : Can't start ijs server 'hpijs'.
</pre><p>
                Dans ce cas, la solution est d'installer le paquet
                <i class="medialabel">hpijs</i>.
            </p><p>
                Si vous ne pouvez pas déterminer la cause de l'échec,
                effectuez une recherche sur internet avec les mots clefs
                du message d'erreur que vous avez trouvé ; il y a
                des chances que quelqu'un aie déjà résolu votre problème
                auparavant. Vous pouvez aussi essayer de mettre à jour
                les paquets listés dans la <a href="#logiciels" title="2.2. Logiciels requis">Section 2.2, « Logiciels requis »</a> 
                si une version plus à jour est disponible.
            </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="licence"></a>6. Licence &amp; droits d'utilisation</h2></div></div><div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="licence_vf"></a>6.1. Droits d'utilisation (v.f.)</h3></div></div><div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png"></td><th align="left">Avertissement</th></tr><tr><td colspan="2" align="left" valign="top"><p>
            Ceci est la version française non officielle de la licence 
            selon laquelle ce document est distribué. Seule la version 
            anglaise de cette licence (ci-dessous) fait foi.
        </p></td></tr></table></div><p>
            Copyright © 2003 Ian Ward.
        </p><p>
            Copyright © 2003 Vincent Chartier, Claude 
            Thomassin and Jean-Philippe Guérard pour la version 
            française.
        </p><p>
            Ce document est un logiciel libre ; vous pouvez le 
            redistribuer ou le modifier selon les termes de la licence 
            publique générale GNU (GPL), tel que publiée par la Free 
            Software Foundation ; que ce soit dans sa version 2 ou 
            bien, à votre choix, selon toute version ultérieure.
        </p><p>
            Il est distribué dans l'espoir qu'il se révélera utile, mais 
            sans aucune garantie ; sans même les garanties 
            implicites liés aux produits commerciaux ou d'adaptation à 
            un but particulier. Reportez-vous à la licence publique 
            générale GNU (GPL) pour plus d'informations.
        </p><p>
            Une copie de la licence publique générale GNU (GPL) est
            disponible dans le fichier
            <tt class="filename">/usr/share/common-licenses/GPL</tt> livré
            avec la distribution Linux/GNU Debian. Cette licence est
            également disponible sur la Toile à l'adresse <a href="http://www.gnu.org/copyleft/gpl.html" target="_top">http://www.gnu.org/copyleft/gpl.html</a>. Vous pouvez
            également obtenir une copie de cette licence en écrivant (en
            anglais) à Free Software Foundation, Inc., 59 Temple Place,
            Suite 330, Boston, MA 02111-1307, États-Unis d'Amérique.
        </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="license"></a>6.2. License</h3></div></div><div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png"></td><th align="left">Avertissement</th></tr><tr><td colspan="2" align="left" valign="top"><p>
            Ceci est la version originale officielle de la licence 
            selon laquelle ce document est distribué. Seule cette 
            version fait foi. Une version française non-officielle est 
            disponible ci-dessus.
        </p></td></tr></table></div><p>
            Copyright © 2003 Ian Ward.
        </p><p>
            Copyright © 2003 Vincent Chartier, Claude 
            Thomassin and Jean-Philippe Guérard for the french 
            translation.
        </p><p>
            This manual is free software; you may redistribute it and/or
            modify it under the terms of the GNU General Public License
            as published by the Free Software Foundation; either version
            2, or (at your option) any later version.
        </p><p>
            This is distributed in the hope that it will be useful, but
            without any warranty; without even the implied warranty of
            merchantability or fitness for a particular purpose. See the
            GNU General Public License for more details.
        </p><p>
            A copy of the GNU General Public License is available as
            /usr/share/common-licenses/GPL in the Debian GNU/Linux
            distribution or on the World Wide Web at
            http://www.gnu.org/copyleft/gpl.html. You can also obtain it
            by writing to the Free Software Foundation, Inc., 59 Temple
            Place, Suite 330, Boston, MA 02111-1307, USA. 
        </p></div></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.id2497897" href="#id2497897">1</a>] </sup>C'est-à-dire en retirant le
                caractère dièse (« # ») en début de
                ligne.</p></div></div></div></body></html>
