<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>Linux - Optical Disk HOWTO </TITLE>
</HEAD>
<BODY>
<H1>Linux - Optical Disk HOWTO </H1>

<H2>Skip Rye,   
<A HREF="mailto:abr@preferred.com">abr@preferred.com</A></H2>v1.6, 11 December 1998
<HR>
<EM>Ce document décrit l'installation et la configuration des lecteurs de
disques optiques sous Linux.
Que ceux qui ont pratiqué le sujet me fassent part de leurs remarques afin que je puisse les inclure dans le document SGML pour les transmettre à la communauté. N'oubliez pas de me confirmer que je peux mentionner votre adresse électronique.</EM>
<HR>

<H2><A NAME="s1">1. Avertissement</A></H2>


<P>Les personnes impliquées dans la rédaction, la distribution et la 
traduction du présent document déclinent toute responsabilité quant aux 
dommages qui pourraient découler de son utilisation.</P>

<H2><A NAME="s2">2. Copyright </A></H2>

<P>Les noms "Optical Disk-HOWTO" et "LF1000 mini-HOWTO" sont protégés.</P>

<H2><A NAME="ss2.1">2.1 LF1000 mini-HOWTO</A>
</H2>

<P>Copyright (c) 1996,1997 by Skip Rye, abr@brspc_0064.msd.ray.com</P>
<H2><A NAME="ss2.2">2.2 Optical Disk-HOWTO</A>
</H2>

<P>Copyright (c) 1997,1998 by Skip Rye, abr@preferred.com</P>
<P>La distribution de ce document doit se conformer aux termes de la 
licence LDP tels que définis à l'adresse&nbsp;:
<A HREF="http://sunsite.unc.edu/LDP/COPYRIGHT.html">sunsite.unc.edu/LDP/COPYRIGHT.html</A>.</P>


<H2><A NAME="s3">3. Technologie du changement de phase optique</A></H2>


<H2><A NAME="ss3.1">3.1 Introduction</A>
</H2>

<P>La technologie du changement de phase permet de stocker l'information 
binaire via l'état de phase d'un matériau particulier. Le périphérique 
module l'intensité d'un rayon laser pour modifier l'état de phase. A un 
certain niveau de puissance, le faisceau laser permet une cristallisation 
du support tandis qu'un autre niveau le laisse complètement amorphe. Le 
support ne réfléchira pas les émissions laser de la même façon selon 
qu'il se présente cristallisé ou non. Il est ainsi possible de stocker 
des données sur le disque.</P>

<P>La spécificité du disque optique réside en ce que le formatage du disque
repose sur une succession de pistes concentriques chacune divisée en
secteurs, à l'instar des disques magnéto-optiques. La proximité des pistes
autorise le stockage d'une quantité de données importante. A la différence
d'un cédérom, cela confère à l'ensemble l'aspect d'un disque magnétique. 
Les cédéroms sont eux dotés d'une piste en spirale à l'image de celle des 
CD audios La différence entre le disque à changement de phase et le disque 
optique ne se cantonne pas à une division en pistes et secteurs. La 
technologie du changement de phase permet une écriture directe des données, 
opération couteuse avec un système magnéto-optique. Le support possède
en outre la propriété intéressante de ne PAS être sensible aux champs 
magnétiques ou aux décharges électriques. Cela lui confère une durée de vie 
particulièrement élevée.</P>

<H2><A NAME="ss3.2">3.2 LF1000 Panasonic</A>
</H2>


<H3>Caractéristiques intéressantes&nbsp;: </H3>

<P>
<UL>
<LI> Lecture/écriture des disques optiques.</LI>
<LI> Lecture des cédéroms en quadruple vitesse.</LI>
<LI> Lecture des CD Kodak (stockage des photos).</LI>
<LI> Le support a une durée de vie de 15 ans. </LI>
<LI> Interface de type SCSI-2. </LI>
<LI> Formatage en pistes et secteurs.</LI>
<LI> Temps d'accès de 165 ms (bien meilleur qu'une bande de sauvegarde).</LI>
<LI> 650 Mb de données par disque.</LI>
<LI> Les disques coûtent dans les 50 $ pièce. </LI>
</UL>
</P>

<H3>Ce qu'il faut savoir</H3>

<P>
<UL>
<LI> Le format du disque optique n'est pas compatible avec un autre lecteur.</LI>
<LI> Le support Unix semble inexistant. Le produit cible plutôt les 
utilisateurs de DOS/Windows et de Macintosh.</LI>
<LI> N'achetez pas le lecteur PD qui utilise le port parallèle. A ma 
connaissance, aucun pilote de périphériques sous Linux ne le gère.</LI>
</UL>
</P>

<H3>Installation</H3>

<P>Le LF1000 est un périphérique supportant les échanges en SCSI-2. Il dispose
d'une taille de bloc de 512 octets et est compatible avec les pilotes SCSI de
Linux. L'installation a eu lieu sur un compatible PC muni d'un 486 d'AMD à 100 
MHZ et d'un contrôleur SCSI Adaptec 1542C. La prise en charge et l'insertion 
dans l'arborescence du disque ont suivi les étapes ci-dessous&nbsp;:</P>

<H3>Phases de l'installation</H3>

<P>
<UL>
<LI> Mettez en place le lecteur et configurez son numéro de périphérique sur
la chaîne SCSI de façon qu'il n'interfère pas avec les autres
éléments de la chaîne. Rebranchez les câbles.</LI>
<LI> Démarrez l'ordinateur. Le contrôleur SCSI devrait remarquer la présence
du lecteur.</LI>
<LI> Au cours du lancement du noyau Linux, vous apercevrez normalement un
nouveau périphérique SCSI. Comme je disposais déjà d'un lecteur
magnéto-optique sur la chaîne SCSI, le périphérique est apparu en 
/dev/sdb.</LI>
<LI> Je n'ai pas partitionné le disque parce que fdisk a émis un 
avertissement et que je n'avais pas envie d'introduire quelque
incompatibilité que ce soit du point de vue de dosemu.</LI>
<LI> mkfs -t ext2 /dev/sdb </LI>
<LI> mkdir /pd </LI>
<LI> mount -t ext2 -o ro,suid,dev,exec,auto,nouser,async /dev/sdb /pd --&nbsp;on
se cantonne à des accès en lecture (pas d'écriture).</LI>
<LI> mount -t ext2 -o defaults /dev/sdb /pd --&nbsp;accès en lecture/écriture. </LI>
</UL>
</P>
<P><EM>Prêts pour le décollage ?</EM></P>

<H3>Conseils d'utilisation </H3>

<P>
<UL>
<LI> Le support physique est sensé être ré-inscriptible environ 500000 fois.
Il n'est donc pas recommandé d'installer un système d'exploitation à usage
permanent tel Linux sur un disque optique à changement de phase. De tels
systèmes d'exploitation usent souvent du disque à des fins de cache
mémoire. Au fil du temps, l'espérance de vie du support à changement de 
phase risque d'être atteinte.
</LI>
<LI>Montez autant que possible le disque en lecture seule.
</LI>
<LI> Pour les accès au disque en écriture, privilégiez les transferts 
de grandes quantités de données. Vous diminuerez ainsi la dispersion des 
fichiers, source de nombreux déplacements.
</LI>
<LI> Quoi qu'il en soit, le disque à changement de phase reste un bon support
pour les sauvegardes, les images ou les programmes que vous n'utilisez pas
trop souvent. La récupération d'archives est bien plus rapide qu'avec une 
bande. L'archivage peut se cantonner à un cp -rp sans avoir besoin du pilote
pour les bandes. Les liens symboliques seront cependant remplacés par les 
fichiers correspondants. Note du traducteur&nbsp;: cp -arp y remédie.]
<LI> Si lors d'une écriture de fichiers vous constatez qu'il ne se produit
aucune modification sur le disque optique, vous avez probablement oublié de
désenclencher la protection en écriture du disque.</LI>
</LI>
</UL>
</P>

<H2><A NAME="ss3.3">3.3 Notes supplémentaires de configuration par Jeff Rooze</A>
</H2>

<P>Bonjour,</P>
<P>J'ai lu votre article traitant de la configuration du Panasonic
LF-1000 sous Linux. Sur mon système, le disque optique et le
cédérom ont chacun leur nom, ce qui me permet de monter n'importe
lequel de ces supports quand je le souhaite. Aucun disque n'est
requis dans le lecteur lorsque je démarre Linux. Enfin, j'utilise
sur les disques optiques un système de fichiers de type ext2.</P>
<P>J'ai rencontré quelques problèmes.</P>
<P>  
Tout d'abord, mon disque dur occupait l'ID SCSI 6 et mon lecteur à
changement de phase l'ID 4. Je désirais une priorité plus élevée pour
mon disque dur que pour le lecteur à changement de phase. Sous Linux,
le pilote SCSI recherche les périphériques en partant de l'ID SCSI la
plus basse. Par conséquent, le nommage des périphériques dépendait du
contenu du disque optique. Difficile de vivre avec une racine 
attachée à un périphérique dont le nom change sans arrêt&nbsp;! J'ai résolu
le problème en modifiant l'ordre de recherche des périphériques dans le
pilote SCSI.  </P>
<P>Ensuite, le noyau Linux inclus dans ma distribution n'examine pas 
tous les LUNS SCSI. Or le disque optique propose un mode dans lequel
le cédérom se retrouve sur le LUN 1 et le disque optique sur le LUN 0.
Le mode est choisi au moyen des cavaliers de configuration du périphérique.
Le cavalier #2 doit être en position basse. S'il est en position
haute, l'identité du périphérique dépend du type de disque qu'il contient
et ce dernier est signalé sur le LUN 0. En l'absence de disque, je crois
que le périphérique se manifeste comme un lecteur de cédéroms.
J'utilise une carte SCSI 16-xx de Future Domain en guise d'adaptateur.
Le pilote correspondant dans le noyau linux reconnaît les signatures de
disque optique lorsqu'il examine les LUNS. Je pense que c'est le cas de la 
plupart des gestionnaires SCSI. J'ai configuré le noyau de façon
que tous les LUNS soient examinés par les gestionnaires SCSI au démarrage
(option "scan all LUNS"). Le noyau affecte un nom différent à chaque
périphérique. Ce qui suit provient d'un enregistrement des messages de
démarrage. Vous remarquerez la présence d'une série d'erreurs, due à
l'absence de disque dans le lecteur tandis que celui-ci tentait d'accéder à
la table des partitions pour obtenir la taille des blocs. Par défaut,
la taille des blocs est fixée à 512 octets. Je pense modifier prochainement
ce comportement, pour le gestionnaire SCSI Future Domain, lorsqu'un 
périphérique optique est détecté.
<BLOCKQUOTE><CODE>
<PRE>
>  scsi0 &lt;fdomain>: BIOS version 3.2 at 0xde000 using scsi id 7
>  scsi0 &lt;fdomain>: TMC-18C50 chip at 0x140 irq 12
>  scsi0 : Future Domain TMC-16x0 SCSI driver, version 5.28
>  scsi : 1 host.
>    Vendor: CONNER    Model: CP30545 545MB3.5  Rev: A9AF
>    Type:   Direct-Access                      ANSI SCSI revision: 02
>  Detected scsi disk sda at scsi0, id 6, lun 0
>    Vendor: MATSHITA  Model: PD-1 LF-1000      Rev: A109
>    Type:   Optical Device                     ANSI SCSI revision: 02
>  Detected scsi disk sdb at scsi0, id 4, lun 0
>    Vendor: MATSHITA  Model: PD-1 LF-1000      Rev: A109
>    Type:   CD-ROM                             ANSI SCSI revision: 02
>  Detected scsi CD-ROM sr0 at scsi0, id 4, lun 1
>  fdomain: Selection failed
>  scsi : detected 1 SCSI cdrom 2 SCSI disks total.
>  SCSI Hardware sector size is 512 bytes on device sda
>  fdomain: REQUEST SENSE Key = 2, Code = 3a, Qualifier = 0
>  last message repeated 3 times
>  sdb : READ CAPACITY failed.
>  sdb : status = 0, message = 00, host = 0, driver = 28
>  sdb : extended sense code = 2
>  sdb : block size assumed to be 512 bytes, disk size 1GB.
>  .
>  .
>  .
>  Partition check:
>    sda: sda1 sda2 sda3
>  scsidisk I/O error: dev 0810, sector 0
>    unable to read partition table of device 0810
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ensuite, j'ai modifié le fichier décrivant les arborescences disponibles 
sur ma machine (/etc/fstab) pour que chaque périphérique y soit présent.
Je n'ai pas tenté le montage automatique au démarrage. Ci-suit un
extrait de mon /etc/fstab. Les options les plus importantes sont noauto,
rw (resp. ro) et les indicateurs de vérification.</P>
<P>Afin de créer un système de fichier sur le disque à changement de phase, 
j'ai utilisé la commande suivante&nbsp;: "mkfs.ext2 -i 2048 /dev/sdb".</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
# fstab - Liste des systèmes de fichiers
#
# device  mount   type          options              dumpfrequency
checkpass
/dev/sdb /optd    ext2   rw,user,suid,noauto,sync,exec,dev,umask=0 0 2
/dev/sr0 /dist  iso9660  ro,user,suid,noauto,sync,exec,dev 0 2
</PRE>
</CODE></BLOCKQUOTE>
</P>

<P>Après ces changements, je n'ai pas eu de problèmes au montage de quelque
périphérique que ce soit. Il me suffit d'insérer un disque et de taper
"mount /optd" ou "mount /dist". Le système se charge du reste.</P>
<P>J'espère que ces informations seront utiles.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
Jeff
-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\ Jeff Rooze -- http://www.treknet.net/~jrooze -- jrooze@treknet.net /
/  If builders built buildings the way some programmers write        \
\  programs, then the first woodpecker that came along would destroy /
/  civilization.                                     GERALD WEINBERG \
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</PRE>
</CODE></BLOCKQUOTE>
</P>

<P>J'ai appliqué les instructions de Jeff comme suit&nbsp;:
<UL>
<LI> Modification du noyau dont l'arborescence se situait sous 
/usr/src/linux au moyen de xconfig puis installation dudit noyau.</LI>
<LI> Basculement du cavalier de mode du disque à changement de phase sur la
position non-DOS. J'ai connecté un interrupteur à la broche de choix du
mode puis l'ai logé sur la face arrière. Après avoir déterminé quelle était
la position ouverte de l'interrupteur, je l'ai notée "DOS". L'autre
correspond bien sûr à Linux. Avant le démarrage de mon système, j'agis sur
l'interrupteur en conséquence. Il semblerait que la position Linux soit
la plus fréquemment employée.</LI>
<LI> Redémarrage de la machine. On doit voir apparaître plusieurs LUN
à l'initialisation, lors de l'examen du disque à changement de phase. Si le 
noyau date, on modifiera le fichier "/usr/src/linux/drivers/scsi/config.in".</LI>
<LI> Mise à jour de la fstab (fichier /etc/fstab) pour prendre en compte
aussi bien la lecture de cédéroms que de disques à changement de phase.</LI>
<LI> Utilisation de la commande mount adéquate.</LI>
<LI> Un ``df'' pour vérifier que tout va bien.</LI>
</UL>
</P>
<P>Ma tentative de passage à 6 de l'identité SCSI de mon disque primaire a 
révélé certains problèmes. Je ne me souviens plus exactement mais cela 
semblait provenir du fait que mon contrôleur Adaptec 1542 et le SCSI Corel
exigent un disque amorçable sous l'identité 0 pour que la mise en place du
BIOS soit compatible avec le DOS. J'ai donc remis le disque comme à
l'origine et j'ai commencé à me servir tranquillement de mon disque à
changement de phase. Avec cette configuration, ``workman'' --&nbsp;le lecteur de
CD audio&nbsp;-- fonctionne correctement.</P>

<H2><A NAME="s4">4. Principe de fonctionnement de la technique magnéto-optique</A></H2>


<H2><A NAME="ss4.1">4.1 Introduction </A>
</H2>

<P>Les disques magnéto-optiques ont recours à un champ magnétique dit 
``lointain'' et à un faisceau laser pour modifier la polarisation d'un
milieu magnétique. Le support est tel qu'il doit être chauffé
pour qu'un changement de polarisation soit possible, d'où la
présence du laser. Un laser de puissance provoque un échauffement de la 
surface du disque jusqu'à une température suffisante pour que le champ
``lointain'' soit capable de polariser la surface magnétique. Peu après,
le disque refroidit et fixe la polarisation.
Je crois qu'un laser de faible puissance sert pour la lecture, le champ
magnétique dû à la polarisation du disque interagissant avec les
composantes de son champ électromagnétique. J'espère que c'est à peu près
ça mais rien n'est moins sûr. A corriger peut-être.</P>
<P>La précision apportée par le laser pour le changement de polarisation
autorise une densité de pistes et de bits plus élevée que celle des
techniques magnétiques conventionnelles. Le champ ``lointain'' élimine 
les dégâts parfois occasionnés par les têtes magnétiques, du moins si
l'étiquette de votre disque ne se relève pas subitement et s'il n'y a 
pas une saloperie du même genre sur la cartouche du disque. La plupart
des supports autorisent le stockage de 650 Mo de données par face et
sur certains modèles les deux faces sont employées, portant la 
capacité à 1,3 Go. Il faudra cependant retourner le disque pour passer
d'une tranche de 650 Mo à l'autre.</P>

<H2><A NAME="ss4.2">4.2 Olympus, Epson, Mitsubishi MK230LK3 - Stephan Shuichi Haupt</A>
</H2>

<P>
<A HREF="mailto:Stephan Shuichi Haupt &lt;stephan@bios.t.u-tokyo.ac.jp>">Stephan Shuichi Haupt &lt;stephan@bios.t.u-tokyo.ac.jp></A></P>
<P>
<PRE>
Bonjour,

  j'ai remarqué que le HOWTO ne parle guère des disques magnéto-optiques,
peut-être en raison de leur manque de popularité. Au Japon, ils sont
cependant fort répandus, plus particulièrement les modèles trois pouces
et demi qui supportent des disques de 128, 230 et dernièrement 640 Mo.
J'imagine que les informations en japonais concernant ces lecteurs ne
manquent pas. Certaines personnes ne s'en estiment néanmoins guère plus
avancées pour autant :o). Les disques magnéto-optiques s'emploient comme
n'importe quel autre support amovible et s'avèrent adaptés aux petites
sauvegardes compte tenu de leur faible coût (10 dollars US pour une
unité de 640 Mo en octobre 1998). Je vais dire quelques mots des lecteurs
de 230 Mo à interface SCSI.

Disques employés : plusieurs (Olympus, Epson et en ce moment un MK230LK3
de Mitsubishi), pas de problèmes particuliers. Les lecteurs présentent
parfois des cavaliers aux configurations exotiques (``Mode Mac'' et
autres). Désactivez-les. Si vous souhaitez vous équiper d'un disque, 
faites attention à la taille du cache : elle peut améliorer notablement
le taux de transfert, qui restera bien sûr inférieur à ceux des disques 
durs.
Contrôleurs SCSI : cartes à base de NCR53C810 (Asus SC-200), Adaptec
APA-1460A, Adaptec AHA2940.
Installez le lecteur comme vous le feriez avec un disque SCSI
supplémentaire. Il apparaîtra de la même façon. Aucun disque n'est 
requis dans le lecteur au démarrage.

Il y a deux façons de formater les disques :
- à la mode disquette. Lancez directement mkfs sur le périphérique associé,
à savoir quelque chose comme sdb ou sdc. Je déconseille cette méthode (cf.
ci-dessous) ;
- comme un disque dur. Utilisez fdisk pour partitionner le périphérique et
appliquez ensuite mkfs aux partitions concernées (quelque chose du style
sdc0, je n'ai pour ma part jamais défini plus d'une partition sur un disque 
magnéto-optique).
Je n'ai pour l'instant pas encore essayé de démarrer depuis un disque
magnéto-optique mais je ne vois aucune raison pour laquelle cela ne
fonctionnerait pas. Compte tenu des performances du lecteur, je 
cantonnerais cependant ce genre d'utilisation aux disques de secours.

Remarque : les disques prévus pour dos ou windows, une fois formatés à la
mode ``disquette'', risquent de s'avérer inutilisables avec l'un quelconque
de ces systèmes tandis que le recours au partitionnement (FAT16, type 6) 
suivi de mkdosfs fonctionne correctement (au moins avec NT3.5/4.0).
Quand il se termine, fdisk émet un avertissement au sujet des partitions de
type FAT16 : prêtez-y donc attention (cf. la page de manuel de fdisk).
La taille des secteurs n'est pas positionnée automatiquement par mkdosfs.
Invoquez ``mkdosfs -s 8''. Cette information a été pêchée dans un site ouaibe, courant
1995 (merci à Ken Kawabata pour l'avoir trouvée et déchiffrée). Un système
de fichiers de type vfat fonctionnera correctement. Pour l'instant je n'ai
employé que les couples FAT/dosfs et Linux/ext2 avec mes disques.

Note : le support reste assez sensible, aux champs magnétiques bien sûr, 
mais également aux contraintes mécaniques. Certains formats paraissent
plus fragiles, le Mac semblant le pire : des pertes de données ont eu
lieu lors de retraits de disques avec de faibles trafics réseau. 

Ces informations n'aideront personne à retrouver son chemin au fin fond 
de la jungle, mais elles peuvent quand même s'avérer utiles. 

        Steve 

-- 
***********************cut*here*or*do*not********************************
        S. Shuichi Haupt
        email stephan@bios.t.u-tokyo.ac.jp
        http://www.bios.t.u-tokyo.ac.jp/~stephan/

---------------- 11 décembre 1998 mise à jour de Steve -------------------

Bon, certains problèmes vont parfois se manifester avec les disques
magnéto-optiques. La meilleure façon de les éviter consiste à ne pas
employer les disques tels quels au sortir du magasin. Le montage 
risque même de provoquer des plantages du noyau. J'ai
malencontreusement essayé de monter un disque de 640Mo, prétendument 
formaté sous Windows 95, peut être en FAT32, en tant que système de
fichier vfat : à éviter...
De plus, les noyaux 2.0.x ne gèrent pas les blocs de 2 ko (ainsi que les
disques de 640 Mo). Un patch adéquat semble se promener quelque part
au Japon mais je n'ai pas encore mis la main dessus. Le lien suivant
en fournira sûrement la description :
http://elektra.e-technik.uni-ulm.de/~mbuck/linux/patches.html.
Sinon, allez fouiller du côté de u-tokyo.ac.jp. La page des développeurs
s'y trouve.

Le meilleur emploi des disques de 640 Mo passe par fdisk et mkfs. 
C'est ce que j'ai fait avec mke2fs sur des partitions de type 83 :
mke2fs -b 2048 /dev/sdxy

J'examinerai le cas des partitions de type FAT16 et de mkdosfs dès que
j'aurai un peu de temps (et quelques disques).

Tout ce qui précède a été réalisé avec un noyau 2.1.124.

Steve
-- 
***********************cut*here*or*do*not********************************
        Stephan Shuichi 
office: Dept. for Mechano-Informatics, Yoshizawa Lab.
        Faculty for Engineering, University of Tokyo
        Tel 03-3812-2111 ext 6390, FAX 03-5802-2957
        email stephan@bios.t.u-tokyo.ac.jp
        http://www.bios.t.u-tokyo.ac.jp/~stephan/
private: --

</PRE>
</P>

<H2><A NAME="ss4.3">4.3 Fujitsu DynaMO 640 - Phil Garcia</A>
</H2>

<P>
<A HREF="mailto:pgarcia@execpc.com">pgarcia@execpc.com</A>
<PRE>
  Vous avez sûrement déjà reçu de nombreux messages concernant le Dynamo
640 de Fujitsu. Je dispose de la version interne, le 640SZI. Numéro de
version donné par le gestionnaire SCSI : M2513-MCC3064SS. J'ai
dernièrement installé ce disque presque sans la moindre difficulté. Je
dis presque car la taille des secteurs des disques de 640 Mo est
de 2048 octets, format que ne gèrent pas les noyaux 2.0.x mais 
qu'admettent les noyaux de développement. Un patch pour les noyaux
2.0.x est disponible via : 
http://wwwcip.informatik.uni-erlangen.de/~orschaer/mo/.
Le même site vous fournira une version adaptée de fdisk.

Autrement, l'installation du périphérique ne diffère pas de celle d'un disque
dur SCSI. Il fonctionne bien et j'en suis très content. 

Phil Garcia

</PRE>
</P>

<H2><A NAME="ss4.4">4.4 Panasonic LF-7010 - Philip Kerr</A>
</H2>

<P>
<A HREF="mailto:philip_kerr_at_wmc__brsf2@wmcmail.wmc.ac.uk">philip_kerr_at_wmc__brsf2@wmcmail.wmc.ac.uk</A>
<PRE>
     Cher Skip
     
  Vous avez demandé dans votre HOWTO aux utilisateurs de relater leurs 
expériences des disques optiques sous Linux. Vous trouverez ci-dessous les
détails de la mise en oeuvre d'un LF-7010 de Panasonic (SCSI) avec une 
Sparc Classic. J'utilise des RedHat, 4.2 et 5.1.
  Amitiés 
    Philip Kerr &lt;philip.kerr@wmc.ac.uk>
     
  PS : j'essaie à présent de faire fonctionner le lecteur sous Solaris
2.6 et c'est une autre paire de manches.     
     ------------------------
branchement du disque (ID 5)...
mise en route de la station...
messages :
     scsi0 : Sparc ESP100A-FAST
     scsi : 1 host.
     Vendor: SAMSUNG   Model: WN32162U          Rev: 0100
     Type:   Direct-Access                      ANSI SCSI revision: 02
     
     Detected scsi disk sda at scsi0, channel 0, id 3, lun 0
     Vendor: MATSHITA  Model: LF-7010  (00:06)  Rev: 1.42
     Type:   Optical Device                     ANSI SCSI revision: 02
     Detected scsi removable disk sdb at scsi0, channel 0, id 5, lun 0 scsi 
     : detected 2 SCSI disks total.
     esp0: target 3 [period 100ns offset 15 10.00MHz FAST SCSI-II]
     SCSI device sda: hdwr sector= 512 bytes. Sectors= 4236661 [2068 MB] 
     [2.1 GB]
     esp0: target 5 [period 248ns offset 4 4.03MHz synchronous SCSI] sdb : 
     READ CAPACITY failed.
     sdb : status = 0, message = 00, host = 0, driver = 28 sdb : extended 
     sense code = 2 
     sdb : block size assumed to be 512 bytes, disk size 1GB.  
     sunlance.c:v1.9 21/Aug/96 Miguel de Icaza (miguel@nuclecu.unam.mx) 
     eth0: LANCE 08:00:20:04:3d:cf 
     eth0: using auto-carrier-detection.
     Partition check:
     sda: sda1 sda2 sda3 sda4 sda5 sda6 sda7 sda8
     sdb:scsidisk I/O error: dev 08:10, sector 0, absolute sector 0 unable 
     to read partition table
J'ai modifié mon /etc/fstab, ajoutant l'entrée adéquate pour le lecteur 
(en /dev/sdb) :
     ==========
     /etc/fstab
     ==========
     /dev/sda1          /                       ext2    defaults        1 1 
     /dev/sda2          swap                    swap    defaults        0 0 
     /dev/fd0           /mnt/floppy             msdos   noauto,user     0 0 
     /dev/sr0           /mnt/cdrom              iso9660 noauto,ro,user  0 0 
     /dev/sdb           /mnt/optical            ext2    noauto,rw,user  0 0 
     none               /proc                   proc    defaults        0 0
fsck :     
     [root@localhost me]# /sbin/mkfs -t ext2 /dev/sdb
     
     mke2fs 1.10, 24-Apr-97 for EXT2 FS 0.5b, 95/08/09 /dev/sdb is entire 
     device, not just one partition! Proceed anyway? (y,n) y
     Linux ext2 filesystem format
     Filesystem label=
     118320 inodes, 472448 blocks
     23622 blocks (5.00%) reserved for the super user First data block=1
     Block size=1024 (log=0)
     Fragment size=1024 (log=0)
     58 block groups
     8192 blocks per group, 8192 fragments per group 2040 inodes per group
     Superblock backups stored on blocks: 
     8193, 16385, 24577, 32769, 40961, 49153, 57345, 65537, 73729, 81921, 
     90113, 98305, 106497, 114689, 122881, 131073, 139265, 
     147457, 
     155649, 163841, 172033, 180225, 188417, 196609, 204801, 
     212993, 221185, 
     229377, 237569, 245761, 253953, 262145, 270337, 278529, 
     286721, 294913, 
     303105, 311297, 319489, 327681, 335873, 344065, 352257, 
     360449, 368641, 
     376833, 385025, 393217, 401409, 409601, 417793, 425985, 
     434177, 442369, 
     450561, 458753, 466945
     
     Writing inode tables: done     
     Writing superblocks and filesystem accounting information: done
Réinitialisation... 
Montage du disque...
J'ai encore ajouté une entrée à la fstab :
     /dev/sdb           /mnt/dostical          msdos   noauto,rw,user 0 0 
A présent, je peux accéder à des disques optiques formatés aussi bien en
ext2 qu'en msdos en utilisant au choix le point d'ancrage optical ou
dostical.
</PRE>
</P>

<H2><A NAME="s5">5. Les juke-box optiques</A></H2>

<P>Je n'ai pas eu l'occasion d'essayer de juke-box optiques avec Linux mais
avec HP-UX. Dans cette configuration, le juke-box disposait de son propre 
adressage SCSI et à chaque lecteur était associé un LUN. A chaque face
d'un disque correspondait un périphérique. La commande de montage prenait
le périphérique adéquat en argument. Je disposais d'un juke-box avec un seul
lecteur et 16 platines, soit 20 Go de disponibles. Je m'imaginais que 
l'écriture d'un gestionnaire de montage pour le partage des disques entre
utilisateurs serait une véritable corvée jusqu'à ce que je découvre que le
gestionnaire du juke-box autorisait le montage d'un nombre quelconque de 
disques dont il assurait l'arbitrage. Voilà une fonctionnalité sympathique&nbsp;!
Bien sûr, on reste cantonné à de la lecture pour un système dans
lequel on espère qu'il n'y aura pas trop de processus à accéder simultanément
au juke-box. Le disque s'arrête, le support le charge, se déplace, le range,
se déplace encore, charge un autre disque, le met en place, le lecteur le
charge, prend 12 secondes pour se mettre à tourner --&nbsp;toujours avec nous&nbsp;?
Un train d'enfer en vérité&nbsp;!</P>

<H2><A NAME="ss5.1">5.1 Maxoptix 520 - Zed Shaw</A>
</H2>

<P>
<A HREF="mailto:shawz@imap1.asu.edu">shawz@imap1.asu.edu</A></P>
<H3>Message original de Zed - 13 février 1998</H3>

<P>
<PRE>
Bonjour,

  j'étais en train de lire votre guide (une vraie trousse de survie, merci)
et je me demandais de quel type de juke-box vous vous serviez ? J'ai un 
Maxoptix 520 -- 20 disques de 2,6 Go chacun, sympa -- et j'aimerais arriver à
le piloter depuis une machine sous Linux pour que mes utilisateurs puissent
lire les disques. L'accès aux lecteurs me pose de sérieux problèmes. Pour
l'instant, je ne vois que deux lecteurs et quelque chose qui répond au doux
nom de MAXLYB. Je pense qu'il s'agit d'un vague contrôleur.  
Je me demandais si votre juke-box était du même type ou similaire et comment 
vous l'aviez installé. Bien que vous soyez sous HP-UX, toute information
serait la bienvenue. Je suis disposé à vous donner accès à ma machine si 
vous voulez voir à quoi ressemble le juke-box. 52 Go de capacité de stockage,
il n'y a pas mieux !
Votre aide sera vraiment la bienvenue.

Zed A. Shaw
Application Systems Analyst
Arizona State University
</PRE>
</P>

<H3>Échange avec Zed le lundi 16 février 1998&nbsp;:</H3>

<P>
<PRE>
> Il semblerait que votre Maxoptix 520 soit un juke-box à deux lecteurs.
Oui, celui-là même.

> 
> Tous les juke-box sont munis d'un contrôleur de platine. Il s'agit
> probablement du périphérique MAXLYB.
> ...

J'ai découvert que l'on ne s'inquiétait pas trop chez Maxoptix quand il
était question de pilotes. Manifestement, il n'en ont pas écrit le moindre
pour quelque interface que ce soit ! J'ignore comment une société pareille
peut vivre. Je vais encore les harceler, vous avez raison, l'engin
a besoin d'un pilote qui gère sa platine. Du côté des bonnes nouvelles,
on signale que le MX520 (il s'agit du numéro de série du juke-box) émule
pas mal de contrôleurs différents. Peut-être un de ceux-ci est-il géré ? 
Je vais regarder ça.

>
> Prenez donc contact avec Maxoptix afin de voir s'ils disposent d'un logiciel
> correspondant à votre version du noyau Linux. Si ce n'est pas le cas,
> demandez-leur les spécifications de programmation du contrôleur de platine et
> peut-être pourrons-nous en écrire un !
> 

Pour sûr, si je n'arrive pas à obtenir le moindre pilote et que j'arrive à 
convaincre les gens de Maxoptix de me fournir les spécifications, je serai le
premier heureux d'écrire un pilote. Je demanderai surement de l'aide vu que je
manque de temps pour tout faire moi-même. Connaissez-vous quelqu'un d'autre
dont nous pourrions tirer quelque chose ?

>
> Transmettez-moi les informations que vous obtiendrez afin que je les
> intègre, ainsi que les remerciements, dans le HOWTO.
>

Naturellement. Je vais commencer par glaner quelques informations. Pour 
l'instant ça reste léger. 

> > Je me demandais si votre juke-box était du même type ou similaire et 
> > comment vous l'aviez installé. Bien que vous soyez sous HP-UX, toute 
> > information serait la bienvenue. Je suis disposé à vous donner accès à 
> > ma machine si vous voulez voir à quoi ressemble le juke-box. 52 Go de 
> > capacité de stockage, il n'y a pas mieux !
> 
> Excellent. À mon domicile j'emploie PPP pour monter les 84 plateaux de
> mon juke-box HP. Ça s'avère assez lent. Je préférerais l'avoir sous la main.

Je ne dispose pas de cet engin chez moi : les 30000 dollars que mon employeur 
a dépensé pour l'obtenir me font défaut. Néanmoins, il n'en a rien tiré et
a dû le laisser ramasser la poussière depuis un an. Il me laisse donc
m'amuser avec et essayer de lui trouver un usage.

Je reprendrai contact dès que j'aurai des informations supplémentaires,
sûrement en cours de semaine lorsque je saurai si je peux le faire
fonctionner ou non.

Zed
</PRE>
</P>


</BODY>
</HTML>
