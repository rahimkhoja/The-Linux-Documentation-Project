<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>
    Guide pratique de gravure d'un CD RedHat
  </title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.66.1"><meta name="description" content="

      Ce document explique comment créer vos propres CD à partir des
      différentes versions de la distribution Linux RedHat (jusqu'à la
      version 9), équivalents à ceux que RedHat commercialise. La
      structure de la distribution est décrite, ainsi que la procédure
      d'inclusion de paquets RPM mis à jour. Il donne quelques conseils
      et quelques exemples de personnalisation de l'installation par
      défaut. Ce document contient également des scripts automatisant
      autant que possible la (re)génération des images CD. Créer vos
      propres CD ne demandera qu'une bonne connexion réseau et un
      graveur de CD (une connaissance des scripts shells peut aussi être
      utile).

  "></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" lang="fr"><div class="titlepage"><div><div><h1 class="title"><a name="id2405966"></a>
    Guide pratique de gravure d'un CD RedHat
  </h1></div><div><h3 class="subtitle"><i>
      Adaptation française du <span class="emphasis"><em>Burning a RedHat
      CD HOWTO</em></span>
  </i></h3></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Luigi</span> <span class="surname">Bitonti</span></h3><tt class="email">&lt;<a href="mailto:uknadors%20CHEZ%20yahoo%20POINT%20com">uknadors CHEZ yahoo POINT com</a>&gt;</tt></div><div class="author"><h3 class="author"><span class="firstname">Morten</span> <span class="surname">Kjeldgaard</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Peter</span> <span class="surname">von der Ahé</span></h3></div></div></div><div><p class="othercredit"><span class="contrib">Vérification et traduction française</span>: <span class="firstname">Guillaume</span> <span class="surname">Lelarge</span></p></div><div><p class="othercredit"><span class="contrib">Relecture de la version française</span>: <span class="firstname">Guillaume</span> <span class="surname">Hatt</span>, <span class="firstname">Jean-Philippe</span> <span class="surname">Guérard</span></p></div><div></div><div><p class="othercredit"><span class="contrib">Préparation de la publication de la v.f.</span>: <span class="firstname">Jean-Philippe</span> <span class="surname">Guérard</span></p></div><div><p class="releaseinfo">Version : 2.1.fr.1.1</p></div><div><p class="copyright">Copyright © 2000 Morten Kjeldgaard, Peter von der Ahé</p></div><div><p class="copyright">Copyright © 2002, 2003 Luigi Bitonti</p></div><div><p class="copyright">Copyright © 2003, 2004 Guillaume Lelarge, Guillaume Hatt, Jean-Philippe Guérard</p></div><div><p class="pubdate">2004-11-01</p></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="3"><b>Historique des versions</b></th></tr><tr><td align="left">Version 2.1.fr.1.1</td><td align="left">2004-11-01</td><td align="left">GL, GH, JPG</td></tr><tr><td align="left">Version 2.1.fr.1.0</td><td align="left">2003-12-07</td><td align="left">GL, GH</td></tr><tr><td align="left">Version 2.1</td><td align="left">2003-10-17</td><td align="left">LB</td></tr><tr><td align="left" colspan="3">
      
          Ajout de la Redhat 9. Correction de quelques bogues mineurs. Merci à
          tous ceux qui ont envoyé des commentaires et des correctifs.
          (<span class="emphasis"><em>Added RedHat 9. Fixed some minor bugs. Thanks to all
          the people who have sent in comments and patches.</em></span>)
	  
      </td></tr><tr><td align="left">Version 2.03.fr.1.0</td><td align="left">2003-08-18</td><td align="left">GL, GH, JPG</td></tr><tr><td align="left">Version 2.03</td><td align="left">2003-03-10</td><td align="left">LB</td></tr><tr><td align="left" colspan="3">
      
          Ajout de quelques commentaires et corrections pour le guide pratique.
          Les mises à jour anaconda sont maintenant incluses y compris
          les versions 7.x et plus.
      
          (<span class="emphasis"><em>Added some comments and fixes to the howto.
          The anaconda updates are now included correctly even for versions
          &gt;= 7.x.</em></span>)
	  
      </td></tr><tr><td align="left">Version 2.02</td><td align="left">2003-03-06</td><td align="left">LB</td></tr><tr><td align="left" colspan="3">

          La vérification de la signature fonctionne maintenant pour les
          paquets ciblés pour d'autres versions de la distribution
          RedHat que celle utilisée pour lancer les scripts. Correction
          d'un bogue dans la section de comparaison de version des
          scripts.

          (<span class="emphasis"><em>The signature checking now works for packages targeted
          to versions of RedHat different from the one used to run the scripts.
          Corrected a bug in the version comparison section of the
          scripts.</em></span>)
	  
      </td></tr><tr><td align="left">Version 2.01</td><td align="left">2002-12-04</td><td align="left">LB</td></tr><tr><td align="left" colspan="3">

          Deuxième édition de la nouvelle version de ce guide pratique.
          Tous les scripts ont été revus et nettoyés. Le script
          updateDist.sh vérifie maintenant que toutes les mises à jour
          ont été téléchargées avant de vérifier les signatures.

          (<span class="emphasis"><em>Second release of the new version of the howto.
          All the scripts were reviewed and cleaned. The updateDist.sh
          script now checks that all the updates were downloaded before checking
          the signatures.</em></span>)
	  
      </td></tr><tr><td align="left">Version 2.0</td><td align="left">2002-10-28</td><td align="left">LB</td></tr><tr><td align="left" colspan="3">
      
          Première édition de la version 2 de ce guide pratique.
      
          (<span class="emphasis"><em>First release of the new version (2.00) of the
          HOWTO</em></span>)
      </td></tr></table></div></div><div><div class="abstract"><p class="title"><b>Résumé</b></p><p>

      Ce document explique comment créer vos propres CD à partir des
      différentes versions de la distribution Linux RedHat (jusqu'à la
      version 9), équivalents à ceux que RedHat commercialise. La
      structure de la distribution est décrite, ainsi que la procédure
      d'inclusion de paquets RPM mis à jour. Il donne quelques conseils
      et quelques exemples de personnalisation de l'installation par
      défaut. Ce document contient également des scripts automatisant
      autant que possible la (re)génération des images CD. Créer vos
      propres CD ne demandera qu'une bonne connexion réseau et un
      graveur de CD (une connaissance des scripts shells peut aussi être
      utile).

  </p></div></div></div><hr></div><div class="toc"><p><b>Table des matières</b></p><dl><dt><span class="sect1"><a href="#introduction">1. Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="#avertissement">1.1. Avertissement et licence</a></span></dt></dl></dd><dt><span class="sect1"><a href="#redhat-ftp-site">2. Anatomie du site FTP de Red Hat</a></span></dt><dd><dl><dt><span class="sect2"><a href="#arborescence-redhat">2.1. 
    
        Organisation des répertoires de la distribution Redhat 9
    
    </a></span></dt><dt><span class="sect2"><a href="#repertoire-redhat">2.2. 
        
        Le répertoire « <span class="quote">RedHat</span> », le cœur de la
        distribution
    
    </a></span></dt><dt><span class="sect2"><a href="#repertoire-updates">2.3. Le répertoire « <span class="quote">updates</span> »</a></span></dt><dt><span class="sect2"><a href="#id2511532">2.4. Différences avec l'arborescence 8.0</a></span></dt><dt><span class="sect2"><a href="#id2511625">2.5. Différences avec l'arborescence 7.x</a></span></dt><dt><span class="sect2"><a href="#id2511706">2.6. Différences avec l'arborescence de la 6.x</a></span></dt></dl></dd><dt><span class="sect1"><a href="#paquets-rpm">3. Paquets RPM</a></span></dt><dd><dl><dt><span class="sect2"><a href="#comparer-versions-rpm">3.1. Comparer deux versions d'un paquet RPM</a></span></dt></dl></dd><dt><span class="sect1"><a href="#mirroir-local">4. Obtenir votre copie locale de la distribution</a></span></dt><dd><dl><dt><span class="sect2"><a href="#utiliser-wget-bash">4.1. Utiliser wget et bash</a></span></dt><dt><span class="sect2"><a href="#utiliser-mirror">4.2. Utiliser mirror</a></span></dt></dl></dd><dt><span class="sect1"><a href="#inclusion-des-mises-a-jour">5. Inclure les mises à jour</a></span></dt><dd><dl><dt><span class="sect2"><a href="#mise-a-jour-des-permissions">5.1. Corriger les modes de protection des fichiers</a></span></dt><dt><span class="sect2"><a href="#remplacement-des-paquets">5.2. Remplacer les RPM mis à jour</a></span></dt><dt><span class="sect2"><a href="#reconstruire-l-installateur">5.3. Reconstruire l'installateur</a></span></dt></dl></dd><dt><span class="sect1"><a href="#graver-le-cd">6. Graver le ou les CD</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2515729">6.1. Essayer l'image ou les images</a></span></dt><dt><span class="sect2"><a href="#id2515778">6.2. Graver le ou des disques</a></span></dt></dl></dd><dt><span class="sect1"><a href="#fichiers-comps">7. Le fichier comps</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2515954">7.1. 
    
        Format du fichier <tt class="filename">comps</tt> pour RedHat 
        versions &lt; 6.1
    
    </a></span></dt><dt><span class="sect2"><a href="#id2516130">7.2. Format du fichier comps pour RedHat version 6.1</a></span></dt><dt><span class="sect2"><a href="#id2516325">7.3. Format du fichier comps dans RedHat version 6.2</a></span></dt><dt><span class="sect2"><a href="#id2516438">7.4. Format d'un fichier comps dans la RedHat version 7.3</a></span></dt><dt><span class="sect2"><a href="#id2516717">7.5. 
    
        Format du fichier comps à partir des versions 8.0 et 9 de 
        RedHat
    
    </a></span></dt></dl></dd><dt><span class="sect1"><a href="#installation">8. Installation à partir du CD</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2517409">8.1. Démarrer d'un CD amorçable</a></span></dt></dl></dd><dt><span class="sect1"><a href="#other-distributions">9. Autres distributions Linux</a></span></dt><dt><span class="sect1"><a href="#this-document">10. Ce document…</a></span></dt><dd><dl><dt><span class="sect2"><a href="#references">10.1. Documents connexes</a></span></dt><dt><span class="sect2"><a href="#id2517735">10.2. Remerciements</a></span></dt></dl></dd><dt><span class="sect1"><a href="#adaptation-francaise">11. Adaptation française</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2517973">11.1. Traduction</a></span></dt><dt><span class="sect2"><a href="#id2517991">11.2. Relecture</a></span></dt></dl></dd></dl></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="introduction"></a>1. Introduction</h2></div></div></div><p>

    Il existe de nombreuses raisons de créer vos propres CD. Peut-être
    êtes-vous avare et voulez-vous économiser le prix d'une <a href="http://www.redhat.fr/" target="_top">distribution Red Hat</a>. Ou
    peut-être souhaitez-vous graver des CD contenant la plus récente
    distribution et toutes les dernières mises à jour. C'est très
    pertinent car après chaque version majeure de la distribution
    RedHat, de nombreuses mises à jour sont publiées, dont un certain
    nombre relatives à la sécurité. Jetez juste un œil sur la
    <a href="https://www.redhat.com/security/archives.html" target="_top">page
    d'errata</a>. Ou peut-être voulez-vous personnaliser
    l'installation par défaut en ajoutant quelques paquets absents et en
    en retirant certains autres.

  </p><p>

    Voici ce que vous apprendrez dans les sections suivantes (je
    l'espère). Les exemples seront basés sur les versions 7.3, 8.0 et 9
    de la distribution. Les notes relatives aux versions précédentes
    (&lt;6.1) proviennent d'une version précédente et ont été rassemblées
    par les auteurs originaux. Les notes relatives à la version 6.2 sont
    basées sur des essais que je n'ai pas terminés (et je ne sais pas si
    je les terminerai) et sur quelques documents que vous trouverez dans
    la section <a href="#references">documents connexes</a>. La procédure donnée dans
    les sections suivantes pour Redhat 7.3 et 8.0 peut fonctionner sur
    toutes les plates-formes compatibles avec cette distribution (Alpha,
    PPC et cætera), pour toutes les versions 7.x (et peut-être les
    versions 8.x et 9 dans un avenir pas si lointain) mais je l'ai
    seulement essayée sur la plate-forme i386 avec le Linux Redhat 7.3,
    8.0 et 9 (je serais intéressé par plus d'informations).

  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>

        Les opérations décrites ont des implications légales, ce qui
        veut dire que vous ne pouvez pas redistribuer les CD en tant que
        RedHat Linux si vous les avez modifiés de façon non conforme à
        la politique de RedHat. Pour les rendre légalement
        redistribuables, vous devez d'abord appliquer les lignes de
        conduites indiquées sur le <a href="http://www.redhat.com/about/corporate/trademark/" target="_top">site web
        de RedHat</a>.

      </p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>

      Rappelez-vous de toujours mettre en place les variables dans
      <tt class="filename">rhcd.conf</tt> et d'<span class="emphasis"><em>exporter</em></span>
      la variable d'environnement <tt class="literal">RHCDPATH</tt> avant de
      lancer les scripts que vous trouverez tout au long du reste de ce
      document et en relation avec les versions supérieures ou égales à
      la 6.2 de la RedHat Linux. Un fichier <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a> d'exemple,
      qui devrait être bien commenté, est donné avec les scripts.

      </p></td></tr></table></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="avertissement"></a>1.1. Avertissement et licence</h3></div></div></div><p>
    
      Ce document est distribué dans l'espoir qu'il sera utile, mais
      SANS AUCUNE GARANTIE ; sans même la garantie implicite de
      qualité loyale et marchande ou d'exactitude pour un usage
      particulier.
    
    </p><p>
    
      Ni l'auteur ni les distributeurs, ou tout autre contributeur de ce
      document, ne sont de quelque façon que ce soit responsables pour
      les dommages physiques, financiers, moraux ou de tout autre type,
      occasionnés en suivant les suggestions de ce texte.
      
    </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="redhat-ftp-site"></a>2. Anatomie du site FTP de Red Hat</h2></div></div></div><p>

    Dans l'esprit de la communauté Linux, la société RedHat a rendu
    disponible ses distributions Linux pour plusieurs plates-formes sur
    son site FTP. Elles sont toutes disponibles à partir de la racine du
    répertoire de distribution (<a href="ftp://ftp.redhat.com/pub/redhat/linux/" target="_top">pub/redhat/linux/</a>).
    Jetez donc un œil sur l'arborescence de la distribution.

  </p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="arborescence-redhat"></a>2.1. 
    
        Organisation des répertoires de la distribution Redhat 9
    
    </h3></div></div></div><p>
    
      La plus récente distribution n'est, à l'heure où j'écris ces
      lignes, disponible que pour la plate-forme i386. Le répertoire de
      premier niveau semble un peu inutile, étant donnée la présence
      d'une seule architecture (<a href="ftp://ftp.redhat.com/pub/redhat/linux/9/en/os/" target="_top">/pub/redhat/linux/9/en/os/</a>). 
      
    </p><pre class="screen">
i386/
</pre><p>

      Le répertoire de premier niveau des versions un peu antérieures à
      la version 9 contient les distributions destinées aux différentes
      plates-formes. Par exemple, le répertoire correspondant de la
      version 7.1 du Linux RedHat est structuré comme ceci :

    </p><pre class="screen">
alpha/   i386/   ia64/   ppc/   s390x/
</pre><p>

      Pour une distribution Redhat 9, la racine du répertoire i386
      ressemble à ce qui suit :

    </p><pre class="screen">
-rwxr-xr-x   2 root   root    248 Mar 14  2003  autorun
drwxr-xr-x   7 root   root   4096 Mar 14  2003  dosutils
-rw-r--r--   3 root   root   6192 Mar 14  2003  EULA
-rw-r--r--   3 root   root  18385 Mar 14  2003  GPL
drwxr-xr-x   3 root   root   2048 Mar 14  2003  images
drwxr-xr-x   2 root   root   2048 Mar 14  2003  isolinux
-rw-r--r--   3 root   root   6127 Mar 14  2003  README
-rw-r--r--   2 root   root  13052 Mar 14  2003  README-Accessibility
-rw-r--r--   2 root   root   6686 Mar 14  2003  README.de
-rw-r--r--   2 root   root   6990 Mar 14  2003  README.es
-rw-r--r--   2 root   root   6492 Mar 14  2003  README.fr
-rw-r--r--   2 root   root   6805 Mar 14  2003  README.it
-rw-r--r--   2 root   root   7995 Mar 14  2003  README.ja
-rw-r--r--   2 root   root   7312 Mar 14  2003  README.ko
-rw-r--r--   2 root   root   5070 Mar 14  2003  README.pt
-rw-r--r--   2 root   root   6613 Mar 14  2003  README.pt_BR
-rw-r--r--   2 root   root   5879 Mar 14  2003  README.zh_CN
-rw-r--r--   2 root   root   5892 Mar 14  2003  README.zh_TW
drwxr-xr-x   4 root   root   2048 Mar 14  2003  RedHat
-rw-r--r--   2 root   root  25824 Mar 14  2003  RELEASE-NOTES
-rw-r--r--   2 root   root  29902 Mar 14  2003  RELEASE-NOTES-de.html
-rw-r--r--   2 root   root  30409 Mar 14  2003  RELEASE-NOTES-es.html
-rw-r--r--   2 root   root  32354 Mar 14  2003  RELEASE-NOTES-fr.html
-rw-r--r--   2 root   root  30064 Mar 14  2003  RELEASE-NOTES.html
-rw-r--r--   2 root   root  29925 Mar 14  2003  RELEASE-NOTES-it.html
-rw-r--r--   2 root   root  34666 Mar 14  2003  RELEASE-NOTES-ja.html
-rw-r--r--   2 root   root  33520 Mar 14  2003  RELEASE-NOTES-ko.html
-rw-r--r--   2 root   root  29496 Mar 14  2003  RELEASE-NOTES-pt_BR.html
-rw-r--r--   2 root   root  22747 Mar 14  2003  RELEASE-NOTES-pt.html
-rw-r--r--   2 root   root  25217 Mar 14  2003  RELEASE-NOTES-zh_CN.html
-rw-r--r--   2 root   root  26645 Mar 14  2003  RELEASE-NOTES-zh_TW.html
-rw-r--r--   3 root   root   1910 Mar 14  2003  RPM-GPG-KEY
-r--r--r--   1 root   root   1823 Mar 14  2003  TRANS.TBL
</pre><p>

      Le répertoire <tt class="filename">SRPMS</tt>
      contient les paquets RPMS en format source.

    </p><p>

      Le répertoire <tt class="filename">images</tt>
      contient les images des disquettes de démarrage et de pilotes. Ces
      images peuvent être copiés sur une disquette si nécessaire. Pour
      la version 9, il n'existe qu'une seule image de disque de
      démarrage. Cette image de démarrage est appelée
      <tt class="filename">boot.img</tt>. Si l'installation n'est pas
      exécutée depuis un CD-ROM ou un disque dur, il est nécessaire de
      préparer également une seconde disquette avec les pilotes. Un
      fichier <tt class="filename">boot.iso</tt> est maintenant également
      disponible. Il permet de démarrer une machine à partir du lecteur
      de CD-ROM afin de pouvoir plus facilement lancer une installation
      réseau (c'est-à-dire sans avoir besoin de manipuler une tonne de
      disquettes). Reportez-vous à la section <a href="#installation">installation</a> et aux références qu'elle contient pour
      plus d'informations. Consultez le fichier
      <tt class="filename">README</tt> contenu dans ce répertoire pour
      obtenir une explication plus détaillée du rôle des différents
      fichiers.

    </p><p>

      Le répertoire <tt class="filename">isolinux</tt>
      contient les fichiers nécessaires au démarrage depuis le CD (et
      pour reconstruire des CD de démarrage qui fonctionnent de la même
      façon). Ce processus a été modifié pour passer d'une émulation de
      disquette à pas d'émulation du tout. Ce qui aide à éviter les
      contraintes d'espace et les problèmes de compatibilité.

    </p><p>

      Le répertoire <tt class="filename">dosutils</tt>
      contient différents programmes pour certains autres systèmes
      d'exploitation, qui sont parfois utiles pour le bon déroulement du
      processus d'installation. Il contient aussi un fichier
      <tt class="filename">README</tt> explicatif.

    </p><p>

      La liste est complétée par un grand nombre de fichiers et par le
      répertoire <tt class="filename">RedHat</tt>. Ce
      dernier est le sujet des sections qui suivent tandis que le
      contenu des précédents est clairement indiqué par leur nom (sauf
      peut-être le fichier <tt class="filename">EULA</tt> dont le nom est
      l'abréviation [en anglais] de « <span class="quote">Accord de licence avec
      l'utilisateur final</span> »). 

    </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="repertoire-redhat"></a>2.2. 
        
        Le répertoire « <span class="quote">RedHat</span> », le cœur de la
        distribution
    
    </h3></div></div></div><p> 

      La majeure partie de l'arborescence de la distribution se situe
      dans le répertoire <tt class="filename">RedHat</tt> :

    </p><pre class="screen">
drwxr-xr-x   2 root   root  53248 Jun 14 03:15  RPMS
drwxr-xr-x   2 root   root   4096 Jun 14 04:15  base
</pre><p>
    
      Le répertoire <tt class="filename">RPMS</tt> contient
      la majeure partie de la distribution RedHat, sous la forme d'un
      ensemble de fichiers RPM (abréviation de <span class="foreignphrase"><i class="foreignphrase">Redhat
      Package Manager</i></span>, c'est-à-dire « <span class="quote">gestionnaire
      de paquets RedHat</span> »). Un paquet RPM contient en général des
      exécutables binaires, accompagnés de leurs fichiers de
      configuration et de leur documentation. Référez-vous à la section
      <a href="#paquets-rpm">les paquets RPM</a> pour plus d'informations.
    
    </p><p>

      Le répertoire <tt class="filename">base</tt> contient
      différents fichiers nécessaires lors de l'installation, comme le
      fichier <tt class="filename">comps.xml</tt>, qui définit les
      <span class="emphasis"><em>composants</em></span> (groupes de paquets) utilisés
      durant la phase « <span class="quote">Sélection des groupes de
      paquetages<sup>[<a name="id2511265" href="#ftn.id2511265">1</a>]</sup></span> ». Reportez-vous à la section <a href="#fichiers-comps">le fichier comps</a> pour plus d'informations sur ce fichier
      et son utilisation.

    </p><p>

      Le répertoire <tt class="filename">base</tt> contient
      deux autres fichiers d'importance : <tt class="filename">hdlist</tt>
      et <tt class="filename">hdlist2</tt>. Ils contiennent la plupart des
      informations incluses dans les champs d'en-têtes de l'ensemble des
      paquets RPM du répertoire <tt class="filename">RPMS</tt>. Il est donc possible de
      déterminer les interdépendances entre paquets RPM par une simple
      lecture de ces fichiers, sans avoir à lire chacun des paquets RPM,
      ce qui est très appréciable notamment lors des installations par
      FTP. Ces fichiers permettent également de déterminer les fichiers
      correspondant à un paquet donné (par exemple
      <tt class="filename">perl</tt> renvoie vers le paquet
      <i class="medialabel">perl-5.004-6.i386.rpm</i>). Ce qui veut dire
      que si vous ajoutez vos propres paquets ou des mises à jour RedHat
      (reportez-vous à la section <a href="#inclusion-des-mises-a-jour">inclure les mises à jour</a>) dans le répertoire
      <tt class="filename">RPMS</tt>, vous aurez besoin de
      mettre à jour <tt class="filename">hdlist</tt> et
      <tt class="filename">hdlist2</tt>. La façon de réaliser cette mise à
      jour sera décrite dans <a href="#reconstruire-l-installateur">reconstruire l'installateur</a>. En dehors de ces
      fichiers, on trouve les images à partir desquelles l'environnement
      d'installation est lancé (c'est-à-dire le noyau, l'interpréteur
      python, anaconda, et cætera).

    </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="repertoire-updates"></a>2.3. Le répertoire « <span class="quote">updates</span> »</h3></div></div></div><p>
    
      Le répertoire <tt class="filename">/pub/redhat/linux/updates</tt> contient
      des mises à jour destinées à toutes les versions de la
      distribution RedHat depuis la 3.0.3. C'est l'endroit où vous
      trouverez les paquets qui ont été mis à jour pour une raison ou
      une autre. Vous devez tout particulièrement faire attention aux
      mises à jour de sécurité. Elles sont affichées sur la page des
      erreurs de RedHat dès qu'une correction est disponible. Les
      fichiers les plus importants trouvés dans le répertoire <tt class="filename">updates</tt> sont :
    
    </p><pre class="screen">
drwxrwsr-x   3 root    root    4096 Jul 13 10:13  5.2
drwxrwsr-x   3 root    root    4096 Jul 13 10:13  6.0
drwxrwsr-x   3 root    root    4096 Jul 13 10:13  6.1
drwxrwsr-x   4 root    root    4096 Jul 13 10:14  6.2
drwxrwsr-x   4 root    root    4096 Jul 13 10:14  7.0
drwxrwsr-x   4 root    root    4096 Jul 13 10:14  7.1
drwxrwsr-x   4 root    root    4096 Jul 13 10:13  7.2
drwxrwsr-x   3 root    root    4096 Jul 13 10:14  7.3
drwxrwsr-x   3 root    root    4096 Jul 13 10:14  8.0
drwxrwsr-x   3 root    root    4096 Jul 13 10:14  9
</pre><p>
    
      La structure de chacun de ces sous-répertoires est similaire à ce
      qui est décrit dans la section <a href="#arborescence-redhat">l'organisation de la Redhat 9</a>. Donc, pour chaque version, vous
      trouverez dans le sous-répertoire <tt class="filename">en/os/</tt> une série de sous-répertoires
      représentant les nombreuses architectures ainsi que les
      sous-répertoires <tt class="filename">noarch</tt> et
      <tt class="filename">SRPMS</tt>, respectivement pour
      les paquets qui fonctionnent sur toutes les architectures et pour
      ceux qui sont sous forme de source.
      
    </p><pre class="screen">
drwxrwsr-x   2 root    root    4096 Sep 23 05:28  SRPMS
drwxrwsr-x   2 root    root    4096 Aug 28 18:25  athlon
drwxrwsr-x   2 root    root    8192 Sep 23 05:28  i386
drwxrwsr-x   2 root    root    4096 Jul 13 10:14  i486
drwxrwsr-x   2 root    root    4096 Aug 28 18:26  i586
drwxrwsr-x   2 root    root    4096 Aug 28 18:26  i686
drwxrwsr-x   2 root    root    4096 Jul 13 10:14  noarch
</pre></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2511532"></a>2.4. Différences avec l'arborescence 8.0</h3></div></div></div><p>

      La disposition de la distribution 8.0 est pratiquement identique à
      celle que nous venons de décrire. Les seules différences majeures,
      à cet égard, se trouvent dans le répertoire <tt class="filename">images</tt>.

    </p><p>
    
      Le répertoire <tt class="filename">images</tt>
      contient les images de disquettes de démarrage et de pilotes,
      pouvant être copiées sur une disquette si nécessaire. La première
      image de démarrage est appelée <tt class="filename">boot.img</tt> et
      est nécessaire lorsque l'installation est exécutée directement
      depuis le CD-ROM. Si vous envisagez une installation via un disque
      monté par NFS ou par FTP, l'image disque
      <tt class="filename">bootnet.img</tt> sera nécessaire. Les
      installations via l'adaptateur PCMCIA nécessitent la disquette
      <tt class="filename">pcmcia.img</tt>. Reportez-vous à la section <a href="#installation">installation</a> et aux références qui s'y trouvent pour
      plus d'informations. Consultez le fichier
      <tt class="filename">README</tt> contenu dans ce répertoire pour
      obtenir une explication plus détaillée du rôle des différents
      fichiers.
      
    </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2511625"></a>2.5. Différences avec l'arborescence 7.x</h3></div></div></div><p>

      Les deux distributions sont pratiquement similaires sous cet
      aspect. Les seuls changements intéressants pour nous (et faciles à
      remarquer en regardant l'arborescence de la distribution) sont la
      disparition du répertoire <tt class="filename">isolinux</tt> et quelques modifications
      affectant le répertoire <tt class="filename">RedHat/base</tt>. Le premier changement
      est dû à la façon dont les CD d'installation sont rendus
      amorçables dans les versions antérieures à la 8.0 (le mode
      « <span class="quote">émulation disquette</span> » a été changé en mode « <span class="quote">pas
      d'émulation</span> » pour la version 8.0), alors que le second est
      un effet du passage en XML du fichier <tt class="filename">comps</tt>
      pour les distributions Redhat postérieures à la 8.0 (ce qui
      explique pourquoi il a été renommé
      <tt class="filename">comps.xml</tt>). Dans les distributions Redhat 7.3
      et précédentes, le fichier <tt class="filename">Redhat/base/comps</tt>
      est un simple fichier texte dont la syntaxe n'est pas très souple.

    </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2511706"></a>2.6. Différences avec l'arborescence de la 6.x</h3></div></div></div><p>

      Pour la version 6.2 (<a href="ftp://ftp.redhat.com/pub/redhat/linux/6.2/en/os/" target="_top">ftp://ftp.redhat.com/pub/redhat/linux/6.2/en/os/</a>), la
      dernière de la série des 6, l'organisation est la suivante (celle
      des précédentes versions est à peu près similaire, mais pas
      complètement) :

    </p><pre class="screen">
alpha/   i386/   sparc/
</pre><p>

      La racine du répertoire i386, quant à elle, ressemble à
      ceci :

    </p><pre class="screen">
-rw-r--r--   1 root   root  18385 Sep  7  1999  COPYING
-rw-r--r--   1 root   root   3400 Mar  8  2000  README
-rw-r--r--   1 root   root  16300 Mar  8  2000  RELEASE-NOTES
-rw-r--r--   1 root   root   1908 Sep 25  1999  RPM-GPG-KEY
drwxr-xr-x   1 root   root    512 Sep 27 15:22  RedHat
drwxr-xr-x   1 root   root  17408 Sep 27 15:22  SRPMS
-rwxr-xr-x   1 root   root    538 Sep 26  1999  autorun
-rwxr--r--   1 root   root   2048 Mar  9  2000  boot.cat
drwxr-xr-x   1 root   root    512 Sep 27 15:22  doc
drwxr-xr-x   1 root   root    512 Sep 27 15:22  dosutils
drwxr-xr-x   1 root   root    512 Sep 27 15:22  images
drwxr-xr-x   1 root   root    512 Sep 27 15:22  misc
</pre><p>

      Dans les paragraphes suivants, j'indiquerai uniquement les
      différences avec les versions plus récentes ; ce qui ne sera
      pas explicitement mentionné ici est resté (ou est supposé être
      resté) inchangé.

    </p><p>
    
      Le répertoire <tt class="filename">doc</tt> contient
      une foule d'informations. En premier lieu, ce répertoire contient
      le manuel d'installation RedHat au format HTML (qui est aussi
      disponible sur le site de RedHat : <a href="http://www.europe.redhat.com/documentation/rhl6.2/install-guide-fr/" target="_top">Guide
      d'installation Redhat 6.2</a>). Il contient également le Guide
      de référence et le Guide de démarrage (<span class="foreignphrase"><i class="foreignphrase">Getting
      started</i></span>). La documentation des versions 7.x, 8.0
      et 9 est distribuée sur un CD séparé (dans une arborescence
      différente sur le site ftp). 
    
    </p><p>

      Le répertoire <tt class="filename">images</tt>
      contient les images de disquettes de démarrage. Si nécessaire, ces
      images peuvent être recopiées sur disquette, comme pour les
      distributions Redhat 9, 8.0 et 7.3. Référez-vous à la section
      <a href="#installation">installation</a> et aux références qu'elle contient
      pour plus d'information. Le répertoire <tt class="filename">misc</tt> contient les sources et les
      exécutables d'un certain nombre de programmes nécessaires à
      l'installation.

    </p><p>  

      La plus importante partie de l'arborescence est (encore) située
      sous le répertoire <tt class="filename">RedHat</tt> :

    </p><pre class="screen">
drwxr-xr-x   2 root   root   28672   Oct 26 09:01  RPMS
drwxr-xr-x   2 root   root    4096   Oct 26 09:01  base
-rw-r--r--   1 root   root       0   Jan 19  1999  i386
drwxr-xr-x   6 root   root    4096   Oct 26 09:01  instimage
</pre><p>
    
      Vous devez déjà connaître Le répertoire <tt class="filename">RPMS</tt>. Référez-vous à la section <a href="#paquets-rpm">les paquets RPM</a> pour plus d'informations. Le répertoire
      <tt class="filename">base</tt> contient les
      différents fichiers nécessaires à l'installation, comme pour les
      Redhat 7.3, 8.0 et 9. Les seules différences visibles sont la
      présence d'un unique fichier <tt class="filename">hdlist</tt> et
      l'absence du fichier <tt class="filename">stage2.img</tt> dont les
      fonctionnalités devraient être assurées par les fichiers contenus
      dans le répertoire <tt class="filename">instimage</tt>. Ce répertoire contient, en
      fait, un vrai système de fichiers limité à l'essentiel et
      comportant les programmes et bibliothèques partagées nécessaires à
      l'installation.
    
    </p><p>

      Le répertoire <tt class="filename">updates</tt> est
      en fait similaire à celui qui est décrit pour la version 9, la
      seule différence étant qu'il comporte davantage de répertoires
      relatifs aux différentes architectures.

    </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="paquets-rpm"></a>3. Paquets RPM</h2></div></div></div><p>

    La majeure partie de la distribution RedHat consiste en un ensemble
    de fichiers RPM ((abréviation de <span class="foreignphrase"><i class="foreignphrase">Redhat Package
    Manager</i></span>, c'est-à-dire « <span class="quote">gestionnaire de paquets
    RedHat</span> »). Un paquet RPM contient en général des exécutables
    binaires, accompagnés de leurs fichiers de configuration et de leur
    documentation. Le programme <a href="http://www.rpm.org" target="_top">rpm</a> est un puissant gestionnaire de
    paquets, qui peut être utilisé pour installer, interroger, vérifier,
    mettre à jour, effacer et construire des paquets au format RPM.
    <span class="application">Rpm</span> est très pratique car il gère une
    base de données de tous les paquets installés, ce qui permet de
    savoir à tout moment ce qui est installé.

  </p><p>

    Les fichiers binaires RPM inclus dans la distribution ont été
    construits sur un système utilisant lui-même la distribution. C'est
    important car la plupart des programmes des paquets dépendent de
    bibliothèques partagées. La nouvelle version 3 de la bibliothèque C
    standard GNU (compatible 64 bits) a été utilisée à partir de la
    distribution Redhat 5.0. Cette version de la bibliothèque est
    communément appelée <span class="emphasis"><em>glibc</em></span> ou, sous Linux,
    <span class="emphasis"><em>libc 6</em></span>. Tous les exécutables de cette
    distribution ont été liés à cette bibliothèque. Si vous tentez
    d'installer les fichiers binaires d'une distribution différente, il
    y a beaucoup de chances que cela ne fonctionne pas, sauf si vous
    installez le paquet libc5 pour obtenir une compatibilité
    descendante. Il existe aussi des incompatibilités entre les
    nombreuses versions du <span class="application">RedHat Package
    Manager</span> lui-même qui empêcheront l'installation de
    certains paquets même sur les machines où ils sont supposés
    fonctionner.

  </p><p>

    Les noms des paquets RPM contiennent le suffixe
    <tt class="filename">.<i class="replaceable"><tt>archi</tt></i>.rpm</tt>, où
    <i class="replaceable"><tt>archi</tt></i> est l'architecture. Celle-ci a
    habituellement pour valeur <tt class="literal">i386</tt> pour les
    binaires destinés à la plate-forme Intel. Les paquets que vous
    installez doivent correspondre aux versions des bibliothèques
    partagées installées sur la machine. Le programme <a href="http://www.rpm.org" target="_top">rpm</a> est habituellement assez bon
    pour s'en assurer. Néanmoins, il existe des moyens de passer outre
    cette vérification. Si vous décidez de forcer l'installation d'un
    paquet de cette façon, soyez <span class="emphasis"><em>vraiment</em></span> sûr de
    savoir ce que vous faites. Néanmoins, l'utilisation du disque de
    démarrage d'installation de RedHat vous garantie qu'un ensemble
    correct de paquets RPM sera installé sur la machine.

  </p><p>

    Si vous découvrez un paquet RPM qui n'a pas été installé sur votre
    système durant le processus d'installation, ne désespérez pas. À
    tout moment, vous pourrez (sous le compte root) installer des
    paquets RPM. Par exemple :

  </p><pre class="screen">
# rpm --install WindowMaker-0.18-1b.i386.rpm
</pre><p>

    Vous pouvez même installer un paquet RPM directement depuis
    Internet, si vous connaissez son URL :

  </p><pre class="screen">
# URL="ftp://rufus.w3.org/redhat-contrib/noarch/mirror-2.9-2.noarch.rpm"
# rpm --install "$URL"
</pre><p>
  
    Si vous voulez mettre à jour un paquet RPM (ou l'installer s'il
    n'est pas présent sur la machine), utilisez la commande :

  </p><pre class="screen">
# rpm --update  WindowMaker-0.18-1b.i386.rpm
</pre><p>

      Si vous voulez mettre à jour un paquet RPM dont une version 
      précédente est déjà installée, utilisez la commande :

  </p><pre class="screen">
# rpm --freshen  WindowMaker-0.18-1b.i386.rpm
</pre><p>

    Il existe un autre type de paquets RPM qui contient les sources
    originales qui ont servi à construire les binaires. Ces paquets ont
    le suffixe <tt class="filename">.src.rpm</tt> et sont
    situés dans le répertoire <tt class="filename">SRPMS</tt>. La moitié du troisième CD et les
    deux derniers des cinq CD de la distribution Redhat 8.0 (ou la 7.3)
    contiennent des paquets source. Pour la 9, ils sont sur trois CD
    séparés. Pour la 6.2 (et les précédentes versions, pas trop
    anciennes), les choses changent un peu puisqu'il n'existe qu'un seul
    CD d'installation qui ne comporte pas les paquets SRPMS, que vous
    pouvez graver sur un disque différent si vous le voulez.

  </p><p>

    Pour obtenir plus d'informations sur le gestionnaire de paquet
    RedHat, je vous suggère de lire les pages de manuel et le très
    complet <a href="http://www.rpm.org/max-rpm/" target="_top">Maximum
    rpm</a>. 

  </p><p>

    Dans la prochaine section, je présenterai un programme C qui sera
    utilisé dans divers scripts tout au long du reste de ce guide
    pratique. Il indique, entre deux versions du même paquet RPM, celui
    qui est le plus récent. Ce programme est basé sur le code utilisé
    dans le gestionnaire de paquets RedHat (version 4.1) et est utilisé
    quand l'option <tt class="option">--freshen</tt> est ajoutée.

  </p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="comparer-versions-rpm"></a>3.1. Comparer deux versions d'un paquet RPM</h3></div></div></div><p>

      Le code C des trois fichiers <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rpmvc/Makefile" target="_top">Makefile</a>, <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rpmvc/rvc.h" target="_top">rvc.h</a>, <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rpmvc/rvc.c" target="_top">rvc.c</a> a été extrait
      du code du gestionnaire de paquets RedHat et (légèrement) modifié
      pour répondre à nos besoins. Ils forment un programme C simple
      qui, avec deux versions A et B d'un paquet retourne 1, 0 ou -1 si
      A est respectivement plus récent, égal ou plus ancien que B et
      d'autres valeurs en cas d'erreur (vous pouvez lire les
      commentaires du code pour plus d'informations). Pour compiler le
      programme, vous aurez besoin du programme
      <tt class="filename">make</tt> et du compilateur C
      <tt class="filename">gcc</tt>. Copiez les fichiers dans le même
      répertoire et lancez la commande :

    </p><pre class="screen">
$ make
</pre><p>

      Ce programme est nécessaire à pratiquement tous les scripts
      utilisés dans les sections suivantes. Pour que les scripts
      puissent le retrouver, vous devez définir la variable
      <tt class="literal">RVC</tt> dans le fichier <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a>.

    </p><p>

      Vous trouverez une copie des sources et de la version précompilée
      dans l'archive <a href="outils/RedHat-CD-HOWTO/rhcd-scripts.tar.gz" target="_top">rhcd-scripts.tar.gz</a> située dans le répertoire <tt class="filename">rpmvc</tt>.

    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>

        Ce programme était utilisé de façon incorrecte par les scripts
        <span class="emphasis"><em>updateDist.sh (ver. &lt; 1.17)</em></span> et
        <span class="emphasis"><em>updateCD.sh (ver. &lt; 1.12)</em></span>. Je vous
        suggère fortement d'éviter les versions antérieures de ces
        scripts antérieures, même si ce problème n'est pas fréquent (du
        moins en apparence).

    </p></td></tr></table></div></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mirroir-local"></a>4. Obtenir votre copie locale de la distribution</h2></div></div></div><p>

    Vous aurez besoin d'une copie de la distribution sur un disque où
    vous pouvez écrire et accessible à partir de l'ordinateur possédant
    le graveur (ouah !). Si vous souhaitez incorporer les dernières
    mises à jour, ce répertoire devra (aussi) être accessible à partir
    d'une machine Linux, soit à partir d'un disque local, soit à partir
    du disque distant monté via NFS, soit à partir d'un disque JAZ. Vous
    pouvez copier la distribution à partir des CD de RedHat (recommandé)
    ou vous pouvez l'obtenir par FTP. Si vous choisissez d'utiliser FTP,
    il existe deux moyens de le faire. Vous pouvez utiliser un script
    shell basé sur <span class="emphasis"><em>wget</em></span>, script présenté dans la
    section suivante ou utiliser le paquet <span class="emphasis"><em>mirror</em></span>
    comme suggéré jusqu'à la version 1.34 de ce guide pratique
    (consultez la section <a href="#utiliser-mirror">utiliser mirror</a>). 

  </p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="utiliser-wget-bash"></a>4.1. Utiliser wget et bash</h3></div></div></div><p>      

      Ce n'est pas la plus simple des méthodes, même si elle est
      probablement la plus exacte. Je l'apprécie parce qu'elle permet de
      comparer les versions RPM des fichiers et non plus leur date et
      heure ou leur nom (comme les paquets classiques de synchronisation
      à distance) et qu'elle vérifie les signatures des mises à jour à
      chaque fois qu'elle en télécharge, si la variable
      <tt class="literal">CHECKSIG</tt> du fichier <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a> lui
      indique de le faire.

    </p><p>
      
      Créez un répertoire qui contiendra les fichiers d'installation et
      placez-vous à l'intérieur, puis lancez la commande
      suivante, qui téléchargera environ 3 Go de données sur votre
      disque dur :
      
    </p><pre class="screen">
$ wget -r -c -t0 -l0 --retr-symlinks -nH --cut-dirs=9 \
  ftp://ftp.mirror.ac.uk/sites/ftp.redhat.com/pub/redhat/linux/updates/7.3/en/os/i386
</pre><p>

      Vous voudrez probablement changer le miroir FTP de téléchargement
      et, en conséquence, le paramètre indiqué à l'option
      <tt class="option">--cut-dirs</tt>. Ce paramètre est utilisé
      conjointement avec l'option <tt class="option">-nH</tt> pour éviter la
      re-création de la hiérarchie des répertoires du site FTP. Pour
      plus d'informations sur l'utilisation correcte de cette option,
      jetez un œil sur la <a href="http://www.gnu.org/manual/wget-1.8.1/wget.html" target="_top">documentation
      de wget</a> et les pages de manuel correspondantes.

    </p><p>

      Si vous voulez exclure un ou plusieurs répertoires du
      téléchargement, vous pouvez utiliser l'option <tt class="option">-X
      <i class="replaceable"><tt>liste</tt></i></tt>, où
      <i class="replaceable"><tt>liste</tt></i> représente une liste de
      répertoires séparés par des virgules. Par exemple, pour exclure le
      répertoire <tt class="filename">SRPMS</tt> du précédent
      téléchargement, vous pouvez utiliser :

    </p><pre class="screen">
$ wget -r -c -t0 -l0 --retr-symlinks -nH --cut-dirs=9 \
   -X /sites/ftp.redhat.com/pub/redhat/linux/updates/7.3/en/os/i386/SRPMS \
   ftp://ftp.mirror.ac.uk/sites/ftp.redhat.com/pub/redhat/linux/updates/7.3/en/os/i386
</pre><p>

      Cela peut être utile si vous prenez en compte la taille du
      répertoire <tt class="filename">SRPMS</tt> (environ 1,2 Go) ;
      en tout cas, je le trouve utile.

    </p><p>

      Si vous voulez vérifier les signatures GPG pour vous assurer de
      l'authenticité des paquets (ce qui est quelque chose que je vous
      suggère), vous devrez installer le paquet
      <span class="emphasis"><em>gnupg</em></span> (nécessaire uniquement pour la RedHat
      7.3) et importer la clé publique
      <span class="emphasis"><em>security@redhat.com</em></span> que vous trouverez dans
      le répertoire racine des CD (<tt class="filename">RPM-GPG-KEY</tt>) ou
      sur le <a href="http://www.redhat.com/solutions/security/news/publickey.html#key" target="_top">site web RedHat</a>. La clé est importée en lançant la
      commande : <b class="userinput"><tt>
      gpg --import <i class="replaceable"><tt>nom_du_fichier</tt></i>
      </tt></b> pour les versions jusqu'à la 7.3 incluse, ce qui a
      été remplacé par <b class="userinput"><tt>
      rpm --import <i class="replaceable"><tt>nom_du_fichier</tt></i>
      </tt></b> pour les versions 8.0 et 9 (pour plus d'informations
      sur ceci, jetez un œil aux sites web de <a href="http://www.gnupg.org/" target="_top">GNU Privacy Guard</a> et de <a href="http://www.rpm.org/" target="_top">RPM</a> — le Gestionnaire de
      paquets RedHat).

    </p><p>

      Si vous voulez vérifier les paquets RPM, vous pouvez le faire en
      utilisant la commande suivante (que je suppose lancée depuis le
      répertoire où vous avez réalisé les téléchargements) :

    </p><p>

      Pour les versions jusqu'à la 7.3 incluse :

    </p><pre class="screen">
$ find . -name "*.rpm" -exec rpm -K --nopgp {} \; |grep "NOT *OK"
</pre><p>

      Pour les versions 8.0 et 9 (ainsi que pour les versions futures,
      je suppose) :
      
    </p><pre class="screen">
$ find . -name "*.rpm" -exec rpm -K {} \; |grep "NOT *OK"
</pre><p> 
      
        Si vous ne voulez pas vous « <span class="quote">ennuyer</span> » avec toutes
        ces étapes, j'espère que vous voudrez au moins vérifier
        l'intégrité des fichiers téléchargés (ce qui ne veut pas dire
        que personne ne les a modifiés), à l'aide des signatures md5.
        Ceci est fait avec :
    
      </p><p>
  
        Pour les versions jusqu'à 7.3 (incluse) :

      </p><pre class="screen">
$ find . -name "*.rpm" -exec rpm -K --nopgp --nogpg {} \; |grep "NOT *OK"
</pre><p>
    
      Pour les versions 8.0 et 9 (ainsi que pour les versions à venir,
      je suppose) :

    </p><pre class="screen">
$ find . -name "*.rpm" -exec rpm -K --nosignature {} \; |grep "NOT *OK"
</pre><p>

      Le contenu d'une distribution RedHat ne change pas entre les
      versions, donc vous aurez seulement besoin de télécharger ces
      paquets <span class="emphasis"><em>UNE FOIS</em></span>. Toutes les modifications de
      la distribution sont contenues dans le répertoire <tt class="filename">updates</tt>. Donc, si vous voulez
      conserver un miroir à jour de la distribution RedHat, vous aurez
      seulement besoin de maintenir le répertoire <tt class="filename">updates</tt> à jour. Ceci se fait en
      utilisant le script <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/updateDist.sh" target="_top">updateDist.sh</a>. Avant d'utiliser ce script, vous devrez
      configurer le fichier <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a> et exporter la variable
      <tt class="literal">RHCDPATH</tt> pointant vers le répertoire où se
      trouve ce fichier.

    </p><pre class="screen">
$ export RHCDPATH=<i class="replaceable"><tt>/home/luigi/tmp/</tt></i>rhcd-scripts
$ sh updateDist.sh
</pre><p>

      Ce script va télécharger les nouvelles mises à jour en excluant
      les sous-répertoires indiqués dans la variable
      <tt class="literal">EXCLUDELIST</tt>, en déplaçant les plus anciennes
      (c'est-à-dire celles remplacées par de nouvelles versions) dans le
      répertoire indiqué par la variable <tt class="literal">OLDDIR</tt> après
      avoir réussi deux tests. Le premier test compare les fichiers
      <tt class="filename">.listing</tt> générés par
      <tt class="filename">wget</tt> avec le contenu des répertoires locaux
      pour s'assurer que tous les fichiers ont été téléchargés. Le
      second test vérifie les signatures des paquets en fonction des
      valeurs de deux variables <tt class="literal">CHECKSIG</tt> et
      <tt class="literal">USEGPG</tt> (positionnez-les à
      « <span class="quote"><tt class="literal">yes</tt></span> » si vous souhaitez que cette
      opération soit réalisée). En cas d'échec du processus de
      vérification de signature, le script déplacera le mauvais paquet
      dans <tt class="literal">OLDDIR</tt> en lui affectant l'extension
      « <span class="quote"><tt class="literal">.UPDcheckfail</tt></span> » et abandonnera sans déplacer les
      anciennes mises à jour dans <tt class="literal">OLDDIR</tt>. 

    </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="utiliser-mirror"></a>4.2. Utiliser mirror</h3></div></div></div><p>

      Mirror est un script perl sophistiqué comparant le contenu d'un
      répertoire d'un site distant avec un répertoire local. Il
      utilisera FTP pour récupérer les fichiers qui sont sur le site
      distant mais pas sur le site local et supprimera sur le site local
      les fichiers qui ne sont pas sur le site distant. Le programme
      mirror est paramétré via un fichier de configuration. Le RPM du
      paquet est disponible à partir de <a href="http://rufus.w3.org/linux/RPM/mirror.html" target="_top">rufus.w3.org</a>. Créez une copie locale
      <tt class="filename">mirror.redhat</tt> du fichier de configuration de
      <span class="application">mirror</span> et modifiez les champs
      appropriés en haut du fichier. Après la section des valeurs par
      défaut (<span class="foreignphrase"><i class="foreignphrase">default</i></span>), définissez les
      paquets suivants :

    </p><pre class="programlisting">
package=updates
  site=ftp.mirror.ac.uk
  exclude_patt=(SRPMS/)
  remote_dir=/sites/ftp.redhat.com/pub/redhat/linux/updates/7.3/en/os/i386
  local_dir=<i class="replaceable"><tt>/home/luigi/tmp/</tt></i>redhat-cd/redhat-7.3-updates

package=dist
  site=ftp.mirror.ac.uk
  exclude_patt=(SRPMS/)
  remote_dir=/sites/ftp.redhat.com/pub/redhat/linux/7.3/en/os/i386
  local_dir=<i class="replaceable"><tt>/home/luigi/tmp/</tt></i>redhat-cd/redhat-7.3
</pre><p>

      La commande suivante va copier l'arborescence RedHat au complet
      sur votre disque local. <span class="emphasis"><em>**Pensez**</em></span>, avant de
      faire cela, que vous allez télécharger à peu près 1,5 Go de
      données (si vous avez exclu le répertoire <tt class="filename">SRPMS</tt>) !

    </p><pre class="screen">
$ mirror -pdist mirror.redhat 
</pre><p>
 
      Ceci va créer une copie à l'identique du site FTP de RedHat sur
      votre disque local. Le contenu de la distribution RedHat ne change
      pas entre les versions, donc vous aurez seulement besoin de
      télécharger ces paquets <span class="emphasis"><em>une fois</em></span>. Tout
      changement dans la distribution se trouvera dans le répertoire
      <tt class="filename">updates</tt>. Donc, si vous
      voulez maintenir votre miroir à jour, vous aurez seulement besoin
      d'actualiser le répertoire <tt class="filename">updates</tt>. Cela se fait avec la commande suivante :
 
    </p><pre class="screen">
$ mirror -pupdates mirror.redhat 
</pre><p>

      Vous pouvez la lancer régulièrement, disons une fois par semaine,
      avec un script cron. La distribution RedHat est disponible sur un
      grand nombre de serveurs FTP dans le monde entier, mis à jour
      quotidiennement à partir du site de référence <a href="ftp://ftp.redhat.com/pub" target="_top">ftp.redhat.com</a>. Vous
      devriez choisir un site FTP proche de vous, en consultant la
      <a href="http://www.redhat.com/download/mirror.html" target="_top">liste des
      sites miroirs RedHat</a>.

    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
    
        Je n'ai pas testé personnellement cette procédure. C'était la
        seule procédure proposée sur les anciennes versions de ce guide
        pratique (jusqu'à la version 1.34, concernant RedHat
        &lt; 6.1).
    
    </p></td></tr></table></div></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="inclusion-des-mises-a-jour"></a>5. Inclure les mises à jour</h2></div></div></div><p>

    Il y a trois étapes, les deux premières étant (pratiquement)
    identiques pour toutes les versions, alors que la dernière change un
    peu en raison des modifications de l'installateur anaconda :

  </p><div class="orderedlist"><ol type="i"><li><p>
        Corriger les modes de protection des fichiers
      </p></li><li><p>
        Remplacer les RPM mis à jour
      </p></li><li><p>
        Reconstruire l'installateur
      </p></li></ol></div><p>

    Pour incorporer les mises à jour, vous aurez besoin d'avoir un accès
    en écriture au répertoire de la distribution à partir d'une machine
    Linux, avec une version fonctionnelle de <a href="http://www.rpm.org" target="_top">rpm</a> installée, alors que
    <span class="emphasis"><em>pour reconstruire l'installateur anaconda, vous aurez
    besoin d'utiliser une version du Linux RedHat égale à celle pour
    laquelle vous reconstruisez l'installateur (sinon la procédure
    échouera)</em></span>. Si vous maintenez à jour un miroir du
    répertoire <tt class="filename">updates</tt>, vous
    pourrez à tout moment produire un CD incluant les dernières mises à
    jours en répétant ces étapes.
  
  </p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="mise-a-jour-des-permissions"></a>5.1. Corriger les modes de protection des fichiers</h3></div></div></div><p>

      Durant le processus d'installation des versions jusqu'à la 6.2
      incluse, certains programmes sont lancés directement depuis le CD.
      Malheureusement, le programme FTP ne préserve pas toujours les
      droits des fichiers et des répertoires copiés. Donc, il est
      nécessaire de s'assurer que les droits d'exécution sont bien
      donnés aux programmes, scripts shells et bibliothèques partagées,
      avant que le répertoire ne soit gravé sur le CD. Ceci est fait en
      lançant le script <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/updatePerm.sh" target="_top">updatePerm.sh</a> sur votre copie locale de la distribution. 
      C'est réellement nécessaire pour les versions 6.2 et précédentes.
      La seule partie utile de cette procédure pour les versions 7.3,
      8.0 et 9 est la mise à jour des droits des répertoires, le reste ne
      fera aucun mal et cela maintient les choses cohérentes. Ce script
      est quasi-identique au script <tt class="filename">updatePerm</tt>
      inclus dans la version précédente de ce guide pratique, seuls
      quelques changements mineurs ont été réalisés. Avant d'utiliser ce
      script, vous devez paramétrer le fichier <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a> et exporter
      la variable <tt class="literal">RHCDPATH</tt> pointant vers le
      répertoire où se trouve ce fichier.

    </p><pre class="screen">
$ export RHCDPATH=<i class="replaceable"><tt>/home/luigi/tmp/</tt></i>rhcd-scripts
$ sh updatePerm.sh
</pre></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="remplacement-des-paquets"></a>5.2. Remplacer les RPM mis à jour</h3></div></div></div><p>

      Le script <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/updateCD.sh" target="_top">updateCD.sh</a> copie
      tous les nouveaux fichiers du répertoire <tt class="filename">update</tt> vers le répertoire <tt class="filename">RPMS</tt> (et <tt class="filename">SRPMS</tt>). Le script utilise le
      programme <tt class="filename">rvc</tt> qui a été présenté dans la
      section <a href="#comparer-versions-rpm">comparer les versions des RPM</a> pour déterminer
      quels sont les paquets du répertoire update qui sont plus récents. Les
      paquets plus anciens sont déplacés dans le répertoire
      <tt class="literal">${OLDDIR}</tt>. Si la variable
      <tt class="literal">CHECKSIG</tt> est positionnée à
      « <span class="quote"><tt class="literal">yes</tt></span> », tous les paquets de
      l'arborescence principale verront leur signature vérifiée. Si la
      vérification de signature d'un paquet échoue (le type de
      vérification dépend de la variable <tt class="literal">USEGPG</tt> du
      fichier <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a>), celui-ci
      est déplacé dans le répertoire <tt class="literal">OLDDIR</tt> avec une
      extension ajoutée, « <span class="quote"><tt class="literal">CDcheckfail</tt></span> ».

    </p><p>

      Avant d'utiliser ce script, vous devrez paramétrer le fichier de
      configuration <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a> et exporter la variable
      <tt class="literal">RHCDPATH</tt> pointant vers le répertoire où se
      trouve ce fichier.

    </p><pre class="screen">
$ export RHCDPATH=<i class="replaceable"><tt>/home/luigi/tmp/</tt></i>rhcd-scripts
$ sh updateCD.sh
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>

        Après avoir incorporé les mises à jour dans le répertoire
        principal <tt class="filename">RedHat/RPMS</tt>,
        votre copie de la distribution n'est plus un miroir du site de
        la distribution RedHat. En fait, elle est plus à jour ! 
        Donc, si vous essayez de resynchroniser votre distribution en
        utilisant mirror, les anciennes versions des paquets RPM qui ont
        été mis à jour seront téléchargées une nouvelle fois et les
        mises à jour supprimées. La procédure basée sur bash et wget ne
        souffre pas de ce problème, mais laissera l'arborescence
        principale dans un état incohérent. Les anciens et les nouveaux
        paquets seront dans ce cas mélangés ensembles. Cependant, vous
        pourrez les trouver et les supprimer en intégrant l'exécutable
        <tt class="filename">rvc</tt> à un script shell simple (que je
        laisserai comme exercice pour le lecteur…).

    </p></td></tr></table></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="reconstruire-l-installateur"></a>5.3. Reconstruire l'installateur</h3></div></div></div><p>

      Les choses ont bien changé dans cette section avec l'arrivée de
      l'installateur anaconda (version 6.1) et la considérable
      augmentation de taille (et… du nombre de CD) que les
      distributions 7.x et 8.0 ont connue. Jusqu'à la version 6.2, la
      seule étape composant cette section était la génération d'un
      nouveau fichier <tt class="filename">hdlist</tt>. Avec la version 6.2,
      cela ne reste vrai que jusqu'à un certain point, en raison des
      changements dans l'installateur anaconda, dans le logiciel
      <span class="emphasis"><em>rpm</em></span> lui-même (qui est passé des versions 3.x
      aux versions 4.x) et de la migration des paquets mis à jour vers
      cette nouvelle version (les mises à jour de la version 6.2 sont en
      fait empaquetées pour les deux versions majeures du logiciel
      <tt class="filename">rpm</tt>). Nous envisagerons trois procédures
      différentes en essayant de couvrir toutes les versions.

    </p><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="reconstruire-rh61"></a>5.3.1. RedHat ≤ 6.1</h4></div></div></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2513474"></a>5.3.1.1. Régénérer le fichier hdlist</h5></div></div></div><p>
        
          Lors de l'installation à partir du CD, le programme
          d'installation du CD se base sur le fichier
          <tt class="filename">RedHat/base/hdlist</tt> qui décrit quels sont
          les paquets RPM disponibles sur le CD. Le fichier
          <tt class="filename">hdlist</tt> peut être généré par le programme
          <tt class="filename">misc/src/install/genhdlist</tt>. Ce programme
          doit être lancé avec comme seul argument le chemin absolu vers
          la racine de la distribution. Voici le script
          <tt class="filename">updateHdlist</tt> qui appelle ce programme
          (depuis la version 1.34 de ce guide pratique) :
        
        </p><pre class="programlisting">
#!/bin/bash

RHVERSION=6.1
ARCH=i386

echo "Génération de hdlist..."
RACINERH=<i class="replaceable"><tt>/home/luigi/tmp/</tt></i>redhat-${RHVERSION}
GENHDDIR=${RACINERH}/${ARCH}/misc/src/anaconda/utils
          
chmod u+x ${GENHDDIR}/genhdlist
chmod 644 ${RACINERH}/${ARCH}/RedHat/base/hdlist
${GENHDDIR}/genhdlist ${RACINERH}/${ARCH} || echo "*** ÉCHEC DE GENHDLIST ***"

exit 0
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Note importante pour les RedHat &lt; 6.1"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note importante pour les RedHat &lt; 6.1</th></tr><tr><td colspan="2" align="left" valign="top"><p>
        
            L'installation de la Redhat 6.1 est complètement différente
            de celle des versions précédentes car RedHat a introduit
            <span class="emphasis"><em>anaconda</em></span>. Le programme
            <tt class="filename">genhdlist</tt> est maintenant situé à un
            autre endroit, donc dans le script ci-dessus, nous 
            utiliserons :
            
          </p><pre class="programlisting">
GENHDDIR=${RHROOT}/${ARCH}/misc/src/anaconda/utils
</pre><p>

            alors que pour les versions jusqu'à 6.0 (comprise), cette
            ligne doit être :

          </p><pre class="programlisting">
GENHDDIR=${RHROOT}/${ARCH}/misc/src/install
</pre></td></tr></table></div><p>

          Dans certains cas, <tt class="filename">genhdlist</tt> n'arrive pas
          à démarrer, car l'exécutable n'est pas lié statiquement. Dans
          un tel cas, vous pouvez ajouter la ligne :
          
        </p><pre class="programlisting">
${RHROOT}/${ARCH}/RedHat/instimage/usr/lib
</pre><p>

          dans le fichier <tt class="filename">/etc/ld.so.conf</tt> et lancer
          la commande <b class="userinput"><tt>ldconfig -v</tt></b>.

        </p><p>

          Une autre solution est de recompiler
          <tt class="filename">genhdlist</tt>. La modification suivante du
          script <tt class="filename">updateHdlist</tt> fonctionnait sous
          Redhat 5.2 :

        </p><pre class="programlisting">
#!/bin/bash

RHVERSION=6.1
ARCH=i386

RACINERH=/misc/redhat/redhat-${RHVERSION}
GENHDDIR=${RACINERH}/${ARCH}/misc/src/anaconda/utils

echo "Compilation de hdlist..."
sed -e 's/FD_t/int/' \
    -e 's/fdOpen/open/' \
    -e 's/fdClose/close/' \
    -e 's/fdFileno//' &lt; ${GENHDDIR}/genhdlist.c &gt; /tmp/genhdlist.c
cc -o /tmp/genhdlist -I/usr/include/rpm /tmp/genhdlist.c -lrpm -lz

echo "Génération de hdlist..."
chmod 644 ${RACINERH}/${ARCH}/RedHat/base/hdlist
/tmp/genhdlist ${RACINERH}/${ARCH} || echo "*** ÉCHEC DE GENHDLIST ***"

exit 0
</pre><p>

          Dans cette version du script, une copie du source C de
          <tt class="filename">genhdlist.c</tt>, compilable sous
          RedHat 5.2, est créée dans <tt class="filename">/tmp</tt>. Cette copie est réalisée en
          filtrant le source C original avec <span><b class="command">sed</b></span> via
          un tube. Cette version de <tt class="filename">genhdlist</tt> est
          alors utilisée pour créer le fichier
          <tt class="filename">hdlist</tt>.
          
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Note importante pour la Redhat 5.2"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note importante pour la Redhat 5.2</th></tr><tr><td colspan="2" align="left" valign="top"><p>        

            Tel qu'il est distribué avec les RedHat versions 5.2 et
            précédentes, <tt class="filename">genhdlist</tt> PLANTE si le
            répertoire <tt class="filename">RedHat/RPMS</tt> contient des
            fichiers qui ne sont <span class="emphasis"><em>pas</em></span> des fichiers
            RPM ! Cela pose problème car dans la distribution 5.2,
            il y a des fichiers non-RPM nommés
            <tt class="filename">ls-lR</tt> et <tt class="filename">ls-lR.gz</tt>
            situés dans <tt class="filename">RedHat/RPMS</tt>. Donc, vous devez
            supprimer tous les fichiers non-RPM de ce répertoire. Sinon,
            vous pouvez appliquer le correctif <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/oldversion/genhdlist.c.diff" target="_top">genhdlist.c.diff</a>
            au fichier <tt class="filename">misc/src/install/genhdlist.c</tt>
            et faire un <span class="emphasis"><em>make</em></span>. Ce correctif fait
            ignorer à <tt class="filename">genhdlist</tt> tout fichier
            non-RPM.

          </p></td></tr></table></div></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="creer-l-image-iso"></a>5.3.1.2. Créer l'image iso du CD</h5></div></div></div><p>

          Vous aurez besoin de créer un fichier image qui sera écrit sur
          le CD. Ce fichier fera au moins 500 Mo, donc trouvez une
          partition avec assez d'espace libre. Vous aurez peut-être
          besoin d'utiliser le compte root pour lancer les commandes
          mount et cdrecord. Ici, vous allez préparer l'image iso du CD
          amorçable que vous allez graver. Il n'est pas strictement
          nécessaire de créer un CD amorçable, car vous pourriez
          utiliser une disquette de démarrage à la place, mais c'est une
          fonctionnalité vraiment sympathique (et elle rend le
          comportement de votre disque plus similaire à celui du disque
          original). Voici les commandes que j'utilise pour réaliser
          cette tâche :

        </p><pre class="programlisting">
$ mkdir <i class="replaceable"><tt>/repertoire-destination-images</tt></i>
$ mkisofs  -r  -J  -T  -v  -V "Red Hat 6.1 (Hedwig)" \
   -c boot.cat  -b images/boot.img \
   -o <i class="replaceable"><tt>/repertoire-destination-images</tt></i>/i386-disc.iso .
</pre><p>

          C'est nécessaire pour graver le disque (amorçable) et cela
          doit être lancé à partir du répertoire de niveau supérieur de
          la distribution. Le répertoire <tt class="filename"><i class="replaceable"><tt>/repertoire-destination-images</tt></i></tt>
          est le réceptacle de l'image iso que vous allez générez et il
          doit (obligatoirement) exister avant de lancer la procédure.
          Dans la table suivante, vous pourrez lire une brève
          explication des nombreuses options et de leur signification
          (la plupart ont été extraites de la page de manuel de
          <tt class="filename">mkisofs</tt>). 

        </p><p>

          </p><div class="table"><a name="id2513925"></a><p class="title"><b>Tableau 1. Options et paramètres de mkisofs</b></p><table summary="Options et paramètres de mkisofs" border="0"><colgroup><col align="left"><col align="left"></colgroup><tbody><tr><td align="left">-r</td><td align="left">
                    
                    Extensions Rock Ridge, indiquant des valeurs utiles pour
                    les droits.
                  
                  </td></tr><tr><td align="left">-J</td><td align="left">
                    
                    Extensions Joliet pour utiliser le CD sous quelques
                    autres systèmes d'exploitation.
                  
                  </td></tr><tr><td align="left">-T</td><td align="left">
                    
                    Génère un fichier TRANS.TBL dans chaque répertoire
                    afin que, même sur des systèmes non compatibles avec
                    les extensions Rock Ridge, la correspondance des
                    noms de fichier soit correcte.
                  
                  </td></tr><tr><td align="left">-v</td><td align="left">Mode bavard</td></tr><tr><td align="left"><tt class="literal">-V <i class="replaceable"><tt>identifiant</tt></i></tt></td><td align="left">
                  
                    Indique l'identifiant du volume (nom ou label du
                    volume) qui devra être écrit dans le bloc maître.
                  
                  </td></tr><tr><td align="left"><tt class="literal">-c <i class="replaceable"><tt>catalogue_de_démarrage</tt></i></tt></td><td align="left">
                    
                    Indique le chemin et le nom du fichier contenant le
                    catalogue de démarrage, qui sera utilisé lors de la
                    création d'un CD amorçable « <span class="quote">El Torito</span> ».
                    Le chemin doit être relatif au chemin source indiqué
                    à mkisofs.
                  
                  </td></tr><tr><td align="left"><tt class="literal">-b <i class="replaceable"><tt>image_eltorito</tt></i></tt></td><td align="left">
                  
                    Indique le chemin et le nom du fichier contenant
                    l'image de démarrage à utiliser lors de la création
                    du CD amorçable « <span class="quote">El Torito</span> ». Le chemin
                    doit être relatif au chemin source indiqué à
                    mkisofs. L'image doit être une image de disquette
                    (ce qui explique pourquoi nous utilisons une des
                    images de disquette trouvées sur le CD original).
                    Vous pourrez choisir d'utiliser l'image
                    <tt class="filename">pcmcia.img</tt> à la place si vous
                    voulez réaliser une installation en utilisant des
                    périphériques PCMCIA tels que des cartes réseau ou
                    des lecteurs CDROM.
                  
                  </td></tr><tr><td align="left"><tt class="literal">-o <i class="replaceable"><tt>nom_du_fichier</tt></i></tt></td><td align="left">Nom du fichier contenant l'image iso générée</td></tr><tr><td align="left">.</td><td align="left">
                    
                    Ceci est le répertoire racine de notre image iso
                    (nous travaillons à partir du répertoire racine de
                    chaque CD, donc un point est suffisant).
                    
                  </td></tr></tbody></table></div><p>
        </p><p>

          Vous trouverez plus d'informations sur la façon de graver une
          image sur un support dans <a href="#graver-le-cd">graver le CD</a>. Les
          étapes <tt class="filename">mkisofs</tt> et
          <tt class="filename">cdrecord</tt> peuvent être exécutées en
          utilisant une application graphique comme <a href="http://www.xcdroast.org/" target="_top">X-CD-Roast</a> qui devrait
          actuellement permettre la création de CD amorçables (je ne
          l'ai jamais utilisé, donc ne vous attendez pas à ce que je
          vous donne des explications).

        </p></div></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="reconstruire-rh62"></a>5.3.2. Redhat 6.2</h4></div></div></div><p>

        Apparemment, c'est l'enfant difficile des distributions RedHat
        lorsque vient le moment de graver un CD à jour. L'arrivée de la
        version 4 du gestionnaire de paquets RedHat (RPM) a cassé la
        procédure de mise à jour de l'installateur anaconda. Les
        procédures que j'indique fonctionneront uniquement si les
        paquets mis à jour sont construits en utilisant une version du
        logiciel RPM postérieure ou égale à la version 3.0.4 (donc, en
        pratique, la version 3.0.4 ou 3.0.5).

      </p><p>

        Si vous utilisez les paquets originaux de RedHat, il faudra
        éviter d'utiliser les mises à jour publiées après le
        28 mars 2001 (ce qui est un peu inutile selon moi). 
        Une autre solution est de reconstruire les paquets en utilisant
        l'ancien format rpm. Vous trouverez des informations sur cette
        procédure et les outils nécessaires sur la page <a href="http://www.tigress.co.uk/rmy/rh62/rpmhack.html" target="_top">« <span class="quote">rpmhack</span> »</a>.
        Je n'ai pas personnellement essayé cette procédure, mais,
        d'après les listes de discussion anaconda-devel et
        kickstart<sup>[<a name="id2514260" href="#ftn.id2514260">2</a>]</sup>, elle semble fonctionner.

      </p><p>

        Si vous décidez de rester sur les anciens paquets originaux et
        de compléter la mise à jour (en utilisant les paquets rpm 4.0.2
        après la fin de l'installation), il existe deux façons de le
        faire, en fonction du type de mise à jour que vous souhaitez
        effectuer. Si certaines des mises à jour dépendent directement
        du processus d'installation (c'est-à-dire le noyau, python,
        kudzu), vous devrez utiliser la procédure de reconstruction de
        l'installateur expliquée dans le document <a href="http://web.archive.org/web/20030207104819/http://www.scyld.com/~pzb/rhcd.html" target="_top">Construire
        un CDROM Red Hat Linux 6.2</a>. Sinon vous pourrez utiliser
        l'ancienne procédure (celle pour les versions précédentes
        jusqu'à la 6.1 incluse, telle qu'elle est expliquée dans la
        section précédente). Les deux dernières étapes, qui sont la
        création de l'image iso et la gravure du support, sont décrites
        respectivement dans <a href="#creer-l-image-iso">créer des images iso</a> et <a href="#graver-le-cd">graver le CD</a>.

      </p></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="reconstruire-rh73"></a>5.3.3. Redhat 9, 8.0 et 7.3</h4></div></div></div><p>
      
        Une fois encore, beaucoup de choses ont été changées avec la
        sortie de la série 7.x. Il faut maintenant réaliser un plus
        grand nombre d'opérations pour obtenir une série de CD frais et
        à jour. En réalité, le CD a cessé d'être unique avec la version
        7.0. L'arborescence doit maintenant être divisé pour tenir sur
        le support. Ce qui est fait en utilisant le script
        <span><b class="command">splitdistro</b></span>, qui est écrit en python comme
        beaucoup d'éléments de l'installateur anaconda. Pour terminer
        cette partie, vous <span class="emphasis"><em>devrez</em></span> utiliser une
        machine Linux utilisant la distribution Redhat 7.3, 8.0 ou 9 sur
        laquelle soit installé le paquet
        <i class="medialabel">anaconda-runtime</i> (il aura probablement
        la version 7.3.7, 8.0.4 ou 9.0.4), en fonction de la version que
        vous voulez reconstruire. La procédure est composée de sept
        étapes :
        
      </p><div class="orderedlist"><ol type="i"><li><p>
              Régénérer les fichiers <tt class="filename">hdlist</tt> et
              <tt class="filename">hdlist2</tt>
            </p></li><li><p>
              Mettre à jour le fichier <tt class="filename">comps.xml</tt> (ou
              <tt class="filename">comps</tt>)
            </p></li><li><p>Reconstruire l'installateur</p></li><li><p>Diviser la distribution en plusieurs parties de la taille d'un CD</p></li><li><p>
              Régénérer (encore) les fichiers <tt class="filename">hdlist</tt> et
              <tt class="filename">hdlist2</tt>
            </p></li><li><p>Générer les images iso</p></li><li><p>Ajouter et vérifier les signatures md5 dans les images iso</p></li></ol></div><p>

        Toutes ces étapes sont regroupées en un seul script qui sera
        présenté dans la section « <span class="quote"><a href="#script-updatebuild">le script updateBuild.sh</a></span> ».

      </p><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2514490"></a>5.3.3.1. Opérations préliminaires sur l'arborescence principale</h5></div></div></div><p>

          Quelques-uns des scripts inclus dans le paquet
          <i class="medialabel">anaconda-runtime</i> ont besoin de
          l'arborescence principale, qui doit être déplacée dans un
          sous-répertoire nommé comme l'architecture que nous allons
          construire (donc <tt class="filename">i386/</tt>
          chez moi). Nous déplacerons tout vers ce répertoire avant de
          lancer la procédure. Nous corrigerons également les appels des
          scripts qui n'ont pas besoin de cette modification.

        </p><p>

           Pour la Redhat 9 et 8.0 :

        </p><pre class="programlisting">
$ chmod  -R  u+w  <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>
$ mkdir  -p  <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386
$ cd <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>
$ /bin/mv  *  i386
</pre><p>

          Vous devrez remplacer <tt class="filename"> 
          <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i> 
          </tt> par le <span class="emphasis"><em>chemin absolu</em></span> du 
          répertoire où la racine de votre copie locale de la 
          distribution est placée (peut-être quelque part sur l'un des 
          disques durs). Vous obtiendrez une erreur, lors de l'exécution 
          de la dernière commande, car le répertoire <tt class="filename">i386/</tt> ne peut être déplacé sous 
          lui-même, mais vous ne devez pas en tenir compte.
          
        </p><p>

           Pour Redhat 7.3 :
  
        </p><pre class="programlisting">
$ chmod  -R  u+w <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>
$ mkdir  -p  <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386
$ cd <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>
$ for i in `ls` ; do [ $i != "SRPMS" -a $i != i386 ] &amp;&amp; \
  /bin/mv $i i386 ; done
</pre><p>

          Cette fois-ci (je l'espère) la dernière commande ne devrait 
          produire aucune erreur.
          
        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2514623"></a>5.3.3.2. Régénérer les fichiers hdlist et hdlist2</h5></div></div></div><p>

          Ceci est fait au moyen des deux commandes suivantes et avec
          l'aide du programme <span><b class="command">genhdlist</b></span>.

        </p><pre class="programlisting">
$ /usr/lib/anaconda-runtime/genhdlist
<i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386
$ chmod  644
<i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386/RedHat/base/hdlist{,
2}
</pre><p>
          
          Une fois encore <tt class="filename"> 
          <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i> 
          </tt> est le <span class="emphasis"><em>chemin absolu</em></span> du 
          répertoire où la racine de votre copie locale de la 
          distribution est placée. La seconde commande est nécessaire 
          pour vous assurer que les droits de ce fichier sont corrects. 
          Vous devez déjà avoir une idée de ce que sont ces fichiers si 
          vous avez lu la section « <span class="quote"><a href="#repertoire-redhat">le répertoire RedHat</a></span> ».

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="maj-comps.xml"></a>5.3.3.3. Mettre à jour le fichier <tt class="filename">comps.xml</tt></h5></div></div></div><p>

          Avec la distribution Linux RedHat 8.0, le format du fichier
          <tt class="filename">comps</tt> a complètement changé et il est
          maintenant basé sur XML. Ce nouveau format apporte une plus
          grande flexibilité et facilité de personnalisation. La section
          « <span class="quote"><a href="#fichiers-comps">le fichier comps</a></span> » vous donnera
          plus d'informations sur le sujet. Si vous avez modifié ou si
          vous souhaitez modifier la liste des paquets installés, vous
          aurez besoin de réaliser cette étape. Ce qui implique alors
          d'avoir installé une version modifiée du paquet <a href="rhcd-scripts/comps-9.tar.gz" target="_top">comps-9.tar.gz</a>
          (l'original ne fonctionne pas pour moi) ou <a href="http://rhlinux.redhat.com/anaconda/comps-8.0.tar.gz" target="_top">
          comps-8.0.tar.gz</a> (suivant la version que vous
          construisez) qui contient le fichier maître comps trouvé sur
          le site web de RedHat, ainsi que le paquet
          <tt class="filename">comps-extras</tt>. Suivez alors ces étapes
          pour la Redhat 9 et 8.0 :

        </p><pre class="programlisting">
$ cd <i class="replaceable"><tt>/répertoire-de-votre-choix</tt></i>
$ tar xzvf
<i class="replaceable"><tt>/chemin-vers-comps-9.tar.gz</tt></i>/comps-9.tar.gz 
$ cd comps
$ make
$ cat comps-milan.xml |sed 's!&lt;/comps&gt;!!g' &gt;comps-tmp.xml
$ /usr/share/comps-extras/getfullcomps.py  comps.xml \
   <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i> i386 &gt;&gt;
comps-tmp.xml
$ echo '&lt;/comps&gt;' &gt;&gt; comps-tmp.xml
$ cp comps-tmp.xml
<i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386/RedHat/base/comps.
xml
</pre><p>

          En plus de <tt class="filename"> 
          <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i> 
          </tt>, vous devrez prendre soin d'indiquer des noms 
          valides pour <tt class="filename"> 
          <i class="replaceable"><tt>/répertoire-de-votre-choix</tt></i> 
          </tt> et <tt class="filename"> 
          <i class="replaceable"><tt>/chemin-vers-comps-9.tar.gz</tt></i> 
          </tt>. Le reste des commandes pourra simplement être 
          recopié. Et vous devrez évidemment changer 9 en 8.0 si vous 
          construisez une version 8.0.

        </p><p>

          De nouveau, avant de lancer la commande 
          <span><b class="command">make</b></span>, vous devrez modifier le fichier 
          <tt class="filename">comps-milan.xml.in</tt> en utilisant votre 
          éditeur de texte favori et en suivant les lignes de conduite 
          et suggestions de la section « <span class="quote"><a href="#fichiers-comps">le fichier comps</a></span> » et de la page « <span class="quote"><a href="http://rhlinux.redhat.com/anaconda/comps.html" target="_top">anaconda 
          comps</a></span> » du site web RedHat.

        </p><p>

          Toutes les étapes nécessaires après la commande 
          <span><b class="command">make</b></span> seront réalisées par le script de la 
          section « <span class="quote"><a href="#script-updatebuild">le script updateBuild.sh</a></span> ». 
          Ce script utilise la variable <tt class="literal">COMPSFILE</tt>, 
          pour trouver le fichier <tt class="filename">comps-milan.xml</tt> 
          (il n'a pas besoin d'avoir ce nom, j'utilise juste le nom 
          original, mais vous pouvez le changer si vous le voulez).

        </p><p>

          Si vous utilisez la distribution Redhat 7.3, le fichier 
          <tt class="filename">comps</tt> (avez-vous remarqué la différence 
          de nom ?) est un fichier de texte avec une syntaxe 
          complètement différente. Cette syntaxe est décrite plus 
          précisément dans <a href="#fichiers-comps">le fichier comps</a>. Pour cette 
          distribution, les seules opérations nécessaires sont 
          l'adaptation du fichier pour correspondre à vos besoins et la 
          recopie du fichier <tt class="filename">RedHat/base/comps</tt> dans 
          l'arborescence principale en remplacement de l'original.

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2514955"></a>5.3.3.4. Reconstruire l'installateur</h5></div></div></div><p>

          Cette étape consiste à reconstruire l'installateur anaconda 
          dans votre copie locale de la distribution en utilisant les 
          paquets mis à jour. Pour la Redhat 9, lancez :

        </p><pre class="programlisting">
$ /usr/lib/anaconda-runtime/buildinstall  \
  --pkgorder <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/pkgorder.txt
 \
  --comp dist-9 --product "Red Hat Linux" --version 9  \
  --release "Redhat 9 (Shrike)"
<i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386
</pre><p>

          Où, une fois encore, <tt class="filename"> 
          <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>
          </tt> est le répertoire où est placée la racine de votre 
          copie locale de la distribution.

        </p><p>

          Pour la distribution Redhat 8.0, la procédure est pratiquement 
          identique (l'option <tt class="option"> --product </tt> en 
          moins) :

        </p><pre class="programlisting">
$ /usr/lib/anaconda-runtime/buildinstall  \
  --pkgorder <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/pkgorder.txt
 \
  --comp dist-8.0 --version 8.0  --release "Redhat 8.0 (Psyche)" \
  <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386  
</pre><p>
 
          Ou si, comme moi, vous utilisez toujours une Redhat 7.3 :

        </p><pre class="programlisting">
$ /usr/lib/anaconda-runtime/buildinstall  \
   --pkgorder
<i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/pkgorder.txt  \
   --comp dist-7.3 --version 7.3
<i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386  
</pre><p>

        L'absence de l'option (obligatoire pour la 8.0) <tt class="option"> 
        --release </tt> est la seule différence notable.

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2515064"></a>5.3.3.5. Diviser la distribution</h5></div></div></div><p>

          Dans cette étape, nous allons créer cinq répertoires, chacun 
          correspondant à un CD différent et y placer des liens 
          physiques vers les fichiers réels contenus dans votre copie 
          locale de la distribution.

          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>

              Cette étape ne marchera pas du tout avec la distribution 
              RedHat 7.3 si vous n'utilisez pas la version modifiée 
              du script <tt class="filename">splitdistro</tt> présentée dans 
              le prochain paragraphe. Pour les distribution 
              RedHat 8.0 et 9, une version modifiée de 
              <tt class="filename">splitdistro</tt> est proposée 
              principalement parce que, même si les problèmes du script 
              précédent ont été corrigés, l'exécution échouait 
              systématiquement s'il n'existait pas suffisamment de 
              paquets pour remplir tous les CD (les quatre premiers 
              complètement et le dernier même seulement partiellement).

            </p></td></tr></table></div><p> 
        </p><pre class="programlisting">
$ /usr/lib/anaconda-runtime/splitdistro  \
  --fileorder
<i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/pkgorder.txt  --release \
  "Redhat 9.0 (Shrike)"  <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i> 
i386 
</pre><p>

          La seule chose que vous ayez besoin de changer pour les 
          versions 8.0 et la 7.3 est le texte indiqué à l'option
          <tt class="option">--release</tt> (qui doit être « <span class="quote">Redhat
          8.0 (Psyche)</span> » ou « <span class="quote">Redhat 7.3 (Valhalla)</span> »).

        </p><p>

          Pour la distribution Redhat 7.3, la version du script 
          (python) <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/splitdistro7.3" target="_top">splitdistro7.3</a> 
          utilisée a été extraite du paquet <span class="emphasis"><em>anaconda-runtime 
          7.3.7</em></span> et modifiée par moi. Vous pouvez le 
          substituer à l'original, nommé 
          <tt class="filename">/usr/lib/anaconda-runtime/splitdistro</tt>, 
          après avoir éventuellement sauvegardé ce dernier.

        </p><p>

          La seule modification (en dehors de quelques petites 
          corrections) que ce script aie subie est un changement de son 
          comportement si le répertoire <tt class="filename">SRPMS</tt> n'est 
          pas trouvé (il n'échoue pas, mais génère les CD sans paquets 
          source).

        </p><p>

          Pour la distribution Redhat 8.0, la version du script 
          (python) <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/splitdistro8.0" target="_top">splitdistro8.0</a> 
          utilisée a été extraite du paquet 
          <i class="medialabel">anaconda-runtime 8.0.4</i> et 
          modifiée une nouvelle fois par moi pour obtenir quelques 
          améliorations dont je ressentais le besoin. Vous devez le 
          substituer au fichier original (peut-être après avoir 
          sauvegardé ce dernier) nommé 
          <tt class="filename">/usr/lib/anaconda-runtime/splitdistro</tt>. 
          Néanmoins, l'original fonctionnera bien pour construire une 
          distribution qui comprend tous les paquets 
          <span class="emphasis"><em>SRPMS</em></span> (et ainsi remplir les cinq CD, car 
          sinon le script échouera).

        </p><p>

          La seule modification apportée au script est un changement 
          dans son comportement s'il ne trouve pas le répertoire 
          <tt class="filename">SRPMS</tt> (il n'échoue plus, mais génère les 
          CD sans paquets source) ou s'il y a un CD sans paquet (le 
          script générera un répertoire vide un lieu d'échouer).

        </p><p>

          Pour la distribution Redhat 9, vous trouverez une copie
          du script incluant les mêmes modifications que le script de
          la 8.0 ici : <a href="rhcd-scripts/splitdistro9" target="_top">splitdistro9</a>. Tout ce
          qui a été dit dans le paragraphe précédent pour la
          distribution Redhat 8.0 s'applique à la version 9.

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2515281"></a>5.3.3.6. Régénérer les fichiers hdlist et hdlist2</h5></div></div></div><p>

           Il est nécessaire de recréer les fichiers hdlist et hdlist2,
           en utilisant certaines des informations obtenues dans les
           étapes précédentes. Il n'y a pas de différences entre 7.3,
           8.0 et 9 pour l'exécution de ce programme. La commande à
           utiliser est la suivante :

         </p><pre class="programlisting">
$ /usr/lib/anaconda-runtime/genhdlist  \
  --fileorder
<i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/pkgorder.txt 
--withnumbers \
  <i class="replaceable"><tt>/chemin-absolu-de-la-racine</tt></i>/i386-disc[1-3]
</pre><p>

           Comme vous pouvez le voir, comparé à la première utilisation
           de genhdlist, deux nouvelles options sont passées au
           programme. La première, <tt class="option">--fileorder</tt>, indique
           à genhdlist d'utiliser le fichier
           <tt class="filename">pkgorder.txt</tt> que nous avons généré à la
           seconde étape (<a href="#reconstruire-l-installateur">reconstruire l'installateur</a>). Ce fichier contient
           la répartition des paquets sur les différents CD et est
           utilisé par l'installateur pour déterminer dans quel ordre
           les paquets doivent être installés. De manière simple, si
           vous ne l'utilisez pas, vous finirez probablement par changer
           très souvent de CD lors de l'installation. L'option
           <tt class="option">--withnumbers</tt> est nécessaire pour associer
           un numéro de CD à chaque paquet (comme vous le voyez, un
           joker indiquant les trois premières images iso est utilisé).

         </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2515368"></a>5.3.3.7. Générer les images iso</h5></div></div></div><p>

          Dans cette étape, vous allez préparer les images iso à graver
          sur les CD réels. Il y a deux commandes distinctes à utiliser,
          l'une pour le premier disque et l'autre pour le reste des CD. 
          Ceci est dû au besoin de rendre amorçable le premier CD. Ce
          n'est pas strictement nécessaire car vous pouvez utiliser à la
          place une disquette de démarrage mais il s'agit d'une
          fonctionnalité intéressante (et elle rend le comportement de
          vos disques plus similaire aux originaux).  Voici les
          commandes que j'utilise pour réaliser cette tâche :

          </p><pre class="programlisting">
$ mkdir <i class="replaceable"><tt>/repertoire-destination-images</tt></i>
$ mkisofs  -r  -J  -T  -v  -V "Red Hat 9 (Shrike) disque 1" \
   -c isolinux/boot.cat  -b isolinux/isolinux.bin -no-emul-boot \
   -boot-load-size 4 -boot-info-table \
   -o <i class="replaceable"><tt>/repertoire-destination-images</tt></i>/i386-disc1.iso .
</pre><p>

            Cela est nécessaire pour graver le premier disque
            (amorçable) pour les distributions Redhat 8.0 et 9
            (sans émulation de disquette) et c'est exécuté à partir du
            répertoire racine de la distribution. Le répertoire
            <tt class="filename">
            <i class="replaceable"><tt>/repertoire-destination-images</tt></i>
            </tt> est le contenant pour les cinq images iso que
            vous avez générées et il doit exister avant de pouvoir
            lancer la procédure. La seule modification à effectuer pour
            la distribution Redhat 8 est le nom du volume, qui
            devrait être « <span class="quote">Red Hat 8.0 (Psyche) disque 1</span> ».

          </p><pre class="programlisting">
$ mkdir <i class="replaceable"><tt>/repertoire-destination-images</tt></i>
$ mkisofs  -r  -J  -T  -v  -V "Red Hat 7.3 (Valhalla) disc 1" \
   -c boot.cat  -b dosutils/autoboot/boot.img \
   -o <i class="replaceable"><tt>/repertoire-destination-images</tt></i>/i386-disc1.iso .
</pre><p>

            C'est nécessaire pour graver le premier disque (amorçable)
            sur la 7.3.  Cette commande doit être exécutée à partir
            du répertoire racine de la distribution (cette fois-ci nous
            utilisons l'émulation de disquette).

          </p><p>

            Le reste des images peut être écrit au moyen d'une boucle
            « <span class="quote">for</span> » :

          </p><pre class="programlisting">
$ for i in `echo 2 3 4 5` ; do mkisofs  -r  -J  -T  -v  \
   -V "Red Hat 9 (Shrike) disc ${i}"  \
   -o <i class="replaceable"><tt>/repertoire-destination-images</tt></i>/i386-disc${i}.iso . ; done
</pre><p>

            La boucle présentée va préparer les quatre dernières images
            en leur donnant les bons numéros. Comme vous pouvez le voir,
            il y a deux options manquantes par rapport à la commande
            précédente et, comme vous pouvez le deviner, ces commandes
            ne sont utiles que pour créer un CD amorçable.  Dans <a href="#creer-l-image-iso">créer des images iso</a>, vous pourrez lire une brève
            explication sur des différentes options et de leurs
            significations (la plupart ont été extraites de la page de
            manuel). De nouveau, si vous construisez une
            distribution Redhat 8.0, vous devriez changer le nom du 
            volume par « <span class="quote">Red Hat 8.0 (Psyche) disc1</span> ».

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2515527"></a>5.3.3.8. 
        
          Implanter et vérifier les signatures md5 dans les images iso
        
        </h5></div></div></div><p>

          C'est une étape optionnelle mais elle permet l'utilisation de 
          l'option « <span class="quote">checkmedia</span> » pour vérifier les 
          signatures des CD avant de les installer et donc de garantir 
          leur intégrité.

        </p><p>

          Les commandes suivantes permettent d'injecter ou de vérifier
          une signature md5 sur une image iso :

        </p><pre class="programlisting">
$ /usr/lib/anaconda-runtime/implantisomd5 <i class="replaceable"><tt>image-iso</tt></i>
$ /usr/lib/anaconda-runtime/checkisomd5 <i class="replaceable"><tt>image-iso</tt></i>
</pre><p>

          Après avoir fini toutes ces étapes, nous aurons obtenu les 
          cinq images CD à graver. Considérant que saisir tout ceci est 
          un peu long, la prochaine section présentera un script qui 
          réalise toutes ces opérations en une seule fois (n'oubliez pas 
          de configurer correctement les paramètres).

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="script-updatebuild"></a>5.3.3.9. Réunir toutes ces étapes</h5></div></div></div><p>

          Le script <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/updateBuild.sh" target="_top">updateBuild.sh</a> 
          exécutera toutes les étapes nécessaires à la reconstruction 
          des CD des distributions Redhat 7.3, 8.0 et 9 en un seul 
          lancement (sous le compte <tt class="literal">root</tt>). Avant 
          d'utiliser ce script, vous devrez définir une variable 
          <tt class="literal">RHCDPATH</tt> pointant vers le répertoire où se 
          trouve le fichier <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a> et 
          paramétrer ce fichier. Si vous voulez inclure un fichier 
          <tt class="filename">comps.xml</tt> modifié (ou 
          <tt class="filename">comps</tt>) dans vos CD, comme expliqué dans 
          <a href="#fichiers-comps">le fichier comps</a>, vous devrez le copier à 
          l'emplacement défini par la variable 
          <tt class="literal">COMPSFILE</tt> avant d'exécuter le script. Si 
          vous en avez besoin, n'oubliez pas d'ajouter le script modifié 
          <tt class="filename">splitdistro</tt> dans le répertoire <tt class="filename">/usr/lib/anaconda-runtime</tt>.
      
        </p><pre class="screen">
# export RHCDPATH=<i class="replaceable"><tt>/home/luigi/tmp/</tt></i>rhcd-scripts
# sh updateBuild.sh
</pre></div></div></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="graver-le-cd"></a>6. Graver le ou les CD</h2></div></div></div><p>
  
    Cette étape est composée d'une partie optionnelle et d'une partie 
    obligatoire. Rappelez-vous que vous aurez probablement besoin 
    d'être connecté sous le compte « <span class="quote">root</span> » de votre machine 
    pour lancer <span><b class="command">cdrecord</b></span>.
  
  </p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2515729"></a>6.1. Essayer l'image ou les images</h3></div></div></div><p>

      Si vous êtes paranoïaque, vous pouvez tester votre nouvelle image
      disque en la montant. Si vous oubliez de corriger les droits
      des fichiers ou de mettre en place les extensions rock ridge,
      alors l'erreur sera évidente puisque les noms de fichier et la
      structure des répertoires seront erronés. Le test (optionnel) peut
      être réalisé en entrant la commande suivante :
      
    </p><pre class="programlisting">
# mount -t iso9660 -o ro,loop=/dev/loop0 <i class="replaceable"><tt>image-iso</tt></i> /mnt/cdrom
</pre><p>

      Où <tt class="filename"><i class="replaceable"><tt>image-iso</tt></i></tt> est 
      le nom que vous aurez donné à l'image iso à monter (qui doit être 
      seule pour les versions supérieures ou égales à la 6.2). Quand 
      vous avez terminé, n'oubliez pas de la démonter :

    </p><pre class="programlisting">
# umount /mnt/cdrom
</pre></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2515778"></a>6.2. Graver le ou des disques</h3></div></div></div><p>

      Assurez-vous que vous avez défini les bons paramètres pour votre 
      périphérique. Par exemple, la commande suivante est destinée à un 
      graveur 4x, ce qui est assez lent. De plus, on suppose que le 
      graveur de CD est ici sur le bus SCSI numéro 0, avec l'ID 0 et le 
      LUN 0. Vous pourrez obtenir ces valeurs en lançant un 
      <b class="userinput"><tt>cdrecord -scanbus</tt></b> et en les assignant 
      au paramètre « <span class="quote"><tt class="option">-dev=</tt></span> ».
      
    </p><pre class="programlisting">
# cdrecord -v speed=4 dev=0,0,0 <i class="replaceable"><tt>/repertoire-destination-images</tt></i>/<i class="replaceable"><tt>disc1.img</tt></i>
</pre></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="fichiers-comps"></a>7. Le fichier comps</h2></div></div></div><p>

    Le fichier <tt class="filename">comps</tt> définit la façon dont les 
    paquets seront regroupés durant l'installation. Dans la distribution 
    RedHat, ceci est fait selon les fonctionnalités qu'ils offrent, par 
    exemple :

  </p><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Utilisation d'imprimantes</p></li><li style="list-style-type: circle"><p>Système X Window</p></li><li style="list-style-type: circle"><p>GNOME</p></li><li style="list-style-type: circle"><p>KDE</p></li><li style="list-style-type: circle"><p>Outils courrier, web et forums</p></li><li style="list-style-type: circle"><p>…</p></li><li style="list-style-type: circle"><p>Développement du noyau</p></li><li style="list-style-type: circle"><p>Documentation supplémentaire</p></li></ul></div><p>

    Quelquefois durant le processus d'installation, l'utilisateur se 
    trouve face à une fenêtre appelée « <span class="quote">Composants à 
    installer</span> ». Quelques-uns des composants ont été 
    présélectionnés, d'autres non. Le dernier point sur la liste des 
    composants est appelé « <span class="quote">Tout</span> ». Sur la fenêtre, il existe 
    aussi une option de personnalisation qui permet à l'utilisateur de 
    choisir très précisément la liste des paquets qui seront installés. 
    Personnaliser l'installation ou sélectionner « <span class="quote">Tout</span> » 
    dans la liste des composants est le seul moyen d'obtenir que votre 
    propre sélection de paquets soit installée, sauf si vous modifiez le 
    fichier <tt class="filename">RedHat/base/comps</tt>.
    
  </p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2515954"></a>7.1. 
    
        Format du fichier <tt class="filename">comps</tt> pour RedHat 
        versions &lt; 6.1
    
    </h3></div></div></div><p>
    
      Le fichier <tt class="filename">comps</tt> commence avec un en-tête
      indiquant la version du format du fichier comps, suivie d'une 
      ligne vide.
    
    </p><pre class="screen">
0.1
&lt;empty line&gt;
</pre><p>

      Puis, il dresse la liste des composants, séparés par des lignes 
      vides :

    </p><pre class="screen">
&lt;composant 1&gt;
&lt;ligne vide&gt;
&lt;composant 2&gt;
&lt;ligne vide&gt;
...
&lt;composant n&gt;
&lt;ligne vide&gt;
EOF
</pre><p>

      Chaque composant est défini comme suit :

    </p><pre class="screen">
(0|1) (--hide)? &lt;name&gt;
&lt;RPM 1&gt;
&lt;RPM 2&gt;
...
&lt;RPM n&gt;
end
</pre><p>

      Avant le nom de chaque composant est placé un <tt class="literal">0</tt> 
      ou un <tt class="literal">1</tt>. Une valeur de <tt class="literal">1</tt> à 
      cet endroit indique que le composant est choisi par défaut alors 
      qu'un <tt class="literal">0</tt> signifie le contraire. L'option 
      <tt class="option">--hide</tt> veut dire que l'entrée ne sera pas 
      affichée, sauf si vous choisissez l'installation « <span class="quote">en mode 
      expert</span> ». Le premier composant est appelé 
      « <span class="quote">Base</span> » et il est spécial, dans le sens où il 
      <span class="emphasis"><em>doit</em></span> être présent et qu'il n'apparaîtra pas 
      dans le dialogue (vous ne pouvez pas désélectionner l'installation 
      de la base, ce qui est sensé). Suit une liste de paquets RPM 
      appartenant à ce composant. Notez qu'il s'agit du nom du paquet 
      stocké <span class="emphasis"><em>dans le fichier rpm</em></span> et 
      <span class="emphasis"><em>non</em></span> d'une partie du nom de fichier du paquet 
      (bien qu'il soient sensés, par convention, être identiques).

    </p><p>

      En ajoutant vos paquets au fichier <tt class="filename">comps</tt>, 
      vous pourrez personnaliser votre propre distribution et vous 
      assurer que vos paquets seront installés par défaut. Une chose à 
      laquelle vous devez faire attention est l'interdépendance entre 
      vos paquets, mais ici c'est à vous de jouer :-) Un mot pour vous 
      prévenir : faites attention de ne pas ajouter ou supprimer 
      des espaces blancs supplémentaires dans le fichier. Examinez le 
      fichier <tt class="filename">comps</tt> existant (faites une copie de 
      l'original) pour voir comment il est fait (ou vérifiez 
      <tt class="filename">i386/misc/src/install/pkgs.c</tt> si vous voulez 
      comprendre comment le fichier est analysé).

    </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2516130"></a>7.2. Format du fichier comps pour RedHat version 6.1</h3></div></div></div><p>

      Avec la version 6.1 de la distribution RedHat, le format du 
      fichier <tt class="filename">comps</tt> a changé. Le décodage 
      s'effectue dans 
      <tt class="filename">${RHROOT}/${ARCH}/misc/src/anaconda/comps.py</tt>. 
      Je n'ai pas encore analysé ce script python et les règles 
      suivantes ont été obtenues seulement en étudiant le fichier 
      <tt class="filename">comps</tt> et en essayant quelques paramétrages.

    </p><p>

      Dans la version 6.1, la définition du 
      <span class="emphasis"><em>composant</em></span> est étendue pour inclure quelques 
      éléments optionnels supplémentaires avant les 
      <span class="emphasis"><em>&lt;RPM&gt;</em></span>. Ces éléments sont :

    </p><pre class="screen">
&lt;RPM-dépendant-de-l-architecture 1&gt;
...
&lt;RPM-dépendant-de-l-architecture n&gt;
&lt;composant-requis 1&gt;
...
&lt;composant-requis n&gt;
&lt;RPM-dépendant-d-un-composant 1&gt; 
...
&lt;RPM-dépendant-d-un-composant n&gt;
</pre><p>

        Un &lt;RPM-dépendant-de-l-architecture&gt; définit une 
        dépendance entre un paquet et une architecture spécifique et a 
        pour définition :

      </p><pre class="screen">
(!)?arch: &lt;RPM&gt;
</pre><p>

        Donc, il peut, par exemple, se présenter dans le monde réel
        comme :

      </p><pre class="screen">
!alpha: kernelcfg
</pre><p>

        ce qui veut dire : si l'architecture n'est pas alpha alors
        il faut installer le paquet <span class="emphasis"><em>kernelcfg</em></span>.
        
      </p><p>

        Ou comme :
      </p><pre class="screen">
i386: mkbootdisk
</pre><p>
      
        Ce qui veut dire : si l'architecture est i386 alors il faut
        installer le paquet <span class="emphasis"><em>mkbootdisk</em></span>.
      
      </p><p>

        Un &lt;composant-requis&gt; renforce la dépendance avec un autre
        composant et il est défini comme :

      </p><pre class="screen">
@ &lt;composant&gt;
</pre><p>

        Donc, par exemple, si à l'intérieur de la définition d'un
        composant, vous trouvez la ligne suivante :

      </p><pre class="screen">
@ Station réseau
</pre><p>
      
        cela veut dire que le composant lui-même a besoin de
        l'installation d'un autre composant nommé <span class="emphasis"><em>Station
        réseau</em></span>.
      
      </p><p>

        Un &lt;RPM-dépendant-d-un-composant&gt; est utilisé pour sélectionner
        l'installation de quelques paquets additionnels pour un
        composant, étant donné la présence d'un autre composant. Sa
        définition est la suivante :

      </p><pre class="screen">
? &lt;composant&gt; { 
  &lt;RPM 1&gt;
  ...
  &lt;RPM n&gt;
}
</pre><p>

        Donc si, par exemple, dans la définition d'un composant, il vous
        arrive de lire les lignes suivantes :

      </p><pre class="screen">
? KDE { 
  kpppload
}
</pre><p>
    
      alors si le composant <span class="emphasis"><em>KDE</em></span> est installé, le 
      paquet <span class="emphasis"><em>kpppload</em></span> sera installé en même temps 
      que les paquets inclus dans le composant où se trouve cette 
      définition.
    
    </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2516325"></a>7.3. Format du fichier comps dans RedHat version 6.2</h3></div></div></div><p>

      Avec RedHat version 6.2, le format du fichier 
      <tt class="filename">comps</tt> a apparemment très légèrement changé. 
      Le décodage se fait toujours dans 
      <tt class="filename">${RHROOT}/${ARCH}/misc/src/anaconda/comps.py</tt>. 
      Encore une fois, je n'ai pas analysé ce script python et les 
      règles suivantes ont été obtenues uniquement en étudiant le 
      fichier et en essayant quelques paramétrages.

    </p><p>

      Dans la version 6.2, la définition du composant est étendue pour
      inclure deux éléments optionnels supplémentaires :

    </p><pre class="screen">
&lt;RPM-dépendant-de-la-langue 1&gt;
...
&lt;RPM-dépendant-de-la-langue n&gt;
&lt;composant-dépendant-de-l-architecture 1&gt;
...
&lt;composant-dépendant-de-l-architecture n&gt;
</pre><p>

      Un <span class="emphasis"><em>&lt;RPM-dépendant-de-la-langue&gt;</em></span> est 
      nécessaire pour demander l'installation d'un paquet lorsqu'une 
      langue spécifique a été sélectionnée. C'est défini ainsi :

    </p><pre class="screen">
(lang &lt;langue&gt;): &lt;RPM&gt;
</pre><p>

      Par exemple, la ligne suivante

    </p><pre class="screen">
(lang ja_JP): locale-ja
</pre><p>

      veut dire : si la langue japonaise est sélectionnée, alors il 
      faudra installer le paquet <span class="emphasis"><em>locale-ja</em></span> en plus 
      des autres paquets installés pour ce composant.

    </p><p>

      Un 
      <span class="emphasis"><em>&lt;composant-dépendant-de-l-architecture&gt;</em></span> 
      étend le concept du 
      <span class="emphasis"><em>&lt;RPM-dépendant-de-l-architecture&gt;</em></span>, 
      introduit pour la version 6.1, au composant entier, comme 
      vous pouvez le voir à la lecture de sa définition :

    </p><pre class="screen">
(!)?arch: &lt;composant&gt;
</pre></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2516438"></a>7.4. Format d'un fichier comps dans la RedHat version 7.3</h3></div></div></div><p>

      Avec la version 7.3 de la distribution RedHat, le format du 
      fichier <tt class="filename">comps</tt> possède une syntaxe plus 
      puissante. Le décodage prend place (encore) dans le script 
      <tt class="filename">comps.py</tt>, que vous trouverez dans le 
      répertoire <tt class="filename">/usr/lib/anaconda/</tt> si vous avez 
      installé le paquet <i class="medialabel">anaconda</i>. Les 
      dépendances d'un composant ou d'un paquet envers une langue ou une 
      architecture données peuvent maintenant être liées par l'opérateur 
      logique <tt class="literal">and</tt> (et logique). Par exemple :

    </p><pre class="screen">
(arch !s390 and arch !s390x and arch !ia64): readline2.2.1
</pre><p>

      ce qui veut dire que si l'architecture n'est ni s390, ni s390x, ni 
      ia64, alors il faudra installer le paquet readline2.2.1. Ceci peut 
      être fait avec des composants au lieu des paquets et avec des 
      langues à la place des architectures. Tout ceci est sans aucun 
      doute plus qu'assez pour les exemples simples de personnalisation 
      de l'installation par défaut qui seront présentés dans la section 
      suivante.

    </p><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="personnaliser-rh73"></a>7.4.1. Personnaliser l'installation par défaut de la RedHat version 7.3</h4></div></div></div><p>
      
        L'exemple que nous allons suivre dans cette section implique de 
        modifier le fichier <tt class="filename">comps</tt> pour changer les 
        valeurs par défaut concernant l'installation des paquets. Je 
        préfère habituellement (en fait spécialement dans certaines 
        situations) une installation par défaut incluant seulement les 
        paquets de base, avec quelques légères modifications pour 
        certains d'entre eux. Dans le premier des exemples présentés, 
        nous construirons une installation par défaut qui ajoute 
        <span class="emphasis"><em>libsafe</em></span> au composant « <span class="quote">Base</span> », 
        dont la plupart des paquets, qui sont généralement installés par 
        défaut, seront désélectionnés dans le but de construire une 
        installation minimale. Dans le second des exemples, nous 
        modifierons quelques-uns des composants pour construire une 
        autre installation minimale qui réponde à nos besoins (cette 
        fois, pratiquement parfaitement ; ce sont, en fait, mes 
        besoins, les vôtres pouvant varier). Si vous voulez inclure un 
        fichier <tt class="filename">comps</tt> modifié dans vos CD, vous 
        devrez le copier dans l'arborescence principale juste avant de 
        lancer les opérations décrites dans <a href="#reconstruire-rh73">reconstruire l'installateur 7.3 ou 8.0</a>.
      
      </p><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2516593"></a>7.4.1.1. Ajouter des RPMS et désélectionner les composants par défaut</h5></div></div></div><p>

          Pour personnaliser votre installation de cette façon, vous 
          devrez éditer le fichier <tt class="filename">comps</tt> avec votre 
          éditeur de texte favori (faites attention à ne pas laisser 
          d'espaces ou de tabulations dans ce fichier) et le déplacer 
          dans le répertoire <tt class="filename">Redhat/base</tt> en écrasant 
          l'original.

        </p><p>

          Dans le <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/comps/comps.1" target="_top">premier fichier 
          comps</a> inclus, le paquet <span class="emphasis"><em>libsafe</em></span> 
          est ajouté au composant « <span class="quote">Base</span> » (système de base) 
          et presque tous les composants sont désélectionnés pour 
          obtenir une installation par défaut comportant seulement 200 
          paquets (je sais qu'ils peuvent être encore trop nombreux).

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2516658"></a>7.4.1.2. Modifier quelques-uns des composants standards</h5></div></div></div><p>

          Nous avons construit le <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/comps/comps.2" target="_top">deuxième fichier 
          comps</a> ci-joint à partir de la configuration précédente 
          en réduisant un peu plus l'installation par défaut (cette 
          fois, elle ne contient plus que 154 paquets). Quelques-uns des 
          groupes ont été divisé pour donner à l'installation une 
          meilleure granularité. Toutes les modifications que vous 
          faites doivent prendre en compte les interdépendances entre 
          paquets et les applications utilisées durant les phases 
          d'installation (par exemple, vous ne pouvez pas supprimer 
          <span class="emphasis"><em>kudzu</em></span> du composant 
          <span class="emphasis"><em>Base</em></span>, bien que vous puissiez le faire 
          après installation). Je dois aussi vous préciser que des 
          résultats similaires peuvent être obtenus en utilisant 
          <span class="emphasis"><em>kickstart</em></span>. Pour plus d'informations à ce 
          propos, vous pourrez lire le <a href="http://www.europe.redhat.com/documentation/rhl7.3/rhl-cg-fr-7.3/ch-kickstart2.php3" target="_top">Guide 
          de Personnalisation du Linux RedHat</a>.
          
        </p></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2516717"></a>7.5. 
    
        Format du fichier comps à partir des versions 8.0 et 9 de 
        RedHat
    
    </h3></div></div></div><p>

      Avec les versions 8.0 et 9, le format du fichier 
      <tt class="filename">comps</tt> a complètement changé et on utilise 
      maintenant un fichier XML, nommé <tt class="filename">comps.xml</tt>. 
      Les détails de la syntaxe de ce fichier sont présentés dans la 
      section <a href="http://rhlinux.redhat.com/anaconda/comps.html" target="_top">Les comps 
      d'Anaconda</a> du site web de RedHat.

    </p><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="custom-comps-rh80"></a>7.5.1. 
          
          Personnaliser l'installation par défaut de la RedHat 
          version 8.0
      
      </h4></div></div></div><p>

        Nous allons maintenant reprendre les exemples présentés pour la 
        version 7.3 en prenant en compte les modifications qu'ont 
        subi les différents groupes. Le groupe le plus important (le 
        groupe « <span class="quote">Base</span> ») est ici divisé en deux groupes 
        nommés « <span class="quote">Base</span> » et « <span class="quote">Core</span> ». Le groupe 
        « <span class="quote">Base</span> » devrait représenter la plus petite 
        installation possible.

      </p><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2516798"></a>7.5.1.1. Notre premier exemple revisité pour Redhat 8.0</h5></div></div></div><p>

          Cette fois, pour personnaliser votre installation, vous devrez 
          éditer le fichier <tt class="filename">comps-milan.xml.in</tt> avec 
          votre éditeur de texte favori. Ce fichier se trouve dans 
          l'archive <a href="http://rhlinux.redhat.com/anaconda/comps-8.0.tar.gz" target="_top">comps-8.0.tar.gz</a> 
          disponible sur le site web de RedHat. Pour ajouter les 
          informations relatives aux paquets au fichier que vous créez, 
          vous aurez besoin d'avoir installé le paquet rpm 
          <i class="medialabel">comps-extras</i>. Les commandes à lancer 
          pour terminer les opérations sont indiquées dans <a href="#maj-comps.xml">mettre à jour comps.xml</a> et dans la <a href="http://rhlinux.redhat.com/anaconda/comps.html" target="_top">documentation</a>. 
          Après avoir créé le fichier, vous devrez le copier dans le 
          répertoire <tt class="filename">Redhat/base</tt> en écrasant 
          l'original. Si vous utilisez <a href="#script-updatebuild">le script updateBuild.sh</a>, vous devrez seulement copier 
          <tt class="filename">comps-milan.xml</tt> (après avoir modifié le 
          <tt class="filename">comps-milan.xml.in</tt> qui se trouve dans le 
          paquet tar/gzip <tt class="filename">comps-8.0.tar.gz</tt> et 
          lancer la commande <span class="emphasis"><em>make</em></span>), à l'emplacement 
          que vous avez déjà indiqué dans la variable 
          <tt class="literal">COMPSFILE</tt> (dans <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a>).

        </p><p>

          Dans le <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/comps/comps-milan.xml.in.1" target="_top">premier
          fichier comps</a> ci-joint, le paquet
          <span class="emphasis"><em>libsafe</em></span> a été ajouté au groupe
          (composant) « <span class="quote">Base</span> » et pratiquement tous les
          groupes (composants) ont été désélectionnés, sauf
          « <span class="quote">Base</span> » et « <span class="quote">Core</span> », pour avoir une
          installation par défaut de seulement 220 paquets environ
          (probablement trop nombreux, encore une fois).

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2516948"></a>7.5.1.2. Notre deuxième exemple revisité pour Redhat 8.0</h5></div></div></div><p>

          Nous avons construit le <a href="outils/RedHat-CD-HOWTO/rhcd-scripts/comps/comps-milan.xml.in.2" target="_top">deuxième 
          fichier comps</a> ci-joint en partant de la configuration 
          précédente et en réduisant un peu plus l'installation par 
          défaut (cette fois, il ne restera que 158 paquets dans 
          l'installation par défaut). Encore une fois, des résultats 
          similaires peuvent être obtenus en utilisant 
          <span class="emphasis"><em>kickstart</em></span>, pour plus d'informations à ce 
          propos, vous pourrez lire le <a href="http://www.redhat.com/docs/manuals/linux/RHL-8.0-Manual/custom-guide/ch-kickstart2.html" target="_top">Guide 
          de personnalisation du Linux RedHat</a>. Dans cet exemple, 
          je n'ai pas complètement désélectionné l'installation du 
          groupe « <span class="quote">Base</span> », parce qu'il contient trop de 
          paquets que j'utilise d'habitude. J'ai donc juste 
          désélectionné l'installation par défaut pour ces paquets en 
          les rendant optionnels. Comme vous pouvez le voir, même le 
          paquet <i class="medialabel">redhat-logos</i> du groupe 
          « <span class="quote">Core</span> » a été rendu optionnel. Sachant que tous 
          les paquets de ce groupe doivent représenter, ensembles, la 
          <span class="emphasis"><em>plus petite installation possible</em></span>, vous 
          ne voudrez sans doute pas le faire (mes CD fonctionnent même 
          même comme cela ; cependant, il doit y avoir quelques 
          problèmes que je n'ai pas encore détectés). Le paquet 
          <tt class="filename">tripwire</tt> a aussi été ajouté au groupe 
          « <span class="quote">Base</span> ». La dernière modification visible a été 
          faite au groupe « <span class="quote">dialup</span> », qui sera installé même 
          s'il est désélectionné, parce que le groupe 
          « <span class="quote">Base</span> » en dépend (ce qui est indiqué dans la 
          définition du groupe lui-même). J'ai seulement sélectionné 
          pour installation certains paquets de ce groupe dont j'ai 
          habituellement besoin et laissé le reste désélectionné.

        </p></div></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="custom-comps-rh9"></a>7.5.2. 
          
          Personnaliser l'installation par défaut de la RedHat 
          version 9
          
      </h4></div></div></div><p>
      
        Nous allons de nouveau reproduire les exemples présentés pour
        les versions 7.3 et 8 en prenant en compte les modifications
        qu'ont subies les différents groupes.
      
      </p><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2517084"></a>7.5.2.1. Notre premier exemple revisité pour la Redhat 9</h5></div></div></div><p>

          Comme dans le cas de la 8.0, pour personnaliser votre 
          installation, vous devrez modifier le fichier 
          <tt class="filename">comps-milan.xml.in</tt> avec votre éditeur de 
          texte favori. Ce fichier est disponible dans le fichier <a href="rhcd-scripts/comps-9.tar.gz" target="_top">comps-9.tar.gz</a> avec 
          les scripts <span class="emphasis"><em>(comme je l'ai déjà dit, vous ne 
          trouverez pas la même chose sur le site web de 
          Redhat)</em></span>. Pour ajouter les informations relatives 
          aux paquets au fichier que vous créez, vous aurez besoin 
          d'avoir installé le paquet rpm 
          <tt class="filename">comps-extras</tt>. Les commandes à utiliser 
          sont indiquées dans <a href="#maj-comps.xml">mettre à jour comps.xml</a> et dans la 
          <a href="http://rhlinux.redhat.com/anaconda/comps.html" target="_top">documentation</a>. 
          Après avoir créé le fichier, vous devrez le copier dans le 
          répertoire <tt class="filename">Redhat/base</tt> en écrasant 
          l'original. Si vous utilisez <a href="#script-updatebuild">le script updateBuild.sh</a>, vous devrez seulement copier 
          <tt class="filename">comps-milan.xml</tt>, (après avoir modifié 
          <tt class="filename">comps-milan.xml.in</tt> trouvé dans le paquet 
          tar/gzip <tt class="filename">comps-9.tar.gz</tt> et avoir lancé la 
          commande <span class="emphasis"><em>make</em></span>), vers la destination que 
          vous avez déjà indiquée dans la variable 
          <tt class="literal">COMPSFILE</tt> (<a href="rhcd-scripts/rhcd.conf" target="_top">rhcd.conf</a>).

        </p><p>

          Dans le <a href="rhcd-scripts/comps/comps-milan.xml.in.1-9" target="_top">premier 
          fichier comps</a> inclus, le paquet 
          <span class="emphasis"><em>libsafe</em></span> a été ajouté au groupe 
          (composant) « <span class="quote">Base</span> » et pratiquement chaque groupe 
          (composant) a été désélectionné, mis à part 
          « <span class="quote">Base</span> » et « <span class="quote">Core</span> », de façon à avoir 
          une installation par défaut comprenant seulement environ 240 
          paquets (hummm, la complexité augmente beaucoup…).

        </p></div><div class="sect4" lang="fr"><div class="titlepage"><div><div><h5 class="title"><a name="id2517244"></a>7.5.2.2. Notre second exemple revisité pour Redhat 9</h5></div></div></div><p>

          Dans le <a href="rhcd-scripts/comps/comps-milan.xml.in.2-9" target="_top">second fichier 
          comps</a> ci-joint, nous partons de la configuration 
          précédente et nous réduisons un peu plus l'installation par 
          défaut (cette fois, il n'y aura qu'environ 175 paquets dans 
          l'installation par défaut). Ceci ressemble beaucoup à 
          l'exemple présenté pour la Redhat 8.0, donc je vais 
          éviter de vous ennuyer avec les mêmes explications. Encore une 
          fois, des résultats identiques peuvent être obtenus en 
          utilisant <span class="emphasis"><em>kickstart</em></span>. Vous trouverez plus 
          d'informations sur le sujet en lisant le <a href="http://www.redhat.com/docs/manuals/linux/RHL-9-Manual/custom-guide/ch-kickstart2.html" target="_top">Guide 
          de personnalisation du Linux RedHat</a>.

        </p></div></div></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="installation"></a>8. Installation à partir du CD</h2></div></div></div><p>

    Lors de l'installation à partir du nouveau CD, vous pourriez avoir 
    tout d'abord besoin de créer une disquette d'installation amorçable. 
    <span class="emphasis"><em>IMPORTANT : utilisez une disquette neuve, tout juste 
    formatée en format MS-DOS !</em></span>. Utiliser une vieille 
    disquette peut entraîner des problèmes étranges lors de 
    l'installation ! Sur un système Linux, vous pourrez créer la 
    disquette en utilisant la commande <tt class="filename">dd</tt> :

  </p><pre class="screen">
$ dd if=/mnt/cdrom/images/boot.img of=/dev/fd0 bs=1440k 
</pre><p>

    Sur un système tournant sous DOS ou Windows-9x, vous aurez besoin
    d'utiliser le programme <tt class="filename">rawrite.exe</tt>, disponible
    dans le répertoire <tt class="filename">dosutils</tt>
    du CD. Sur une machine sous Windows-9x/Me/NT/2k, vous pourrez
    utiliser <tt class="filename">rawritewin.exe</tt> situé dans le
    répertoire <tt class="filename">dosutils/rawritewin</tt>.

  </p><p>

    Arrêtez la machine sur laquelle vous voulez installer votre CD (ou 
    faire une mise à jour du système), insérez la disquette de démarrage 
    et votre CD fraîchement gravé, et laissez la machine démarrer à 
    partir de la disquette. Pour plus d'informations sur le processus 
    d'installation, voir les documents ainsi que le <a href="http://www.traduc.org/docs/howto/lecture/Installation-HOWTO.html" target="_top">Guide pratique 
    Installation</a> ou le <a href="http://www.traduc.org/docs/howto/lecture/Bootdisk-HOWTO.html" target="_top">Guide pratique des disques 
    d'amorçage</a>.

  </p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2517409"></a>8.1. Démarrer d'un CD amorçable</h3></div></div></div><p>

      La plupart des machines modernes sont capables de démarrer à 
      partir d'un CD, à condition qu'il soit rendu amorçable par 
      procédure indiquée dans la section <a href="#creer-l-image-iso">créer des images iso</a>. Souvent, néanmoins, vous aurez 
      besoin de changer le paramétrage du BIOS pour permettre le 
      démarrage à partir du lecteur de CD. Référez-vous à la 
      documentation de votre carte-mère pour savoir comment le faire.

    </p></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="other-distributions"></a>9. Autres distributions Linux</h2></div></div></div><p>

    Les informations concernant les versions inférieures ou égales à la 
    version 6.1, présentes dans les précédentes versions de ce 
    guide pratique (≤ 1.34) et reprises dans le présent 
    document, sont supposées s'appliquer à toutes les distributions 
    clones de la RedHat, telle que la distribution <a href="http://www.linux-mandrake.com/fr/" target="_top">Mandrake</a>. Malgré 
    tout, cette procédure n'a pas été vérifiée [pour d'autres 
    distributions] (comme vous pouvez le lire dans le guide pratique 
    lui-même).

  </p><p>

    C'est en gros la même chose pour la distribution <a href="http://www.linuxppc.org" target="_top">LinuxPPC</a> pour les PowerMac 
    d'Apple. Pour créer une distribution pour la plate-forme PowerMac, 
    vous devrez utiliser <a href="http://rufus.w3.org/linux/RPM/mkhybrid.html" target="_top">mkhybrid</a> à 
    la place de <tt class="filename">mkisofs</tt> et ce devrait être la seule 
    différence.

  </p><p>

    Les informations concernant les nouvelles versions de RedHat 
    (&gt; 6.1) ne devraient pas fonctionner avec la distribution 
    Mandrake, qui dispose maintenant d'un installateur assez différent 
    de celui de RedHat. Je ne sais absolument pas s'il est possible de 
    mettre à jour les CD d'autres distributions clones de la 
    distribution RedHat de la même façon, mais je serais heureux d'en 
    être informé.

  </p></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="this-document"></a>10. Ce document…</h2></div></div></div><p>

    Le code source SGML de la plus récente version originale de ce 
    document est disponible <a href="http://www.tldp.org/HOWTO/RedHat-CD-HOWTO/RedHat-CD-HOWTO" target="_top">ici</a>.



  </p><p>

    Le code source XML de la dernière version française de ce document 
    est disponible sur le site du projet <a href="http://www.traduc.org" target="_top">Traduc.org</a> : <a href="ftp://ftp.traduc.org/pub/traduc.org/doc-vf/HOWTO/telechargement/sgml/" target="_top">ftp://ftp.traduc.org/pub/traduc.org/doc-vf/HOWTO/telechargement/sgml/</a>.

  </p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="references"></a>10.1. Documents connexes</h3></div></div></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="id2517587"></a>10.1.1. 
          Documentation relatifs à la version actuelle
      </h4></div></div></div><p> 
  
        Les documents suivants ont été utiles pour la création de ce
        guide pratique :
  
      </p><p>

        Le « <span class="quote">Petit guide (non officiel) de personnalisation de 
        l'installateur de la Redhat 7</span> » de Tony Nugent. Ce 
        document est très intéressant et utile. Donc, si vous pensez 
        sérieusement construire des CD personnalisés, je vous suggère 
        fortement de le lire. Vous le trouverez sur <a href="http://www.linuxworks.com.au/redhat-installer-howto.html" target="_top">www.linuxworks.com.au</a>.

      </p><p>

        Miguel Freitas a écrit le « <span class="quote">Petit guide des CD 
        RedHat 7</span> », que vous pourrez lire sur ce <a href="http://cambuca.ldhs.cetuc.puc-rio.br/RedHat7-CDs-HowTo.html" target="_top">site 
        web</a>.

      </p><p>

        Ron Yorston a écrit le document <a href="http://www.tigress.co.uk/rmy/rh62/rpmhack.html" target="_top">rpmhack</a>, 
        qui est intéressant pour la version 6.2 du Linux RedHat.

      </p><p>

        Quelqu'un (je n'ai pas trouvé son nom) a écrit le document 
        <a href="http://www.scyld.com/~pzb/rhcd.html" target="_top">Construire un 
        CDROM Linux Red Hat 6.2</a>, utile pour la version 6.2.

      </p></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="id2517667"></a>10.1.2. Documentation relative à l'édition précédente</h4></div></div></div><p>

        Avec le sens des bonnes choses de la vie, Jussi Torhonen de 
        Finlande
        
        <tt class="email">&lt;<a href="mailto:jussi%20POINT%20torhonen%20CHEZ%20tietosavo%20POINT%20fi">jussi POINT torhonen CHEZ tietosavo POINT fi</a>&gt;</tt>
        
        nous dit <a href="http://www.iwn.fi/~jt/cd/" target="_top">comment créer un
        CD-ROM RedHat Linux 5.2 amorçable fait-à-la-maison</a>.

      </p><p>

        Consultez aussi le <a href="http://www.traduc.org/docs/howto/lecture/CD-Writing-HOWTO.html" target="_top">« <span class="quote">Guide pratique de la 
        gravure de CD</span> »</a> du projet de documentation Linux 
        (LDP).

      </p></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2517735"></a>10.2. Remerciements</h3></div></div></div><p>

      À part les personnes mentionnées ci-dessus, je remercie les 
      personnes suivantes pour leurs informations précieuses, 
      commentaires, discussions et cætera :

    </p><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="id2517746"></a>10.2.1. Remerciement pour la version actuelle</h4></div></div></div><p>
        </p><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>
              Morten Kjeldgaard,
              
              <tt class="email">&lt;<a href="mailto:mok%20CHEZ%20imsb%20POINT%20au%20POINT%20dk">mok CHEZ imsb POINT au POINT dk</a>&gt;</tt>
              
          </p></li><li style="list-style-type: circle"><p>
          
              Peter von der Ahé,
              
              <tt class="email">&lt;<a href="mailto:pahe+rhcd%20CHEZ%20daimi%20POINT%20au%20POINT%20dk">pahe+rhcd CHEZ daimi POINT au POINT dk</a>&gt;</tt>
              
          </p></li><li style="list-style-type: circle"><p>
          
              Giulia Tomaselli
              
          </p></li><li style="list-style-type: circle"><p>
              
              Jacinta Conneely
              
          </p></li><li style="list-style-type: circle"><p>
              
              Filippo Carcaci
              
          </p></li><li style="list-style-type: circle"><p>
          
              Guillaume Lelarge
              
              <tt class="email">&lt;<a href="mailto:gleu%20CHEZ%20wanadoo%20POINT%20fr">gleu CHEZ wanadoo POINT fr</a>&gt;</tt>
              
          </p></li><li style="list-style-type: circle"><p>
          
              Alain Portal
              
              <tt class="email">&lt;<a href="mailto:aportal%20CHEZ%20univ-montp2%20POINT%20fr">aportal CHEZ univ-montp2 POINT fr</a>&gt;</tt>
           
          </p></li><li style="list-style-type: circle"><p>
              
              Toutes les personnes des listes de discussion
              anaconda-devel et kickstart
              
          </p></li></ul></div><p>
      </p></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="id2517846"></a>10.2.2. Remerciements pour les versions précédentes</h4></div></div></div><p>
        </p><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>
    
            Lars Christensen
            
            <tt class="email">&lt;<a href="mailto:larsch%20CHEZ%20cs%20POINT%20auc%20POINT%20dk">larsch CHEZ cs POINT auc POINT dk</a>&gt;</tt>
    
          </p></li><li style="list-style-type: circle"><p>
          
              Thomas Duffy
              
              <tt class="email">&lt;<a href="mailto:tbd%20CHEZ%20cs%20POINT%20brown%20POINT%20edu">tbd CHEZ cs POINT brown POINT edu</a>&gt;</tt>
              
          </p></li><li style="list-style-type: circle"><p>
          
              Dawn Endico
              
              <tt class="email">&lt;<a href="mailto:dawn%20CHEZ%20math%20POINT%20wayne%20POINT%20edu">dawn CHEZ math POINT wayne POINT edu</a>&gt;</tt>
          
          </p></li><li style="list-style-type: circle"><p>
              
              Seva
              
              <tt class="email">&lt;<a href="mailto:seva%20CHEZ%20null%20POINT%20cc%20POINT%20uic%20POINT%20edu">seva CHEZ null POINT cc POINT uic POINT edu</a>&gt;</tt>
              
          </p></li><li style="list-style-type: circle"><p>
              
              Michael Thomas Cope
              
              <tt class="email">&lt;<a href="mailto:mcope%20CHEZ%20orion%20POINT%20ac%20POINT%20hmc%20POINT%20edu">mcope CHEZ orion POINT ac POINT hmc POINT edu</a>&gt;</tt>
              
          </p></li><li style="list-style-type: circle"><p>
          
              Charles J. Fisher
              
              <tt class="email">&lt;<a href="mailto:charles_fisher%20CHEZ%20bigfoot%20POINT%20com">charles_fisher CHEZ bigfoot POINT com</a>&gt;</tt>
              
          </p></li><li style="list-style-type: circle"><p>
              
              Eric Thomas
              
              <tt class="email">&lt;<a href="mailto:eric%20POINT%20thomas%20CHEZ%20ericsson%20POINT%20com">eric POINT thomas CHEZ ericsson POINT com</a>&gt;</tt>
          
          </p></li><li style="list-style-type: circle"><p>
          
              Gordon Yuen
              
              <tt class="email">&lt;<a href="mailto:gdccyuen%20CHEZ%20yahoo%20POINT%20com">gdccyuen CHEZ yahoo POINT com</a>&gt;</tt>
              
          </p></li><li style="list-style-type: circle"><p>
              
              Dave Morse
              
              <tt class="email">&lt;<a href="mailto:morse%20CHEZ%20nichimen%20POINT%20com">morse CHEZ nichimen POINT com</a>&gt;</tt>
              
          </p></li></ul></div><p>
      </p></div></div></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="adaptation-francaise"></a>11. Adaptation française</h2></div></div></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2517973"></a>11.1. Traduction</h3></div></div></div><p>
        
        La traduction française de ce document a été réalisée 
        par Guillaume Lelarge
        
        <tt class="email">&lt;<a href="mailto:gleu%20CHEZ%20wanadoo%20POINT%20fr">gleu CHEZ wanadoo POINT fr</a>&gt;</tt>.
    
    </p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="id2517991"></a>11.2. Relecture</h3></div></div></div><p>
    
        La relecture de ce document a été réalisée par Guillaume Hatt

        <tt class="email">&lt;<a href="mailto:ghatt%20CHEZ%20netcourrier%20POINT%20com">ghatt CHEZ netcourrier POINT com</a>&gt;</tt>.
    
    </p><p>
    
        Une relecture complémentaire de ce document a été réalisée par 
        Jean-Philippe Guérard
        
        <tt class="email">&lt;<a href="mailto:fevrier%20CHEZ%20tigreraye%20POINT%20org">fevrier CHEZ tigreraye POINT org</a>&gt;</tt>.
    
    </p></div></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.id2511265" href="#id2511265">1</a>] </sup>
          
          « <span class="quote">Paquetages</span> » est le terme utilisé par RedHat pour
          parler des « <span class="quote">paquets</span> », c'est-à-dire des formats
          d'archive utilisés pour distribuer des applications et
          incluant tout ce qui est nécessaire à l'installation, à la
          désinstallation et au fonctionnement de cette application.
          
        </p></div><div class="footnote"><p><sup>[<a name="ftn.id2514260" href="#id2514260">2</a>] </sup>
        
        Vous pourrez trouver ces listes dans la section des <a href="https://listman.redhat.com/mailman/listinfo" target="_top">listes de
        discussion</a> du site web de RedHat.
        
        </p></div></div></div></body></html>
