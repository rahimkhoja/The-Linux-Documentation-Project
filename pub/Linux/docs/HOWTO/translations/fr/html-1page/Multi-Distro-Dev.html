<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Petit guide du développement multi-distributions</title><link rel="stylesheet" href="style.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.1"/><meta name="description" content="Ce document décrit un bricolage rapide destiné à faciliter le développement et les tests de programmes tournant dans l'espace utilisateurs pour différentes distributions Linux."/></head><body><div xml:lang="fr" class="article" title="Petit guide du développement multi-distributions"><div class="titlepage"><div><div><h2 class="title"><a xmlns:saxon="http://icl.com/saxon" id="Developement-multi-distrib"/>
    
        Petit guide du développement multi-distributions
    
    </h2></div><div><h3 class="subtitle"><i>
        
        Traduction française du <span class="foreignphrase"><em class="foreignphrase">Development for Multiple 
        Linux Distributions mini-HOWTO</em></span>
    
    </i></h3></div><div><div class="author"><h3 class="author"><span class="firstname">Ed</span> <span class="surname">Hill</span></h3><code class="email">&lt;<a class="email" href="mailto:ed CHEZ eh3 POINT com">ed CHEZ eh3 POINT com</a>&gt;</code></div></div><div><p class="othercredit"><span class="contrib">Adaptation française</span> : <span class="firstname">Joan</span> <span class="surname">Goutte</span></p></div><div><p class="othercredit"><span class="contrib">Relecture de la version française</span> : <span class="firstname">Dorian</span> <span class="surname">Musso</span>, <span class="firstname">Simon</span> <span class="surname">Depiets</span></p></div><div/><div><p class="othercredit"><span class="contrib">Préparation de la publication de la v.f.</span> : <span class="firstname">Jean-Philippe</span> <span class="surname">Guérard</span></p></div><div><p class="releaseinfo">Version : 0.9.1.fr.1.0</p></div><div><p class="pubdate">2004-03-11</p></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="3"><b>Historique des versions</b></th></tr><tr><td align="left">Version 0.9.1.fr.1.0</td><td align="left">2004-03-11</td><td align="left">JG, DM, SD, JPG</td></tr><tr><td align="left" colspan="3">Traduction française</td></tr><tr><td align="left">Version 0.9.1</td><td align="left">2002-08-14</td><td align="left">EH3</td></tr><tr><td align="left" colspan="3">
	    
	    Petite mise à jour pour l'utilisation de X11 (sockets).
	    <span class="emphasis"><em>Small update for using X11
	    (sockets).</em></span>
	    
	</td></tr><tr><td align="left">Version 0.9</td><td align="left">2001-12-03</td><td align="left">EH3</td></tr><tr><td align="left" colspan="3">
	
	    Version initiale. <span class="emphasis"><em>Initial
	    version.</em></span>
	
	</td></tr></table></div></div><div><div class="abstract" title="Résumé"><p class="title"><b>Résumé</b></p><p>
        
        Ce document décrit un bricolage rapide destiné à faciliter le
        développement et les tests de programmes tournant dans l'espace
        utilisateurs pour différentes distributions Linux.
    
    </p></div></div></div><hr/></div><div class="toc"><p><b>Table des matières</b></p><dl><dt><span class="section"><a href="#Introduction">1. Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#droits-d-utilisation">1.1. Droits d'utilisation</a></span></dt><dt><span class="section"><a href="#commentaires">1.2. Commentaires et corrections</a></span></dt></dl></dd><dt><span class="section"><a href="#installation">2. Installation</a></span></dt><dt><span class="section"><a href="#utilisation">3. 
    
        Utiliser les distributions secondaires
    
    </a></span></dt><dt><span class="section"><a href="#remerciements">4. Remerciements</a></span></dt></dl></div><div class="section" title="1. Introduction"><div class="titlepage"><div><div><h2 class="title"><a xmlns:saxon="http://icl.com/saxon" id="Introduction"/>1. Introduction</h2></div></div></div><p>
          
        Lors du développement d'une application, il est parfois
        nécessaire de programmer ou de tester des programmes sur
        différentes distributions Linux. Ce petit guide trace les
        grandes lignes d'une utilisation élégante de
        <span class="command"><strong>chroot</strong></span> qui peut, dans bien des cas, éviter de
        redémarrer sous différentes distribution Linux pour réaliser des
        tests ou des développements.
          
    </p><p>
        
        En quelques mots, l'astuce consiste à placer tous les fichiers
        d'une certaine distribution dans un simple répertoire et de
        faire un <span class="command"><strong>chroot</strong></span><sup>[<a id="d0e118" href="#ftn.d0e118" class="footnote">1</a>]</sup>
        
        vers l'intérieur de ce répertoire. Vous vous retrouverez ainsi
        dans un environnement d'exécution restreint qui vous permettra
        de développer, tester ou rechercher les erreurs de votre
        programme dans le contexte qui vous intéresse. Cette méthode
        fonctionnera à condition que :
        
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
    
        la version du noyau de la distribution « principale »
        (ou « primaire ») que vous exécutez soit (un minimum)
        compatible avec la distribution « secondaire »,
        c'est-à-dire la distribution exécutée en environnement
        restreint ;
    
    </p></li><li class="listitem"><p>
    
        votre application tourne principalement dans l'espace
        utilisateur (i. e. : ne soit pas un module du noyau) et ne
        dépende pas intimement d'un dispositif particulier du noyau (i.
        e. : du comportement de <code class="filename">/proc</code>).

    </p></li></ol></div><div class="section" title="1.1. Droits d'utilisation"><div class="titlepage"><div><div><h3 class="title"><a xmlns:saxon="http://icl.com/saxon" id="droits-d-utilisation"/>1.1. Droits d'utilisation</h3></div></div></div><p>
          Copyright © 2001 Ed Hill III.
      </p><p>
          Copyright © 2004 Joan Goutte, Dorian Musso, Simon Depiets 
          et Jean-Philippe Guérard pour la version française.
      </p><p>
          
          Vous pouvez redistribuer et modifier ce document selon les
          termes de la Licence de documentation libre GNU (FDL) (version
          1.1 ou toute version ultérieure publiée par la Free Software
          Foundation), sans section invariante, ni texte de première ou
          de quatrième de couverture. Une copie de cette licence est
          accessible sur <a class="ulink" href="http://www.gnu.org/copyleft/fdl.html" target="_top">http://www.gnu.org/copyleft/fdl.html</a>.

      </p><p><span class="foreignphrase"><em class="foreignphrase">
      
          Permission is granted to copy, distribute and/or modify this
          document under the terms of the GNU Free Documentation
          License, Version 1.1 or any later version published by the
          Free Software Foundation; with no Invariant Sections, with no
          Front-Cover Texts, and with no Back-Cover Texts. A copy of the
          license is available at <a class="ulink" href="http://www.gnu.org/copyleft/fdl.html" target="_top">http://www.gnu.org/copyleft/fdl.html</a>.
      
      </em></span></p></div><div class="section" title="1.2. Commentaires et corrections"><div class="titlepage"><div><div><h3 class="title"><a xmlns:saxon="http://icl.com/saxon" id="commentaires"/>1.2. Commentaires et corrections</h3></div></div></div><p>
      
          Ce document a été traduit dans le cadre du projet 
          <a class="ulink" href="http://www.traduc.org" target="_top">traduc.org</a>. 
          N'hésitez pas à faire parvenir vos commentaires, corrections 
          et suggestions d'améliorations à
          <code class="email">&lt;<a class="email" href="mailto:commentaires CHEZ traduc POINT org">commentaires CHEZ traduc POINT org</a>&gt;</code>.
      
      </p></div></div><div class="section" title="2. Installation"><div class="titlepage"><div><div><h2 class="title"><a xmlns:saxon="http://icl.com/saxon" id="installation"/>2. Installation</h2></div></div></div><p>
    
        Nous supposerons que vous avez déjà :
    
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>

        une distribution Linux « principale » (ou
        « primaire ») installée avec un noyau 2.4 ou
        supérieur ;
        
    </p></li><li class="listitem"><p>
    
        une partition libre de 2 à 4 Go ;
    
    </p></li><li class="listitem"><p>
    
        suffisamment d'espace disque pour l'installation des
        distributions secondaires (et pour les travaux de
        développement et de test en découlant).
        
    </p></li></ol></div><p>
    
        Partant de ces hypothèses, voici les grandes lignes de l'une des
        solutions permettant d'installer plusieurs distributions
        secondaires qui seront utilisées pour des développements, des
        tests, ou d'autres choses :
        
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
    
        Premièrement, créez ou allouez une partition non utilisée de
        votre disque dur qui soit assez grande (2 à 4 Go seront en
        général suffisants) pour faire une installation de base de l'une
        des distributions Linux secondaires.
        
    </p></li><li class="listitem"><p><a xmlns:saxon="http://icl.com/saxon" id="installez"/>
    
        Installez la distribution secondaire sur cette partition mais ne
        l'ajoutez pas à votre configuration de démarrage. Notez que
        cette installation a seulement besoin d'inclure les paquets que
        votre application (ou votre essai) exige. Par exemple, il est
        possible que vous puissiez vous passez d'installer des
        applications très gourmandes en espaces telles que le serveur X.
    
    </p></li><li class="listitem"><p><a xmlns:saxon="http://icl.com/saxon" id="copiez"/>
        
        Redémarrez votre distribution Linux principale et montez la
        partition contenant la distribution fraîchement installée. 
        Copiez (de préférence en utilisant <code class="filename">tar -cp</code>
        ou une autre méthode conservant les droits) tous les fichiers de
        la distribution secondaire vers une destination telle que <code class="filename">/opt/distributions/<em class="replaceable"><code>NOM_DE_LA_DISTRIBUTION</code></em></code>.
        
    </p></li><li class="listitem"><p>

        Répétez les étapes <a class="xref" href="#installez">2</a> et <a class="xref" href="#copiez">3</a> pour toutes les distributions
        supplémentaires que vous souhaitez installer. Au bout du compte,
        vous devriez obtenir une structure de répertoires ressemblant à
        celle-ci :

    </p><pre class="programlisting">
/opt/distributions/redhat_6.2/
                   suse_7.2/
                   mandrake_8.1/
                   debian-potato/
                   slackware_8.0/
</pre><p>
    
        où chaque répertoire contient la totalité des fichiers issus de 
        l'installation de chaque distribution.

    </p></li></ol></div></div><div class="section" title="3.  Utiliser les distributions secondaires"><div class="titlepage"><div><div><h2 class="title"><a xmlns:saxon="http://icl.com/saxon" id="utilisation"/>3. 
    
        Utiliser les distributions secondaires
    
    </h2></div></div></div><p>
        
        Une fois les distributions secondaires installées, les étapes à
        suivre pour les utiliser sont :
    
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
    
        Il est important que la distribution Linux principale utilise un
        noyau Linux 2.4 ou plus récent, afin de profiter des
        possibilités de points de montage multiples qu'offrent ces
        noyaux. Pour de nombreuses tâches, les systèmes de fichiers
        <code class="filename">/proc</code> et <code class="filename">/tmp</code> devront être montés à nouveau
        dans la distribution secondaire en utilisant :
        
    </p><pre class="programlisting">
mount --bind /proc /opt/distributions/redhat_6.2/proc
mount --bind /tmp /opt/distributions/redhat_6.2/tmp
</pre></li><li class="listitem"><p>
    
        Aussi, il peut être utile de réaliser un nouveau montage (au
        lieu de la copier) de l'arborescence des sources de la première
        distribution dans la distribution secondaire :
        
    </p><pre class="programlisting">
mount --bind /home/<em class="replaceable"><code>UTILISATEUR</code></em>/src/<em class="replaceable"><code>PROJET</code></em> \
    /opt/distributions/redhat_6.2/home/<em class="replaceable"><code>UTILISATEUR</code></em>/src/<em class="replaceable"><code>PROJET</code></em>
</pre></li><li class="listitem"><p>
    
        Connectez-vous sous le compte <code class="literal">root</code> et
        faites :

    </p><pre class="programlisting">
xhost +localhost chroot /opt/distributions/redhat_6.2 /bin/bash
</pre><p>
        
        pour obtenir un interpréteur de commandes
        (<span class="foreignphrase"><em class="foreignphrase">shell</em></span>) dans l'une des
        distributions secondaires. Notez que la commande
        <span class="command"><strong>xhost</strong></span> n'est utile que si vous avez
        l'intention d'utiliser des applications X.
        
    </p></li><li class="listitem"><p>
	
        Enfin (si nécessaire) créez un utilisateur dans l'environnement
        restreint. Vous pouvez maintenant développer, construire ou
        tester votre application dans cette distribution Linux
        « séparée » ! Notez que vous aurez également à
        définir la variable d'environnement <code class="literal">DISPLAY</code>
        si vous désirez utiliser des applications X.
 
    </p></li></ol></div><p>
        
        Bien ! Vous disposez maintenant d'un interpréteur de 
        commandes que vous pouvez, à toutes fins utiles, exécuter sous 
        la distribution Linux secondaire de votre choix.
        
    </p></div><div class="section" title="4. Remerciements"><div class="titlepage"><div><div><h2 class="title"><a xmlns:saxon="http://icl.com/saxon" id="remerciements"/>4. Remerciements</h2></div></div></div><p>
        
        Je ne suis pas à l'origine des idées présentées dans ce petit
        guide. Elles ont été recueillies dans des messages de Ben Reed
        (de <a class="ulink" href="http://www.opennms.org/" target="_top">OpenNMS</a>) pour
        l'une des listes de discussions du groupe d'utilisateurs de
        Linux <a class="ulink" href="http://www.trilug.org/" target="_top">TriLUG</a>. J'ai
        trouvé que ces informations pouvaient être très utiles et j'ai
        voulu documenter ces idées pour les autres.
        
    </p></div><div class="footnotes"><br/><hr width="100" align="left"/><div class="footnote"><p><sup>[<a id="ftn.d0e118" href="#d0e118" class="para">1</a>] </sup> La commande <span class="command"><strong>chroot</strong></span> permet d'exécuter
        une commande ou un interpréteur de commandes en utilisant un
        répertoire racine différent. On parle d'une commande exécutée
        dans un <em class="firstterm">environnement d'exécution
        restreint.</em> </p></div></div></div></body></html>