<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
  "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY howto      "http://www.traduc.org/docs/howto/lecture/">
<!ENTITY guide      "http://www.traduc.org/docs/guides/lecture/">
]>

<article lang="fr">

<articleinfo>

<title>
Petit guide d'économie de l'espace disque
</title>

<subtitle>
    
Version française du <foreignphrase lang="en">Saving Space
mini-HOWTO</foreignphrase>
                
</subtitle>

<releaseinfo>Version&nbsp;: 1.1.fr.1.0</releaseinfo>  

<pubdate>23 janvier 2005</pubdate>

<author>
     <firstname>Guido</firstname>
     <surname>Gonzato</surname>
     <email>guido CHEZ ibogeo POINT df POINT unibo POINT it</email>
</author>

<othercredit role="traduction" class="translator">
     <firstname>Simon</firstname>
     <surname>Depiets</surname>
     <contrib>Adaptation française</contrib>
     <email>2df CHEZ tuxfamily POINT org</email>
 </othercredit>

<othercredit role="relecture" class="translator">
    <firstname>Bernard</firstname>
    <surname>Adrian</surname>
    <contrib>Relecture de la version française</contrib>
    <email>bernadrian CHEZ free POINT fr</email>
</othercredit>

<othercredit role="relecture" class="translator">
    <firstname>Éric</firstname>
    <surname>Madesclair</surname>
    <contrib>Relecture de la version française</contrib>
    <email>eric TIRET m CHEZ wanadoo POINT fr</email>
</othercredit>

<othercredit role="publication" class="copyeditor">
    <firstname>Jean-Philippe</firstname>
    <surname>Guérard</surname>
    <contrib>Préparation de la publication de la v.f.</contrib>
    <email>fevrier CHEZ tigreraye POINT org</email>
</othercredit>

<abstract><para>

Ce petit guide explique comment installer Linux pour qu'il occupe le 
moins d'espace disque possible. Ce qui sera particulièrement utile pour 
les possesseurs d'ordinateurs portables.

</para></abstract>

    <date>2005-01-23</date>

  <revhistory>

    <revision>
      <revnumber>1.1.fr.1.0</revnumber>
      <date>2005-01-23</date>
      <authorinitials>SD, ÉM, BA, JPG</authorinitials>
      <revremark>Première traduction française.</revremark>
    </revision>

    <revision>
      <revnumber>1.1</revnumber>
      <date>1999-04-07</date>
      <authorinitials>GG</authorinitials>
    </revision>

  </revhistory>

</articleinfo>

<sect1>
  <title>
      Commentaires et corrections
  </title>

  <para>

       Merci de faire parvenir en anglais à l'auteur vos questions
       et commentaires relatifs à la version originale de ce
       document à l'adresse

       <email>guido CHEZ ibogeo POINT df POINT unibo POINT it</email>.

  </para>
  <para>

      N'hésitez pas à faire parvenir tout commentaire relatif à
      la version française de ce document à

      <email>commentaires CHEZ traduc POINT org</email>

      en précisant son titre, sa date et sa version.

  </para>
</sect1>

<sect1>

  <title>
      Nouvelles versions de ce document
  </title>

  <para>

      Vous trouverez la plus récente version française de ce document à
      l'adresse&nbsp;: <ulink url="&howto;Saving-Space.html"/>.

  </para>

  <para>
      
      La plus récente version originale de ce document est disponible à
      l'adresse&nbsp;: <ulink
        url="http://www.tldp.org/HOWTO/Saving-Space"/>.
  
  </para>
</sect1>

<sect1> 
  <title>
    Introduction
  </title>
  <para>

    J'ai un portable pré-installé avec Windows 95 sur lequel j'ai 
    installé Linux. Windows a été réinstallé sur une partition de 
    500&nbsp;Mo, libérant de l'espace pour créer une partition Linux de 
    240&nbsp;Mo. Même si cela paraît peu, j'ai trouvé moyen d'installer 
    un système Linux complet, basé sur la distribution Red Hat 4.1 et, 
    avec un peu de magie, j'ai économisé le maximum d'espace.
    

  </para>
  <para>

    Si vous avez besoin d'espace, les indications que vous trouverez
    dans les sections suivantes économiseront un espace considérable sur
    le disque dur. Le seul avertissement que je peux vous donner
    est&nbsp;: ne me blâmez pas si quelque chose ne fonctionne
    pas&nbsp;!  Nous utiliserons certains programmes qui ont fonctionné
    pour moi, mais cela peut être dangereux. Vous êtes prévenu.

  </para>
</sect1>

<sect1>
  <title>
    Logiciels nécessaires
  </title>
  <para>
    Vous aurez besoin de&nbsp;:
  </para>
  <itemizedlist>
    <listitem><para>

        un système Linux fonctionnant (n'importe quelle version devrait
        convenir)&nbsp;;

      </para>
    </listitem>
    <listitem>
      <para>

        l'utilitaire de compression <application>gzip</application>, ou
        éventuellement <application>bzip2</application> que vous pouvez
        trouver à l'adresse suivante <ulink url="ftp://sunsite.unc.edu:/pub/Linux/utils/compress"></ulink>&nbsp;;
        cet outil est plus performant que <application>gzip</application>, mais est aussi un peu plus lent
        et consomme beaucoup de mémoire&nbsp;;

      </para>
    </listitem>
    <listitem>
      <para>

        D'<application>upx</application> un utilitaire de compression pour exécutables, dont
        la page web se trouve à l'url&nbsp;<ulink url="http://upx.sourceforge.net/"></ulink>&nbsp;;

      </para>
    </listitem>
    <listitem>
      <para>

        le paquet <application>zlibc</application>, disponible à l'url <ulink
        url="ftp://sunsite.unc.edu:/pub/Linux/libs/compression"></ulink>. 
        Il est appelé <filename>zlibc-X.X.tar.gz</filename>, où
        <quote>X.X</quote> est le numéro de la dernière version.

      </para>
    </listitem>
  </itemizedlist>
  <para>

    Il existe d'autres utilitaires de compression pour exécutables. L'un 
    deux est <application>gzexe</application>, tandis que 
    <application>tcx</application> était probablement le meilleur avant 
    le développement d'<application>upx</application>&nbsp;; il y a aussi 
    <application>tzx</application>, qui est, en théorie, meilleur que 
    <application>tcx</application>. Cependant, j'ai tout détruit lorsque 
    je l'ai essayé sur un ordinateur de rechange, bien que je ne soit 
    pas sûr d'avoir fait une erreur quelque part. Vous devriez utiliser 
    <application>upx</application>&nbsp;: il est sûr, efficace et très 
    pratique.

  </para>
  <para>

    Il y a des correctifs du noyau qui proposent une compression du 
    système de fichiers à la Stacker, mais, au moment ou j'écris ces 
    lignes, aucun n'a une réputation de stabilité ou de sécurité.

  </para>
</sect1>
<sect1>
  <title>
    La procédure
  </title>
  <sect2>
    <title>
      Supprimer les sources du noyau
    </title>
    <para>

      Les sources du noyau prennent plus de 20&nbsp;Mo, et vous pouvez
      vouloir les supprimer. Si c'est le cas, je vous suggère de
      compiler un nouveau noyau qui convient à votre machine une fois
      pour toutes, et de se débarrasser des sources. Faites attention,
      néanmoins.

    </para>
    <para>

      Il n'est <emphasis>pas</emphasis> recommandé de supprimer les
      sources du noyau à moins que vous ne soyez sûr que votre machine
      soit correctement configurée. De plus vous aurez besoin des
      fichiers entêtes du noyau pour la compilation de programme en C. 
      Réfléchissez-y à deux fois&nbsp;!

    </para>
    <para>

      Si vous décidez d'enlever les sources, ne supprimez <emphasis>pas</emphasis>
      l'arborescence <filename>include/linux</filename> à moins que vous
      ne soyez sûr de ne plus jamais compiler d'applications sur votre
      ordinateur.

    </para>
  </sect2>
  <sect2>
    <title>
      Trier les applications
    </title>
    <para>

      Maintenant décidez de quelles applications vous avez
      <emphasis>vraiment</emphasis> besoin. Certaines peuvent être
      redondantes&nbsp;: par exemple, êtes vous sûr que vous ne pouvez
      pas vivre sans <application>Emacs</application>&nbsp;? Vous pouvez
      utiliser <application>Vim</application> à la place.

    </para>
    <para>

    C'est à vous de décider ce que vous voulez garder. Voici quelques
    idées générales&nbsp;:

    </para>
    <itemizedlist>
      <listitem><para>

          le paquet <application>gcc</application> est un assez gros
          paquet.  Il est nécessaire pour recompiler le noyau et toutes
          les applications pour lesquelles il n'y a pas de binaires
          Linux pré-compilés. Il est aussi nécessaire, bien sûr, si vous
          écrivez vos propres programmes C ou Fortran
          (avec <application>f2c</application> ou
          <application>g77</application>)&nbsp;; considérez vos besoins
          avant de le supprimer. D'autres compilateurs comme
          <application>lcc</application> sont efficaces, mais pas du
          niveau de <application>gcc</application>. Je vous suggère de
          le garder&nbsp;;

      </para></listitem>
      <listitem><para>
          
          X11 est énorme, mais il est agréable de l'avoir. Si vous
          décidez que vous ne pouvez pas vous en passez, essayez au
          moins de ne garder que ce qui est nécessaire&nbsp;: uniquement le
          serveur X correspondant à votre carte, un simple gestionnaire de fenêtres,
          un <application>xterm</application>, pas de polices 100 dpi, et
          cætera&nbsp;;
          
      </para></listitem>
      <listitem><para>

          TeX et les paquets l'accompagnant sont aussi très gros.
          Utilisez TeX à la place de LaTeX, vous permettra d'économiser
          beaucoup d'espace&nbsp;; ne pas utiliser les visionneuses X11
          telles <application>xdvi</application> et
          <application>ghostview</application> est possible si vous
          utilisez <application>dvitty</application>,
          <application>dvivga</application> ou d'autres. Éliminer le
          besoin pour X11 dviware peut même rendre X11 redondant&nbsp;;

      </para></listitem>
      <listitem><para>
          les jeux ne sont jamais <quote>nécessaires</quote>
      </para></listitem>
    </itemizedlist>
  </sect2>
  <sect2>
    <title>
      Alléger les binaires
    </title>
    <para>

      Réduisons la taille des binaires. Déplacez-vous vers <filename>/usr/bin</filename> 
	  et saisissez la commande&nbsp;:

    </para>

<synopsis>
machine:/usr/bin# strip *
</synopsis>

    <para>

      ce qui supprimera les symboles contenus dans les binaires. Répétez
      cette étape dans <filename>/usr/X11R6/bin/</filename> et les
      autres dossiers contenant des exécutables (n'oubliez pas de
      localiser les binaires TeX et <application>gcc</application>),
      mais ne lancez <emphasis>pas</emphasis> cette commande dans
      <filename>/sbin</filename>, <filename>/bin</filename>, ou
      <filename>/usr/sbin/</filename> votre installation est en
      jeu&nbsp;!

    </para>
  </sect2>
  <sect2>
    <title>
      Compression avec <application>upx</application>
    </title>
    <para>
    
      Tout d'abord, installez <application>upx</application> et lisez sa
      documentation. Puis allez dans <filename>/usr/bin</filename> et
      lancez la commande <userinput>upx *</userinput>&nbsp;; cela
      compressera tous les exécutables, même les suid
      (<application>tcx</application> ne le ferait pas). Répétez cette
      étape dans tous les autres dossiers comme ci-dessus.
    
    </para>
    <para>

      N'oubliez pas de compresser les exécutables à chaque fois que vous
      installez un nouveau paquet&nbsp;!

    </para>
  </sect2>
  <sect2>
    <title>
      Compresser de tous les côtés
    </title>
    <para>
    
      Il y a beaucoup d'autres fichiers pouvant être compressés une fois
      pour toutes.  Commençons par <filename>/usr/doc/</filename>&nbsp;;
      allez dans ce dossier et saisissez la commande&nbsp;:
    
    </para>
<synopsis>
machine:/usr/doc# find . -type f -exec gzip -9 {} \; 2> /dev/null
</synopsis>
    <para>
    
      N'oubliez pas de compresser la documentation à chaque fois que
      vous installez un nouveau paquet&nbsp;!
    
    </para>
    <para>

      Répétez cette étape dans le dossier contenant la documentation
      pour TeX (sur mon système,
      <filename>/usr/lib/texmf/texmf/doc/</filename>). Si vous êtes
      <emphasis>vraiment</emphasis> sûr de vous, vous pouvez aussi
      supprimer ces dossiers.

    </para>
    <para>

      Maintenant, installez <application>zlibc</application> et compilez
      le. Si votre système est comme le mien, le processus de
      compilation s'annulera à cause d'une libc manquante.  Ce n'est pas
      grave, vous trouverez un fichier <filename>uncompress.o</filename>
      et c'est celui dont nous avons besoin. Déplacez-le vers
      <filename>/usr/local/lib/</filename> et ajoutez cette ligne dans
      le fichier <filename>/etc/profile</filename>&nbsp;:

    </para>
<synopsis>
export LD_ELF_PRELOAD=/usr/local/lib/uncompress.o
</synopsis>
    <para>

      Maintenant, vous pouvez compresser avec
      <application>gzip</application> non seulement la documentation,
      mais aussi les fichiers de données&nbsp;: les applications qui les
      utilisent pourront néanmoins les utiliser. En théorie, cette
      astuce devrait fonctionner avec la plupart des applications, mais
      en pratique votre degré de succès peut varier.  Le mien ne fut pas
      impressionnant.

    </para>
  </sect2>
</sect1>
<sect1>
  <title>
    Un exemple
  </title>
  <para>

    Voici ce que j'ai obtenu en appliquant la procédure ci-dessus sur un
    de mes ordinateurs. Avant le traitement,
    <application>df</application> a compté que j'utilisais 398 798 blocs
    de 1024&nbsp;:

  </para>
  <itemizedlist>
    <listitem><para>

        Je n'ai pas supprimé les sources du noyau ni les entêtes&nbsp;;

    </para></listitem>
    <listitem><para>

        J'ai désinstallé beaucoup d'applications et tous les jeux, mais
        j'ai laissé, X11, X11 devel, C et Fortran devel, Tcl/Tk, les
        outils réseau, et quelques autres applications standards.
        <application>df</application> a compté 244 668 blocs
        utilisés&nbsp;;

    </para></listitem>
    <listitem><para>

        J'ai lancé <application>upx</application> sur
        <filename>/usr/bin</filename>,
        <filename>/usr/X11R6/bin</filename>,
        <filename>/usr/lib/texmf/bin/i586-linux</filename> et
        <filename>/usr/lib/gcc-lib/i386-linux/2.7.2.1</filename>. 226
        270 blocs utilisés&nbsp;;

    </para></listitem>
    <listitem><para>

        J'ai compressé la documentation contenue dans
        <filename>/usr/doc</filename> et
        <filename>/usr/lib/texmf/texmf/doc</filename>: 198 745 blocs
        utilisés.

    </para></listitem>
  </itemizedlist>
  <para>

    Pour résumer, j'ai commencé avec 398&nbsp;798&nbsp;blocs et terminé
    avec 198&nbsp;745. Pensez à tout ce que vous pouvez mettre dans ces
    200&nbsp;000&nbsp;blocs économisés&nbsp;! J'en aurait même sauvé
    plus si j'avais utilisé <application>bzip2</application> à la place
    de <application>gzip</application>.

  </para>
  <para>

    En moyenne, si vous faites attention depuis le début et que vous
    n'installez que les applications nécessaires, compresser les
    exécutables et la documentation vous économiserez environ 20&nbsp;Mo. 
    Sur un portable, cela peut être énorme.

  </para>
</sect1>
  <sect1> 
    <title>
      Droits d'utilisation et informations légales
    </title>

    <para>
      Copyright &copy; 2001 Guido Gonzato pour la version originale.
    </para>
  
    <para>
    
      Copyright &copy; 2004-2005 Simon Depiets, Bernard Adrian, Éric 
      Madesclair et Jean-Philippe Guérard pour la version française.
    
    </para>
    <para>
   
      Sauf mention contraire, les guides pratiques Linux sont la
      propriété de leurs auteurs respectifs. Les guides pratiques Linux
      peuvent être reproduits en tout ou partie par tout moyen physique
      ou électronique, tant que les mentions des droits d'auteur et des
      droits d'utilisation sont conservées dans toutes les copies. La
      redistribution commerciale est permise et encouragée, mais
      l'auteur aimerait en être averti.

    </para>
    <para><foreignphrase>

      Unless otherwise stated, Linux HOWTO documents are copyrighted by
      their respective authors. Linux HOWTO documents may be reproduced
      and distributed in whole or in part, in any medium physical or
      electronic, as long as this copyright notice is retained on all
      copies. Commercial redistribution is allowed and encouraged;
      however, the author would like to be notified of any such
      distributions.

    </foreignphrase></para>
   <para>

     Toute traduction, travaux dérivés ou compilation incorporant un
     guide pratique Linux est aussi couverte par les mêmes droits
     d'auteur et conditions de distribution. De plus, vous n'êtes pas
     autorisé à réaliser un travail dérivé de ce guide pratique et à
     imposer des conditions supplémentaires à sa distribution. Des
     exceptions à ces règles peuvent être accordées sous certaines
     conditions&nbsp;; veuillez contacter le coordinateur des guides
     pratiques Linux à l'adresse donnée ci-dessous.

   </para>

   <para><foreignphrase>

     All translations, derivative works, or aggregate works
     incorporating any Linux HOWTO documents must be covered under this
     copyright notice. That is, you may not produce a derivative work
     from a HOWTO and impose additional restrictions on its
     distribution. Exceptions to these rules may be granted under
     certain conditions; please contact the Linux HOWTO coordinator at
     the address given below.

   </foreignphrase></para>

   <para>
 
     En résumé, nous souhaitons promouvoir la diffusion de ces
     informations par tous les moyens possible. Toutefois, nous tenons à
     conserver nos droits d'auteur sur ces guides pratiques et nous
     souhaiterions être informés de tout projet de redistribution.
     
   </para>

   <para><foreignphrase>
   
     In short, we wish to promote dissemination of this information
     through as many channels as possible. However, we do wish to retain
     copyright on the HOWTO documents, and would like to be notified of
     any plans to redistribute the HOWTOs.
   
   </foreignphrase></para>

   <para>
    
     Si vous avez des questions, contactez (en anglais)
     
     <email>guido CHEZ ibogeo POINT df POINT unibo POINT it</email>
    
   </para>

   <para><foreignphrase>

    If you have any questions, please contact
    
    <email>guido CHEZ ibogeo POINT df POINT unibo POINT it</email>

   </foreignphrase></para>
   <para>
   
     Ce document est fourni <quote>comme il est</quote>. J'ai fait un
     gros effort pour l'écrire aussi précisément que j'ai pu, mais vous
     utilisez les informations qui s'y trouvent à vos risque et périls.
     En aucun cas je ne pourrai être tenu pour responsable des dommages
     résultant de l'utilisation de ce travail.
   
   </para>
  <para><foreignphrase>

      This document is provided ``as is''. I put great effort into
      writing it as accurately as I could, but you use the information
      contained in it at your own risk. In no event shall I be liable
      for any damages resulting from the use of this work.

  </foreignphrase></para>
  <para>

    Les réactions sont les bienvenues. Pour toute requête, suggestion,
    et cætera, sentez-vous libre de me contacter.

  </para>
  <para><foreignphrase>

    Feedback is welcome. For any requests, suggestions, flames, etc.,
    feel free to contact me.

  </foreignphrase></para>
</sect1>
</article>
