<!doctype linuxdoc system>

<article>

<title>StarOffice mini-HOWTO
<author><url url  = "mailto:mkb@poboxes.com"
                 name = "Matthew Borowski">,
<newline>
Adapté par <url url  = "mailto:nat@linux-france.com"
             name = "Nat Makarévitch">

<date>Version 0.8fr8b
<abstract>
Installation de StarOffice (StarDivision, GmbH) sous Linux.
</abstract>

<toc>

<sect>Introduction<p>
Site de référence de la <url url = "http://www.jnpcs.com/mkb/linux"
name ="Version Originale">

La plus récente version française de ce texte se trouve sur
<url url = "http://www.linux-france.com/"
name = "son site de référence">.
Seule la diffusion des versions non modifiées est autorisée.

L'ensemble logiciel <em>StarOffice</em>, rédigé en langage C et exploitant
la bibliothèque Motif, rassemble plusieurs outils de bureautique :
<itemize>
<item>StarWriter, traitement de texte
<item>StarCalc, tableur
<item>StarImage, logiciel de dessin
<item>StarDraw, logiciel de dessin objet
<item>StarChart, grapheur
<item>StarMath, éditeur d'équations
</itemize>

La version Linux de StarOffice est librement utilisable en dehors des
contextes commerciaux mais tout utilisateur professionnel doit acquérir une
licence dont le coût est pour le moment non déterminé.

Seule la distribution <em>OpenLinux</em> (commercialisée par <url url =
"http://www.caldera.com/" name = "Caldera">) permet d'employer partout
StarOffice.

<sect1>Motif<p>
StarOffice utilise la version 2.0 de la bibliothèque Motif.<newline>
<em>Motif 1.2</em> ou <em>LessTif</em> ne permettront donc pas d'exploiter
le binaire dépendant de bibliothèques dynamiques.

La version "statique" du programme, générée de façon à intégrer les
bibliothèques, fonctionne partout mais induit une charge sévère du système.

StarOffice fonctionne bien sur mon Pentium 100 disposant de 48 Mo de mémoire
vive, sous Linux Red Hat 4.1 et Motif 2.0.  Le chargement de la version
"dynamique" exige beaucoup moins de ressources que la version "statique" et
dure environ une minute.
</sect1>

<sect>Pour obtenir StarOffice<p>
La <url url = "ftp://ftp.gwdg.de/pub/linux/staroffice" name = "la plus
récente disponible"> se trouve sur le serveur FTP de
Lire le fichier "README.StarOffice" avant de télécharger les archives
proposées.<p>

Ces fichiers se trouvent aussi sur d'autres serveurs FTP, par exemple
(France métropolitaine) au <url url =
"ftp://ftp.lip6.fr/pub/linux/staroffice/" name = "LIP6">

Liste des archives à télécharger (cas de la version 3.1) :

<itemize>
<item>StarOffice31-common.tar.gz
<item>l'une des archives de documents standard et d'exemples :
<itemize>
<item>StarOffice31-english.tar.gz (version anglaise)
ou
<item>StarOffice31-german.tar.gz (version allemande)
</itemize>
<item>l'une des archives de binaires :
<itemize>
<item>StarOffice31-dynbin (dynamiques)
ou
<item>StarOffice31-statbin.tar.gz (statiques)
</itemize>
<item>(le cas échéant) StarOffice31-upgrade2final.tar.gz
</itemize>
  
Note : l'éditeur <url url = "http://www.caldera.com/" name =
"Caldera"> propose aussi StarOffice, par exemple sous forme de CD-ROM vendu
7,99 dollars américains.
</sect>

<sect>Installation<p>

Voici les étapes de l'installation de StarOffice :
<itemize>
<item>l'utilisateur <em>root</em> doit décompacter sous <tt>/usr/local</tt>
les archives <em>tar</em> fournies
<item>chaque utilisateur doit lancer au moins une fois le programme
d'installation locale
<item>chaque utilisateur doit "sourcer" un fichier créé lors de
l'installation locale<newline>(<em>~/.sd.sh</em> or <em>~/.sd.csh</em>)
<item>chaque utilisateur lira avec profit la section de ce document
consacrée à <ref id="Variable d'environnement LANG" name="LANG">.<p>
</itemize>

<sect1>Bibliothèque C (libc)
<p>
Les binaires de StarOffice reposent sur la version 5.4.4 de la bibliothèque
C, et fonctionneront avec la libc 5.3, <bf>mais</bf> le programme
d'installation ne donne satisfaction qu'avec une version de libc au moins
égale à 5.4.4.

Une solution (non testée) permettant d'installer le logiciel sans mettre à
jour consisterait à désarchiver une libc adéquate dans un répertoire
temporaire puis à la référencer dans la variable d'environnement
<em>LD&lowbar;LIBRARY&lowbar;PATH</em> avant d'invoquer l'utilitaire d'installation.

Il est inutile d'essayer d'employer une libc trop ancienne car
la procédure d'installation échoue en ce cas avec le message
d'erreur : 
<verb>
 line 1: Syntax error at token 'I' expected declarator;
</verb>

<sect2>Mise à jour de la libc<p>
La plus récente version de la libc se nomme
<em>libc-VERSION.bin.tar.gz</em> (par exemple
<em>libc-5.4.33.bin.tar.gz</em>) et se trouve dans le répertoire
<tt>/pub/linux/GCC</tt> des sites FTP (par exemple <em>ftp.lip6.fr</em>).

En extraire le contenu dans un répertoire temporaire puis, en tant que
root, copier le fichier <tt>libc.so.*</tt> dans le répertoire
<tt>/lib</tt>. Établir ensuite le lien symbolique nécessaire à sa prise en
charge grâce à la commande :
<verb>
ln -sf /lib/libc.so.VERSION /lib/libc.so.5
</verb>
où <em>VERSION</em> remplace le numéro de version.

Les utilisateurs de la distribution Red Hat utiliseront plutôt le paquet
<em>rpm</em> adéquat.

Le <em>Dr. Romano Giannetti</em> (romano@iet.unipi.it) nous révèle comment
installer sans mise à jour de la libc sur une machine Red Hat 4.2 avec
libc5.3 :
<enum>

<item>récupérer une <tt>libc.so.5.4</tt>.x, pas exemple sous forme de
<tt>rpm</tt> (il se trouve dans le répertoire <tt>contrib</tt> des sites
FTP). L'extraire dans un répertoire temporaire vide grâce à : <tt>rpm2cpio
libc.so.5.4.x-y.rpm | cpio --extract --make-directories</tt>. La
bibliothèque se trouvera dans le répertoire <tt>./lib</tt>

<item>déplacer <tt>libc.so.5.4.</tT>x idans votre répertoire home. Puis
(correct sous un shell de la famille sh): <tt>ln -s libc.so.5.4.x libc.so.5
; export LD&lowbar;LIBRARY&lowbar;PATH=&dollar;HOME:/lib:/usr/lib</tt>

<item>invoquer <tt>setup</tt>
</enum>
</sect2>

<sect2>Installation du programme<p>
Il suffit, en tant que <em>root</em>, d'extraire les archives de 
StarOffice sous <tt>/usr/local/</tt> :
<verb>
cd /usr/local
tar -xzvf NOM_DU_FICHIER.tar.gz
</verb>
</sect2>

<sect2>Configuration<p>
Chaque futur utilisateur de StarOffice doit invoquer les commandes
suivantes :
<verb>
cd /usr/local/StarOffice-3.1
./setup
</verb>
puis opter pour la "standard installation".
Il est recommandé d'accepter d'installer dans le chemin de répertoire
proposé ("default installation path").

StarOffice utilise un certain nombre de variables d'environnement.  Les
fichiers <tt>~/.sd.sh</tt> (pour le shell Bourne) et <tt>~/.sd.csh</tt>
(pour le shell C) mettent en place les valeurs adéquates. Les utilisateurs
de <em>bash</em> devront placer à la fin de leur fichier <tt>~/.bashrc</tt>
une ligne :
<verb>
source ~/.sd.sh
</verb>
Cette nécessaire modification ne sera prise en charge que lors des
connexions ("login") suivantes.
</sect2>

<sect2>Bogue de Caldera OpenLinux<p>

<url url = "mailto:pcr@busprod.com" name = "Phil Reardon"> indique que la
procédure d'installation du StarOffice d'OpenLinux ajoute à l'un des
chemins de répertoires un caractère '/' inutile. Pour résoudre ce problème
il suffit de supprimer le premier caractère '/' apparaissant dans la
ligne :
<verb>
exec ${pfad:='.'}/linux-x86/bin/$name;;
</verb>
Il faut donc supprimer le '/' placé avant "linux-x86".
</sect2>

<sect2>Variable d'environnement LANG<p>
<label id="Variable d'environnement LANG">
Les fichiers <tt>~/.sd.sh</tt> et <tt>~/.sd.csh</tt> lient la variable
d'environnement <em>LANG</em> à une valeur, ce qui oblige divers programmes
(dont <em>Perl</em> et <em>man</em>) à émettre des messages
d'avertissement, par exemple :
"warning: setlocale(LC&lowbar;CTYPE, "")..." ou bien 
"Failed to open the message catalog man on the path NLSPATH=".

Il suffit, pour s'en affranchir, de supprimer la ligne "LANG=us" de
<tt>~/.sd.sh</tt> et la ligne "setenv LANG us" de <tt>~/.sd.csh</tt>.

Merci à <url url = "mailto:alklein@adelphia.net" name = "Adam L. Klein">,
de m'avoir indiqué cela.
</sect2>

<sect>Invocation<p>
Lancer au préalable une seule instance par machine de :
<itemize>
<item>"svdaemon" afin de disposer de l'aide en ligne 
<item>"svportmap" afin d'assurer la communication entre les applications
</itemize>

Pour invoquer StarOffice :
<tscreen><verb>
export LANG=fr
. ~/sd.sh
/usr/local/StarOffice-3.1/linux-x86/bin/soffice3
</verb></tscreen>

Lors de la première invocation bien vérifier que les chemins des fichiers
de configuration sont corrects (menu « options »).

Les binaires sont abrités dans
<tt>/usr/local/StarOffice-3.1/linux-x86/bin/</tt> et se nomment
<tt>soffice3</tt>, <tt>sdraw3</tt>, <tt>swriter3</tt>, <tt>scalc3</tt>,
<tt>smath3</tt>, <tt>schart3</tt> et <tt>simage3</tt>.
</sect>

<sect>Astuces
<p>
Voici diverses astuces communiquées par <em>Patrick D'Cruze</em>
(pdcruze@netpal.com.au)

<enum>
<item>
Les variables d'environnement mises en place par <tt>.sd.sh</tt> (ou
<tt>.sd.csh</tt>) polluent parfois les autres applications. J'ai donc
supprimé leur "sourcing" dans mes fichiers d'initialisation du shell (par
exemple <tt>.bash&lowbar;profile</tt>). Puis ai copié le fichier <tt>.sd.sh</tt>
sous le nom de <tt>/usr/local/bin/swriter</tt> et y ai ajouté une première
ligne <tt>#!  /bin/bash</tt> et une ligne <tt>exec swriter3 &dollar;*</tt> à la
fin. Il suffisait dès lors de le rendre exécutable (<tt>chmod a+rx
<tt>/usr/local/bin/swriter</tt></tt>) afin de permettre à tout utilisateur,
en l'invoquant, d'utiliser StarWriter.

<item>
De nombreux utilisateurs affirment que le chargement de StarOffice exige
beaucoup de temps (jusqu'à une minute). Ce délai correspond, selon les
auteurs de la plupart des articles Usenet pertinents, à l'allocation de
mémoire effectuée par l'éditeur de liens dynamiques <tt>ld.so</tt> pour
chaque symbole référencé par Star Office. Ce dernier exploite un nombre
élevé de bibliothèques, l'éditeur de liens explore par conséquent une
quantité importante de fichiers. Une solution consiste à confiner
StarOffice, grâce à <tt>chroot</tt>, dans une arborescence où se trouveront
dupliquées les seules bibliothèques nécessaires (<tt>/usr/X11R6/lib</tt>,
<tt>libc/libm</tt> et <tt>libg++/libstdc++</tt>), afin d'épargner à
l'éditeur de liens dynamiques d'inutiles recherches. StarWriter, sur mon
P13/32 Mo, démarre ainsi en 15 secondes.
</enum>
</sect>

<sect>Problèmes divers<p>
En cas de problème de fontes :
<tt>chmod -R a+r /usr/local/StarOffice3.1/Xp3</tt>

En cas de problème d'impression invoquer, en tant que root, les commandes
suivantes :
<code>
mkdir /tmp/XpSp_ 
mkdir /tmp/Xp_
mkdir /tmp/XpSp_/tmp 
mkdir /tmp/Xp_/tmp
chgrp -R users /tmp/XpSp_
chgrp -R users /tmp/Xp_
</code>

<sect>Autres sources d'information<p>
<itemize>
<item><url url = "http://www.stardivision.com/" name = "StarDivision">, en
particulier <url url =
"http://www.stardivision.com/support/foren/grplist.html"
name="le forum">.
<item><url url =

"http://www.on-line.de/~michael.hoennig/soffice4-linux-faq-01.html"
name="M. Hoennig">, donc la GUILDE propose une <url
url="http://www.guilde.asso.fr/guilde/contrib/soffice4-linux-faq-33.html"
name="adaptation en français">.

Voici un autre <url name="document traitant de Star Office"
url="http://www.waldherr.org/soffice/"> (concerne surtout la Red Hat
5).
</itemize>
</sect>

<sect>Section ajoutée dans l'adaptation en français
<p>
<sect1>Francophones<p>
Voici comment <url url="http://web.fdn.fr/~tquinot/dead-keys.fr.html"
name="faire fonctionner les touches mortes d'accentuation">.

Saisir les accents sous Applixware est possible grâce à une <url
url="../Fr-HOWTO/point&lowbar;Xmodmap.gz" name="table xmodmap"> adéquate.
</sect1>

<sect1>Install de <em><url name="JP Lecaille"
url="mailto:lullaby@club-internet.fr"></em> (SO 4 sous RH 5)
<p>
Je précise que j'utilise la Red Hat 5.

je décompresse <tt>so40&lowbar;lnx&lowbar;01.tar.gz</tt> dans le répertoire
<tt>/usr/local</tt>, puis <tt>libc-5.4.44.bin.tar.gz</tt> dans le même
répertoire (je ne me rappelle plus où j'ai trouvé la <tt>libc</tt>, je
suppose que c'est accessible sur <url url="http://ftpsearch.ntnu.no/"
name="FTP Search">).

Ensuite je me place dans le répertoire
<tt>/usr/local/Office40&lowbar;Install/lib</tt> et je fais :
<tscreen><verb>
ln -s libc.so.5.4.44 libc.so
ln -s libc.so.5.4.44 libc.so.5
ln -s libm.so.5.0.9 libm.so
ln -s libm.so.5.0.9 libm.so.5
</verb></tscreen>

J'édite le fichier <tt>setup</tt> du répertoire
<tt>/usr/local/Office40&lowbar;Install</tt> et je le change en :
<tscreen><verb>
#!/bin/sh
#
# StarOffice setup script
# (c) 1997, Star Division GmbH

cd `dirname $0`
sd_archive_path=`pwd`
sd_setup_binary=setup.bin
sd_platform=`uname -s`

# some platforms may need an additional search path for X11 shared libraries
case $sd_platform in
  SunOS)
	 LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/openwin/lib
	 export LD_LIBRARY_PATH
	 ;;
      *)
	 LD_LIBRARY_PATH=/usr/local/Office40_Install/lib/:$LD_LIBRARY_PATH
	 export LD_LIBRARY_PATH
	 ;;
esac

	export SAL_FONTPATH XPPATH

# execute setup binary
exec $sd_archive_path/$sd_setup_binary $*
</verb></tscreen>

Il ne reste plus qu'à invoquer <tt>~/Office40&lowbar;Install/setup /net</tt>.
</sect1>
</sect>

<sect>Contributions<p>
Merci de contacter l'auteur ou le traducteur de ce document si vous
disposez d'informations intéressantes.

Cette adaptation française doit beaucoup à J. Chion et à P. Vaur.
</sect>

<sect>Copyright<p>
  Ce document est (C) 1997 by Matthew Borowski.

  La redistribution de ce document par tout moyen électronique est permise
  sous condition qu'il demeure inchangé. Si vous voulez inclure ce
  document dans un CD-ROM ou un livre, demandez une autorisation
  auparavent (je préfère que les demandes soient effectuées par
  courrier électronique).

  L'auteur décline toute responsabilité quant à ce qui pourrait advenir
  directement ou indirectement du fait de l'utilisation de ce document.
  L'auteur n'est pas employé chez de StarDivision, GmbH ou Caldera, Inc.

  Commentaires et questions peuvent être adressés directement à l'auteur
  à mkb@poboxes.com.
</sect>
</article>
