%!PS-Adobe-3.0
%%BoundingBox: 0 0 595 842
%%LanguageLevel: 2
%%Creator: htmldoc 1.8.22 Copyright 1997-2002 Easy Software Products, All Rights Reserved.
%%CreationDate: D:20030421013843-0200
%%Title: Linux VPN Masquerade HOWTO - Version française
%%Generator: Modular DocBook HTML Stylesheet Version 1.7
%%Pages: 35
%%DocumentNeededResources:
%%+ font Courier
%%+ font Courier-Oblique
%%+ font Times-Roman
%%+ font Times-Italic
%%+ font Times-BoldItalic
%%+ font Helvetica
%%+ font Helvetica-Bold
%%+ font Helvetica-Oblique
%%+ font Symbol
%%DocumentData: Clean7bit
%%EndComments
%%BeginProlog
%%BeginResource: procset htmldoc-page 1.8 22
/BD{bind def}bind def/B{dup 0 exch rlineto exch 0 rlineto neg 0 exch rlineto
closepath stroke}BD/C{setrgbcolor}BD
/CM{concat}BD/DF{findfont dup length dict begin{1 index/FID ne{def}{pop pop}
ifelse}forall/Encoding fontencoding def currentdict end definefont pop}BD
/F{dup 0 exch rlineto exch 0 rlineto neg 0 exch rlineto closepath fill}BD
/FS{/hdFontSize exch def}BD/GS{gsave}BD/GR{grestore}BD/J{0 exch ashow}BD
/L{0 rlineto stroke}BD/M{moveto}BD/RO{rotate}BD/S{show}BD/SC{dup scale}BD
/SF{findfont hdFontSize scalefont setfont}BD/SP{showpage}BD/T{translate}BD
%%EndResource
/fontencoding[
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent/ampersand
/quotesingle/parenleft/parenright/asterisk/plus/comma/minus/period/slash/zero
/one/two/three/four/five/six/seven/eight/nine/colon/semicolon/less/equal/greater
/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft
/backslash/bracketright/asciicircum/underscore/grave/a/b/c/d/e/f/g/h/i/j/k/l/m/n
/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde/.notdef/Euro
/.notdef/quotesinglbase/florin/quotedblbase/ellipsis/dagger/daggerdbl/circumflex
/perthousand/Scaron/guilsinglleft/OE/.notdef/.notdef/.notdef/.notdef/quoteleft
/quoteright/quotedblleft/quotedblright/bullet/endash/emdash/tilde/trademark
/scaron/guilsinglright/oe/.notdef/.notdef/Ydieresis/space/exclamdown/cent
/sterling/Euro/yen/Scaron/section/scaron/copyright/ordfeminine/guillemotleft
/logicalnot/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/Zcaron/mu/paragraph/periodcentered/zcaron/onesuperior/ordmasculine
/guillemotright/OE/oe/Ydieresis/questiondown/Agrave/Aacute/Acircumflex/Atilde
/Adieresis/Aring/AE/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute
/Icircumflex/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn/germandbls
/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla/egrave/eacute
/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis/eth/ntilde/ograve
/oacute/ocircumflex/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex
/udieresis/yacute/thorn/ydieresis]def
/F0/Courier DF
/F2/Courier-Oblique DF
/F4/Times-Roman DF
/F6/Times-Italic DF
/F7/Times-BoldItalic DF
/F8/Helvetica DF
/F9/Helvetica-Bold DF
/Fa/Helvetica-Oblique DF
/Fc/Symbol findfont definefont pop
%%EndProlog
%%Page: 1 1
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 552.91 M 487.0 2.0 F
19 FS/F9 SF 0 728.992 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
13.2 FS/F9 SF 0 698.79 M(John D. Hardin <jhardin@wolfenet.com>, version fran\347aise par Yann Hirou)S
0 682.95 M(<hirou@linuxfr.org>)S
11 FS/F4 SF 0 656.11 M($Revision: 1.1.1.1 $ $Date: 2003/01/03 02:38:54 $)S
0 616.51 M(Ce document d\351crit comment configurer un pare-feu Linux pour masquer le trafic d'un r\351seau priv\351 virtuel)S
0 603.31 M(\(NdT: Virtual Private Network, VPN\) utilisant IPsec ou PPTP, vous permettant ainsi d'\351tablir une connexion)S
0 590.11 M(VPN sans perdre ni la s\351curit\351 ni la flexibilit\351 apport\351es par la connexion internet de votre pare-feu Linux, et)S
0 576.91 M(vous permettant de rendre accessible un serveur VPN qui n'a pas d'adresse IP publique. Des informations sur)S
0 563.71 M(la configuration du client et du serveur VPN sont \351galement fournies.)S
/F7 SF 0 522.11 M(Table des mati\350res)S
/F6 SF 0 508.91 M(1. Introduction)S
36 495.71 M(1.1. Introduction)S
36 482.51 M(1.2. Avis, Cr\351dits & Ressources)S
36 469.31 M(1.3. Copyright & mise en garde)S
0 456.11 M(2. Connaissances requises)S
36 442.91 M(2.1. Qu'est-ce qu'un VPN ?)S
36 429.71 M(2.2. Qu'est-ce qu'IPsec ?)S
36 416.51 M(2.3. Qu'est-ce que PPTP ?)S
36 403.31 M(2.4. Qu'est-ce que FWZ ?)S
36 390.11 M(2.5. Pourquoi masquer un client VPN ?)S
36 376.91 M(2.6. Plusieurs clients sur mon r\351seau local peuvent-ils utiliser IPsec simultan\351ment ?)S
36 363.71 M(2.7. Plusieurs clients sur mon r\351seau local peuvent-ils utiliser PPTP simultan\351ment ?)S
36 350.51 M(2.8. Puis-je acc\351der au r\351seau distant depuis l'ensemble de mon r\351seau local ?)S
36 337.31 M(2.9. Pourquoi masquer le serveur VPN ?)S
36 324.11 M(2.10. Pourquoi patcher le noyau Linux ?)S
36 310.91 M(2.11. \311tat actuel)S
0 297.71 M(3. Configurer le pare-feu Linux)S
36 284.51 M(3.1. Exemple de r\351seau)S
36 271.31 M(3.2. D\351terminer ce qui doit \352tre fait sur le pare-feu)S
36 258.11 M(3.3. Patcher et configurer le noyau 2.0.x pour le support de masquage VPN)S
36 244.91 M(3.4. Patcher et configurer le noyau 2.2.x pour le support de masquage VPN)S
36 231.71 M(3.5. Param\351trage de ipfwadm pour un client ou un serveur VPN avec une adresse IP priv\351e)S
36 218.51 M(3.6. Param\351trage d'ipchains pour un client ou serveur VPN avec une adresse IP priv\351e)S
36 205.31 M(3.7. Une note sur l'adressage IP dynamique)S
36 192.11 M(3.8. Param\351trages additionnels pour un serveur VPN avec une adresse IP priv\351e)S
36 178.91 M(3.9. Param\351trage d'ipfwadm pour un serveur VPN avec une adresse IP publique)S
36 165.71 M(3.10. Param\351trage d'ipfwadm pour un client VPN avec une adresse IP publique)S
36 152.51 M(3.11. Param\351trage d'ipchains pour un serveur VPN avec une adresse IP publique)S
36 139.31 M(3.12. Param\351trage d'ipchains pour un client VPN avec une adresse IP publique)S
36 126.11 M(3.13. Masquage VPN et LRP)S
36 112.91 M(3.14. Masquage VPN sur un syst\350me tournant avec FreeS/WAN ou PoPToP)S
0 99.71 M(4. Configurer le client VPN)S
36 86.51 M(4.1. Configurer un client MS W'95)S
36 73.31 M(4.2. Configurer un client MS W'98)S
36 60.11 M(4.3. Configurer un client MS W'ME)S
36 46.91 M(4.4. Configurer un client MS NT)S
36 33.71 M(4.5. Configuration pour du routage r\351seau \340 r\351seau)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
480.884 0 M(1)S
GR
SP
%%Page: 2 2
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 110.552 M 487.0 2.0 F
11 FS/F6 SF 36 737 M(4.6. Masquer des VPNs bas\351s sur SecuRemote de CheckPoint)S
0 723.8 M(5. D\351pannage)S
36 710.6 M(5.1. Tests)S
36 697.4 M(5.2. Probl\350mes possibles)S
36 684.2 M(5.3. D\351pannage)S
36 671 M(5.4. Clients MS PTPP et noms de domaines)S
36 657.8 M(5.5. Clients PPTP MS et IPX Novell)S
36 644.6 M(5.6. Probl\350mes de mots de passe r\351seau MS)S
36 631.4 M(5.7. Si votre session IPsec meurt automatiquement apr\350s un certain laps de temps)S
36 618.2 M(5.8. Si le masquage VPN ne fonctionne pas apr\350s le red\351marrage)S
36 605 M(5.9. Si votre seconde session PPTP tue votre premi\350re session)S
0 591.8 M(6. Notes techniques sur le masquage IPsec et consid\351rations sp\351ciales sur la s\351curit\351)S
36 578.6 M(6.1. Limites et faiblesses du masquage IPsec)S
36 565.4 M(6.2. Routage correct du trafic crypt\351 entrant)S
15.8 FS/F9 SF 0 534.16 M(1. Introduction)S
13.2 FS/F9 SF 0 504.592 M(1.1. Introduction)S
11 FS/F4 SF 0 477.752 M(Ce document d\351crit comment configurer le masquage d'un trafic VPN de type IPsec ou PPTP. Les VPNs)S
0 464.552 M(utilisant SSH \(comme celui vendu par F-Secure, et r\351f\351renc\351 dans le VPN mini-HOWTO\) sont fond\351s sur un)S
0 451.352 M(trafic TCP standard, et ne n\351cessitent aucune modification particuli\350re du noyau.)S
0 424.952 M(Le masquage de VPN vous permet d'\351tablir une ou plusieurs sessions IPsec et/ou PPTP vers des serveurs VPN)S
0 411.752 M(accessibles sur internet via votre pare-feu internet sans que vous deviez connecter la machine sur laquelle)S
0 398.552 M(tourne le client VPN directement \340 votre FAI \(Fournisseur d'Acc\350s Internet\) - donc en conservant tous les)S
0 385.352 M(avantages de votre pare-feu internet sous Linux. Il vous est \351galement possible de configurer un serveur VPN)S
0 372.152 M(avec une adresse IP de r\351seau priv\351 \(voir le RFC1918\) derri\350re un pare-feu Linux faisant du masquage, vous)S
0 358.952 M(permettant ainsi de fournir de fa\347on assez s\351curis\351e un acc\350s \340 un r\351seau priv\351 via seulement une seule adresse)S
0 345.752 M(IP r\351f\351renc\351e - y compris si cette adresse IP repr\351sente celle d'une connexion modem pouvant varier.)S
0 319.352 M(Il est tr\350s fortement recommand\351 que vous compreniez, configuriez et testiez le masquage IP avant de tenter)S
0 306.152 M(de mettre en place du masquage VPN. Consultez le IP Masquerade HOWTO et la page de ressources sur le)S
0 292.952 M(masquage IP \340 l'adresse http://ipmasq.cjb.net/ avant de commencer. La planification et la mise en place de)S
0 279.752 M(votre VPN et de votre pare-feu d\351passent le cadre de ce document. Voici quelques ressources :)S
36 253.352 M(http://www.linux.org/help/ldp/howto/Firewall-HOWTO.html)S
/Fc SF 28.19 253.352 M(\267 )S
/F4 SF 36 240.152 M(http://hal2000.hal.vein.hu/~mag/linux-security/VPN-HOWTO.html)S
/Fc SF 28.19 240.152 M(\267 )S
/F4 SF 0 187.352 M(Le patch pour les noyaux de la s\351rie 2.0.x fonctionne bien sur la version 2.0.36 du noyau Linux, et a \351t\351)S
0 174.152 M(int\351gr\351 dans la version 2.0.37. Il doit \351galement fonctionner sur les versions ant\351rieures \340 la 2.0.36, et devrait)S
0 160.952 M(fonctionner sur les noyaux Linux jusqu'\340 la version 2.1.102. Le code du masquage IP se trouvant dans le)S
0 147.752 M(noyau a \351t\351 restructur\351 autour de la version 2.1.103, n\351cessitant un patch diff\351rent pour les s\351ries de noyaux)S
0 134.552 M(2.1.105+ et 2.2.x.. Un patch est disponible pour les noyaux de 2.2.5 \340 2.2.17, et il devrait fonctionner sur les)S
0 121.352 M(noyaux ant\351rieurs.)S
13.2 FS/F9 SF 0 90.752 M(1.2. Avis, Cr\351dits & Ressources)S
11 FS/F4 SF 0 63.912 M(Le site o\371 trouver les patchs du noyau pour le masquage VPN avec Linux est)S
0 50.712 M(http://www.impsec.org/linux/masquerade/ip_masq_vpn.html)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(1. Introduction)S
480.884 0 M(2)S
GR
SP
%%Page: 3 3
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
11 FS/F4 SF 0 737 M(N'h\351sitez pas \340 m'envoyer votre avis ou des commentaires sur ce document \340 l'adresse)S
0 723.8 M(<jhardin@wolfenet.com>. La version actuelle est disponible \340 l'adresse :)S
36 697.4 M(HTML: ftp://ftp.rubyriver.com/pub/jhardin/masquerade/VPN-howto/VPN-Masquerade.html)S
/Fc SF 28.19 697.4 M(\267 )S
/F4 SF 36 684.2 M(PostScript: ftp://ftp.rubyriver.com/pub/jhardin/masquerade/VPN-howto/VPN-Masquerade.ps.gz)S
/Fc SF 28.19 684.2 M(\267 )S
/F4 SF 36 671 M(SGML source: ftp://ftp.rubyriver.com/pub/jhardin/masquerade/VPN-Masquerade.sgml)S
/Fc SF 28.19 671 M(\267 )S
/F4 SF 0 644.6 M(Si vous travaillez avec un noyau dont le num\351ro de version est sup\351rieur \340 tous ceux mentionn\351s dans ce)S
0 631.4 M(document,)S
/F6 SF ( merci)S
/F4 SF ( de regarder s'il n'y a pas une version \340 jour de ce HOWTO sur le site cit\351 ci-dessus avant de)S
0 618.2 M(me contacter directement.)S
0 591.8 M(Il peut \351galement \352tre trouv\351 via le r\351pertoire HOWTO du Linux Documentation Project et le r\351pertoire)S
/Fa SF 0 578.6 M(/usr/doc/HOWTO/)S
/F4 SF ( sur la machine Linux la plus proche. Ces copies ne sont pas directement mises \340 jour par)S
0 565.4 M(moi, donc elles peuvent \352tre un peu d\351pass\351es.)S
0 539 M(J'ai personnellement de l'exp\351rience sur le masquage de clients IPsec et PPTP tournant sur MS W'98 et NT,)S
0 525.8 M(sur la configuration d'un serveur PPTP avec une adresse IP publique, et sur l'utilisation de PPTP pour du)S
0 512.6 M(routage inter-r\351seaux.)S
0 486.2 M(Les informations sur le masquage d'un serveur PPTP avec une adresse IP priv\351e proviennent de discussions)S
0 473 M(avec Len Bayles <len@isdi.com>, Simon Cocking <simon@ibs.com.au> et C. Scott Ananian)S
0 459.8 M(<cananian@lcs.mit.edu>.)S
0 433.4 M(Le site pour le patch du noyau concernant uniquement le masquage PPTP pour les s\351ries de noyaux 2.1.105+)S
0 420.2 M(et les premiers 2.2.x est http://bmrc.berkeley.edu/people/chaffee/linux_pptp.html.)S
0 393.8 M(Le site pour le patch du noyau concernant la redirection de port)S
/Fa SF ( ipportfw)S
/F4 SF ( et pour l'outil de configuration des)S
0 380.6 M(noyaux 2.0.x est http://www.ox.compsoc.org.uk/~steve/portforwarding.html. La redirection de port est incluse)S
0 367.4 M(dans les noyaux 2.2.x, et l'outil de configuration)S
/Fa SF ( ipmasqadm)S
/F4 SF ( contr\364lant la redirection de port des 2.2.x peut)S
0 354.2 M(\352tre obtenu \340 l'adresse http://juanjox.kernelnotes.org/.)S
0 327.8 M(Le site pour le redirecteur IP g\351n\351rique)S
/Fa SF ( ipfwd)S
/F4 SF ( est http://www.pdos.lcs.mit.edu/~cananian/Projects/IPfwd/.)S
0 301.4 M(Pleins de remerciements \340 Gordon Chaffee <chaffee@cs.berkeley.edu> pour avoir cod\351 et partag\351 un patch)S
0 288.2 M(pour traceroute qui permet de tracer le trafic GRE. Il va se montrer d'une valeur inestimable pour la d\351tection)S
0 275 M(d'erreurs si votre trafic GRE se trouve bloqu\351 quelque part. Le patch est disponible \340 l'adresse)S
0 261.8 M(http://www.wolfenet.com/~jhardin/pptp-traceroute.patch.gz)S
0 235.4 M(Encore plus de remerciements \340 Steve Chinatti <chinatti@alumni.Princeton.EDU> pour avoir partag\351 sa)S
0 222.2 M(modification du masquage IPsec, d'o\371 j'ai r\351cup\351r\351 sans vergogne quelques id\351es tr\350s importantes...)S
0 195.8 M(De plus amples informations sur comment installer des r\350gles de pare-feu s'ex\351cutant automatiquement - y)S
0 182.6 M(compris comment utiliser automatiquement la bonne adresse IP dans un environnement d'adressage IP)S
0 169.4 M(dynamique - peuvent se trouver \340 l'adresse http://www.wolfenet.com/~jhardin/ipfwadm/invocation.html)S
0 143 M(Le site pour Linux FreeS/WAN \(IPsec pour Linux\) est http://www.xs4all.nl/~freeswan/ - c'est la solution de)S
0 129.8 M(VPN sous Linux conseill\351e.)S
0 103.4 M(Un serveur PPTP Linux natif appel\351 PoPToP est disponible \340 l'adresse)S
0 90.2 M(http://www.moretonbay.com/vpn/pptp.html - pour les informations les plus \340 jour sur PPTP sous Linux, allez)S
0 77 M(y.)S
0 50.6 M(Paul Cadach <paul@odt.east.telecom.kz> a \351crit des patchs qui ajoutent au pppd de Linux le support)S
0 37.4 M(MS-CHAP-v2, MPPE et Multilink. Allez voir)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(1. Introduction)S
480.884 0 M(3)S
GR
SP
%%Page: 4 4
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 594.2 M 487.0 2.0 F
0.88 0.88 0.88 C 0 384.095 M 487.7 69.6 F
0.00 0.00 0.00 C 0 452.96 M 487.7 0.7 F
0 384.095 M 0.7 69.6 F
487 384.095 M 0.7 69.6 F
0 384.095 M 487.7 0.7 F
0 349.095 M 487.0 2.0 F
0 101.047 M 487.0 2.0 F
11 FS/F4 SF 0 737 M(ftp://ftp.east.telecom.kz/pub/src/networking/ppp/ppp-2.3.5-my.tgz pour MS-CHAP et MPPE, et)S
0 723.8 M(ftp://ftp.east.telecom.kz/pub/src/networking/ppp/multilink/ppp-2.3.5-mp.tgz pour Multilink. Un autre)S
0 710.6 M(ensemble de patchs \(probablement int\351ressants\) pour pppd est disponible sur le site de t\351l\351chargement de)S
0 697.4 M(PoPToP \340 l'adresse http://www.moretonbay.com/vpn/download_pptp.html.)S
0 671 M(Le site du projet original PPTP pour Linux est http://www.pdos.lcs.mit.edu/~cananian/Projects/PPTP et un)S
0 657.8 M(patch pour ajouter les fonctionnalit\351s de serveur PPTP est disponible \340 l'adresse)S
0 644.6 M(http://debs.fuller.edu/cgi-bin/display?list=pptp=222)S
0 618.2 M(Merci \340 Eric Raymond de maintenir Le fichier du Jargon \(The Jargon File\), et \340 Denis Howe de maintenir Le)S
0 605 M(dictionnaire en ligne gratuit de l'informatique \(The Free On-line Dictionary of Computing\).)S
13.2 FS/F9 SF 0 574.4 M(1.3. Copyright & mise en garde)S
11 FS/F4 SF 0 547.56 M(Ce document est Coyright \251 1999-2000 par John D. Hardin. Vous avez la permission de le redistribuer sous)S
0 534.36 M(les termes de la licence LDP, disponible \340 l'adresse http://www.linuxdoc.org/COPYRIGHT.html)S
0 507.96 M(Les informations fournies dans ce document sont correctes dans la limite de mon savoir. Le masquage IP est)S
/F6 SF 0 494.76 M(exp\351rimental)S
/F4 SF (, et il est possible que j'aie fait des erreurs en \351crivant ou testant le patch du noyau, ou encore en)S
0 481.56 M(\351crivant les instructions dans ce document ; \340 vous de d\351cider si vous souhaitez effectuer les changements)S
0 468.36 M(indiqu\351s dans ce document.)S
9.2 FS/F2 SF 1.432 442.361 M(L'AUTEUR NE PEUT ETRE TENU RESPONSABLE POUR DES DEGATS CAUSES PAR DES)S
1.432 431.361 M(ACTIONS BASEES SUR LES INFORMATIONS CONTENUES DANS CE DOCUMENT.)S
1.432 420.361 M(SAUVEGARDEZ TOUTES LES DONNEES CRITIQUES AVANT D'EFFECTUER LES )S
1.432 409.361 M(CHANGEMENTS INDIQUES DANS CE DOCUMENT. ASSUREZ VOUS D'AVOIR UN NOYAU)S
1.432 398.361 M(QUI MARCHE, SUR LEQUEL VOUS POUVEZ DEMARRER, AVANT DE PATCHER ET)S
1.432 387.361 M(DE RECOMPILER VOTRE NOYAU COMME INDIQUE DANS CE DOCUMENT.)S
11 FS/F4 SF 0 359.895 M(En d'autres mots, prenez des pr\351cautions.)S
15.8 FS/F9 SF 0 326.655 M(2. Connaissances requises)S
13.2 FS/F9 SF 0 297.087 M(2.1. Qu'est-ce qu'un VPN ?)S
11 FS/F4 SF 0 270.247 M(Un R\351seau Priv\351 Virtuel \(Virtual Private Network\), ou "VPN", est un tunnel qui v\351hicule le trafic d'un r\351seau)S
0 257.047 M(priv\351 d'un syst\350me terminal vers un autre, en empruntant un r\351seau public \(comme l'internet\), sans que les)S
0 243.847 M(interm\351diaires entre les deux machines terminales soient visibles du point de vue du trafic v\351hicul\351, et sans)S
0 230.647 M(que les \351quipements interm\351diaires voient les paquets qui sont en train de transiter dans le tunnel. Le tunnel)S
0 217.447 M(peut en option compresser et/ou crypter les donn\351es, fournissant des performances accrues et quelques)S
0 204.247 M(mesures de s\351curit\351.)S
0 177.847 M(La partie "Virtuelle" vient du fait que vous construisez une liaison priv\351e au dessus d'un r\351seau public, plut\364t)S
0 164.647 M(que d'acheter une liaison en dur sur une ligne lou\351e. Le VPN vous permet de consid\351rer que vous utilisez une)S
0 151.447 M(ligne lou\351e ou une ligne t\351l\351phonique pour communiquer entre les deux points terminaux.)S
0 125.047 M(Pour information, vous pouvez trouver la FAQ sur le VPN \340 l'adresse)S
0 111.847 M(http://kubarb.phsx.ukans.edu/~tbird/vpn/FAQ.html.)S
13.2 FS/F9 SF 0 81.247 M(2.2. Qu'est-ce qu'IPsec ?)S
11 FS/F6 SF 0 54.407 M(IPsec)S
/F4 SF ( est un ensemble de protocoles standards pour impl\351menter des communications s\351curis\351es ainsi que)S
0 41.207 M(l'\351change de cl\351s de cryptage entre ordinateurs. Il peut \352tre utilis\351 pour mettre en place un VPN.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(1.3. Copyright & mise en garde)S
480.884 0 M(4)S
GR
SP
%%Page: 5 5
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 422.6 M 487.0 2.0 F
0 61.56 M 487.0 2.0 F
11 FS/F4 SF 0 737 M(Un r\351seau priv\351 virtuel IPsec consiste g\351n\351ralement en deux canaux de communication entre les machines)S
0 723.8 M(terminales : un canal d'\351change de cl\351s, par lequel les informations sur l'authentification et les cl\351s de cryptage)S
0 710.6 M(transitent, et un ou plusieurs canaux de donn\351es par lesquels le trafic du r\351seau priv\351 est v\351hicul\351.)S
0 684.2 M(Le canal d'\351change de cl\351s est une connexion UDP standard en provenance de et vers le port 500. Le canal de)S
0 671 M(donn\351es transportant le trafic entre le client et le serveur utilise le protocole IP num\351ro 50 \(ESP\).)S
0 644.6 M(Vous pouvez trouver de plus amples informations dans la FAQ IPsec de F-Secure, \340 l'adresse)S
0 631.4 M(http://www.Europe.F-Secure.com/support/vpn+/faq/techfaq.html, et dans les RFC2402 \(le protocole AH,)S
0 618.2 M(protocole IP num\351ro 51\), RFC2406 \(le protocole ESP, protocole IP num\351ro 50\), et RFC2408 \(le protocole)S
0 605 M(d'\351change de cl\351s ISAKMP\).)S
0 578.6 M(IPsec est un protocole de communication sym\351trique. Cependant, vu que la plupart des gens vont s'y trouver)S
0 565.4 M(confront\351 uniquement sous la forme d'un client Windows acc\351dant \340 une passerelle centrale de s\351curit\351)S
0 552.2 M(r\351seau, le terme "client" va \352tre utilis\351 pour d\351signer la machine devant laquelle l'utilisateur est assis, et le)S
0 539 M(terme "serveur" va \352tre utilis\351 pour d\351signer la passerelle centrale de s\351curit\351 r\351seau.)S
0 512.6 M(Note importante : si votre VPN est bas\351 sur le protocole AH \(y compris AH+ESP\), il ne peut pas \352tre masqu\351.)S
0 499.4 M(Le protocole AH utilise un contr\364leur d'int\351grit\351 cryptographique sur des parties de l'ent\352te IP, y compris)S
0 486.2 M(l'adresse IP. Le masquage IP modifie l'adresse source pour les paquets sortants, et l'adresse destination pour)S
0 473 M(les paquets entrants. La passerelle de masquage ne pouvant pas participer \340 l'\351change de cl\351s, elle ne peut pas)S
0 459.8 M(r\351g\351n\351rer correctement les contr\364leurs d'int\351grit\351 cryptographiques pour les ent\352tes IP modifi\351s. Les paquets)S
0 446.6 M(IP modifi\351s seront donc rejet\351s par le destinataire comme des paquets invalides, car ils ne passeront pas le test)S
0 433.4 M(d'int\351grit\351 cryptographique.)S
13.2 FS/F9 SF 0 402.8 M(2.3. Qu'est-ce que PPTP ?)S
11 FS/F6 SF 0 375.96 M(PPTP)S
/F4 SF ( signifie)S
/F6 SF ( P)S
/F4 SF (oint-to-)S
/F6 SF (P)S
/F4 SF (oint)S
/F6 SF ( T)S
/F4 SF (unnelling)S
/F6 SF ( P)S
/F4 SF (rotocol. C'est un protocole propos\351 par Microsoft pour r\351aliser un)S
0 362.76 M(VPN.)S
0 336.36 M(Le protocole VPN PPTP consiste en deux canaux de communication entre le client et le serveur : un canal de)S
0 323.16 M(contr\364le par lequel les informations de gestion du lien transitent, et un canal de donn\351es par lequel le trafic)S
0 309.96 M(\(\351ventuellement crypt\351\) du r\351seau priv\351 est v\351hicul\351.)S
0 283.56 M(Le canal de contr\364le est une connexion TCP standard vers le port 1723 du serveur. Le canal de donn\351es)S
0 270.36 M(v\351hiculant le trafic du r\351seau priv\351 utilise le protocole IP num\351ro 47, un protocole d'encapsulation g\351n\351rique)S
0 257.16 M(d\351crit dans le RFC1701. La transmission transparente des donn\351es sur le canal de donn\351es est r\351alis\351e par la)S
0 243.96 M(n\351gociation d'une connexion PPP standard sur ce canal, simplement comme s'il s'agissait d'une connexion)S
0 230.76 M(modem directement du client vers le serveur. Les options n\351goci\351es sur le tunnel via le protocole PPP)S
0 217.56 M(contr\364lent si les donn\351es sont compress\351es et/ou crypt\351es, et donc PPTP n'a rien \340 voir avec le cryptage.)S
0 191.16 M(Les d\351tails du protocole PPTP sont document\351s dans le RFC2637.)S
0 164.76 M(L'impl\351mentation du protocole PPTP par Microsoft n'est pas consid\351r\351e comme tr\350s s\351curis\351e. Si vous \352tes)S
0 151.56 M(int\351ress\351s par les d\351tails, voici trois analyses diff\351rentes :)S
0 125.16 M(http://www.counterpane.com/pptp.html)S
0 98.76 M(http://www.geek-girl.com/bugtraq/1999_1/0664.html)S
0 72.36 M(http://oliver.efri.hr/~crv/security/bugs/NT/pptp2.html)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(2.3. Qu'est-ce que PPTP ?)S
480.884 0 M(5)S
GR
SP
%%Page: 6 6
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 631.16 M 487.0 2.0 F
0 441.72 M 487.0 2.0 F
13.2 FS/F9 SF 0 734.8 M(2.4. Qu'est-ce que FWZ ?)S
11 FS/F6 SF 0 707.96 M(FWZ)S
/F4 SF ( est un protocole de cryptage propri\351taire d\351velopp\351 par Check Point Software Technologies. Il est utilis\351)S
0 694.76 M(dans les VPNs qui sont construits autour de leur produit Firewall-1.)S
0 668.36 M(Un pare-feu Checkpoint peut \352tre configur\351 avec diff\351rents modes. Le mode d' "encapsulation FWZ")S
/F6 SF ( ne peut)S
0 655.16 M(pas)S
/F4 SF ( \352tre masqu\351. Le mode "IKE", qui utilise les protocoles standards IPsec, peut \352tre masqu\351 avec des)S
0 641.96 M(changements de configuration minimes sur la passerelle VPN.)S
13.2 FS/F9 SF 0 611.36 M(2.5. Pourquoi masquer un client VPN ?)S
11 FS/F4 SF 0 584.52 M(La plupart des clients VPN actuels partent du principe que vous allez connecter l'ordinateur client directement)S
0 571.32 M(\340 internet. Faire cela lorsque vous n'avez qu'une seule connexion d'acc\350s internet contourne votre pare-feu)S
0 558.12 M(Linux, la s\351curit\351, ainsi que les capacit\351s de partage d'acc\350s qu'il fournit. \311tendre le pare-feu Linux pour aussi)S
0 544.92 M(masquer le trafic VPN vous permet de conserver la s\351curit\351 pare-feu fournie par le pare-feu Linux, ainsi que)S
0 531.72 M(d'autoriser d'autres syst\350mes de votre r\351seau local \340 acc\351der \340 internet, sans avoir \340 prendre en compte le fait)S
0 518.52 M(que la connexion VPN soit active ou non.)S
0 492.12 M(Si votre pare-feu est utilis\351 en environnement professionnel, vous pouvez \351galement souhaiter imposer aux)S
0 478.92 M(utilisateurs clients du VPN de traverser ce pare-feu pour des raisons de s\351curit\351, plut\364t que de leur fournir des)S
0 465.72 M(modems pour qu'ils puissent se connecter tout seuls \340 l'ext\351rieur quand ils ont besoin d'utiliser le VPN. Le)S
0 452.52 M(masquage VPN vous permet de le faire m\352me si les machines clientes n'ont pas des adresses IP publiques.)S
13.2 FS/F9 SF 0 421.92 M(2.6. Plusieurs clients sur mon r\351seau local peuvent-ils utiliser IPsec)S
0 406.08 M(simultan\351ment ?)S
11 FS/F4 SF 0 379.24 M(Oui, bien qu'il puisse y avoir parfois quelques probl\350mes mineurs.)S
0 352.84 M(Les protocoles IPsec d\351finissent une m\351thode pour identifier les flux de trafic appel\351e)S
/F6 SF ( Index des Param\350tres)S
0 339.64 M(de S\351curit\351 \(Security Parameters Index\))S
/F4 SF ( \("SPI"\). Malheureusement le SPI utilis\351 pour le trafic sortant est)S
0 326.44 M(diff\351rent du SPI utilis\351 pour le trafic entrant, et il n'y a pas d'autre information permettant l'identification qui)S
0 313.24 M(ne soit pas crypt\351e, donc l'association entre le flux entrant et le flux sortant est difficile et pas parfaitement)S
0 300.04 M(fiable.)S
0 273.64 M(Le masquage IPsec tente d'associer les trafics ESP entrant et sortant en mettant en s\351rie les nouvelles)S
0 260.44 M(connexions. Alors que ceci fonctionne bien pendant les tests, on ne peut pas garantir que ce soit parfaitement)S
0 247.24 M(fiable, et la s\351rialisation des nouveaux trafics peut aboutir \340 des fins d'attente \(timeouts\) si la liaison est)S
0 234.04 M(satur\351e ou si plusieurs machines locales faisant de l'IPsec tentent d'initier des communications ou de)S
0 220.84 M(r\351\351changer leurs cl\351s simultan\351ment, avec la m\352me machine distante faisant de l'IPsec.)S
0 194.44 M(Il est \351galement reconnu que ce sch\351ma associatif peut ne pas arriver \340 associer les flux de trafic correctement,)S
0 181.24 M(les machines faisant de l'IPsec ne vont alors pas prendre en compte le trafic mal dirig\351, car il aura de)S
0 168.04 M(mauvaises valeurs SPI. Ce comportement est requis par le RFC sur IPsec.)S
0 141.64 M(Ces probl\350mes auraient pu \352tre supprim\351s s'il y avait eu un moyen d'\351couter les nouvelles valeurs SPI)S
0 128.44 M(provenant de l'\351change de cl\351s ISAKMP avant que le moindre trafic ESP n'apparaisse, mais malheureusement)S
0 115.24 M(cette partie de l'\351change de cl\351s est crypt\351e.)S
0 88.84 M(Afin de minimiser les probl\350mes associ\351s \340 cela, il est recommand\351 d'ouvrir une fen\352tre de commandes sur)S
0 75.64 M(votre machine IPsec masqu\351e, et de lancer le programme "ping" vers une machine du r\351seau distant pour)S
0 62.44 M(maintenir le tunnel actif.)S
0 36.04 M(Regardez les notes techniques sur IPsec \340 la fin du document pour de plus amples d\351tails.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(2.4. Qu'est-ce que FWZ ?)S
480.884 0 M(6)S
GR
SP
%%Page: 7 7
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 739.4 M 487.0 2.0 F
0 481.32 M 487.0 2.0 F
0 183.64 M 487.0 2.0 F
13.2 FS/F9 SF 0 719.6 M(2.7. Plusieurs clients sur mon r\351seau local peuvent-ils utiliser PPTP)S
0 703.76 M(simultan\351ment ?)S
11 FS/F4 SF 0 676.92 M(Oui.)S
0 650.52 M(Vous devez mettre en place le masquage d'identifiant d'appel PPTP \(PPTP Call ID\) lors de la configuration de)S
0 637.32 M(votre noyau, afin de distinguer les diff\351rents flux de donn\351es en provenance du m\352me serveur. Le masquage)S
0 624.12 M(PPTP avec le masquage d'identifiant d'appel activ\351 va permettre d'avoir plusieurs sessions masqu\351es)S
0 610.92 M(simultan\351es sans restriction sur le choix du serveur que le client appelle.)S
0 584.52 M(Le RFC sur PPTP sp\351cifie dans la section 3.1.3 qu'il ne peut y avoir qu'un seul canal de contr\364le entre deux)S
0 571.32 M(syst\350mes. Ceci)S
/F6 SF ( devrait)S
/F4 SF ( signifier que vous pouvez masquer seulement une session PPTP \340 la fois avec un)S
0 558.12 M(serveur distant donn\351, mais dans la pratique l'impl\351mentation PPTP de MS ne tient pas compte de \347a, tout du)S
0 544.92 M(moins pas dans le Service Pack 4 de NT 4.0. Si le serveur PPTP que vous cherchez \340 atteindre n'autorise)S
0 531.72 M(qu'une seule connexion \340 la fois, il suit correctement le protocole. Notez que cela n'affecte pas un serveur)S
0 518.52 M(masqu\351, mais seulement plusieurs clients masqu\351s cherchant \340 se connecter au m\352me serveur distant.)S
0 492.12 M(Pour d'autres alternatives, voir la question suivante...)S
13.2 FS/F9 SF 0 461.52 M(2.8. Puis-je acc\351der au r\351seau distant depuis l'ensemble de mon r\351seau local)S
0 445.68 M(?)S
11 FS/F4 SF 0 418.84 M(Oui. Cependant, votre client VPN doit pouvoir faire suivre un trafic IP \(IP forwarding\).)S
0 392.44 M(Ceci signifie que vous devrez utiliser soit un client VPN Linux ou un client VPN MS NT. La pile IP de W'95)S
0 379.24 M(et W'98 ne permet pas de faire suivre un trafic IP. NT Workstation le g\350re, et est moins cher que NT Server si)S
0 366.04 M(vous ne l'utilisez que pour router un trafic crypt\351.)S
0 339.64 M(Si vous ne pouvez pas installer un client Linux ou NT, alors vous devrez activer le masquage d'identifiant)S
0 326.44 M(d'appel PPTP si vous utilisez PPTP, et installer un logiciel client VPN sur toutes les machines auxquelles vous)S
0 313.24 M(voulez fournir un acc\350s. Ceci est peu efficace, esth\351tiquement r\351voltant, s\351curitairement mauvais, et peut ne)S
0 300.04 M(pas fonctionner si le serveur PPTP impl\351mente correctement le protocole, mais c'est moins cher que d'acheter)S
0 286.84 M(des licences NT.)S
0 260.44 M(Le routage r\351seau \340 r\351seau avec cette m\351thode fonctionne tr\350s bien. C'est comme \347a que j'ai install\351 mon)S
0 247.24 M(r\351seau \340 la maison. Cela requiert un petit peu plus de connaissances r\351seau que de simplement donner \340 tout le)S
0 234.04 M(monde son client VPN.)S
0 207.64 M(De par mon exp\351rience, le routage de r\351seau \340 r\351seau dans un environnement purement MS requiert)S
0 194.44 M(l'installation de RRAS des deux c\364t\351s du tunnel.)S
13.2 FS/F9 SF 0 163.84 M(2.9. Pourquoi masquer le serveur VPN ?)S
11 FS/F4 SF 0 137 M(Si votre serveur VPN a une adresse IP publique, vous n'avez pas besoin de le masquer, configurez simplement)S
0 123.8 M(votre pare-feu pour router le trafic VPN correctement, comme indiqu\351 plus bas.)S
0 97.4 M(Si votre serveur VPN a une adresse IP de r\351seau priv\351, vous aurez besoin de rediriger vers lui le trafic entrant,)S
0 84.2 M(et de masquer son trafic sortant. Le masquage vous permet de rendre le serveur VPN accessible depuis)S
0 71 M(internet m\352me si vous n'avez qu'une seule adresse IP publique. Ceci devrait aussi fonctionner m\352me si votre)S
0 57.8 M(adresse IP est assign\351e dynamiquement : rendez simplement publique l'adresse IP pour les clients au travers)S
0 44.6 M(de l'utilisation d'un service de DNS dynamique externe, comme par exemple celui fourni par DDNS.ORG ou)S
0 31.4 M(CJB.NET et configurez les clients pour se connecter \340 une machine appel\351e)S
/Fa SF ( notre-entreprise.ddns.org)S
/F4 SF ( ou)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(2.7. Plusieurs clients sur mon r\351seau local peuvent-ils utiliser PPTP simultan\351ment ?)S
480.884 0 M(7)S
GR
SP
%%Page: 8 8
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 686.6 M 487.0 2.0 F
0 470.76 M 487.0 2.0 F
0 83.32 M 487.0 2.0 F
11 FS/F4 SF 0 737 M(quelque chose du genre. Notez que ceci est une faille de s\351curit\351, car il est possible que le client r\351cup\350re du)S
0 723.8 M(serveur DNS dynamique une mauvaise adresse IP \340 cause d'une mauvaise synchronisation, suite \340 un)S
0 710.6 M(probl\350me lors de l'enregistrement de l'adresse IP actuelle, ou suite \340 l'enregistrement d'une adresse IP)S
0 697.4 M(diff\351rente avec le m\352me nom par une tierce partie.)S
13.2 FS/F9 SF 0 666.8 M(2.10. Pourquoi patcher le noyau Linux ?)S
11 FS/F4 SF 0 639.96 M(Le plus gros probl\350me dans le masquage de trafic VPN vient du fait que le masquage IP Linux de base n'a)S
0 626.76 M(aucune connaissance des protocoles IP autres que TCP, UDP et ICMP.)S
0 600.36 M(Tout le trafic peut \352tre redirig\351 et filtr\351 par adresse IP, mais le masquage de protocoles IP autres que TCP,)S
0 587.16 M(UDP et ICMP n\351cessite une modification du noyau.)S
0 560.76 M(Le canal de contr\364le PPTP est du TCP pur, et ne n\351cessite aucune configuration particuli\350re autre que de le)S
0 547.56 M(laisser passer au travers du pare-feu et de le masquer.)S
0 521.16 M(Masquer les canaux de donn\351es IPsec et PPTP n\351cessite une modification qui ajoute le support des protocoles)S
0 507.96 M(ESP et GRE au code de masquage, et le masquage du protocole d'\351change de cl\351s ISAKMP n\351cessite une)S
0 494.76 M(modification qui emp\352che l'op\351ration de masquage de modifier le num\351ro de port UDP source et qui remplace)S
0 481.56 M(le suivi des valeurs de cookies ISAKMP par le suivi du num\351ro de port.)S
13.2 FS/F9 SF 0 450.96 M(2.11. \311tat actuel)S
11 FS/F4 SF 0 424.12 M(Le patch pour les noyaux 2.0.x fonctionne sur le noyau 2.0.36 et est inclus dans les versions standards des)S
0 410.92 M(noyaux 2.0.37 et sup\351rieurs. Il devrait fonctionner sur les noyaux ant\351rieurs, mais je n'ai pas test\351, et je vous)S
0 397.72 M(recommande, si vous utilisez un noyau plus ancien, de passer au noyau 2.0.38 pour des questions de s\351curit\351.)S
0 371.32 M(Le patch pour les noyaux 2.2.x fonctionne sur les noyaux de 2.2.5 \340 2.2.17, et devrait fonctionner sur les)S
0 358.12 M(noyaux plus r\351cents, mais \347a n'a pas \351t\351 test\351. Il a \351t\351 soumis pour \352tre inclus dans la version standard 2.2.18.)S
0 331.72 M(Je n'ai pas les moyens de suivre les noyaux de d\351veloppement, donc actuellement aucun travail n'a \351t\351 fait sur)S
0 318.52 M(le masquage VPN pour les 2.3.x et 2.4.x. Si vous connaissez quelqu'un qui)S
/F6 SF ( travaille)S
/F4 SF ( dessus, merci de me le)S
0 305.32 M(faire savoir.)S
0 278.92 M(Le patch pour les noyaux 2.0.x a \351t\351 test\351 et fonctionne sur les machines \340 base de x86 et sparc, et le patch)S
0 265.72 M(pour les noyaux 2.2.x a \351t\351 test\351 et fonctionne sur les machines \340 base de x86 et PowerPC, mais il ne devrait)S
0 252.52 M(pas y avoir de probl\350me majeur pour le porter sur d'autres architectures. Je crois que les d\351pendances)S
0 239.32 M(vis-\340-vis des architectures proviennent seulement de la repr\351sentation interne des nombres dans la d\351finition)S
0 226.12 M(de l'ent\352te GRE utilis\351 pour formater les messages du journal et de d\351boguage. Si quelqu'un porte ce patch)S
0 212.92 M(pour une architecture autre qu'Intel, j'appr\351cierais d'en avoir un \351cho, afin que je puisse int\351grer les)S
0 199.72 M(changements \340 la version d'origine.)S
0 173.32 M(Un patch noyau sp\351cifique \340 PPTP pour les noyaux 2.1.105+ et les premiers 2.2.x est disponible \340 l'adresse)S
0 160.12 M(http://bmrc.berkeley.edu/people/chaffee/linux_pptp.html.)S
0 133.72 M(Allez voir le site sur le masquage VPN \340 l'adresse)S
0 120.52 M(http://www.impsec.org/linux/masquerade/ip_masq_vpn.html pour l'\351tat des patchs de masquage VPN, et)S
0 107.32 M(http://bmrc.berkeley.edu/people/chaffee/linux_pptp.html pour l'\351tat du patch de masquage sp\351cifique pour)S
0 94.12 M(PPTP s'appliquant aux 2.1.105+/2.2.x.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(2.10. Pourquoi patcher le noyau Linux ?)S
480.884 0 M(8)S
GR
SP
%%Page: 9 9
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 578.287 M 487.7 69.6 F
0.00 0.00 0.00 C 0 647.152 M 487.7 0.7 F
0 578.287 M 0.7 69.6 F
487 578.287 M 0.7 69.6 F
0 578.287 M 487.7 0.7 F
0.88 0.88 0.88 C 0 456.622 M 487.7 69.6 F
0.00 0.00 0.00 C 0 525.487 M 487.7 0.7 F
0 456.622 M 0.7 69.6 F
487 456.622 M 0.7 69.6 F
0 456.622 M 487.7 0.7 F
0 408.422 M 487.0 2.0 F
0 60.582 M 487.0 2.0 F
15.8 FS/F9 SF 0 732.16 M(3. Configurer le pare-feu Linux)S
13.2 FS/F9 SF 0 702.592 M(3.1. Exemple de r\351seau)S
11 FS/F4 SF 0 675.752 M(Pour les exemples de configuration avec des adresses IP priv\351es de ce document, nous allons utiliser cet)S
0 662.552 M(exemple de r\351seau :)S
9.2 FS/F0 SF 1.432 636.553 M(Internet-------- 200.200.200.*   ppp0 ou  200.200.200.200 eth1)S
1.432 625.553 M(                                 Pare-feu Linux \340 deux cartes)S
1.432 614.553 M(            .--- 10.0.0.1        eth0)S
1.432 603.553 M(            |)S
1.432 592.553 M(            |--- 10.0.0.2        Client ou serveur VPN)S
1.432 581.553 M(            |)S
11 FS/F4 SF 0 554.087 M(Pour les exemples de configuration avec des adresses IP publiques de ce document, nous allons utiliser cet)S
0 540.887 M(exemple de r\351seau :)S
9.2 FS/F0 SF 1.432 514.888 M(Internet-------- 200.200.200.200 eth1)S
1.432 503.888 M(                                 Pare-feu Linux \340 deux cartes)S
1.432 492.888 M(            .--- 222.0.0.1       eth0)S
1.432 481.888 M(            |)S
1.432 470.888 M(            |--- 222.0.0.2       Client ou serveur VPN)S
1.432 459.888 M(            |)S
11 FS/F4 SF 0 445.622 M(Le serveur VPN auquel les clients des exemples se connecteront sera)S
/Fa SF ( 199.0.0.1)S
/F4 SF 0 419.222 M(Les clients VPN qui se connecteront au serveur des exemples seront)S
/Fa SF ( 199.0.0.2)S
/F4 SF ( et)S
/Fa SF ( 199.0.0.3)S
13.2 FS/F9 SF 0 388.622 M(3.2. D\351terminer ce qui doit \352tre fait sur le pare-feu)S
11 FS/F4 SF 0 361.782 M(Si votre client ou serveur VPN a une adresse IP publique, vous n'avez)S
/F6 SF ( pas)S
/F4 SF ( besoin de faire du masquage ni de)S
0 348.582 M(modifier votre noyau - le noyau de base va correctement router tout trafic VPN. Vous pouvez directement)S
0 335.382 M(passer aux sections ci-dessous sur la mise en place avec adresse IP publique.)S
0 308.982 M(Si votre client ou serveur VPN a une adresse IP de r\351seau priv\351 comme d\351crit dans le RFC1918 vous avez)S
0 295.782 M(besoin de patcher votre noyau \(\340 moins que ce ne soit un noyau 2.0.37 ou sup\351rieur, dans la s\351rie 2.0.x\).)S
0 269.382 M(Si vous installez un serveur VPN masqu\351, vous allez aussi devoir r\351cup\351rer les deux paquetages suivants.)S
36 216.582 M(Pour rediriger le trafic TCP/UDP entrant \(le canal de contr\364le PPTP 1723/tcp ou le canal ISAKMP)S
36 203.382 M(500/udp\), vous avez besoin du patch noyau de redirection de port appropri\351)S
/Fa SF ( ipportfw)S
/F4 SF ( r\351cup\351rable sur)S
36 190.182 M(http://www.ox.compsoc.org.uk/~steve/portforwarding.html. La redirection de port a \351t\351 incorpor\351e)S
36 176.982 M(dans les noyaux 2.2.x. Regardez)S
/Fa SF ( man ipmasqadm)S
/F4 SF ( pour les d\351tails de configuration. Si)S
/Fa SF ( ipmasqadm)S
/F4 SF 36 163.782 M(n'est pas inclus dans votre distribution, il peut \352tre obtenu \340 l'adresse http://juanjox.kernelnotes.org/.)S
/Fc SF 28.19 216.582 M(\267 )S
/F4 SF 36 150.582 M(Pour rediriger le tunnel contenant le trafic initial entrant \(GRE pour PPTP et ESP pour IPsec\), vous)S
36 137.382 M(avez besoin du redirecteur IP g\351n\351rique)S
/Fa SF ( ipfwd)S
/F4 SF (, qui se trouve sur)S
36 124.182 M(http://www.pdos.lcs.mit.edu/~cananian/Projects/IPfwd/.)S
/Fc SF 28.19 150.582 M(\267 )S
/F4 SF 0 71.382 M(Vous n'avez)S
/F6 SF ( pas)S
/F4 SF ( besoin de redirection de port ni d'ipfwd si vous ne masquez que les clients.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3. Configurer le pare-feu Linux)S
480.884 0 M(9)S
GR
SP
%%Page: 10 10
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 72 361.895 M 374.2 14.6 F
0.00 0.00 0.00 C 72 375.76 M 374.2 0.7 F
72 361.895 M 0.7 14.6 F
445.5 361.895 M 0.7 14.6 F
72 361.895 M 374.2 0.7 F
0.88 0.88 0.88 C 72 295.23 M 374.2 14.6 F
0.00 0.00 0.00 C 72 309.095 M 374.2 0.7 F
72 295.23 M 0.7 14.6 F
445.5 295.23 M 0.7 14.6 F
72 295.23 M 374.2 0.7 F
0.88 0.88 0.88 C 72 224.166 M 389.6 58.6 F
0.00 0.00 0.00 C 72 282.03 M 389.6 0.7 F
72 224.166 M 0.7 58.6 F
460.865 224.166 M 0.7 58.6 F
72 224.166 M 389.6 0.7 F
13.2 FS/F9 SF 0 734.8 M(3.3. Patcher et configurer le noyau 2.0.x pour le support de masquage VPN)S
11 FS/F4 SF 36 681.56 M(Installez les sources du noyau \(de pr\351f\351rence version 2.0.37\), que vous pouvez obtenir sur)S
36 668.36 M(http://www.kernel.org/ ou un site miroir. Les sources doivent se d\351compacter automatiquement dans)S
36 655.16 M(le r\351pertoire)S
/Fa SF ( /usr/src/linux)S
/F4 SF (.)S
25 681.56 M(1. )S
36 641.96 M(Configurer et tester le masquage IP standard \(regardez le IP Masquerade HOWTO\). Ceci va vous)S
36 628.76 M(permettre de vous familiariser avec la recompilation de votre noyau, et plus largement, vous faire)S
36 615.56 M(aborder le masquage IP.)S
25 641.96 M(2. )S
/F6 SF 36 602.36 M(Sauvegardez les sources de votre noyau.)S
/F4 SF 25 602.36 M(3. )S
36 589.16 M(R\351cup\351rez le patch noyau si n\351cessaire.\15)S
36 562.76 M(Si la version de votre noyau est 2.0.36 ou inf\351rieure, r\351cup\351rez le patch du masquage VPN pour noyau)S
36 549.56 M(2.0.x sur le site du masquage VPN list\351 dans la section "Ressources" plus haut.)S
36 523.16 M(Si la version de votre noyau est 2.0.37 ou plus dans la s\351rie 2.0.x, vous n'avez pas besoin d'appliquer)S
36 509.96 M(de patch. Le code du masquage VPN est inclus dans le noyau. Passez la discussion sur le le patch du)S
36 496.76 M(noyau.)S
36 470.36 M(Pour les besoins de ce document, nous supposerons que vous avez sauvegard\351 le patch appropri\351 sous)S
36 457.16 M(le chemin)S
/Fa SF ( /usr/src/ip_masq_vpn.patch.gz)S
/F4 SF (.)S
25 589.16 M(4. )S
36 443.96 M(Appliquez le patch de masquage VPN \340 votre noyau, si n\351cessaire :\15)S
72 391.16 M(Allez dans le r\351pertoire des sources du noyau :)S
9.2 FS/Fa SF 73.432 365.161 M(cd /usr/src/linux)S
11 FS/Fc SF 60.967 391.16 M(\250 )S
/F4 SF 72 324.495 M(Appliquez le patch :)S
9.2 FS/Fa SF 73.432 298.496 M(zcat ../ip_masq_vpn.patch.gz | patch -l -p0 > vpn-patch.log 2>&1)S
/F0 SF 73.432 271.431 M(Notez que les options sont "tiret L minuscule, tiret P minuscule)S
73.432 260.431 M(zero".)S
73.432 249.431 M(Vous pourriez avoir des r\351sultats \351tranges si vous changez l'ordre des)S
73.432 238.431 M(arguments, car la commande patch semble sensible \340 l'ordre dans lequel)S
73.432 227.431 M(ils apparaissent sur la ligne de commande.)S
11 FS/Fc SF 60.967 324.495 M(\250 )S
/F4 SF 72 186.766 M(V\351rifiez le contenu du fichier)S
/Fa SF ( vpn-patch.log)S
/F4 SF ( pour voir si certaines \351tapes ont \351chou\351. Si)S
72 173.566 M(certaines \351tapes n'ont pas fonctionn\351, alors vous avez s\373rement oubli\351 des options, ou lanc\351 le)S
72 160.366 M(programme patch depuis le mauvais r\351pertoire. Utilisez votre sauvegarde pour r\351cup\351rer votre)S
72 147.166 M(noyau, et recommencez.)S
/Fc SF 60.967 186.766 M(\250 )S
/F4 SF 25 443.96 M(5. )S
36 120.766 M(Si vous masquez un serveur VPN, r\351cup\351rez et installez le patch)S
/Fa SF ( ipportfw)S
/F4 SF ( depuis le site indiqu\351 plus)S
36 107.566 M(haut.\15)S
36 81.166 M(Il existe un conflit connu entre le patch de masquage VPN et deux autres patchs r\351seau : le patch de)S
36 67.966 M(cha\356nes pare-feu IP \(ipchains\), et le patch ipportfw. Ils cherchent tous \340 ajouter des options au m\352me)S
36 54.766 M(endroit dans)S
/Fa SF ( net/ipv4/Config.in)S
/F4 SF (, et les changements effectu\351s par un patch alt\350rent le contexte)S
36 41.566 M(recherch\351 par les autres patchs.)S
25 120.766 M(6. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.3. Patcher et configurer le noyau 2.0.x pour le support de masquage VPN)S
474.768 0 M(10)S
GR
SP
%%Page: 11 11
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 36 22 M 406.6 528.7 F
0.00 0.00 0.00 C 36 550 M 406.6 0.7 F
36 22 M 0.7 528.7 F
441.9 22 M 0.7 528.7 F
11 FS/F4 SF 36 737 M(Si vous appliquez le patch de masquage VPN et les patchs de cha\356nes pare-feu IP ou ipportfw sur)S
36 723.8 M(votre noyau 2.0.x, vous allez devoir \351diter \340 la main le fichier)S
/Fa SF ( net/ipv4/Config.in)S
/F4 SF ( et ajouter le bloc)S
36 710.6 M(des options de configuration du fichier patch qui n'ont pas \351t\351 appliqu\351es. En regardant le fichier)S
36 697.4 M(patch vous devez trouver o\371 les nouvelles options doivent \352tre ajout\351es dans le fichier)S
/Fa SF 36 684.2 M(net/ipv4/Config.in)S
/F4 SF (.)S
36 657.8 M(La syntaxe des fichiers patch est simple. Pour chaque bloc de changements \340 effectuer, il y a 2 parties)S
36 644.6 M(: la premi\350re indique l'\351tat "avant" avec une indication des lignes devant \352tre chang\351es ou effac\351es ; la)S
36 631.4 M(seconde indique l'\351tat "apr\350s", avec une indications des lignes qui ont \351t\351 chang\351es ou ajout\351es.)S
36 618.2 M(Utilisez la premi\350re partie pour trouver o\371 ajouter les lignes, et ajoutez les lignes qui sont indiqu\351es)S
36 605 M(dans la seconde partie.)S
36 578.6 M(Ceci ne devrait pas \352tre un probl\350me, ces patchs \351tant \340 jour pour les noyaux 2.0.37+.)S
36 565.4 M(Configurez votre noyau et s\351lectionnez les options suivantes - r\351pondez)S
/F6 SF ( YES)S
/F4 SF ( \340 ce qui suit :)S
9.2 FS/F0 SF 37.432 539.401 M(  * Prompt for development and/or incomplete code/drivers )S
37.432 528.401 M(    CONFIG_EXPERIMENTAL )S
37.432 517.401 M(        - Vous devez l'activer pour voir les options de masquage VPN)S
37.432 495.401 M(  * Networking support )S
37.432 484.401 M(    CONFIG_NET )S
37.432 462.401 M(  * Network firewalls )S
37.432 451.401 M(    CONFIG_FIREWALL )S
37.432 429.401 M(  * TCP/IP networking )S
37.432 418.401 M(    CONFIG_INET )S
37.432 396.401 M(  * IP: forwarding/gatewaying )S
37.432 385.401 M(    CONFIG_IP_FORWARD )S
37.432 363.401 M(  * IP: firewalling )S
37.432 352.401 M(    CONFIG_IP_FIREWALL )S
37.432 330.401 M(  * IP: masquerading \(EXPERIMENTAL\) )S
37.432 319.401 M(    CONFIG_IP_MASQUERADE )S
37.432 308.401 M(        - Option n\351cessaire.)S
37.432 286.401 M(  * IP: PPTP masq support \(EXPERIMENTAL\))S
37.432 275.401 M(    CONFIG_IP_MASQUERADE_PPTP)S
37.432 264.401 M(        - Active le masquage de canal de donn\351es PPTP, si vous)S
37.432 253.401 M(          masquez un client ou un serveur PPTP.)S
37.432 231.401 M(  * IP: PPTP Call ID masq support \(EXPERIMENTAL\))S
37.432 220.401 M(    CONFIG_IP_MASQUERADE_PPTP_MULTICLIENT)S
37.432 209.401 M(        - Active le masquage d'identifiant d'appel PPTP; n\351cessaire)S
37.432 198.401 M(          uniquement si vous comptez masquer plusieurs clients)S
37.432 187.401 M(          se connectant au m\352me serveur distant. N'activez PAS)S
37.432 176.401 M(          cette option si vous masquez un serveur PPTP.)S
37.432 154.401 M(  * IP: IPsec ESP & ISAKMP masq support \(EXPERIMENTAL\))S
37.432 143.401 M(    CONFIG_IP_MASQUERADE_IPSEC)S
37.432 132.401 M(        - Active le masquage IPsec, si vous masquez une machine)S
37.432 121.401 M(          IPsec.)S
37.432 99.401 M(  * IP: IPSEC masq table lifetime \(minutes\))S
37.432 88.401 M(        - Voyez avec votre administrateur r\351seau pour d\351terminer)S
37.432 77.401 M(          quel est "l'intervalle de renouvellement des cl\351s")S
37.432 66.401 M(          ou la "dur\351e de validit\351 d'une cl\351".)S
37.432 55.401 M(          La dur\351e de validit\351 par d\351faut pour les entr\351es de la)S
37.432 44.401 M(          table de masquage est de trente minutes.)S
37.432 33.401 M(          Si l'intervalle de renouvellement des cl\351s est sup\351rieur)S
11 FS/F4 SF 25 565.4 M(7. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.3. Patcher et configurer le noyau 2.0.x pour le support de masquage VPN)S
474.768 0 M(11)S
GR
SP
%%Page: 12 12
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 36 668.135 M 406.6 79.9 F
0.00 0.00 0.00 C 36 668.135 M 0.7 79.9 F
441.9 668.135 M 0.7 79.9 F
36 668.135 M 406.6 0.7 F
0.88 0.88 0.88 C 0 509.07 M 487.7 14.6 F
0.00 0.00 0.00 C 0 522.935 M 487.7 0.7 F
0 509.07 M 0.7 14.6 F
487 509.07 M 0.7 14.6 F
0 509.07 M 487.7 0.7 F
0 236.47 M 487.0 2.0 F
9.2 FS/F0 SF 37.432 737.401 M(          \340 trente minutes, vous devez alors augmenter la dur\351e )S
37.432 726.401 M(          de validit\351 jusqu'\340 une valeur l\351g\350rement sup\351rieure)S
37.432 715.401 M(          \340 l'intervalle de renouvellement des cl\351s.)S
37.432 693.401 M(  * IP: always defragment)S
37.432 682.401 M(    CONFIG_IP_ALWAYS_DEFRAG )S
37.432 671.401 M(        - Tr\350s fortement recommand\351 pour un pare-feu.)S
11 FS/F6 SF 36 643.935 M(NOTE :)S
/F4 SF ( ce ne sont que les \351l\351ments dont vous avez besoin pour le masquage. S\351lectionnez \351galement)S
36 630.735 M(toutes les autres options dont vous avez besoin pour votre configuration sp\351cifique.)S
36 617.535 M(Recompilez le noyau, et installez-le pour le tester. Ne remplacez pas un noyau qui marche par votre)S
36 604.335 M(nouveau noyau tant que vous n'avez pas v\351rifi\351 qu'il fonctionnait.)S
25 617.535 M(8. )S
0 551.535 M(Pour d\351terminer si le noyau qui tourne inclut ou non le support du masquage VPN, lancez la commande)S
0 538.335 M(suivante :)S
9.2 FS/F0 SF 1.432 512.336 M(grep -i masq /proc/ksyms)S
11 FS/F4 SF 0 484.87 M(...et cherchez les entr\351es suivantes :)S
36 458.47 M(Masquage IPsec :)S
/Fa SF ( ip_masq_out_get_isakmp)S
/F4 SF (,)S
/Fa SF ( ip_masq_in_get_isakmp)S
/F4 SF (,)S
/Fa SF ( ip_fw_masq_esp)S
/F4 SF ( et)S
/Fa SF 36 445.27 M(ip_fw_demasq_esp)S
/Fc SF 28.19 458.47 M(\267 )S
/F4 SF 36 432.07 M(Masquage PPTP :)S
/Fa SF ( ip_fw_masq_gre)S
/F4 SF ( et)S
/Fa SF ( ip_fw_demasq_gre)S
/Fc SF 28.19 432.07 M(\267 )S
/F4 SF 36 418.87 M(Masquage d'identifiant d'appel PPTP :)S
/Fa SF ( ip_masq_pptp)S
/Fc SF 28.19 418.87 M(\267 )S
/F4 SF 0 366.07 M(Si vous ne trouvez pas ces entr\351es, le masquage VPN n'est probablement pas support\351. Si vous avez des)S
0 352.87 M(messages d'erreurs sur l'indisponibilit\351 de)S
/Fa SF ( /proc/ksyms)S
/F4 SF ( ou de)S
/Fa SF ( /proc)S
/F4 SF (, assurez-vous d'avoir activ\351 le syst\350me)S
0 339.67 M(de fichiers)S
/Fa SF ( /proc)S
/F4 SF ( dans la configuration de votre noyau.)S
0 313.27 M(Regardez le Kernel HOWTO pour plus de d\351tails sur la configuration et la recompilation de votre noyau.)S
0 286.87 M(Si vous utilisez le masquage IPsec et que votre syst\350me g\351n\350re des erreurs de protection g\351n\351rale \(regardez)S
/Fa SF 0 273.67 M(/var/log/messages)S
/F4 SF (\) ou bien se bloque, regardez le site du masquage VPN pour une mise \340 jour. Ce patch est)S
0 260.47 M(pour le noyau 2.0.38, mais devrait fonctionner sur les noyaux ant\351rieurs. Il a \351t\351 soumis \340 Alan Cox pour \352tre)S
0 247.27 M(inclus dans le noyau 2.0.39.)S
13.2 FS/F9 SF 0 216.67 M(3.4. Patcher et configurer le noyau 2.2.x pour le support de masquage VPN)S
11 FS/F4 SF 36 163.43 M(Installez les sources du noyau \(de pr\351f\351rence version 2.2.17 ou plus\), que vous pouvez obtenir sur)S
36 150.23 M(http://www.kernel.org/ ou un miroir. Les sources doivent \352tre automatiquement extraites dans le)S
36 137.03 M(r\351pertoire)S
/Fa SF ( /usr/src/linux)S
/F4 SF (.)S
25 163.43 M(1. )S
36 123.83 M(Configurez et testez le masquage IP standard \(regardez le IP Masquerade HOWTO\). Ceci va vous)S
36 110.63 M(permettre de vous familiariser avec la recompilation de votre noyau, et plus largement, vous faire)S
36 97.43 M(aborder le masquage IP.)S
25 123.83 M(2. )S
/F6 SF 36 84.23 M(Sauvegardez les sources de votre noyau.)S
/F4 SF 25 84.23 M(3. )S
36 71.03 M(R\351cup\351rez le patch noyau depuis le site du masquage VPN indiqu\351 dans la section "Ressources" plus)S
36 57.83 M(haut.\15)S
25 71.03 M(4. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.4. Patcher et configurer le noyau 2.2.x pour le support de masquage VPN)S
474.768 0 M(12)S
GR
SP
%%Page: 13 13
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 72 628.535 M 374.2 14.6 F
0.00 0.00 0.00 C 72 642.4 M 374.2 0.7 F
72 628.535 M 0.7 14.6 F
445.5 628.535 M 0.7 14.6 F
72 628.535 M 374.2 0.7 F
0.88 0.88 0.88 C 72 561.87 M 374.2 14.6 F
0.00 0.00 0.00 C 72 575.735 M 374.2 0.7 F
72 561.87 M 0.7 14.6 F
445.5 561.87 M 0.7 14.6 F
72 561.87 M 374.2 0.7 F
0.88 0.88 0.88 C 72 501.806 M 450.1 47.6 F
0.00 0.00 0.00 C 72 548.67 M 450.1 0.7 F
72 501.806 M 0.7 47.6 F
521.365 501.806 M 0.7 47.6 F
72 501.806 M 450.1 0.7 F
0.88 0.88 0.88 C 72 463.741 M 395.1 25.6 F
0.00 0.00 0.00 C 72 488.606 M 395.1 0.7 F
72 463.741 M 0.7 25.6 F
466.365 463.741 M 0.7 25.6 F
72 463.741 M 395.1 0.7 F
0.88 0.88 0.88 C 36 22 M 406.6 270.9 F
0.00 0.00 0.00 C 36 292.141 M 406.6 0.7 F
36 22 M 0.7 270.9 F
441.9 22 M 0.7 270.9 F
11 FS/F4 SF 36 737 M(Pour les besoins de ce document, nous supposerons que vous avez sauvegard\351 le patch appropri\351 sous)S
/Fa SF 36 723.8 M(/usr/src/ip_masq_vpn.patch.gz)S
/F4 SF (.)S
36 710.6 M(Appliquez le patch de masquage VPN \340 votre noyau, si n\351cessaire.\15)S
72 657.8 M(Allez dans le r\351pertoire des sources :)S
9.2 FS/Fa SF 73.432 631.801 M(cd /usr/src)S
11 FS/Fc SF 60.967 657.8 M(\250 )S
/F4 SF 72 591.135 M(Appliquez le patch :)S
9.2 FS/Fa SF 73.432 565.136 M(zcat ip_masq_vpn.patch.gz | patch -l -p0 > vpn-patch.log 2>&1)S
/F0 SF 73.432 538.071 M(Notez que les options sont "tiret L minuscule, tiret P minuscule z\351ro".)S
73.432 527.071 M(Vous pourriez avoir des r\351sultats \351tranges si vous changez l'ordre des arguments,)S
73.432 516.071 M(car la commande patch semble sensible \340 l'ordre dans lequel ils apparaissent sur)S
73.432 505.071 M(la ligne de commande.)S
73.432 478.007 M(Notez \351galement que le r\351pertoire depuis lequel vous lancez la commande)S
73.432 467.007 M(patch est diff\351rent pour le patch noyau 2.2.x.)S
11 FS/Fc SF 60.967 591.135 M(\250 )S
/F4 SF 72 426.341 M(V\351rifiez le contenu du fichier)S
/Fa SF ( vpn-patch.log)S
/F4 SF ( pour voir si certaines \351tapes ont \351chou\351. Si des)S
72 413.141 M(\351tapes ont \351chou\351, alors vous avez s\373rement oubli\351 des options, ou lanc\351 la commande patch)S
72 399.941 M(depuis le mauvais r\351pertoire. Utilisez votre sauvegarde pour r\351cup\351rer votre noyau, et)S
72 386.741 M(recommencez.)S
/Fc SF 60.967 426.341 M(\250 )S
/F4 SF 25 710.6 M(5. )S
36 360.341 M(Si vous masquez un serveur VPN, vous n'avez)S
/F6 SF ( pas)S
/F4 SF ( besoin du patch)S
/Fa SF ( ipportfw)S
/F4 SF ( car la redirection de port)S
36 347.141 M(est maintenant de base. Regardez la page de manuel de)S
/Fa SF ( ipmasqadm)S
/F4 SF ( pour de plus amples d\351tails. Si)S
/Fa SF 36 333.941 M(ipmasqadm)S
/F4 SF ( n'est pas inclus dans votre distribution, vous pouvez l'obtenir \340 l'adresse)S
36 320.741 M(http://juanjox.kernelnotes.org/.)S
25 360.341 M(6. )S
36 307.541 M(Configurez votre noyau et s\351lectionnez les options suivantes - r\351pondez)S
/F6 SF ( YES)S
/F4 SF ( \340 ce qui suit :)S
9.2 FS/F0 SF 37.432 281.542 M(  * Prompt for development and/or incomplete code/drivers )S
37.432 270.542 M(    CONFIG_EXPERIMENTAL )S
37.432 259.542 M(        - Vous devez l'activer pour voir les options de masquage VPN.)S
37.432 237.542 M(  * Networking support )S
37.432 226.542 M(    CONFIG_NET )S
37.432 204.542 M(  * Network firewalls )S
37.432 193.542 M(    CONFIG_FIREWALL )S
37.432 171.542 M(  * TCP/IP networking )S
37.432 160.542 M(    CONFIG_INET )S
37.432 138.542 M(  * IP: firewalling )S
37.432 127.542 M(    CONFIG_IP_FIREWALL )S
37.432 105.542 M(  * IP: always defragment)S
37.432 94.542 M(    CONFIG_IP_ALWAYS_DEFRAG )S
37.432 83.542 M(        - N\351cessaire pour le masquage. Cette option peut \352tre)S
37.432 72.542 M(          ou ne pas \352tre dans la configuration de votre)S
37.432 61.542 M(          noyau. Si elle n'est pas pr\351sente, vous)S
37.432 50.542 M(          devez ex\351cuter ceci dans vos scripts de d\351marrage :)S
37.432 39.542 M(        echo 1 > /proc/sys/net/ipv4/ip_always_defrag)S
11 FS/F4 SF 25 307.541 M(7. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.4. Patcher et configurer le noyau 2.2.x pour le support de masquage VPN)S
474.768 0 M(13)S
GR
SP
%%Page: 14 14
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 36 272.135 M 406.6 475.9 F
0.00 0.00 0.00 C 36 272.135 M 0.7 475.9 F
441.9 272.135 M 0.7 475.9 F
36 272.135 M 406.6 0.7 F
0.88 0.88 0.88 C 36 86.671 M 406.6 146.6 F
0.00 0.00 0.00 C 36 232.535 M 406.6 0.7 F
36 86.671 M 0.7 146.6 F
441.9 86.671 M 0.7 146.6 F
36 86.671 M 406.6 0.7 F
9.2 FS/F0 SF 37.432 737.401 M(  * IP: masquerading \(EXPERIMENTAL\) )S
37.432 726.401 M(    CONFIG_IP_MASQUERADE )S
37.432 715.401 M(        - Option n\351cessaire.)S
37.432 693.401 M(  * IP: masquerading special modules support)S
37.432 682.401 M(    CONFIG_IP_MASQUERADE_MOD)S
37.432 671.401 M(        - Option n\351cessaire.)S
37.432 649.401 M(  * IP: ipportfw masq support \(EXPERIMENTAL\))S
37.432 638.401 M(    CONFIG_IP_MASQUERADE_IPPORTFW)S
37.432 627.401 M(        - Activer cette option va vous permettre de masquer un serveur VPN.)S
37.432 605.401 M(  * IP: PPTP masq support)S
37.432 594.401 M(    CONFIG_IP_MASQUERADE_PPTP)S
37.432 583.401 M(        - Active le masquage de canal de donn\351es PPTP, si vous)S
37.432 572.401 M(          masquez un client ou un serveur PPTP. Cette option)S
37.432 561.401 M(          est maintenant disponible en module.)S
37.432 550.401 M(          Notez que vous n'avez plus besoin de sp\351cifier)S
37.432 539.401 M(          le masquage d'identifiant d'appel.)S
37.432 517.401 M(  * IP: IPsec ESP & ISAKMP masq support \(EXPERIMENTAL\))S
37.432 506.401 M(    CONFIG_IP_MASQUERADE_IPSEC)S
37.432 495.401 M(        - Active le masquage IPsec, si vous masquez une machine)S
37.432 484.401 M(          IPsec. Cette option est maintenant disponible en module.)S
37.432 462.401 M(  * IP: IPsec masq table lifetime \(minutes\))S
37.432 451.401 M(        - Voyez avec votre administrateur r\351seau pour d\351terminer)S
37.432 440.401 M(          quel est "l'intervalle de renouvellement des cl\351s")S
37.432 429.401 M(          ou "la dur\351e de validit\351 d'une cl\351".)S
37.432 418.401 M(          La dur\351e de validit\351 par d\351faut pour les entr\351es de la)S
37.432 407.401 M(          table de masquage est de trente minutes.)S
37.432 396.401 M(          Si l'intervalle de renouvellement des cl\351s est sup\351rieur)S
37.432 385.401 M(          \340 trente minutes, vous devez alors augmenter la dur\351e )S
37.432 374.401 M(          de validit\351 jusqu'\340 une valeur l\351g\350rement sup\351rieure)S
37.432 363.401 M(          \340 l'intervalle de renouvellement des cl\351s.)S
37.432 341.401 M(  * IP: Enable parallel sessions \(possible security risk - see help\))S
37.432 330.401 M(    CONFIG_IP_MASQUERADE_IPSEC_PAROK)S
37.432 319.401 M(        - Regardez les notes techniques sur le masquage IPsec et)S
37.432 308.401 M(          la section sp\351ciale sur les informations sur la s\351curit\351 de ce HOWTO)S
37.432 297.401 M(          pour \352tre au courant des probl\350mes de s\351curit\351 lorsque)S
37.432 286.401 M(          vous faites du masquage. Si vous ne masquez qu'un seul client)S
37.432 275.401 M(          IPsec, cette option n'a aucun effet.)S
11 FS/F4 SF 36 247.935 M(R\351pondez)S
/F6 SF ( NO)S
/F4 SF ( \340 ce qui suit :)S
9.2 FS/F0 SF 37.432 221.936 M(  * IP: GRE tunnels over IP)S
37.432 210.936 M(    CONFIG_NET_IPGRE)S
37.432 199.936 M(        - Cette option n'a, contrairement aux apparences, )S
37.432 188.936 M(          *RIEN* \340 voir avec PPTP. Elle active le support)S
37.432 177.936 M(          pour les tunnels GRE tels qu'ils sont utilis\351s)S
37.432 166.936 M(          par les routeurs Cisco. Le fait que vous voyiez)S
37.432 155.936 M(          cette option n'implique pas que le support de)S
37.432 144.936 M(          PPTP est disponible. Vous devez toujours appliquer)S
37.432 133.936 M(          le patch pour le masquage VPN si les options )S
37.432 122.936 M(          PPTP list\351es ci-dessus n'apparaissent pas lorsque )S
37.432 111.936 M(          vous configurez votre noyau. N'activez PAS cette )S
37.432 100.936 M(          option, sauf si vous impl\351mentez un tunnel GRE)S
37.432 89.936 M(          vers un routeur Cisco.)S
11 FS/F6 SF 36 75.671 M(NOTE :)S
/F4 SF ( ce ne sont que les options dont vous avez besoin pour faire du masquage. S\351lectionnez)S
36 62.471 M(\351galement toutes les autres options dont vous avez besoin pour votre configuration sp\351cifique.)S
36 49.271 M(Recompilez le noyau et installez-le pour le tester. Ne remplacez jamais un noyau qui fonctionne par)S
36 36.071 M(votre nouveau noyau tant que vous n'avez pas la preuve qu'il fonctionne.)S
25 49.271 M(8. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.4. Patcher et configurer le noyau 2.2.x pour le support de masquage VPN)S
474.768 0 M(14)S
GR
SP
%%Page: 15 15
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 681.335 M 487.7 14.6 F
0.00 0.00 0.00 C 0 695.2 M 487.7 0.7 F
0 681.335 M 0.7 14.6 F
487 681.335 M 0.7 14.6 F
0 681.335 M 487.7 0.7 F
0.88 0.88 0.88 C 0 561.87 M 487.7 14.6 F
0.00 0.00 0.00 C 0 575.735 M 487.7 0.7 F
0 561.87 M 0.7 14.6 F
487 561.87 M 0.7 14.6 F
0 561.87 M 487.7 0.7 F
0 328.87 M 487.0 2.0 F
0.88 0.88 0.88 C 0 39.125 M 487.7 146.6 F
0.00 0.00 0.00 C 0 184.99 M 487.7 0.7 F
0 39.125 M 0.7 146.6 F
487 39.125 M 0.7 146.6 F
0 39.125 M 487.7 0.7 F
11 FS/F4 SF 0 710.6 M(Pour savoir si le noyau qui tourne contient le support de masquage VPN, lancez la commande suivante :)S
9.2 FS/F0 SF 1.432 684.601 M(grep -i masq /proc/ksyms)S
11 FS/F4 SF 0 657.135 M(...et cherchez les entr\351es suivantes :)S
36 630.735 M(Masquage IPsec :)S
/Fa SF ( ip_masq_esp)S
/F4 SF ( et)S
/Fa SF ( ip_demasq_esp)S
/Fc SF 28.19 630.735 M(\267 )S
/F4 SF 36 617.535 M(Masquage PPTP :)S
/Fa SF ( ip_masq_pptp_tcp)S
/F4 SF ( et)S
/Fa SF ( ip_demasq_pptp_tcp)S
/Fc SF 28.19 617.535 M(\267 )S
/F4 SF 0 591.135 M(Ou lancez :)S
9.2 FS/F0 SF 1.432 565.136 M(lsmod)S
11 FS/F4 SF 0 550.87 M(...et cherchez les entr\351es suivantes :)S
36 524.47 M(Masquage IPsec :)S
/Fa SF ( ip_masq_ipsec)S
/Fc SF 28.19 524.47 M(\267 )S
/F4 SF 36 511.27 M(Masquage PPTP :)S
/Fa SF ( ip_masq_pptp)S
/Fc SF 28.19 511.27 M(\267 )S
/F4 SF 0 458.47 M(Si vous ne voyez pas ces entr\351es, le support de masquage VPN n'est probablement pas activ\351 - avez-vous)S
0 445.27 M(bien tap\351)S
/Fa SF ( modprobe ip_masq_pptp.o)S
/F4 SF ( ou)S
/Fa SF ( modprobe ip_masq_ipsec.o)S
/F4 SF ( si vous les avez compil\351s en)S
0 432.07 M(modules ? Si le masquage VPN ne fonctionne plus apr\350s le red\351marrage de la machine, avez-vous ins\351r\351 les)S
0 418.87 M(commandes)S
/Fa SF ( modprobe)S
/F4 SF ( dans votre fichier de d\351marrage)S
/Fa SF ( /etc/rc.d/rc.local)S
/F4 SF ( ?)S
0 392.47 M(Si vous avez des messages d'erreur sur l'indisponibilit\351 de)S
/Fa SF ( /proc/ksyms)S
/F4 SF ( ou de)S
/Fa SF ( /proc)S
/F4 SF (, assurez-vous d'avoir)S
0 379.27 M(activ\351 le syst\350me de fichiers)S
/Fa SF ( /proc)S
/F4 SF ( lors de la configuration de votre noyau.)S
0 352.87 M(Allez voir le Kernel HOWTO pour de plus amples informations sur la configuration et la recompilation de)S
0 339.67 M(votre noyau.)S
13.2 FS/F9 SF 0 309.07 M(3.5. Param\351trage de ipfwadm pour un client ou un serveur VPN avec une)S
0 293.23 M(adresse IP priv\351e)S
11 FS/F4 SF 0 266.39 M(Le pare-feu doit maintenant \352tre configur\351 pour masquer le trafic VPN sortant. Vous pouvez souhaiter jeter)S
0 253.19 M(un coup d'oeil sur http://www.wolfenet.com/~jhardin/ipfwadm.html pour voir une interface graphique pour la)S
0 239.99 M(commande ipfwadm qui automatise une grande partie du param\351trage du filtrage de paquets au niveau de la)S
0 226.79 M(s\351curit\351.)S
0 200.39 M(Les r\350gles pare-feu minimales sont :)S
9.2 FS/F0 SF 1.432 174.391 M(# Met la politique par d\351faut de transmission des paquets \340 REFUS)S
1.432 163.391 M(ipfwadm -F -p deny)S
1.432 152.391 M(# Autorise le trafic sur le r\351seau local)S
1.432 141.391 M(ipfwadm -I -a accept    -S 10.0.0.0/8 -D 0.0.0.0/0  -W eth0)S
1.432 130.391 M(ipfwadm -O -a accept    -S 0.0.0.0/0  -D 10.0.0.0/8 -W eth0)S
1.432 119.391 M(# Masque le trafic pour les adresses internet et autorise le trafic internet)S
1.432 108.391 M(ipfwadm -F -a accept -m -S 10.0.0.0/8 -D 0.0.0.0/0  -W ppp0)S
1.432 97.391 M(ipfwadm -O -a accept    -S 0.0.0.0/0  -D 0.0.0.0/0  -W ppp0)S
1.432 86.391 M(ipfwadm -I -a accept    -S 0.0.0.0/0  -D 0.0.0.0/0  -W ppp0)S
1.432 75.391 M(ou, si vous avez une connexion permanente,)S
1.432 64.391 M(ipfwadm -F -a accept -m -S 10.0.0.0/8 -D 0.0.0.0/0  -W eth1)S
1.432 53.391 M(ipfwadm -O -a accept    -S 0.0.0.0/0  -D 0.0.0.0/0  -W eth1)S
1.432 42.391 M(ipfwadm -I -a accept    -S 0.0.0.0/0  -D 0.0.0.0/0  -W eth1)S
11 FS/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.5. Param\351trage de ipfwadm pour un client ou un serveur VPN avec une adresse IP priv\351e)S
474.768 0 M(15)S
GR
SP
%%Page: 16 16
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 223.735 M 487.7 432.6 F
0.00 0.00 0.00 C 0 655.6 M 487.7 0.7 F
0 223.735 M 0.7 432.6 F
487 223.735 M 0.7 432.6 F
0 223.735 M 487.7 0.7 F
0 175.535 M 487.0 2.0 F
0.88 0.88 0.88 C 0 22 M 487.7 76.4 F
0.00 0.00 0.00 C 0 97.655 M 487.7 0.7 F
0 22 M 0.7 76.4 F
487 22 M 0.7 76.4 F
11 FS/F4 SF 0 737 M(Mais ce param\351trage est compl\350tement ouvert. Il va permettre de masquer)S
/F6 SF ( tous)S
/F4 SF ( les trafics en provenance de)S
/F6 SF 0 723.8 M(toutes)S
/F4 SF ( les machines du r\351seau interne destin\351 \340)S
/F6 SF ( n'importe quelle)S
/F4 SF ( machine sur internet, et ne met en place)S
0 710.6 M(absolument)S
/F6 SF ( aucune)S
/F4 SF ( s\351curit\351.)S
0 684.2 M(Un param\351trage de pare-feu rigoureux n'autoriserait que le trafic entre le client et le serveur, et bloquerait tout)S
0 671 M(le reste :)S
9.2 FS/F0 SF 1.432 645.001 M(# Met la politique par d\351faut \340 REFUS :)S
1.432 634.001 M(ipfwadm -I -p deny)S
1.432 623.001 M(ipfwadm -O -p deny)S
1.432 612.001 M(ipfwadm -F -p deny)S
1.432 601.001 M(# Autorise le trafic sur le r\351seau local)S
1.432 590.001 M(ipfwadm -I -a accept -S 10.0.0.0/8 -D 0.0.0.0/0  -W eth0)S
1.432 579.001 M(ipfwadm -O -a accept -S 0.0.0.0/0  -D 10.0.0.0/8 -W eth0)S
1.432 568.001 M(# Masque uniquement le trafic VPN entre le client VPN et le serveur VPN)S
1.432 557.001 M(ipfwadm -F -a accept -m -P udp -S 10.0.0.2/32 500 -D 199.0.0.1/32 500  -W ppp0)S
1.432 546.001 M(ipfwadm -F -a accept -m -P tcp -S 10.0.0.2/32     -D 199.0.0.1/32 1723 -W ppp0)S
1.432 535.001 M(ipfwadm -F -a deny      -P tcp -S 10.0.0.2/32     -D 199.0.0.1/32      -W ppp0)S
1.432 524.001 M(ipfwadm -F -a deny      -P udp -S 10.0.0.2/32     -D 199.0.0.1/32      -W ppp0)S
1.432 513.001 M(ipfwadm -F -a accept -m -P all -S 10.0.0.2/32     -D 199.0.0.1/32      -W ppp0)S
1.432 502.001 M(ipfwadm -O -a accept    -P udp -S 200.200.200.0/24 500 -D 199.0.0.1/32 500  -W ppp0)S
1.432 491.001 M(ipfwadm -O -a accept    -P tcp -S 200.200.200.0/24     -D 199.0.0.1/32 1723 -W ppp0)S
1.432 480.001 M(ipfwadm -O -a deny      -P tcp -S 200.200.200.0/24     -D 199.0.0.1/32      -W ppp0)S
1.432 469.001 M(ipfwadm -O -a deny      -P udp -S 200.200.200.0/24     -D 199.0.0.1/32      -W ppp0)S
1.432 458.001 M(ipfwadm -O -a accept    -P all -S 200.200.200.0/24     -D 199.0.0.1/32      -W ppp0)S
1.432 447.001 M(ipfwadm -I -a accept    -P udp -S 199.0.0.1/32 500     -D 200.200.200.0/24 500 -W ppp0)S
1.432 436.001 M(ipfwadm -I -a accept    -P tcp -S 199.0.0.1/32 1723    -D 200.200.200.0/24     -W ppp0)S
1.432 425.001 M(ipfwadm -I -a deny      -P tcp -S 199.0.0.1/32         -D 200.200.200.0/24     -W ppp0)S
1.432 414.001 M(ipfwadm -I -a deny      -P udp -S 199.0.0.1/32         -D 200.200.200.0/24     -W ppp0)S
1.432 403.001 M(ipfwadm -I -a accept    -P all -S 199.0.0.1/32         -D 200.200.200.0/24     -W ppp0)S
1.432 392.001 M(ou, si vous avez une connexion permanente)S
1.432 381.001 M(ipfwadm -F -a accept -m -P udp -S 10.0.0.2/32 500 -D 199.0.0.1/32 500  -W eth1)S
1.432 370.001 M(ipfwadm -F -a accept -m -P tcp -S 10.0.0.2/32     -D 199.0.0.1/32 1723 -W eth1)S
1.432 359.001 M(ipfwadm -F -a deny      -P tcp -S 10.0.0.2/32     -D 199.0.0.1/32      -W eth1)S
1.432 348.001 M(ipfwadm -F -a deny      -P udp -S 10.0.0.2/32     -D 199.0.0.1/32      -W eth1)S
1.432 337.001 M(ipfwadm -F -a accept -m -P all -S 10.0.0.2/32     -D 199.0.0.1/32      -W eth1)S
1.432 326.001 M(ipfwadm -O -a accept    -P udp -S 200.200.200.200/32 500 -D 199.0.0.1/32 500  -W eth1)S
1.432 315.001 M(ipfwadm -O -a accept    -P tcp -S 200.200.200.200/32     -D 199.0.0.1/32 1723 -W eth1)S
1.432 304.001 M(ipfwadm -O -a deny      -P tcp -S 200.200.200.200/32     -D 199.0.0.1/32      -W eth1)S
1.432 293.001 M(ipfwadm -O -a deny      -P udp -S 200.200.200.200/32     -D 199.0.0.1/32      -W eth1)S
1.432 282.001 M(ipfwadm -O -a accept    -P all -S 200.200.200.200/32     -D 199.0.0.1/32      -W eth1)S
1.432 271.001 M(ipfwadm -I -a accept    -P udp -S 199.0.0.1/32 500  -D 200.200.200.200/32 500 -W eth1)S
1.432 260.001 M(ipfwadm -I -a accept    -P tcp -S 199.0.0.1/32 1723 -D 200.200.200.200/32     -W eth1)S
1.432 249.001 M(ipfwadm -I -a deny      -P tcp -S 199.0.0.1/32      -D 200.200.200.200/32     -W eth1)S
1.432 238.001 M(ipfwadm -I -a deny      -P udp -S 199.0.0.1/32      -D 200.200.200.200/32     -W eth1)S
1.432 227.001 M(ipfwadm -I -a accept    -P all -S 199.0.0.1/32      -D 200.200.200.200/32     -W eth1)S
11 FS/F4 SF 0 199.535 M(Note : ces r\350gles n'autorisent que le trafic VPN et bloquent)S
/F6 SF ( tout le reste)S
/F4 SF (. Vous devez ajouter des r\350gles pour)S
0 186.335 M(tous les autres flux que vous voulez autoriser, comme par exemple DNS, HTTP, POP, IMAP, etc...)S
13.2 FS/F9 SF 0 155.735 M(3.6. Param\351trage d'ipchains pour un client ou serveur VPN avec une adresse)S
0 139.895 M(IP priv\351e)S
11 FS/F4 SF 0 113.055 M(Les r\350gles pare-feu ipchains minimales sont :)S
9.2 FS/F0 SF 1.432 87.056 M(# Met la politique par d\351faut de transmission des paquets \340 REFUS)S
1.432 76.056 M(ipchains -P forward DENY)S
1.432 65.056 M(# Autorise le trafic sur le r\351seau local)S
1.432 54.056 M(ipchains -A input   -j ACCEPT -s 10.0.0.0/8 -d 0.0.0.0/0  -i eth0)S
1.432 43.056 M(ipchains -A output  -j ACCEPT -s 0.0.0.0/0  -d 10.0.0.0/8 -i eth0)S
1.432 32.056 M(# Masque le trafic vers les adresses internet et autorise le trafic internet)S
11 FS/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.6. Param\351trage d'ipchains pour un client ou serveur VPN avec une adresse IP priv\351e)S
474.768 0 M(16)S
GR
SP
%%Page: 17 17
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 668.135 M 487.7 79.9 F
0.00 0.00 0.00 C 0 668.135 M 0.7 79.9 F
487 668.135 M 0.7 79.9 F
0 668.135 M 487.7 0.7 F
0.88 0.88 0.88 C 0 152.67 M 532.6 410.6 F
0.00 0.00 0.00 C 0 562.535 M 532.6 0.7 F
0 152.67 M 0.7 410.6 F
531.864 152.67 M 0.7 410.6 F
0 152.67 M 532.6 0.7 F
0 51.67 M 487.0 2.0 F
9.2 FS/F0 SF 1.432 737.401 M(ipchains -A forward -j MASQ   -s 10.0.0.0/8 -d 0.0.0.0/0  -i ppp0)S
1.432 726.401 M(ipchains -A output  -j ACCEPT -s 0.0.0.0/0  -d 0.0.0.0/0  -i ppp0)S
1.432 715.401 M(ipchains -A input   -j ACCEPT -s 0.0.0.0/0  -d 0.0.0.0/0  -i ppp0)S
1.432 704.401 M(ou, si vous avez une connexion permanente,)S
1.432 693.401 M(ipchains -A forward -j MASQ   -s 10.0.0.0/8 -d 0.0.0.0/0  -i eth1)S
1.432 682.401 M(ipchains -A output  -j ACCEPT -s 0.0.0.0/0  -d 0.0.0.0/0  -i eth1)S
1.432 671.401 M(ipchains -A input   -j ACCEPT -s 0.0.0.0/0  -d 0.0.0.0/0  -i eth1)S
11 FS/F4 SF 0 643.935 M(Mais ce param\351trage est compl\350tement ouvert. Il va permettre de masquer)S
/F6 SF ( tous)S
/F4 SF ( les trafics en provenance de)S
/F6 SF 0 630.735 M(toutes)S
/F4 SF ( les machines du r\351seau interne destin\351 \340)S
/F6 SF ( n'importe quelle)S
/F4 SF ( machine sur internet, et ne met en place)S
0 617.535 M(absolument)S
/F6 SF ( aucune)S
/F4 SF ( s\351curit\351.)S
0 591.135 M(Un param\351trage de pare-feu rigoureux n'autoriserait que le trafic entre le client et le serveur, et bloquerait tout)S
0 577.935 M(le reste :)S
9.2 FS/F0 SF 1.432 551.936 M(# Met la politique par d\351faut \340 REFUS :)S
1.432 540.936 M(ipchains -P input   DENY)S
1.432 529.936 M(ipchains -P output  DENY)S
1.432 518.936 M(ipchains -P forward DENY)S
1.432 507.936 M(# Autorise le trafic sur le r\351seau local)S
1.432 496.936 M(ipchains -A input  -j ACCEPT -s 10.0.0.0/8 -d 0.0.0.0/0  -i eth0)S
1.432 485.936 M(ipchains -A output -j ACCEPT -s 0.0.0.0/0  -d 10.0.0.0/8 -i eth0)S
1.432 474.936 M(# Masque uniquement le trafic VPN entre le client VPN et le serveur VPN)S
1.432 463.936 M(# IPsec)S
1.432 452.936 M(ipchains -A forward -j MASQ   -p udp -s 10.0.0.2/32 500      -d 199.0.0.1/32 500     -i ppp0)S
1.432 441.936 M(ipchains -A output  -j ACCEPT -p udp -s 200.200.200.0/24 500 -d 199.0.0.1/32 500     -i ppp0)S
1.432 430.936 M(ipchains -A input   -j ACCEPT -p udp -s 199.0.0.1/32 500     -d 200.200.200.0/24 500 -i ppp0)S
1.432 419.936 M(ipchains -A forward -j MASQ   -p 50  -s 10.0.0.2/32          -d 199.0.0.1/32         -i ppp0)S
1.432 408.936 M(ipchains -A output  -j ACCEPT -p 50  -s 200.200.200.0/24     -d 199.0.0.1/32         -i ppp0)S
1.432 397.936 M(ipchains -A input   -j ACCEPT -p 50  -s 199.0.0.1/32         -d 200.200.200.0/24     -i ppp0)S
1.432 386.936 M(# PPTP)S
1.432 375.936 M(ipchains -A forward -j MASQ   -p tcp -s 10.0.0.2/32       -d 199.0.0.1/32 1723 -i ppp0)S
1.432 364.936 M(ipchains -A output  -j ACCEPT -p tcp -s 200.200.200.0/24  -d 199.0.0.1/32 1723 -i ppp0)S
1.432 353.936 M(ipchains -A input   -j ACCEPT -p tcp -s 199.0.0.1/32 1723 -d 200.200.200.0/24  -i ppp0)S
1.432 342.936 M(ipchains -A forward -j MASQ   -p 47  -s 10.0.0.2/32       -d 199.0.0.1/32      -i ppp0)S
1.432 331.936 M(ipchains -A output  -j ACCEPT -p 47  -s 200.200.200.0/24  -d 199.0.0.1/32      -i ppp0)S
1.432 320.936 M(ipchains -A input   -j ACCEPT -p 47  -s 199.0.0.1/32      -d 200.200.200.0/24  -i ppp0)S
1.432 309.936 M(ou, si vous avez une connexion permanente,)S
1.432 298.936 M(# IPsec)S
1.432 287.936 M(ipchains -A forward -j MASQ   -p udp -s 10.0.0.2/32 500        -d 199.0.0.1/32 500       -i eth1)S
1.432 276.936 M(ipchains -A output  -j ACCEPT -p udp -s 200.200.200.200/32 500 -d 199.0.0.1/32 500       -i eth1)S
1.432 265.936 M(ipchains -A input   -j ACCEPT -p udp -s 199.0.0.1/32 500       -d 200.200.200.200/32 500 -i eth1)S
1.432 254.936 M(ipchains -A forward -j MASQ   -p 50  -s 10.0.0.2/32            -d 199.0.0.1/32           -i eth1)S
1.432 243.936 M(ipchains -A output  -j ACCEPT -p 50  -s 200.200.200.200/32     -d 199.0.0.1/32           -i eth1)S
1.432 232.936 M(ipchains -A input   -j ACCEPT -p 50  -s 199.0.0.1/32           -d 200.200.200.200/32     -i eth1)S
1.432 221.936 M(# PPTP)S
1.432 210.936 M(ipchains -A forward -j MASQ   -p tcp -s 10.0.0.2/32        -d 199.0.0.1/32 1723  -i eth1)S
1.432 199.936 M(ipchains -A output  -j ACCEPT -p tcp -s 200.200.200.200/32 -d 199.0.0.1/32 1723  -i eth1)S
1.432 188.936 M(ipchains -A input   -j ACCEPT -p tcp -s 199.0.0.1/32 1723  -d 200.200.200.200/32 -i eth1)S
1.432 177.936 M(ipchains -A forward -j MASQ   -p 47  -s 10.0.0.2/32        -d 199.0.0.1/32       -i eth1)S
1.432 166.936 M(ipchains -A output  -j ACCEPT -p 47  -s 200.200.200.200/32 -d 199.0.0.1/32       -i eth1)S
1.432 155.936 M(ipchains -A input   -j ACCEPT -p 47  -s 199.0.0.1/32       -d 200.200.200.200/32 -i eth1)S
11 FS/F4 SF 0 128.47 M(Note : ces r\350gles n'autorisent que le trafic VPN. Vous devrez ajouter des r\350gles pour tous les autres flux que)S
0 115.27 M(vous souhaitez autoriser, comme par exemple DNS, HTTP, POP, IMAP, etc...)S
0 88.87 M(Notez \351galement combien ces r\350gles sont plus propres et plus faciles \340 comprendre que les r\350gles ipfwadm)S
0 75.67 M(\351quivalentes. C'est parce que ipchains autorise la sp\351cification de tous les protocoles IP, et pas seulement)S
0 62.47 M(TCP, UDP, ICMP, ou ALL.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.6. Param\351trage d'ipchains pour un client ou serveur VPN avec une adresse IP priv\351e)S
474.768 0 M(17)S
GR
SP
%%Page: 18 18
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 652.295 M 487.7 14.6 F
0.00 0.00 0.00 C 0 666.16 M 487.7 0.7 F
0 652.295 M 0.7 14.6 F
487 652.295 M 0.7 14.6 F
0 652.295 M 487.7 0.7 F
0 458.895 M 487.0 2.0 F
0.88 0.88 0.88 C 36 48.15 M 406.6 69.6 F
0.00 0.00 0.00 C 36 117.015 M 406.6 0.7 F
36 48.15 M 0.7 69.6 F
441.9 48.15 M 0.7 69.6 F
36 48.15 M 406.6 0.7 F
13.2 FS/F9 SF 0 734.8 M(3.7. Une note sur l'adressage IP dynamique)S
11 FS/F4 SF 0 707.96 M(Si votre pare-feu se voit attribuer une adresse IP dynamique par votre FAI \(les comptes modems fonctionnent)S
0 694.76 M(comme \347a, ainsi que certains cablo-op\351rateurs\), alors vous devez ajouter ce qui suit au script de d\351marrage)S
/Fa SF 0 681.56 M(/etc/rc.d/rc.local)S
/F4 SF (:)S
9.2 FS/F0 SF 1.432 655.561 M(echo 7 > /proc/sys/net/ipv4/ip_dynaddr)S
11 FS/F4 SF 0 628.095 M(Ceci active le suivi d'adresse IP dynamique, ce qui signifie que si votre connexion tombe et remonte, toutes)S
0 614.895 M(les sessions actives seront mises \340 jour avec la nouvelle adresse IP plut\364t que de continuer \340 essayer d'utiliser)S
0 601.695 M(l'ancienne adresse IP. Cela ne veut pas dire que les sessions resteront actives malgr\351 l'interruption, mais plut\364t)S
0 588.495 M(qu'elles se fermeront rapidement.)S
0 562.095 M(Si vous ne le faites pas, il peut y avoir une "p\351riode de latence" apr\350s la reconnexion et avant l'expiration des)S
0 548.895 M(anciennes entr\351es de la table de masquage pendant laquelle vous serez masqu\351 avec la mauvaise adresse IP, ce)S
0 535.695 M(qui vous emp\352chera d'\351tablir une connexion.)S
0 509.295 M(Ceci est particuli\350rement utile si vous utilisez un d\351mon de demande de connexion comme)S
/Fa SF ( diald)S
/F4 SF ( pour g\351rer)S
0 496.095 M(votre connexion modem.)S
0 469.695 M(Regardez le fichier)S
/Fa SF ( /usr/src/linux/Documentation/networking/ip_dynaddr.txt)S
/F4 SF ( pour de plus amples d\351tails.)S
13.2 FS/F9 SF 0 439.095 M(3.8. Param\351trages additionnels pour un serveur VPN avec une adresse IP)S
0 423.255 M(priv\351e)S
11 FS/F4 SF 0 396.415 M(Si vous mettez en place le masquage VPN pour un serveur VPN avec une adresse IP priv\351e \(c'est \340 dire que)S
0 383.215 M(vous voulez faire du masquage aussi bien pour les connexions)S
/F6 SF ( entrantes)S
/F4 SF ( que)S
/F6 SF ( sortantes)S
/F4 SF (\), vous avez \351galement)S
0 370.015 M(besoin d'installer deux outils de transmission de paquets. L'un\()S
/Fa SF (ipportfw)S
/F4 SF (\) fait suivre le trafic TCP ou UDP)S
0 356.815 M(entrant adress\351 \340 un port sp\351cifique du pare-feu vers une machine sur le r\351seau local derri\350re le pare-feu. Il)S
0 343.615 M(est utilis\351 pour rediriger le canal de contr\364le PPTP initial 1723/tcp en entr\351e, ou le trafic ISAKMP 500/udp)S
0 330.415 M(vers le serveur VPN. L'autre \()S
/Fa SF (ipfwd)S
/F4 SF (\) est un outil de transmission de paquets plus g\351n\351rique, qui peut \352tre)S
0 317.215 M(utilis\351 pour tous les protocoles IP. Il est utilis\351 pour faire suivre le trafic entrant initial 47/ip \(GRE\) ou 50/ip)S
0 304.015 M(\(ESP\) du canal de donn\351es vers le serveur VPN.)S
0 277.615 M(Les sorties en r\351ponse au trafic entrant 1723/tcp ou 500/udp sont masqu\351es gr\342ce aux fonctionnalit\351s standard)S
0 264.415 M(de masquage IP du noyau Linux. Le trafic sortant 47/ip ou 50/ip est masqu\351 gr\342ce au patch du noyau pour le)S
0 251.215 M(masquage VPN que vous avez install\351 pr\351c\351demment.)S
0 224.815 M(Une fois que ces outils sont install\351s, vous devez les configurer pour faire suivre le trafic vers le serveur VPN.)S
36 172.015 M(Param\351trer)S
/Fa SF ( ipportfw)S
/F4 SF ( pour les noyaux 2.0.x\15)S
36 145.615 M(Les commandes suivantes vont param\351trer)S
/Fa SF ( ipportfw)S
/F4 SF ( pour faire suivre le trafic 500/udp entrant vers le)S
36 132.415 M(serveur IPsec :)S
9.2 FS/F0 SF 37.432 106.416 M(# Param\351trage d'ipportfw pour IPsec avec une adresse IP statique)S
37.432 95.416 M(# Vide la table de redirection d'ipportfw)S
37.432 84.416 M(/sbin/ipportfw -C)S
37.432 73.416 M(# Fait suivre le trafic adress\351 au port 500/udp du pare-feu)S
37.432 62.416 M(# au port 500/udp du serveur IPsec)S
37.432 51.416 M(/sbin/ipportfw -A -u 200.200.200.200/500 -R 10.0.0.2/500)S
11 FS/Fc SF 28.19 172.015 M(\267 )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.7. Une note sur l'adressage IP dynamique)S
474.768 0 M(18)S
GR
SP
%%Page: 19 19
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 36 639.535 M 406.6 69.6 F
0.00 0.00 0.00 C 36 708.4 M 406.6 0.7 F
36 639.535 M 0.7 69.6 F
441.9 639.535 M 0.7 69.6 F
36 639.535 M 406.6 0.7 F
0.88 0.88 0.88 C 36 491.47 M 406.6 69.6 F
0.00 0.00 0.00 C 36 560.335 M 406.6 0.7 F
36 491.47 M 0.7 69.6 F
441.9 491.47 M 0.7 69.6 F
36 491.47 M 406.6 0.7 F
0.88 0.88 0.88 C 36 409.406 M 406.6 69.6 F
0.00 0.00 0.00 C 36 478.27 M 406.6 0.7 F
36 409.406 M 0.7 69.6 F
441.9 409.406 M 0.7 69.6 F
36 409.406 M 406.6 0.7 F
0.88 0.88 0.88 C 36 303.141 M 406.6 14.6 F
0.00 0.00 0.00 C 36 317.006 M 406.6 0.7 F
36 303.141 M 0.7 14.6 F
441.9 303.141 M 0.7 14.6 F
36 303.141 M 406.6 0.7 F
0.88 0.88 0.88 C 36 236.476 M 406.6 14.6 F
0.00 0.00 0.00 C 36 250.341 M 406.6 0.7 F
36 236.476 M 0.7 14.6 F
441.9 236.476 M 0.7 14.6 F
36 236.476 M 406.6 0.7 F
0 69.476 M 487.0 2.0 F
11 FS/F4 SF 36 737 M(Les commandes suivantes vont param\351trer)S
/Fa SF ( ipportfw)S
/F4 SF ( pour faire suivre le trafic entrant 1723/tcp initial)S
36 723.8 M(vers le serveur PPTP :)S
9.2 FS/F0 SF 37.432 697.801 M(# Param\351trage d'ipportfw pour PPTP avec une adresse IP statique)S
37.432 686.801 M(# Vide la table de redirection d'ipportfw)S
37.432 675.801 M(/sbin/ipportfw -C)S
37.432 664.801 M(# Fait suivre le trafic adress\351 au port 1723/tcp du pare-feu)S
37.432 653.801 M(# vers le port 1723/tcp du serveur PPTP)S
37.432 642.801 M(/sbin/ipportfw -A -t 200.200.200.200/1723 -R 10.0.0.2/1723)S
11 FS/F4 SF 36 628.535 M(Notez que les param\350tres d'ipportfw contiennent l'adresse IP internet du pare-feu, et que vous ne)S
36 615.335 M(pouvez pas sp\351cifier l'interface \(par exemple)S
/Fa SF ( ppp0)S
/F4 SF (\) contrairement \340 ipfwadm. Ceci veut dire que dans)S
36 602.135 M(le cas d'une connexion IP dynamique \(comme pour une connexion PPP par modem\) vous devez)S
36 588.935 M(lancer ces commandes \340 chaque fois que vous vous connectez \340 internet, et qu'une nouvelle adresse IP)S
36 575.735 M(vous est attribu\351e. Vous pouvez le faire assez facilement - ajoutez simplement les lignes suivantes \340)S
36 562.535 M(votre script)S
/Fa SF ( /etc/ppp/ip-up)S
/F4 SF ( ou)S
/Fa SF ( /etc/ppp/ip-up.local)S
/F4 SF ( :)S
9.2 FS/F0 SF 37.432 549.736 M(# Param\351trage d'ippportfw pour IPsec avec une adresse IP dynamique)S
37.432 538.736 M(# Vide la table de redirection d'ipportfw)S
37.432 527.736 M(/sbin/ipportfw -C)S
37.432 516.736 M(# Fait suivre le trafic adress\351 au port 500/udp du pare-feu)S
37.432 505.736 M(# vers le port 500/udp du serveur IPsec)S
37.432 494.736 M(/sbin/ipportfw -A -u ${4}/500 -R 10.0.0.2/500)S
11 FS/F4 SF 36 480.47 M(ou :)S
9.2 FS/F0 SF 37.432 467.671 M(# Param\351trage d'ipportfw pour PPTP avec une adresse IP dynamique)S
37.432 456.671 M(# Vide la table de redirection d'ipportfw)S
37.432 445.671 M(/sbin/ipportfw -C)S
37.432 434.671 M(# Fait suivre le trafic adress\351 au port 1723/tcp du pare-feu)S
37.432 423.671 M(# vers le port 1723 du serveur PPTP)S
37.432 412.671 M(/sbin/ipportfw -A -t ${4}/1723 -R 10.0.0.2/1723)S
11 FS/F4 SF 36 398.406 M(Allez voir http://www.wolfenet.com/~jhardin/ipfwadm/invocation.html pour de plus amples d\351tails)S
36 385.206 M(sur la mise en place d'un pare-feu avec une adresse IP dynamique.)S
36 372.006 M(Configurer)S
/Fa SF ( ipfwd)S
/F4 SF ( pour les noyaux 2.0.x et 2.2.x\15)S
36 345.606 M(La commande suivante va param\351trer)S
/Fa SF ( ipfwd)S
/F4 SF ( pour faire suivre le trafic entrant 50/ip initial au le)S
36 332.406 M(serveur IPsec :)S
9.2 FS/F0 SF 37.432 306.407 M(/sbin/ipfwd --masq 10.0.0.2 50 &)S
11 FS/F4 SF 36 278.941 M(La commande suivante va param\351trer)S
/Fa SF ( ipfwd)S
/F4 SF ( pour faire suivre le trafic entrant 47/ip initial au serveur)S
36 265.741 M(PPTP :)S
9.2 FS/F0 SF 37.432 239.742 M(/sbin/ipfwd --masq 10.0.0.2 47 &)S
11 FS/F4 SF 36 225.476 M(Cette commande n'a besoin d'\352tre ex\351cut\351e qu'une seule fois, depuis votre script)S
/Fa SF ( /etc/rc.d/rc.local)S
/F4 SF (.)S
/Fc SF 28.19 372.006 M(\267 )S
/F4 SF 0 172.676 M(Les techniques d\351crites ici peuvent \352tre g\351n\351ralis\351es pour autoriser le masquage de la plupart des serveurs -)S
0 159.476 M(HTTP, FTP, SMTP, etc. Les serveurs qui sont bas\351s uniquement sur TCP ou UDP n'ont pas besoin de)S
/Fa SF ( ipfwd)S
/F4 SF (.)S
0 133.076 M(Si vous masquez un serveur PPTP, vous avez aussi besoin de vous assurer que vous n'avez)S
/F6 SF ( pas)S
/F4 SF ( activ\351 le)S
0 119.876 M(masquage d'identifiant d'appel PPTP dans le noyau. L'activation du masquage d'identifiant d'appel PPTP fait)S
0 106.676 M(croire que vous masquez uniquement des clients PPTP, l'activer risque donc de vous emp\352cher de masquer)S
0 93.476 M(correctement le trafic du serveur PPTP. Cela signifie \351galement qu'avec la version 2.0.x du patch, vous ne)S
0 80.276 M(pouvez pas masquer simultan\351ment un serveur PPTP et des clients PPTP.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.7. Une note sur l'adressage IP dynamique)S
474.768 0 M(19)S
GR
SP
%%Page: 20 20
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 205.255 M 521.6 366.6 F
0.00 0.00 0.00 C 0 571.12 M 521.6 0.7 F
0 205.255 M 0.7 366.6 F
520.864 205.255 M 0.7 366.6 F
0 205.255 M 521.6 0.7 F
0 143.855 M 487.0 2.0 F
13.2 FS/F9 SF 0 734.8 M(3.9. Param\351trage d'ipfwadm pour un serveur VPN avec une adresse IP)S
0 718.96 M(publique)S
11 FS/F4 SF 0 692.12 M(Mettre en place un serveur VPN avec une adresse IP publique se trouvant derri\350re un pare-feu Linux est un)S
0 678.92 M(simple probl\350me de routage et de filtrage de paquets. Le masquage n'est pas n\351cessaire.)S
0 652.52 M(Malheureusement les noyaux 2.0.x ne nous permettent pas de pr\351ciser le protocole IP 47 ou 50, donc ce)S
0 639.32 M(pare-feu est moins s\373r que ce qu'il aurait pu \352tre. Si cela vous pose un probl\350me, alors installez le patch noyau)S
0 626.12 M(pour les cha\356nes pare-feu IP ou passez \340 un noyau de la s\351rie 2.1.x ou 2.2.x, avec lesquels vous pouvez faire)S
0 612.92 M(du filtrage par protocole IP.)S
0 586.52 M(Les r\350gles pare-feu vont avoir un peu cette t\352te l\340 :)S
9.2 FS/F0 SF 1.432 560.521 M(# Cette section doit se trouver apr\350s vos autres r\350gles pare-feu)S
1.432 538.521 M(# Pr\351cisez explicitement les clients potentiels pour plus de s\351curit\351)S
1.432 527.521 M(# Autorise le trafic ISAKMP IPsec entrant et sortant.)S
1.432 516.521 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P udp -S 199.0.0.2/32 500 -D 222.0.0.2/32 500)S
1.432 505.521 M(ipfwadm -O -a accept -W eth1 -V 200.200.200.200 -P udp -D 199.0.0.2/32 500 -S 222.0.0.2/32 500)S
1.432 494.521 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P udp -S 199.0.0.3/32 500 -D 222.0.0.2/32 500)S
1.432 483.521 M(ipfwadm -O -a accept -W eth1 -V 200.200.200.200 -P udp -D 199.0.0.3/32 500 -S 222.0.0.2/32 500)S
1.432 472.521 M(# Autorise le canal de contr\364le PPTP en entr\351e et en sortie)S
1.432 461.521 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P tcp -S 199.0.0.2/32 -D 222.0.0.2/32 1723)S
1.432 450.521 M(ipfwadm -O -a accept -W eth1 -V 200.200.200.200 -P tcp -D 199.0.0.2/32 -S 222.0.0.2/32 1723)S
1.432 439.521 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P tcp -S 199.0.0.3/32 -D 222.0.0.2/32 1723)S
1.432 428.521 M(ipfwadm -O -a accept -W eth1 -V 200.200.200.200 -P tcp -D 199.0.0.3/32 -S 222.0.0.2/32 1723)S
1.432 406.521 M(# Bloque tous les autres trafics TCP et UDP en provenance d'internet)S
1.432 395.521 M(# Ceci est principalement une r\350gle "d\351faut refus TCP/UDP" qui)S
1.432 384.521 M(# ne s'applique qu'\340 l'interface internet.)S
1.432 373.521 M(ipfwadm -I -a deny -W eth1 -V 200.200.200.200 -P tcp)S
1.432 362.521 M(ipfwadm -I -a deny -W eth1 -V 200.200.200.200 -P udp)S
1.432 340.521 M(# Pr\351cisez explicitement les clients potentiels pour plus de s\351curit\351)S
1.432 329.521 M(# Notez que ce param\351trage est trop large, car nous sommes)S
1.432 318.521 M(# oblig\351s de pr\351ciser "-P all" au lieu de "-P 47" ou "-P 50"...)S
1.432 307.521 M(# Autorise le canal de donn\351es PPTP et le trafic ESP IPsec entrant et sortant.)S
1.432 296.521 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P all -S 199.0.0.2/32 -D 222.0.0.2/32)S
1.432 285.521 M(ipfwadm -0 -a accept -W eth1 -V 200.200.200.200 -P all -D 199.0.0.2/32 -S 222.0.0.2/32)S
1.432 274.521 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P all -S 199.0.0.3/32 -D 222.0.0.2/32)S
1.432 263.521 M(ipfwadm -O -a accept -W eth1 -V 200.200.200.200 -P all -D 199.0.0.3/32 -S 222.0.0.2/32)S
1.432 241.521 M(# Bloque tous les autres trafics en provenance d'internet.)S
1.432 230.521 M(# Ceci est principalement une r\350gle du type "par d\351faut, refus")S
1.432 219.521 M(# qui ne s'applique qu'\340 l'interface internet.)S
1.432 208.521 M(ipfwadm -I -a deny -W eth1 -V 200.200.200.200)S
11 FS/F4 SF 0 181.055 M(Si vous installez des r\350gles pare-feu ou des r\350gle de transmission de paquets sur l'interface interne, vous aurez)S
0 167.855 M(\340 faire quelque chose de semblable. L'exemple ci-dessus ne concerne que le trafic VPN ; il vous faut l'ins\351rer)S
0 154.655 M(dans votre param\351trage pare-feu actuel pour autoriser les autres trafics dont vous avez besoin.)S
13.2 FS/F9 SF 0 124.055 M(3.10. Param\351trage d'ipfwadm pour un client VPN avec une adresse IP)S
0 108.215 M(publique)S
11 FS/F4 SF 0 81.375 M(La mise en place d'un client VPN avec une adresse IP publique derri\350re un pare-feu Linux est similaire \340 celle)S
0 68.175 M(d'un serveur VPN avec une adresse IP publique.)S
0 41.775 M(Les r\350gles pare-feu auront cette allure :)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.9. Param\351trage d'ipfwadm pour un serveur VPN avec une adresse IP publique)S
474.768 0 M(20)S
GR
SP
%%Page: 21 21
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 492.135 M 521.6 256.6 F
0.00 0.00 0.00 C 0 748 M 521.6 0.7 F
0 492.135 M 0.7 256.6 F
520.864 492.135 M 0.7 256.6 F
0 492.135 M 521.6 0.7 F
0 483.535 M 487.0 2.0 F
0.88 0.88 0.88 C 0 118.99 M 487.7 234.6 F
0.00 0.00 0.00 C 0 352.855 M 487.7 0.7 F
0 118.99 M 0.7 234.6 F
487 118.99 M 0.7 234.6 F
0 118.99 M 487.7 0.7 F
0 57.59 M 487.0 2.0 F
9.2 FS/F0 SF 1.432 737.401 M(# Autorise le trafic ISAKMP IPsec entrant et sortant.)S
1.432 726.401 M(ipfwadm -O -a accept -W eth1 -V 200.200.200.200 -P udp -S 222.0.0.2/32 500 -D 199.0.0.1/32 500)S
1.432 715.401 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P udp -D 222.0.0.2/32 500 -S 199.0.0.1/32 500)S
1.432 704.401 M(# Autorise le canal de contr\364le PPTP en entr\351e et en sortie.)S
1.432 693.401 M(ipfwadm -O -a accept -W eth1 -V 200.200.200.200 -P tcp -S 222.0.0.2/32 -D 199.0.0.1/32 1723)S
1.432 682.401 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P tcp -D 222.0.0.2/32 -S 199.0.0.1/32 1723)S
1.432 660.401 M(# Bloque tous les autres trafics TCP et UDP en provenance d'internet.)S
1.432 649.401 M(# Ceci est principalement une r\350gle "par d\351faut, refus de TCP/UDP" qui)S
1.432 638.401 M(# ne s'applique qu'\340 l'interface internet.)S
1.432 627.401 M(ipfwadm -I -a deny -W eth1 -V 200.200.200.200 -P tcp)S
1.432 616.401 M(ipfwadm -I -a deny -W eth1 -V 200.200.200.200 -P udp)S
1.432 594.401 M(# Notez que ce param\351trage est trop large, car nous sommes)S
1.432 583.401 M(# oblig\351s de pr\351ciser "-P all" au lieu de "-P 47" ou "-P 50"...)S
1.432 572.401 M(# Autorise le canal de donn\351es PPTP et le trafic ESP IPsec entrant et sortant.)S
1.432 561.401 M(ipfwadm -O -a accept -W eth1 -V 200.200.200.200 -P all -S 222.0.0.2/32 -D 199.0.0.1/32)S
1.432 550.401 M(ipfwadm -I -a accept -W eth1 -V 200.200.200.200 -P all -D 222.0.0.2/32 -S 199.0.0.1/32)S
1.432 528.401 M(# Bloque tous les autres trafics en provenance d'internet.)S
1.432 517.401 M(# Ceci est principalement une r\350gle du type "par d\351faut, refus")S
1.432 506.401 M(# qui ne s'applique qu'\340 l'interface internet.)S
1.432 495.401 M(ipfwadm -I -a deny -W eth1 -V 200.200.200.200)S
13.2 FS/F9 SF 0 463.735 M(3.11. Param\351trage d'ipchains pour un serveur VPN avec une adresse IP)S
0 447.895 M(publique)S
11 FS/F4 SF 0 421.055 M(Mettre en place un serveur VPN avec une adresse IP publique derri\350re un pare-feu Linux correspond \340)S
0 407.855 M(v\351rifier que les commandes de routage et de filtrage de paquet appropri\351es sont bien en place. Le masquage)S
0 394.655 M(n'est pas n\351cessaire.)S
0 368.255 M(Les r\350gles pare-feu auront cette allure :)S
9.2 FS/F0 SF 1.432 342.256 M(# Sp\351cifiez explicitement les clients potentiels pour plus de s\351curit\351.)S
1.432 331.256 M(# Autorise le trafic ISAKMP IPsec entrant et sortant.)S
1.432 320.256 M(ipchains -A input  -j ACCEPT -p udp -s 199.0.0.2/32 500 -d 222.0.0.2/32 500 -i eth1)S
1.432 309.256 M(ipchains -A output -j ACCEPT -p udp -d 199.0.0.2/32 500 -s 222.0.0.2/32 500 -i eth1)S
1.432 298.256 M(ipchains -A input  -j ACCEPT -p udp -s 199.0.0.3/32 500 -d 222.0.0.2/32 500 -i eth1)S
1.432 287.256 M(ipchains -A output -j ACCEPT -p udp -d 199.0.0.3/32 500 -s 222.0.0.2/32 500 -i eth1)S
1.432 276.256 M(# Autorise le trafic ESP IPsec entrant et sortant.)S
1.432 265.256 M(ipchains -A input  -j ACCEPT -p 50  -s 199.0.0.2/32     -d 222.0.0.2/32     -i eth1)S
1.432 254.256 M(ipchains -A output -j ACCEPT -p 50  -d 199.0.0.2/32     -s 222.0.0.2/32     -i eth1)S
1.432 243.256 M(ipchains -A input  -j ACCEPT -p 50  -s 199.0.0.3/32     -d 222.0.0.2/32     -i eth1)S
1.432 232.256 M(ipchains -A output -j ACCEPT -p 50  -d 199.0.0.3/32     -s 222.0.0.2/32     -i eth1)S
1.432 221.256 M(# Autorise le canal de contr\364le PPTP en entr\351e et en sortie.)S
1.432 210.256 M(ipchains -A input  -j ACCEPT -p tcp -s 199.0.0.2/32 -d 222.0.0.2/32 1723 -i eth1)S
1.432 199.256 M(ipchains -A output -j ACCEPT -p tcp -d 199.0.0.2/32 -s 222.0.0.2/32 1723 -i eth1)S
1.432 188.256 M(ipchains -A input  -j ACCEPT -p tcp -s 199.0.0.3/32 -d 222.0.0.2/32 1723 -i eth1)S
1.432 177.256 M(ipchains -A output -j ACCEPT -p tcp -d 199.0.0.3/32 -s 222.0.0.2/32 1723 -i eth1)S
1.432 166.256 M(# Autorise le tunnel PPTP en entr\351e et en sortie.)S
1.432 155.256 M(ipchains -A input  -j ACCEPT -p 47  -s 199.0.0.2/32 -d 222.0.0.2/32      -i eth1)S
1.432 144.256 M(ipchains -A output -j ACCEPT -p 47  -d 199.0.0.2/32 -s 222.0.0.2/32      -i eth1)S
1.432 133.256 M(ipchains -A input  -j ACCEPT -p 47  -s 199.0.0.3/32 -d 222.0.0.2/32      -i eth1)S
1.432 122.256 M(ipchains -A output -j ACCEPT -p 47  -d 199.0.0.3/32 -s 222.0.0.2/32      -i eth1)S
11 FS/F4 SF 0 94.79 M(Si vous installez des r\350gles pare-feu ou des r\350gles de transmission de paquets sur l'interface interne, vous)S
0 81.59 M(aurez \340 faire quelque chose de semblable. L'exemple ci-dessus ne concerne que le trafic VPN ; il vous faut)S
0 68.39 M(l'ins\351rer dans votre param\351trage pare-feu actuel pour autoriser les autres trafics dont vous avez besoin.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.11. Param\351trage d'ipchains pour un serveur VPN avec une adresse IP publique)S
474.768 0 M(21)S
GR
SP
%%Page: 22 22
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 502.255 M 487.7 135.6 F
0.00 0.00 0.00 C 0 637.12 M 487.7 0.7 F
0 502.255 M 0.7 135.6 F
487 502.255 M 0.7 135.6 F
0 502.255 M 487.7 0.7 F
0 493.655 M 487.0 2.0 F
0 264.615 M 487.0 2.0 F
0 101.575 M 487.0 2.0 F
13.2 FS/F9 SF 0 734.8 M(3.12. Param\351trage d'ipchains pour un client VPN avec une adresse IP)S
0 718.96 M(publique)S
11 FS/F4 SF 0 692.12 M(La mise en place d'un client VPN avec une adresse IP publique derri\350re un pare-feu Linux est identique \340)S
0 678.92 M(celle d'un serveur VPN avec une adresse IP publique.)S
0 652.52 M(Les r\350gles pare-feu auront cette allure :)S
9.2 FS/F0 SF 1.432 626.521 M(# Autorise le trafic ISAKMP IPsec entrant et sortant.)S
1.432 615.521 M(ipchains -A output -j ACCEPT -p udp -s 222.0.0.2/32 500 -d 199.0.0.1/32 500 -i eth1)S
1.432 604.521 M(ipchains -A input  -j ACCEPT -p udp -d 222.0.0.2/32 500 -s 199.0.0.1/32 500 -i eth1)S
1.432 593.521 M(# Autorise le trafic ESP IPsec entrant et sortant.)S
1.432 582.521 M(ipchains -A output -j ACCEPT -p 50  -s 222.0.0.2/32     -d 199.0.0.1/32     -i eth1)S
1.432 571.521 M(ipchains -A input  -j ACCEPT -p 50  -d 222.0.0.2/32     -s 199.0.0.1/32     -i eth1)S
1.432 560.521 M(# Autorise le canal de contr\364le PPTP en entr\351e et en sortie.)S
1.432 549.521 M(ipchains -A output -j ACCEPT -p tcp -s 222.0.0.2/32 -d 199.0.0.1/32 1723 -i eth1)S
1.432 538.521 M(ipchains -A input  -j ACCEPT -p tcp -d 222.0.0.2/32 -s 199.0.0.1/32 1723 -i eth1)S
1.432 527.521 M(# Autorise le tunnel PPTP en entr\351e et en sortie.)S
1.432 516.521 M(ipchains -A output -j ACCEPT -p 47  -s 222.0.0.2/32 -d 199.0.0.1/32      -i eth1)S
1.432 505.521 M(ipchains -A input  -j ACCEPT -p 47  -d 222.0.0.2/32 -s 199.0.0.1/32      -i eth1)S
13.2 FS/F9 SF 0 473.855 M(3.13. Masquage VPN et LRP)S
11 FS/F4 SF 0 447.015 M(Le projet de routeur Linux \(Linux Router Project\), qui se trouve \340 l'adresse http://www.linuxrouter.org/,)S
0 433.815 M(fournit un kit pare-feu-sur-disquette bas\351 sur Linux. Avec un PC '386, deux cartes r\351seaux, et un lecteur de)S
0 420.615 M(disquette, vous pouvez mettre en place un pare-feu masquant avec toutes les fonctionnalit\351s. Aucun disque)S
0 407.415 M(dur n'est n\351cessaire.)S
0 381.015 M(Le masquage VPN est cens\351 \352tre inclus dans la version 2.2.9 de LRP - pour v\351rifier s'il est disponible,)S
0 367.815 M(regardez si)S
/Fa SF ( ip_masq_ipsec)S
/F4 SF ( ou)S
/Fa SF ( ip_masq_pptp)S
/F4 SF ( sont dans la liste des modules chargeables dans)S
/Fa SF ( Package)S
0 354.615 M(Settings -> Modules)S
/F4 SF (, ou faites un grep sur)S
/Fa SF ( /proc/ksyms)S
/F4 SF ( comme d\351crit plus haut. Si vous voulez ajouter le)S
0 341.415 M(masquage VPN \340 une version ant\351rieure du LRP, alors quelqu'un sur la liste de diffusion du LRP pourra vous)S
0 328.215 M(fournir une image de disquette, ou bien vous pouvez faire votre propre noyau en utilisant les instructions qui)S
0 315.015 M(se trouvent sur la page du LRP.)S
0 288.615 M(Les r\350gles pare-feu seront ajout\351es au script de d\351marrage dans)S
/Fa SF ( Network Settings -> Direct Network)S
0 275.415 M(Setup)S
/F4 SF (.)S
13.2 FS/F9 SF 0 244.815 M(3.14. Masquage VPN sur un syst\350me tournant avec FreeS/WAN ou PoPToP)S
11 FS/F4 SF 0 217.975 M(Si vous souhaitez utiliser le pare-feu en tant que passerelle IPsec avec FreeS/WAN, vous)S
/F6 SF ( ne devez pas)S
/F4 SF ( activer)S
0 204.775 M(le masquage IPsec. Si vous souhaitez utiliser le pare-feu comme serveur PPTP avec PoPToP, ou comme)S
0 191.575 M(client PPTP en utilisant le logiciel client PPTP pour Linux, vous)S
/F6 SF ( ne devez pas)S
/F4 SF ( activer le masquage PPTP.)S
0 165.175 M(Le masquage VPN et le client ou serveur VPN utilisant les m\352mes protocoles, ils ne peuvent pas cohabiter sur)S
0 151.975 M(le m\352me ordinateur.)S
0 125.575 M(Votre pare-feu)S
/F6 SF ( peut)S
/F4 SF (, cependant, \352tre une passerelle VPN IPsec FreeS/WAN et faire du masquage PPTP, ou)S
0 112.375 M(vice-versa.)S
15.8 FS/F9 SF 0 79.135 M(4. Configurer le client VPN)S
11 FS/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(3.12. Param\351trage d'ipchains pour un client VPN avec une adresse IP publique)S
474.768 0 M(22)S
GR
SP
%%Page: 23 23
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 129.56 M 487.0 2.0 F
13.2 FS/F9 SF 0 734.8 M(4.1. Configurer un client MS W'95)S
11 FS/F4 SF 36 681.56 M(Configurez votre routage pour que votre pare-feu Linux soit votre passerelle par d\351faut :)S
72 655.16 M(Ouvrez)S
/Fa SF ( Panneau de configuration/R\351seau)S
/F4 SF ( ou faites un clic droit sur "Voisinage R\351seau")S
72 641.96 M(et cliquez sur)S
/Fa SF ( Propri\351t\351s)S
/F4 SF (.\15)S
61.616 655.16 M(a. )S
72 628.76 M(Cliquez sur l'onglet)S
/Fa SF ( Configuration)S
/F4 SF (.\15)S
61 628.76 M(b. )S
72 615.56 M(Dans la liste des composants r\351seaux install\351s, faites un double-clic sur la ligne "TCP/IP ->)S
72 602.36 M(votre-carte-r\351seau".\15)S
61.616 615.56 M(c. )S
72 589.16 M(Cliquez sur l'onglet)S
/Fa SF ( Passerelle)S
/F4 SF (.\15)S
61 589.16 M(d. )S
72 575.96 M(Entrez l'adresse IP locale de votre pare-feu Linux. Enlevez les autres passerelles.\15)S
61.616 575.96 M(e. )S
72 562.76 M(Cliquez sur le bouton "OK".\15)S
62.837 562.76 M(f. )S
25 681.56 M(1. )S
36 536.36 M(Testez le masquage. Par exemple, lancez ")S
/Fa SF (telnet le.serveur.de.mail.de.mon.fai smtp)S
/F4 SF (" et vous)S
36 523.16 M(devriez voir la banni\350re d'accueil du serveur de mail.\15)S
25 536.36 M(2. )S
36 509.96 M(Installez et configurez le logiciel de VPN. Pour le logiciel IPsec, suivez les instructions de l'\351diteur.)S
36 496.76 M(Pour PPTP de MS :)S
72 470.36 M(Ouvrez)S
/Fa SF ( Panneau de Configuration/R\351seau)S
/F4 SF ( ou faites un clic droit sur "Voisinage R\351seau")S
72 457.16 M(et cliquez sur)S
/Fa SF ( Propri\351t\351s)S
/F4 SF (.\15)S
61.616 470.36 M(a. )S
72 443.96 M(Cliquez sur l'onglet)S
/Fa SF ( Configuration)S
/F4 SF (.\15)S
61 443.96 M(b. )S
72 430.76 M(Cliquez sur le bouton "Ajouter", et cliquez ensuite sur la ligne "Carte".\15)S
61.616 430.76 M(c. )S
72 417.56 M(S\351lectionnez "Microsoft" comme constructeur, et ajoutez l'adaptateur "Carte de R\351seau Priv\351)S
72 404.36 M(Virtuel Microsoft".)S
61 417.56 M(d. )S
72 391.16 M(Red\351marrez lorsque l'ordinateur vous le demande.\15)S
61.616 391.16 M(e. )S
72 377.96 M(Si vous avez besoin de cryptage fort \(128 bits\), t\351l\351chargez la mise \340 jour pour cryptage fort)S
72 364.76 M(de DUN 1.3 sur le site s\351curis\351 de MS \340 l'adresse)S
72 351.56 M(http://mssecure.www.conxion.com/cgi-bin/ntitar.pl et installez la, red\351marrez ensuite quand)S
72 338.36 M(l'ordinateur vous le demande.\15)S
62.837 377.96 M(f. )S
72 325.16 M(Cr\351ez une nouvelle entr\351e dans votre carnet d'adresse d'appel distant pour votre serveur)S
72 311.96 M(PPTP.\15)S
61 325.16 M(g. )S
72 298.76 M(S\351lectionnez l'adaptateur VPN comme p\351riph\351rique \340 utiliser, et entrez l'adresse IP internet du)S
72 285.56 M(serveur PPTP comme num\351ro de t\351l\351phone.\15)S
61 298.76 M(h. )S
72 272.36 M(S\351lectionnez l'onglet)S
/Fa SF ( Types de Serveur)S
/F4 SF (, et cochez les cases)S
/Fa SF ( Activer la compression)S
72 259.16 M(logicielle)S
/F4 SF ( et)S
/Fa SF ( Demander un mot de passe crypt\351)S
/F4 SF (.\15)S
63.442 272.36 M(i. )S
72 245.96 M(Cliquez sur le bouton "Param\351trages TCP/IP".\15)S
63.442 245.96 M(j. )S
72 232.76 M(Renseignez les informations concernant l'adresse IP dynamique/statique de votre client)S
72 219.56 M(comme pr\351cis\351 par l'administrateur de votre serveur PPTP.\15)S
61 232.76 M(k. )S
72 206.36 M(Si vous souhaitez avoir acc\350s \340 votre r\351seau local pendant que votre connexion PPTP est)S
72 193.16 M(active, d\351cochez la case "Utiliser la passerelle par d\351faut pour le r\351seau distant". \15)S
63.442 206.36 M(l. )S
72 179.96 M(Red\351marrez encore quelques fois, juste par habitude... :-\)\15)S
57.942 179.96 M(m. )S
25 509.96 M(3. )S
13.2 FS/F9 SF 0 109.76 M(4.2. Configurer un client MS W'98)S
11 FS/F4 SF 36 56.52 M(Configurez le routage pour que le pare-feu Linux soit votre passerelle par d\351faut, et testez le)S
36 43.32 M(masquage comme indiqu\351 plus haut.\15)S
25 56.52 M(1. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(4.1. Configurer un client MS W'95)S
474.768 0 M(23)S
GR
SP
%%Page: 24 24
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 501.8 M 487.0 2.0 F
0 431.16 M 487.0 2.0 F
0.88 0.88 0.88 C 0 370.655 M 487.7 25.6 F
0.00 0.00 0.00 C 0 395.52 M 487.7 0.7 F
0 370.655 M 0.7 25.6 F
487 370.655 M 0.7 25.6 F
0 370.655 M 487.7 0.7 F
11 FS/F4 SF 36 737 M(Installez et configurez le logiciel de VPN. Pour un logiciel IPsec, suivez les instructions de l'\351diteur.)S
36 723.8 M(Pour PPTP de MS :)S
72 697.4 M(Ouvrez)S
/Fa SF ( Panneau de Configuration/Ajout/Suppression de programme)S
/F4 SF ( et cliquez sur)S
72 684.2 M(l'onglet)S
/Fa SF (Installation de Windows)S
/F4 SF (. \15)S
61.616 697.4 M(a. )S
72 671 M(Cliquez sur l'option)S
/Fa SF ( Communications)S
/F4 SF ( et cliquez sur le bouton "D\351tails...".\15)S
61 671 M(b. )S
72 657.8 M(Assurez vous que l'option "R\351seau Priv\351 Virtuel \(VPN\)" est coch\351e. Cliquez alors sur le)S
72 644.6 M(bouton "OK".\15)S
61.616 657.8 M(c. )S
72 631.4 M(Red\351marrez la machine lorsqu'on vous le demande.\15)S
61 631.4 M(d. )S
72 618.2 M(Si vous avez besoin d'utiliser du cryptage fort \(128 bits\), t\351l\351chargez la mise \340 jour s\351curit\351)S
72 605 M(pour le cryptage fort VPN sur le site s\351curis\351 de MS \340 l'adresse :)S
72 591.8 M(http://mssecure.www.conxion.com/cgi-bin/ntitar.pl et installez-la, et ensuite red\351marrez)S
72 578.6 M(encore lorsqu'on vous le demande.\15)S
61.616 618.2 M(e. )S
25 737 M(2. )S
36 552.2 M(Cr\351ez et testez une nouvelle entr\351e pour votre serveur VPN dans votre carnet d'adresse d'appel distant,)S
36 539 M(comme d\351crit plus haut.\15)S
25 552.2 M(3. )S
13.2 FS/F9 SF 0 482 M(4.3. Configurer un client MS W'ME)S
11 FS/F4 SF 0 455.16 M(Je n'en ai pas vu pour l'instant. Je suppose que la proc\351dure est tr\350s proche de celle pour W'98. Quelqu'un)S
0 441.96 M(pourrait-il me dire quelles sont les diff\351rences, s'il y en a ? Merci.)S
13.2 FS/F9 SF 0 411.36 M(4.4. Configurer un client MS NT)S
9.2 FS/F0 SF 1.432 384.921 M(Note: cette section peut \352tre incompl\350te car \347a fait)S
1.432 373.921 M(un petit moment que je n'ai pas install\351 PPTP sur un syst\350me NT.)S
11 FS/F4 SF 36 320.055 M(Configurez votre routage pour que le pare-feu Linux soit votre passerelle par d\351faut :)S
72 293.655 M(Ouvrez)S
/Fa SF ( Panneau de Configuration/R\351seau)S
/F4 SF ( ou faites un clic droit sur "Voisinage R\351seau")S
72 280.455 M(et cliquez sur)S
/Fa SF ( Propri\351t\351s)S
/F4 SF (.\15)S
61.616 293.655 M(a. )S
72 267.255 M(Cliquez sur l'onglet)S
/Fa SF ( Protocoles)S
/F4 SF ( et faites un double-clic sur la ligne "Protocole TCP/IP".\15)S
61 267.255 M(b. )S
72 254.055 M(Entrez l'adresse IP locale de votre pare-feu Linux dans la zone de dialogue "Passerelle par)S
72 240.855 M(d\351faut".\15)S
61.616 254.055 M(c. )S
72 227.655 M(Cliquez sur le bouton "OK".\15)S
61 227.655 M(d. )S
25 320.055 M(1. )S
36 201.255 M(Testez le masquage. Par exemple, lancez ")S
/Fa SF (telnet le.serveur.de.mail.de.mon.fai smtp)S
/F4 SF (" et vous)S
36 188.055 M(devriez voir appara\356tre la banni\350re d'accueil du serveur de mails.\15)S
25 201.255 M(2. )S
36 174.855 M(Installez et configurez le logiciel VPN. Pour un logiciel IPsec, suivez les instructions de l'\351diteur.)S
36 161.655 M(Pour PPTP de MS :)S
72 135.255 M(Ouvrez)S
/Fa SF ( Panneau de Configuration/R\351seau)S
/F4 SF ( ou faites un clic droit sur "Voisinage R\351seau")S
72 122.055 M(et cliquez sur)S
/Fa SF ( Propri\351t\351s)S
/F4 SF (.\15)S
61.616 135.255 M(a. )S
72 108.855 M(Cliquez sur l'onglet)S
/Fa SF ( Protocoles)S
/F4 SF (.\15)S
61 108.855 M(b. )S
72 95.655 M(Cliquez sur le bouton "Ajouter", et faites ensuite un double-clic sur la ligne "Point to Point)S
72 82.455 M(Tunneling Protocol".\15)S
61.616 95.655 M(c. )S
72 69.255 M(Quand on vous demande les num\351ros de R\351seaux Virtuels Priv\351s, entrez les num\351ros des)S
72 56.055 M(serveurs PPTP que vous pouvez potentiellement joindre.\15)S
61 69.255 M(d. )S
72 42.855 M(Red\351marrez lorsqu'on vous le demande.\15)S
61.616 42.855 M(e. )S
25 174.855 M(3. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(4.3. Configurer un client MS W'ME)S
474.768 0 M(24)S
GR
SP
%%Page: 25 25
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 462.2 M 487.0 2.0 F
0 365.16 M 487.0 2.0 F
0.88 0.88 0.88 C 36 159.455 M 406.6 25.6 F
0.00 0.00 0.00 C 36 184.32 M 406.6 0.7 F
36 159.455 M 0.7 25.6 F
441.9 159.455 M 0.7 25.6 F
36 159.455 M 406.6 0.7 F
11 FS/F4 SF 72 737 M(Si vous avez besoin d'utiliser du cryptage fort \(128 bits\), t\351l\351chargez la mise \340 jour de PPTP)S
72 723.8 M(pour cryptage fort sur le site s\351curis\351 de MS \340 l'adresse)S
72 710.6 M(http://mssecure.www.conxion.com/cgi-bin/ntitar.pl et installez la, puis red\351marrez lorsqu'on)S
72 697.4 M(vous le demande.\15)S
62.837 737 M(f. )S
72 684.2 M(Cr\351ez une nouvelle entr\351e dans votre carnet d'adresse d'appel distant pour votre serveur)S
72 671 M(PPTP.\15)S
61 684.2 M(g. )S
72 657.8 M(S\351lectionnez l'adaptateur VPN comme p\351riph\351rique \340 utiliser, et entrez l'adresse IP internet du)S
72 644.6 M(serveur PPTP comme num\351ro de t\351l\351phone.\15)S
61 657.8 M(h. )S
72 631.4 M(S\351lectionnez l'onglet)S
/Fa SF ( Types de Serveur)S
/F4 SF ( et cochez les cases)S
/Fa SF ( Activer la compression)S
72 618.2 M(logicielle)S
/F4 SF ( et)S
/Fa SF ( Demander un mot de passe crypt\351)S
/F4 SF (.)S
63.442 631.4 M(i. )S
72 605 M(Cliquez sur le bouton "Param\350tres TCP/IP".\15)S
63.442 605 M(j. )S
72 591.8 M(Renseignez les informations concernant l'adresse IP dynamique/statique de votre client)S
72 578.6 M(comme pr\351cis\351 par l'administrateur de votre serveur PPTP.\15)S
61 591.8 M(k. )S
72 565.4 M(Si vous souhaitez avoir acc\350s \340 votre r\351seau local pendant que la connexion PPTP est active,)S
72 552.2 M(regardez L'article de la Base de Connaissances MS Q143168 pour modifier la base de)S
72 539 M(registres. \()S
/F6 SF (Hum)S
/F4 SF (.\)\15)S
63.442 565.4 M(l. )S
72 525.8 M(Assurez vous d'avoir r\351-appliqu\351 le dernier Service Pack, pour \352tre s\373r que les librairies RAS)S
72 512.6 M(et PPTP sont \340 jour en ce qui concerne la s\351curit\351 et les performances.\15)S
57.942 525.8 M(m. )S
13.2 FS/F9 SF 0 442.4 M(4.5. Configuration pour du routage r\351seau \340 r\351seau)S
11 FS/F6 SF 0 415.56 M(A \351crire.)S
/F4 SF 0 389.16 M(Vous devriez vraiment jeter un oeil sur FreeS/WAN \(IPsec pour Linux\) \340 l'adresse)S
0 375.96 M(http://www.xs4all.nl/~freeswan/ plut\364t que de faire du masquage.)S
13.2 FS/F9 SF 0 345.36 M(4.6. Masquer des VPNs bas\351s sur SecuRemote de CheckPoint)S
11 FS/F4 SF 0 318.52 M(Il est possible de masquer le trafic VPN bas\351 sur SecuRemote de Checkpoint \340 certaines conditions.)S
0 292.12 M(Pour commencer, vous devez configurer le pare-feu SecuRemote pour autoriser les sessions masqu\351es. Sur le)S
0 278.92 M(pare-feu SecuRemote, faites ce qui suit.)S
36 226.12 M(Ex\351cutez)S
/Fa SF ( fwstop)S
/F4 SF 25 226.12 M(1. )S
36 212.92 M(\311ditez)S
/Fa SF ( $FWDIR/conf/objects.C)S
/F4 SF ( et apr\350s la ligne ")S
/Fa SF (:props \()S
/F4 SF (", ajoutez ou modifiez les lignes suivantes)S
36 199.72 M(pour avoir)S
9.2 FS/F0 SF 37.432 173.721 M(:userc_NAT \(true\) )S
37.432 162.721 M(:userc_IKE_NAT \(true\))S
11 FS/F4 SF 25 212.92 M(2. )S
36 122.055 M(Ex\351cutez)S
/Fa SF ( fwstart)S
/F4 SF 25 122.055 M(3. )S
36 108.855 M(R\351installez votre politique de s\351curit\351.\15)S
25 108.855 M(4. )S
36 95.655 M(V\351rifiez que les changements ont \351t\351 pris en compte en v\351rifiant)S
/Fa SF ( $FWDIR/conf/objects.C)S
/F4 SF ( et)S
/Fa SF 36 82.455 M($FWDIR/database/objects.C)S
/F4 SF 25 95.655 M(5. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(4.5. Configuration pour du routage r\351seau \340 r\351seau)S
474.768 0 M(25)S
GR
SP
%%Page: 26 26
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 396.2 M 487.0 2.0 F
0 55.752 M 487.0 2.0 F
11 FS/F4 SF 0 737 M(Si vous utilisez les protocoles IPsec \(appel\351s "IKE" par CheckPoint\) vous n'avez pas besoin de faire autre)S
0 723.8 M(chose pour masquer le trafic VPN. Configurez simplement votre passerelle de masquage pour masquer le)S
0 710.6 M(trafic IPsec comme d\351crit plus haut.)S
0 684.2 M(Le protocole propri\351taire FWZ de CheckPoint est plus compliqu\351. Il y a deux modes dans lesquels FWZ peut)S
0 671 M(\352tre utilis\351 : le mode encapsul\351, et le mode de transport. En mode encapsul\351, la v\351rification d'int\351grit\351 est faite)S
0 657.8 M(sur l'ensemble du paquet IP, comme avec le protocole AH d'IPsec. Changer l'adresse IP casse cette garantie)S
0 644.6 M(d'int\351grit\351, donc les tunnels FWZ encapsul\351s)S
/F6 SF ( ne peuvent pas)S
/F4 SF ( \352tre masqu\351s.)S
0 618.2 M(En mode transport, seule la portion du paquet contenant les donn\351es est crypt\351e, et les ent\352tes IP ne sont pas)S
0 605 M(v\351rifi\351s pour voir s'ils ont \351t\351 modifi\351s. Dans ce mode, le masquage doit fonctionner avec les modifications)S
0 591.8 M(indiqu\351es plus haut.)S
0 565.4 M(La configuration pour choisir entre le mode encapsul\351 ou le mode transport se fait via l'IHM FireWall-1.)S
0 552.2 M(Dans l'objet r\351seau correspondant au pare-feu, sur l'onglet VPN, \351ditez les propri\351t\351s FWZ. Le troisi\350me)S
0 539 M(onglet dans les propri\351t\351s FWZ vous permet de choisir le mode encapsul\351.)S
0 512.6 M(Vous ne pourrez masquer qu'un seul client \340 la fois.)S
0 486.2 M(Vous trouverez de plus amples informations aux adresses :)S
36 459.8 M(http://www.phoneboy.com/fw1/nat.html,)S
/Fc SF 28.19 459.8 M(\267 )S
/F4 SF 36 446.6 M(http://www.phoneboy.com/fw1/faq/0141.html)S
/Fc SF 28.19 446.6 M(\267 )S
/F4 SF 36 433.4 M(http://www.phoneboy.com/fw1/faq/0372.html)S
/Fc SF 28.19 433.4 M(\267 )S
15.8 FS/F9 SF 0 373.76 M(5. D\351pannage)S
13.2 FS/F9 SF 0 344.192 M(5.1. Tests)S
11 FS/F4 SF 0 317.352 M(Pour tester le masquage VPN :)S
36 264.552 M(Activez la connexion \340 votre FAI depuis votre machine Linux, et v\351rifiez qu'elle fonctionne)S
36 251.352 M(correctement.\15)S
25 264.552 M(1. )S
36 238.152 M(V\351rifiez que le masquage fonctionne correctement, par exemple en utilisant une machine de votre)S
36 224.952 M(r\351seau local masqu\351e pour aller surfer sur un site web, ou pour acc\351der \340 un serveur FTP.\15)S
25 238.152 M(2. )S
36 211.752 M(PPTP : v\351rifiez que vous avez correctement configur\351 le masquage du canal de contr\364le PPTP :)S
36 198.552 M(essayez de faire un telnet depuis la machine cliente PPTP vers le port 1723 de votre serveur PPTP. Ne)S
36 185.352 M(vous attendez pas \340 voir quelque chose, mais si vous avez une erreur disant que la connexion a \351chou\351)S
36 172.152 M(ou si vous n'avez pas de r\351ponse, jetez un coup d'oeil aux r\350gles de masquage sur votre machine)S
36 158.952 M(Linux, pour vous assurer que vous masquez bien le trafic en provenance du poste client PPTP vers le)S
36 145.752 M(port TCP 1723 du serveur PPTP.\15)S
25 211.752 M(3. )S
36 132.552 M(PPTP : essayez d'\351tablir une connexion PPTP. Je vous recommande de lancer \351galement)S
/Fa SF ( RASMON)S
/F4 SF 36 119.352 M(s'il est disponible, car il va vous donner un minimum d'informations sur l'\351tat de la connexion. Si vous)S
36 106.152 M(\351tablissez une connexion PPTP lors de votre premi\350re tentative, f\351licitations ! Vous avez r\351ussi !\15)S
25 132.552 M(4. )S
36 92.952 M(IPsec : essayez d'\351tablir une connexion IPsec.\15)S
25 92.952 M(5. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(5. D\351pannage)S
474.768 0 M(26)S
GR
SP
%%Page: 27 27
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 36 89.095 M 406.6 36.6 F
0.00 0.00 0.00 C 36 124.96 M 406.6 0.7 F
36 89.095 M 0.7 36.6 F
441.9 89.095 M 0.7 36.6 F
36 89.095 M 406.6 0.7 F
0.88 0.88 0.88 C 36 22 M 406.6 28.2 F
0.00 0.00 0.00 C 36 49.495 M 406.6 0.7 F
36 22 M 0.7 28.2 F
441.9 22 M 0.7 28.2 F
13.2 FS/F9 SF 0 734.8 M(5.2. Probl\350mes possibles)S
11 FS/F4 SF 0 707.96 M(Il y a plusieurs \351l\351ments qui peuvent emp\352cher d'\351tablir une session VPN. Nous allons les consid\351rer en)S
0 694.76 M(partant du client vers le serveur, puis dans l'autre sens. Pour les exemples, nous partirons du principe que le)S
0 681.56 M(client est un client Windows, ce qui correspond au cas le plus courant.\15)S
36 628.76 M(Information sur la connexion : le "num\351ro de t\351l\351phone" dans l'\351cran de configuration VPN distant)S
36 615.56 M(doit \352tre l'adresse IP internet du serveur VPN, ou l'adresse du pare-feu si le serveur est masqu\351.\15)S
25 628.76 M(1. )S
36 602.36 M(PPTP et cryptage fort : si le client et le serveur n'ont pas le fichier)S
/Fa SF ( NDISWAN.SYS)S
/F4 SF ( ou le logiciel)S
36 589.16 M(PPTP pour W'95/'98 128 bits, vous n'arriverez pas \340 \351tablir une session avec cryptage fort.)S
36 575.96 M(Malheureusement, au cours de mon exp\351rience j'ai constat\351 que ce probl\350me ne g\351n\350re pas de)S
36 562.76 M(message d'erreur, et que le client cherche \340 se connecter sans cesse... Vous pouvez r\351cup\351rer la mise \340)S
36 549.56 M(jour pour le cryptage fort sur le site s\351curis\351 de Microsoft dont l'URL est donn\351e dans la)S
36 536.36 M(section"Configurer un client MS".\15)S
36 509.96 M(Ceci va \351galement affecter les clients IPsec, s'ils utilisent les librairies de cryptage fournies par MS)S
36 496.76 M(plut\364t que leurs propres librairies.)S
25 602.36 M(2. )S
36 483.56 M(Routage : v\351rifiez que la route par d\351faut sur votre client VPN pointe bien vers la machine de)S
36 470.36 M(masquage Linux. Lancez la commande)S
/Fa SF ( route print)S
/F4 SF ( et cherchez l'entr\351e)S
/Fa SF ( 0.0.0.0)S
/F4 SF (.\15)S
36 443.96 M(Si d'autres services masqu\351s \(comme HTTP, FTP, IRC, etc...\) fonctionnent sur votre machine cliente)S
36 430.76 M(VPN, alors ce n'est pas un probl\350me de routage.)S
25 483.56 M(3. )S
36 417.56 M(Masquage : il y a deux parties dans la session VPN.\15)S
36 391.16 M(Pour IPsec, le service d'authentification et d'\351change de cl\351s \(ISAKMP\), qui est une session UDP sur)S
36 377.96 M(le port 500 de la machine IPsec distante, le pare-feu doit \352tre configur\351 pour le masquage comme)S
36 364.76 M(pour tout autre service UDP \(par exemple DNS\).\15)S
36 338.36 M(Pour PPTP, le canal de contr\364le, qui est une session TCP normale vers le port 1723 du serveur PPTP,)S
36 325.16 M(le pare-feu doit \352tre configur\351 pour le masquage comme pour tout autre service TCP \(par exemple)S
36 311.96 M(HTTP\).\15)S
36 285.56 M(Le canal de donn\351es crypt\351 avec IPsec est transport\351 au dessus d'ESP, le protocole IP 50. Le canal de)S
36 272.36 M(donn\351es crypt\351 avec PPTP est transport\351 au dessus de GRE, le protocole IP 47. \(Notez que ce ne sont)S
/F6 SF 36 259.16 M(pas)S
/F4 SF ( des num\351ros de ports TCP ou UDP !\) Le noyau Linux 2.0 ne vous permettant de pr\351ciser que les)S
36 245.96 M(protocoles IP)S
/Fa SF ( TCP)S
/F4 SF (,)S
/Fa SF ( UDP)S
/F4 SF (,)S
/Fa SF ( ICMP)S
/F4 SF ( et)S
/Fa SF ( ALL)S
/F4 SF ( lors de la cr\351ation des r\350gles de masquage, vous devez)S
36 232.76 M(masquer le trafic du protocole)S
/Fa SF ( ALL)S
/F4 SF ( m\352me si vous masquez uniquement des services sp\351cifiques. Si)S
36 219.56 M(vous masquez tout, ne vous en inqui\351tez pas.)S
36 193.16 M(Afin d'isoler les probl\350mes issus des r\350gles du pare-feu de ceux provenant du code de masquage du)S
36 179.96 M(noyau, essayez d'\351tablir une connexion VPN avec votre pare-feu compl\350tement ouvert, et si \347a)S
36 166.76 M(marche, resserrez alors les r\350gles du pare-feu.)S
36 140.36 M(Pare-feu compl\350tement ouvert avec ipfwadm et un noyau 2.0.x :)S
9.2 FS/F0 SF 37.432 114.361 M(ipfwadm -I -p accept)S
37.432 103.361 M(ipfwadm -O -p accept)S
37.432 92.361 M(ipfwadm -F -a accept -m)S
11 FS/F4 SF 36 64.895 M(Pare-feu compl\350tement ouvert avec ipchains et un noyau 2.2.x :)S
9.2 FS/F0 SF 37.432 38.896 M(ipchains -P input   ACCEPT)S
37.432 27.896 M(ipchains -P output  ACCEPT)S
11 FS/F4 SF 25 417.56 M(4. )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(5.2. Probl\350mes possibles)S
474.768 0 M(27)S
GR
SP
%%Page: 28 28
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 36 734.135 M 406.6 13.9 F
0.00 0.00 0.00 C 36 734.135 M 0.7 13.9 F
441.9 734.135 M 0.7 13.9 F
36 734.135 M 406.6 0.7 F
0 157.935 M 487.0 2.0 F
9.2 FS/F0 SF 37.432 737.401 M(ipchains -P forward MASQ)S
11 FS/F4 SF 36 709.935 M(Ne laissez)S
/F6 SF ( pas)S
/F4 SF ( votre pare-feu compl\350tement ouvert plus de temps qu'il n'en faut pour prouver qu'une)S
36 696.735 M(connexion VPN masqu\351e peut \352tre \351tablie !\15)S
36 683.535 M(\311quipements interm\351diaires et Internet : Tous les routeurs entre votre pare-feu Linux et la machine)S
36 670.335 M(IPsec distante doivent autoriser le passage des paquets porteurs du protocole IP 50. Tous les routeurs)S
36 657.135 M(entre votre pare-feu Linux et le serveur PPTP doivent autoriser le passage des paquets porteurs du)S
36 643.935 M(protocole IP 47. Si IPsec ou PPTP fonctionne lorsque votre client VPN est directement connect\351 \340)S
36 630.735 M(votre FAI, alors le probl\350me ne vient probablement pas de l\340.\15)S
36 604.335 M(Pour savoir si un \351quipement interm\351diaire bloque le trafic GRE, utilisez un)S
/Fa SF ( traceroute)S
/F4 SF ( patch\351 pour)S
36 591.135 M(suivre la progression des paquets GRE. Regardez la section des ressources pour de plus amples)S
36 577.935 M(informations sur le patch de traceroute. Un patch similaire pour ESP est en cours de codage.)S
25 683.535 M(5. )S
36 564.735 M(Le pare-feu distant : le pare-feu du c\364t\351 du serveur doit autoriser une machine ayant la m\352me adresse)S
36 551.535 M(IP que celle attribu\351e \340 votre machine Linux par votre FAI \340 se connecter au port 500/udp de la)S
36 538.335 M(machine IPsec ou sur le port 1723/tcp du serveur PPTP. Si le VPN fonctionne lorsque votre client)S
36 525.135 M(VPN est connect\351 directement \340 votre FAI, alors le probl\350me ne vient probablement pas de l\340.\15)S
25 564.735 M(6. )S
36 511.935 M(Le pare-feu c\364t\351 serveur et ESP : les donn\351es crypt\351es IPsec sont transport\351es au dessus du protocole)S
36 498.735 M(IP 50. Si le pare-feu derri\350re lequel se trouve la machine IPsec distante ne fait pas suivre le trafic ESP)S
36 485.535 M(dans les deux sens, IPsec ne pourra pas marcher. Une fois de plus, si IPsec fonctionne lorsque votre)S
36 472.335 M(client IPsec est connect\351 directement \340 votre FAI, alors le probl\350me ne vient probablement pas de l\340.\15)S
25 511.935 M(7. )S
36 459.135 M(Le pare-feu c\364t\351 serveur et GRE : le canal de donn\351es PPTP est transport\351 comme une session PPP)S
36 445.935 M(encapsul\351e dans GRE \(protocole IP 47\). Si le pare-feu derri\350re lequel votre serveur PPTP se trouve)S
36 432.735 M(ne fait pas suivre le trafic GRE dans les deux sens, PPTP ne pourra pas fonctionner. Une fois de plus,)S
36 419.535 M(si PPTP fonctionne lorsque votre client IPsec est connect\351 directement \340 votre FAI, alors le probl\350me)S
36 406.335 M(ne vient probablement pas de l\340.\15)S
25 459.135 M(8. )S
36 393.135 M(Le patch : si votre client IPsec s'authentifie correctement mais ne peut pas \351tablir de connexion)S
36 379.935 M(r\351seau, le patch peut ne pas masquer le trafic ESP correctement. Si votre client PPTP \351tablit le canal)S
36 366.735 M(de contr\364le \(RASMON bipe et le petit t\351l\351phone clignote\) et qu'un trafic GRE est g\351n\351r\351 \(la lumi\350re)S
36 353.535 M(en haut de RASMON clignote\) mais qu'il n'y a pas de trafic GRE en retour \(la lumi\350re en bas de)S
36 340.335 M(RASMON ne clignote pas en r\351ponse\), le patch peut ne pas masquer le trafic GRE correctement.\15)S
36 313.935 M(Regardez dans)S
/Fa SF ( /var/log/messages)S
/F4 SF ( pour trouver les entr\351es des journaux qui montrent que le trafic)S
36 300.735 M(VPN a \351t\351 vu. Activez le d\351boguage du VPN pour vous aider \340 d\351terminer si le patch est responsable)S
36 287.535 M(ou non. Faites aussi tourner un sniffeur sur votre connexion internet en cherchant le trafic VPN)S
36 274.335 M(sortant)S
/F6 SF ( \(voir plus bas\))S
/F4 SF (.)S
25 393.135 M(9. )S
36 261.135 M(Clients multiples : l'ancien patch PPTP ne supporte PAS le masquage de plusieurs clients PPTP)S
36 247.935 M(cherchant \340 acc\351der au)S
/F6 SF ( m\352me)S
/F4 SF ( serveur PPTP. Si vous essayez de le faire, vous devriez reconsid\351rer)S
36 234.735 M(votre architecture r\351seau et voir si vous ne devriez pas installer un routeur PPTP pour vos clients)S
36 221.535 M(locaux. Le patch 2.0 inclus le masquage d'identifiant d'appel, qui permet plusieurs sessions)S
36 208.335 M(simultan\351es.)S
/F6 SF ( Note :)S
/F4 SF ( n'activez pas le masquage d'identifiant d'appel PPTP si vous masquez un serveur)S
36 195.135 M(PPTP. Cela emp\352cherait le trafic sortant en provenance du serveur d'\352tre masqu\351.\15)S
19.5 261.135 M(10. )S
13.2 FS/F9 SF 0 138.135 M(5.3. D\351pannage)S
11 FS/F4 SF 0 111.295 M(La plupart des probl\350mes peuvent \352tre identifi\351s en faisant tourner un sniffeur de paquets \(par exemple)S
/Fa SF 0 98.095 M(tcpdump)S
/F4 SF ( avec l'option)S
/Fa SF ( -v)S
/F4 SF (\) sur votre pare-feu passerelle VPN. Si tout fonctionne correctement, vous allez)S
0 84.895 M(voir le trafic suivant.)S
36 32.095 M(R\351seau local du client :\15)S
/Fc SF 28.19 32.095 M(\267 )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(5.3. D\351pannage)S
474.768 0 M(28)S
GR
SP
%%Page: 29 29
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 181.935 M 487.7 25.6 F
0.00 0.00 0.00 C 0 206.8 M 487.7 0.7 F
0 181.935 M 0.7 25.6 F
487 181.935 M 0.7 25.6 F
0 181.935 M 487.7 0.7 F
0 107.335 M 487.0 2.0 F
0.88 0.88 0.88 C 0 22 M 487.7 24.0 F
0.00 0.00 0.00 C 0 45.295 M 487.7 0.7 F
0 22 M 0.7 24.0 F
487 22 M 0.7 24.0 F
11 FS/F4 SF 36 737 M(IPsec : le trafic UDP \(destination UDP port 500\) et ESP \(protocole IP 50\) en provenance de votre)S
36 723.8 M(client local IPsec \340 destination de l'adresse IP internet de la machine IPsec distante. Si vous ne le)S
36 710.6 M(voyez pas, votre client IPsec est mal configur\351.)S
36 684.2 M(PPTP : le trafic TCP \(destination TCP port 1723\) et GRE \(protocole IP 47\) en provenance de votre)S
36 671 M(client local PPTP \340 destination de l'adresse IP internet du serveur PPTP. Si vous ne le voyez pas, votre)S
36 657.8 M(client PPTP est mal configur\351.)S
36 644.6 M(Du c\364t\351 FAI de votre pare-feu client : un trafic UDP et ESP ou TCP et GRE en provenance de)S
36 631.4 M(l'adresse IP internet du pare-feu client \(souvenez vous, on fait du masquage\) vers l'adresse IP internet)S
36 618.2 M(du serveur VPN. Si vous ne le voyez pas, votre masquage est mal configur\351, ou bien le patch ne)S
36 605 M(fonctionne pas.\15)S
/Fc SF 28.19 644.6 M(\267 )S
/F4 SF 36 591.8 M(Du c\364t\351 FAI de votre pare-feu serveur : un trafic UDP et ESP ou TCP et GRE en provenance de)S
36 578.6 M(l'adresse IP internet de votre client vers l'adresse IP internet du serveur VPN. Si vous ne le voyez pas,)S
36 565.4 M(internet ne marche pas)S
/Fa SF ( :\))S
/F4 SF ( ou des \351quipements interm\351diaires bloquent le trafic ESP ou GRE.\15)S
/Fc SF 28.19 591.8 M(\267 )S
/F4 SF 36 552.2 M(Du c\364t\351 DMZ de votre pare-feu serveur : un trafic UDP et ESP ou TCP et GRE en provenance de)S
36 539 M(l'adresse IP internet du client vers l'adresse IP du serveur. Si vous ne le voyez pas, v\351rifiez les r\350gles)S
36 525.8 M(pare-feu concernant le suivi de paquets UDP port 500 ainsi que ceux porteurs du protocole IP 50 ou)S
36 512.6 M(TCP port 1723 et protocole IP 47, ainsi que la configuration d')S
/Fa SF (ipportfw)S
/F4 SF ( et de)S
/Fa SF ( ipfwd)S
/F4 SF ( si vous masquez)S
36 499.4 M(le serveur.\15)S
/Fc SF 28.19 552.2 M(\267 )S
/F4 SF 36 486.2 M(Du c\364t\351 interne du pare-feu serveur : un trafic UDP \(port source 500\) et ESP ou TCP \(port source)S
36 473 M(1723\) et GRE en provenance de l'adresse IP du serveur VPN et \340 destination de l'adresse IP internet)S
36 459.8 M(du client. Si vous ne le voyez pas, v\351rifiez la configuration du serveur VPN, y compris les r\350gles de)S
36 446.6 M(filtrage de paquets sur le serveur VPN.\15)S
/Fc SF 28.19 486.2 M(\267 )S
/F4 SF 36 433.4 M(Du c\364t\351 FAI du pare-feu serveur : un trafic UDP et ESP ou TCP et GRE en provenance de l'adresse)S
36 420.2 M(IP du serveur VPN \(ou l'adresse IP du pare-feu si le serveur est masqu\351\) vers l'adresse IP internet du)S
36 407 M(client. Si vous ne le voyez pas, v\351rifiez les r\350gles de votre pare-feu concernant la transmission de)S
36 393.8 M(paquets UDP port 500 ainsi que de ceux porteurs du protocole IP 50 ou TCP port 1723 et protocole IP)S
36 380.6 M(47.\15)S
/Fc SF 28.19 433.4 M(\267 )S
/F4 SF 36 367.4 M(Du c\364t\351 FAI de votre pare-feu client : un trafic UDP et ESP ou TCP et GRE en provenance de)S
36 354.2 M(l'adresse IP du serveur VPN et \340 destination de l'adresse IP internet du pare-feu client. Si vous ne le)S
36 341 M(voyez pas, internet se r\351volte encore.\15)S
/Fc SF 28.19 367.4 M(\267 )S
/F4 SF 36 327.8 M(Du c\364t\351 r\351seau local client : un trafic UDP et ESP ou TCP et GRE en provenance de l'adresse IP)S
36 314.6 M(internet du serveur VPN \340 destination de l'adresse IP sur le r\351seau local du client VPN. Si vous voyez)S
36 301.4 M(le trafic UDP mais pas le trafic ESP, ou bien le trafic TCP mais pas le trafic GRE, le patch ne)S
36 288.2 M(fonctionne pas ou n'a pas \351t\351 install\351 correctement.\15)S
/Fc SF 28.19 327.8 M(\267 )S
/F4 SF 0 235.4 M(Vous pouvez trouver utile d'activer le d\351boguage du VPN et de recompiler votre noyau. Ajoutez ce qui suit au)S
0 222.2 M(fichier)S
/Fa SF ( /etc/syslog.conf)S
9.2 FS/F0 SF 1.432 196.201 M(# d\351boguage)S
1.432 185.201 M(*.=debug           /var/log/debug)S
11 FS/F4 SF 0 157.735 M(et regardez)S
/Fa SF ( /var/log/messages)S
/F4 SF ( et)S
/Fa SF ( /var/log/debug)S
/F4 SF ( pour les messages concernant le trafic VPN. Notez que)S
0 144.535 M(l'enregistrement - particuli\350rement l'enregistrement bavard \(verbose log\) - va engendrer une grande activit\351)S
0 131.335 M(disque et va faire grossir tr\350s rapidement les journaux. N'activez pas le d\351boguage si vous n'en avez pas)S
0 118.135 M(besoin, et coupez le quand vous avez fini.)S
13.2 FS/F9 SF 0 87.535 M(5.4. Clients MS PTPP et noms de domaines)S
11 FS/F4 SF 0 60.695 M(Merci \340 Charles Curley <ccurley@trib.com> pour ce qui suit :)S
9.2 FS/F0 SF 1.432 34.696 M(Si vous utilisez PPTP \(Point to Point Tunneling Protocol\) )S
1.432 23.696 M(pour acc\351der \340 un environnement R\351seau Microsoft \(SMB\) et que)S
11 FS/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(5.4. Clients MS PTPP et noms de domaines)S
474.768 0 M(29)S
GR
SP
%%Page: 30 30
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0.88 0.88 0.88 C 0 591.135 M 487.7 156.9 F
0.00 0.00 0.00 C 0 591.135 M 0.7 156.9 F
487 591.135 M 0.7 156.9 F
0 591.135 M 487.7 0.7 F
0 529.735 M 487.0 2.0 F
0 393.095 M 487.0 2.0 F
0 45.255 M 487.0 2.0 F
9.2 FS/F0 SF 1.432 737.401 M(vous avez votre propre environnement R\351seau Microsoft sur votre)S
1.432 726.401 M(r\351seau local \(Samba ou Windows\), donnez \340 votre groupe de travail)S
1.432 715.401 M(local un nom qui n'est pas connu dans l'environnement distant.)S
1.432 704.401 M(La raison est que tant que votre client PPTP est connect\351)S
1.432 693.401 M(\340 l'environnement distant, il va voir les serveurs de noms de )S
1.432 682.401 M(domaine de l'environnement distant, et il ne va voir que les machines)S
1.432 671.401 M(distantes appartenant \340 ce groupe de travail.)S
11 FS/F4 SF 1.432 634.368 M(Vous devez \351viter l'option paresseuse. Microsoft livre Windows pr\351-configur\351 pour un groupe de travail par)S
1.432 621.168 M(d\351faut nomm\351 WORKGROUP. Il y a des gens paresseux qui vont garder ce nom pour leur groupe de travail)S
1.432 607.968 M(quand ils installeront leurs ordinateurs. Donc il y a une bonne chance pour que l'environnement distant ait un)S
1.432 594.768 M(groupe de travail appel\351 WORKGROUP, que cela plaise ou non aux administrateurs.)S
0 566.935 M(Je pense que ceci s'applique ind\351pendamment de l'utilisation du VPN, car les services de nommage sont)S
0 553.735 M(ind\351pendants du transport. Si votre \(ou vos\) client peut voir les serveurs WINS sur le r\351seau distant, vous)S
0 540.535 M(aurez le probl\350me, avec ou sans PPTP.)S
13.2 FS/F9 SF 0 509.935 M(5.5. Clients PPTP MS et IPX Novell)S
11 FS/F4 SF 0 483.095 M(Si vous avez des probl\350mes avec le trafic IPX sur votre liaison PPTP, lisez les sections 3.5 et 5.2 de cet article)S
0 469.895 M(de la base de connaissances MS :)S
0 456.695 M(http://microsoft.com/ntserver/nts/downloads/recommended/dun13win95/ReleaseNotes.asp)S
0 430.295 M(Les m\352mes consid\351rations s'appliquent probablement \351galement \340 W'98.)S
0 403.895 M(Merci \340 David Griswold <dgriswol@ix.netcom.com>)S
13.2 FS/F9 SF 0 373.295 M(5.6. Probl\350mes de mots de passe r\351seau MS)S
11 FS/F4 SF 0 346.455 M(Lorsque vous utilisez un VPN pour acc\351der \340 un r\351seau MS, souvenez-vous qu'il vous faut fournir deux)S
0 333.255 M(jetons d'authentification diff\351rents - un pour se connecter au serveur VPN \(le mot de passe VPN\) et l'autre)S
0 320.055 M(pour acc\351der aux ressources du r\351seau distant une fois que la connexion est \351tablie \(le mot de passe r\351seau\).)S
0 293.655 M(Le mot de passe VPN - le nom d'utilisateur et le mot de passe que vous avez entr\351 dans votre client VPN)S
0 280.455 M(lorsque vous avez initi\351 la connexion au serveur VPN - n'est utilis\351 que par le serveur VPN pour vous)S
0 267.255 M(autoriser \340 vous connecter au r\351seau via le VPN. Il n'est utilis\351 pour rien d'autre une fois que vous \352tes)S
0 254.055 M(connect\351.)S
0 227.655 M(Le mot de passe VPN n'est)S
/F6 SF ( pas)S
/F4 SF ( utilis\351 pour prouver votre identit\351 aux autres ordinateurs du r\351seau distant.)S
0 214.455 M(Pour cela vous devez fournir une autre paire nom d'utilisateur/mot de passe - votre mot de passe r\351seau.)S
0 188.055 M(Il y a deux m\351thodes pour fournir un mot de passe r\351seau. Votre mot de passe r\351seau peut provenir de la)S
0 174.855 M(m\352me paire nom d'utilisateur/mot de passe que celle que vous utilisez lorsque vous vous connectez sur le)S
0 161.655 M(r\351seau local en allumant votre ordinateur. S'il est diff\351rent, vous pouvez configurer votre client VPN pour)S
0 148.455 M(vous demander votre mot de passe pour le r\351seau distant une fois que la connexion VPN est \351tablie.)S
0 122.055 M(Si vous arrivez \340 vous connecter au serveur VPN sans pouvoir acc\351der aux ressources disponibles sur le)S
0 108.855 M(r\351seau distant, alors vous n'avez pas fourni une paire nom d'utilisateur/mot de passe valide sur le r\351seau)S
0 95.655 M(distant. V\351rifiez que le nom d'utilisateur et le mot de passe pour votre r\351seau local fonctionnent aussi sur le)S
0 82.455 M(r\351seau distant, ou configurez votre client VPN pour vous demander un nom d'utilisateur et un mot de passe \340)S
0 69.255 M(utiliser sur le r\351seau distant, et pour vous "enregistrer" sur le r\351seau distant une fois que la connexion VPN est)S
0 56.055 M(\351tablie.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(5.5. Clients PPTP MS et IPX Novell)S
474.768 0 M(30)S
GR
SP
%%Page: 31 31
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 443.72 M 487.0 2.0 F
0 359.88 M 487.0 2.0 F
0 276.04 M 487.0 2.0 F
13.2 FS/F9 SF 0 734.8 M(5.7. Si votre session IPsec meurt automatiquement apr\350s un certain laps de)S
0 718.96 M(temps)S
11 FS/F4 SF 0 692.12 M(Si vous avez des probl\350mes avec votre tunnel IPsec qui meurt r\351guli\350rement, plus particuli\350rement si une)S
0 678.92 M(v\351rification des enregistrements sur le pare-feu montrent que des paquets ISAKMP avec des valeurs "zero)S
0 665.72 M(cookie" passent, voici ce qui arrive.)S
0 639.32 M(Les versions ant\351rieures du patch pour le masquage IPsec ne changeaient pas le d\351lai de fin d'attente \(timeout\))S
0 626.12 M(pour les entr\351es de la table de masquage des paquets ISAKMP UDP. Les entr\351es de la table de masquage pour)S
0 612.92 M(le trafic ISAKMP UDP vont arriver en fin d'attente assez rapidement \(comparativement au canal de donn\351es\))S
0 599.72 M(et vont \352tre supprim\351es ; si l'h\364te IPsec distant d\351cide alors d'initialiser un renouvellement des cl\351s avant que)S
0 586.52 M(la machine IPsec locale ne le fasse, le trafic ISAKMP entrant pour le renouvellement des cl\351s ne pourra alors)S
0 573.32 M(pas \352tre rout\351 vers la machine masqu\351e. Le trafic de renouvellement des cl\351s sera rejet\351, l'h\364te IPsec distant)S
0 560.12 M(pensera que le lien est tomb\351, et que la connexion va \352tre termin\351e.)S
0 533.72 M(Le patch 2.0.x a \351t\351 modifi\351 depuis sa version initiale pour augmenter le d\351lai de fin d'attente des entr\351es de la)S
0 520.52 M(table de masquage concernant les paquets ISAKMP UDP. R\351cup\351rez la version actuelle du patch, disponible)S
0 507.32 M(sur les sites indiqu\351s dans la section Ressources, r\351-appliquez le patch et recompilez votre noyau.)S
0 480.92 M(V\351rifiez \351galement que votre param\350tre)S
/Fa SF ( Dur\351e de vie de la table de masquage IPsec \(IPsec Masq)S
0 467.72 M(Table Lifetime\))S
/F4 SF ( est configur\351 pour \352tre \351gal, ou l\351g\350rement sup\351rieur, \340 votre intervalle de renouvellement)S
0 454.52 M(des cl\351s.)S
13.2 FS/F9 SF 0 423.92 M(5.8. Si le masquage VPN ne fonctionne pas apr\350s le red\351marrage)S
11 FS/F4 SF 0 397.08 M(Vous souvenez-vous d'avoir mis les commandes)S
/Fa SF ( modprobe ip_masq_pptp.o)S
/F4 SF ( ou)S
/Fa SF ( modprobe)S
0 383.88 M(ip_masq_ipsec.o)S
/F4 SF ( dans votre script de d\351marrage)S
/Fa SF ( /etc/rc.d/rc.local)S
/F4 SF ( au cas o\371 vous avez compil\351 le support)S
0 370.68 M(de masquage VPN en modules ?)S
13.2 FS/F9 SF 0 340.08 M(5.9. Si votre seconde session PPTP tue votre premi\350re session)S
11 FS/F4 SF 0 313.24 M(La RFC de PPTP pr\351cise qu'il ne peut y avoir qu'un seul canal de contr\364le entre deux syst\350mes. Cela peut)S
0 300.04 M(vouloir dire qu'un seul client masqu\351 est capable de contacter un serveur PPTP donn\351 \340 un instant donn\351.)S
0 286.84 M(Regardez pour de plus amples d\351tails.)S
15.8 FS/F9 SF 0 253.6 M(6. Notes techniques sur le masquage IPsec et consid\351rations)S
0 234.592 M(sp\351ciales sur la s\351curit\351)S
13.2 FS/F9 SF 0 205.024 M(6.1. Limites et faiblesses du masquage IPsec)S
11 FS/F4 SF 0 178.184 M(Le trafic utilisant le protocole AH)S
/F6 SF ( ne peut pas)S
/F4 SF ( \352tre masqu\351. Le protocole AH inclut un contr\364leur d'int\351grit\351)S
0 164.984 M(cryptographique qui couvre les adresses IP, et que la passerelle de masquage ne peut pas r\351g\351n\351rer)S
0 151.784 M(correctement. Donc tout le trafic AH masqu\351 va \352tre rejet\351 car il aura des contr\364leurs d'int\351grit\351 non valides.)S
0 125.384 M(Le trafic IPsec utilisant le mode de transport ESP ne peut pas non plus \352tre correctement masqu\351. Le mode de)S
0 112.184 M(transport ESP crypte tout ce qui se trouve apr\350s l'ent\352te IP. Or, par exemple, les contr\364leurs d'int\351grit\351 de TCP)S
0 98.984 M(et UDP incluent les adresses IP source et destination, ils se trouvent dans la partie crypt\351e, et ne peuvent donc)S
0 85.784 M(pas \352tre recalcul\351s apr\350s que la passerelle de masquage ait modifi\351 les adresses IP. L'ent\352te TCP/UDP ne va)S
0 72.584 M(donc pas passer les contr\364les d'int\351grit\351 sur la passerelle distante, et le paquet va \352tre rejet\351. Les protocoles)S
0 59.384 M(n'incluant pas les informations sur les adresses IP source ou destination peuvent utiliser le masquage du mode)S
0 46.184 M(de transport.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(5.7. Si votre session IPsec meurt automatiquement apr\350s un certain laps de temps)S
474.768 0 M(31)S
GR
SP
%%Page: 32 32
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
11 FS/F4 SF 0 737 M(Ces limites mises \340 part, le masquage IPsec est s\373r et fiable \340 condition qu'un seul h\364te IPsec soit masqu\351 \340 un)S
0 723.8 M(instant donn\351, ou que chaque h\364te masqu\351 communique avec un serveur distant diff\351rent. Lorsque plusieurs)S
0 710.6 M(machines masqu\351es communiquent avec la m\352me machine distante, quelques faiblesses apparaissent :)S
36 657.8 M(Les communications du mode transport sont sujettes \340 collisions.\15)S
36 631.4 M(Si deux machines masqu\351es ou plus utilisent le mode transport pour communiquer avec le m\352me h\364te)S
36 618.2 M(distant, et si la politique de s\351curit\351 sur l'h\364te distant permet plusieurs sessions de mode transport avec)S
36 605 M(la m\352me machine, il est possible que les sessions aient des collisions. Ceci arrive parce que l'adresse)S
36 591.8 M(IP de la)S
/F6 SF ( passerelle de masquage)S
/F4 SF ( va \352tre utilis\351e pour identifier les sessions, et que les autres)S
36 578.6 M(informations d'identification ne pourront pas \352tre masqu\351es puisqu'elles sont dans la portion crypt\351e)S
36 565.4 M(du paquet.)S
36 539 M(Si la politique de s\351curit\351 de l'h\364te distant n'autorise pas plusieurs sessions simultan\351es en mode)S
36 525.8 M(transport avec la m\352me machine, la situation est pire : la session en mode transport n\351goci\351e en)S
36 512.6 M(dernier va \351craser)S
/F6 SF ( tout)S
/F4 SF ( le trafic de la session pr\351c\351dente, entra\356nant sa "mort". Alors que les sessions)S
36 499.4 M(\351tablies via l'ancienne session IPsec en mode transport vont \352tre rapidement r\351initialis\351es si l'h\364te)S
36 486.2 M(distant n'attend pas de trafic, au moins un paquet de donn\351es va \352tre envoy\351 \340 la mauvaise machine.)S
36 473 M(Ce paquet va probablement \352tre ignor\351 par le destinataire, mais il va tout de m\352me \352tre envoy\351.)S
/F6 SF 36 446.6 M(Donc une collision du mode transport peut avoir comme cons\351quence une fuite d'information entre)S
36 433.4 M(les deux sessions ou bien la fin de l'une des deux sessions.)S
/F4 SF ( L'utilisation d'IPsec en mode transport via)S
36 420.2 M(une passerelle de masquage)S
/F6 SF ( n'est pas recommand\351e)S
/F4 SF ( s'il y a une possibilit\351 que d'autres sessions IPsec)S
36 407 M(en mode transport soient initialis\351es via la m\352me passerelle de masquage vers le m\352me h\364te IPsec)S
36 393.8 M(distant.)S
36 367.4 M(IPsec en mode tunnel avec une adresse de r\351seau externe \(l'h\364te IPsec masqu\351 se voit attribuer une)S
36 354.2 M(adresse IP du r\351seau de l'h\364te distant\) n'est)S
/F6 SF ( pas)S
/F4 SF ( sujet \340 ces probl\350mes, car l'adresse IP fournie par le)S
36 341 M(r\351seau distant sera utilis\351e pour identifier les sessions plut\364t que l'adresse IP de la machine)S
36 327.8 M(masquante.)S
/Fc SF 28.19 657.8 M(\267 )S
/F4 SF 36 314.6 M(Les communications ISAKMP sont sujettes \340 des collisions de cookies.\15)S
36 288.2 M(Si deux ou plusieurs machines masqu\351es \351tablissant une session avec la m\352me machine distante)S
36 275 M(utilisent le m\352me cookie lors de l'initialisation du trafic ISAKMP, la passerelle de masquage va router)S
36 261.8 M(tout le trafic ISAKMP vers la seconde machine. Il y a une chance sur 2^64 \(ie. tr\350s petite\) pour que)S
36 248.6 M(cette collision ait lieu lorsque la connexion ISAKMP initiale est \351tablie.)S
36 222.2 M(Pour corriger cela, il faut inclure le cookie de r\351ponse dans la cl\351 utilis\351e pour router le trafic)S
36 209 M(ISAKMP entrant. Cette modification est incluse dans le code de masquage IPsec des noyaux 2.2.x, et)S
36 195.8 M(la courte p\351riode entre le moment o\371 l'h\364te masqu\351 initialise l'\351change ISAKMP et la r\351ponse de)S
36 182.6 M(l'h\364te distant est prot\351g\351e par le bloquage de tout nouveau trafic ISAKMP qui pourrait entrer en)S
36 169.4 M(collision avec le trafic actuel. Cette modification va bient\364t \352tre port\351e sur le code des 2.0.x.)S
/Fc SF 28.19 314.6 M(\267 )S
/F4 SF 36 156.2 M(Il peut y avoir une collision entre les valeurs SPI du trafic entrant.\15)S
36 129.8 M(Deux ou plusieurs h\364tes IPsec masqu\351s communiquant avec la m\352me machine IPsec distante peuvent)S
36 116.6 M(n\351gocier pour utiliser la m\352me valeur SPI pour le trafic entrant. Si cela arrive, la passerelle de)S
36 103.4 M(masquage va router tout le trafic entrant vers la premi\350re machine qui va recevoir tout le trafic entrant)S
36 90.2 M(avec ce SPI. La probabilit\351 est de 1 sur 2^32 pour chaque session ESP, et le cas peut se pr\351senter \340)S
36 77 M(chaque renouvellement de cl\351s.)S
36 50.6 M(Les valeurs SPI sont rattach\351es \340 diff\351rents SA ayant diff\351rentes cl\351s de cryptage, le premier h\364te ne)S
36 37.4 M(sera donc pas capable de d\351crire les donn\351es destin\351es aux autres machines, donc il n'y aura aucune)S
/Fc SF 28.19 156.2 M(\267 )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(5.7. Si votre session IPsec meurt automatiquement apr\350s un certain laps de temps)S
474.768 0 M(32)S
GR
SP
%%Page: 33 33
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
0 449 M 487.0 2.0 F
11 FS/F4 SF 36 737 M(fuite de donn\351es. Il n'y a aucun moyen pour la passerelle de masquage de d\351tecter ou d'emp\352cher cette)S
36 723.8 M(collision. La seule fa\347on d'emp\352cher cette collision est que l'h\364te IPsec distant v\351rifie la valeur SPI)S
36 710.6 M(propos\351e par la machine masqu\351e pour voir si cette valeur SPI est d\351j\340 utilis\351e par un autre SA depuis)S
36 697.4 M(la m\352me adresse IP. Il est peu probable que ceci soit impl\351ment\351 un jour, car cela imposerait une)S
36 684.2 M(charge suppl\351mentaire \340 une op\351ration d\351j\340 co\373teuse \(le renouvellement des cl\351s\) pour un b\351n\351fice)S
36 671 M(concernant un nombre r\351duit de personnes et un type d'\351v\350nement assez rare.)S
36 657.8 M(Les valeurs SPI entrantes et sortantes peuvent \352tre dissoci\351es.\15)S
36 631.4 M(Ceci sera vu en d\351tail dans la section suivante.)S
/Fc SF 28.19 657.8 M(\267 )S
/F4 SF 0 578.6 M(Pour \351viter ces probl\350mes, le code des noyaux 2.2.x emp\352che par d\351faut l'\351tablissement de plusieurs)S
0 565.4 M(connexions vers la m\352me machine distante. Si vous estimez que la faiblesse li\351e \340 plusieurs connexions vers la)S
0 552.2 M(m\352me machine distante est acceptable, vous pouvez activer les "sessions parall\350les".)S
0 525.8 M(Il peut \352tre g\352nant de bloquer pour des raisons de s\351curit\351 les sessions parall\350les : il n'y a aucun moyen pour le)S
0 512.6 M(code de masquage IPsec de sniffer la session et de voir quand elle se termine, donc les entr\351es de la table de)S
0 499.4 M(masquage vont \352tre conserv\351es pendant leur dur\351e de vie standard, m\352me si la session se termine juste apr\350s)S
0 486.2 M(qu'elle ait \351t\351 \351tablie. Si l'on emp\352che les sessions parall\350les, cela signifie que le serveur n'acceptera pas)S
0 473 M(d'autre client tant que l'entr\351e de la table de masquage la plus r\351cente sera pr\351sente. Cela peut prendre)S
0 459.8 M(plusieurs heures.)S
13.2 FS/F9 SF 0 429.2 M(6.2. Routage correct du trafic crypt\351 entrant)S
11 FS/F4 SF 0 402.36 M(La partie de l'\351change de cl\351s ISAKMP o\371 les valeurs SPI d'ESP sont communiqu\351es est crypt\351e, donc les)S
0 389.16 M(valeurs SPI d'ESP doivent \352tre d\351termin\351es en \351tudiant le trafic ESP actuel. Le trafic ESP sortant ne contient)S
0 375.96 M(aucune indication sur ce que sera le SPI entrant. Cela signifie qu'il n'y a aucune m\351thode fiable pour associer)S
0 362.76 M(le trafic ESP entrant avec le trafic ESP sortant.)S
0 336.36 M(Le masquage IPsec tente d'associer le trafic ESP entrant et sortant en s\351rialisant le trafic ESP par machine)S
0 323.16 M(distante. Concr\350tement :)S
36 270.36 M(Si un paquet ESP sortant avec une valeur SPI qui n'a pas encore \351t\351 vue \(ou dont l'entr\351e dans la table)S
36 257.16 M(de masquage a expir\351\) est re\347u \(il sera appel\351 par la suite un "paquet initial"\), une entr\351e dans la table)S
36 243.96 M(de masquage est cr\351\351e pour cette combinaison AdresseSource+SPI+AdresseDest. Elle est marqu\351e)S
36 230.76 M(comme "en attente", ce qui signifie qu'aucun trafic correspondant \340 cette entr\351e n'a \351t\351 pour l'instant)S
36 217.56 M(re\347u. Le marquage se fait en mettant la valeur "SPI entrant" dans l'entr\351e de la table de masquage \340)S
36 204.36 M(z\351ro, qui est une valeur r\351serv\351e pour cela. Ceci arrivera lors de l'initialisation d'une nouvelle)S
36 191.16 M(connexion ESP et \340 intervalles r\351guliers lors du renouvellement de cl\351s d'une connexion ESP)S
36 177.96 M(existante.)S
/Fc SF 28.19 270.36 M(\267 )S
/F4 SF 36 164.76 M(Tant que l'entr\351e de la table de masquage est en attente, aucun autre paquet ESP initial \340 destination)S
36 151.56 M(du)S
/F6 SF ( m\352me h\364te distant)S
/F4 SF ( n'est trait\351. Les paquets sont imm\351diatement rejet\351s, et une entr\351e du journal)S
36 138.36 M(syst\350me est ajout\351e, pr\351cisant que le trafic est temporairement bloqu\351. Ceci s'applique \351galement au)S
36 125.16 M(trafic initial en provenance de la m\352me machine masqu\351e \340 destination du m\352me h\364te distant, si les)S
36 111.96 M(valeurs SPI sont diff\351rentes. Le trafic vers d'autres h\364tes distants, et le trafic o\371 les deux valeurs SPI)S
36 98.76 M(sont connues \(trafic d\351j\340 "\351tabli"\) n'est pas affect\351.)S
/Fc SF 28.19 164.76 M(\267 )S
/F4 SF 36 85.56 M(Ceci peut facilement mener \340 un d\351ni de service sur la machine distante, c'est pour cela que la dur\351e)S
36 72.36 M(de vie de cette entr\351e en attente de la table de masquage ESP est faible, et que seul un nombre limit\351)S
36 59.16 M(de tentatives pour le m\352me trafic est autoris\351. Ceci permet de faire un acc\350s via round-robin \340 la)S
36 45.96 M(machine distante si plusieurs machines masqu\351es tentent d'initialiser simultan\351ment la connexion et)S
36 32.76 M(que les r\351ponses n'arrivent pas tr\350s vite, par exemple \340 cause d'une congestion r\351seau, ou d'une)S
/Fc SF 28.19 85.56 M(\267 )S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(6.2. Routage correct du trafic crypt\351 entrant)S
474.768 0 M(33)S
GR
SP
%%Page: 34 34
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
11 FS/F4 SF 36 737 M(machine distante lente. Le d\351compte des tentatives commence d\350s qu'il y a une collision, donc l'h\364te)S
36 723.8 M(IPsec masqu\351 peut attendre une r\351ponse aussi longtemps qu'il le faut jusqu'\340 ce qu'il soit n\351cessaire de)S
36 710.6 M(faire une mise en s\351rie des connexions.)S
36 697.4 M(Quand un paquet ESP est re\347u en provenance de l'h\364te distant en attente, et que la valeur SPI)S
36 684.2 M(n'appara\356t dans aucune entr\351e de la table de masquage, il est suppos\351 que le paquet est la r\351ponse au)S
36 671 M(paquet en attente initial. La valeur SPI est stock\351e dans l'entr\351e courante de la table de masquage)S
36 657.8 M(associant les valeurs SPI, et le trafic ESP entrant est alors rout\351 vers la machine masqu\351e. A ce point)S
36 644.6 M(un autre paquet initial destin\351 au serveur distant peut \352tre trait\351.)S
/Fc SF 28.19 697.4 M(\267 )S
/F4 SF 36 631.4 M(Tout trafic ESP avec une valeur SPI de z\351ro est rejet\351 comme \351tant invalide, conform\351ment au RFC.)S
/Fc SF 28.19 631.4 M(\267 )S
/F4 SF 0 578.6 M(Il y a plusieurs possibilit\351s pour que l'association de trafic ne se fasse pas proprement :)S
36 525.8 M(La latence du r\351seau ou la lenteur d'une machine distante peuvent retarder suffisamment la r\351ponse au)S
36 512.6 M(paquet initial pour que l'entr\351e de la table de masquage ait expir\351, et qu'une autre machine masqu\351e ait)S
36 499.4 M(eu sa chance d'initialiser un trafic. Ceci peut faire que la r\351ponse sera associ\351e au mauvais SPI sortant,)S
36 486.2 M(et donc le trafic entrant sera rout\351 vers la mauvaise machine masqu\351e. Si cela arrive, la machine)S
36 473 M(masqu\351e recevant le trafic par erreur le rejettera parce qu'il n'aura pas la valeur SPI attendue, et tout le)S
36 459.8 M(monde risque de patienter jusqu'\340 la fin du temps d'attente pour faire un nouvel \351change de cl\351s, et)S
36 446.6 M(r\351essayer. On peut y rem\351dier en \351ditant)S
/Fa SF ( /usr/src/linux/net/ipv4/ip_masq.c)S
/F4 SF ( \()S
/Fa SF (ip_masq_ipsec.c)S
/F4 SF ( dans)S
36 433.4 M(le 2.2.x\) et en augmentant la dur\351e de vie d'INIT ou le nombre de tentatives INIT autoris\351es, avec)S
36 420.2 M(pour co\373t l'agrandissement de la fen\352tre de bloquage \(et de d\351ni de service\).)S
/Fc SF 28.19 525.8 M(\267 )S
/F4 SF 36 407 M(Les sessions inactives ou semi-inactives \(avec un trafic entrant peu fr\351quent et aucun trafic sortant\))S
36 393.8 M(sur une longue p\351riode peuvent le rester suffisamment longtemps pour que l'entr\351e de la table de)S
36 380.6 M(masquage expire. Si la machine distante envoie du trafic d'une session ayant d\351j\340 expir\351 au niveau de)S
36 367.4 M(la table de masquage pendant qu'une initialisation est en cours vers la m\352me machine, le trafic peut)S
36 354.2 M(\352tre incorrectement rout\351, pour la m\352me raison que plus haut. On peut y rem\351dier en s'assurant que le)S
36 341 M(param\350tre de configuration du noyau)S
/Fa SF ( IPsec Masq Table Lifetime)S
/F4 SF ( est l\351g\350rement plus grand que)S
36 327.8 M(l'intervalle de renouvellement des cl\351s, qui est la dur\351e la plus longue que les paires SPI peuvent)S
36 314.6 M(utiliser. Le probl\350me ici est que vous ne pouvez pas conna\356tre tous les intervalles de renouvellement)S
36 301.4 M(des cl\351s si vous masquez plusieurs serveurs distants, ou que certains peuvent avoir leurs intervalles de)S
36 288.2 M(renouvellement des cl\351s positionn\351s \340 des valeurs d\351raisonnablement \351lev\351es, comme plusieurs)S
36 275 M(heures.)S
/Fc SF 28.19 407 M(\267 )S
/F4 SF 36 261.8 M(S'il y a un d\351lai entre un renouvellement de cl\351s et la transmission du trafic ESP sortant utilisant le)S
36 248.6 M(nouveau SPI, et si durant ce d\351lai un trafic ESP entrant utilisant ce nouveau SPI est re\347u, il n'y a pas)S
36 235.4 M(d'entr\351e de la table de masquage d\351crivant comment router le trafic entrant. Si une autre machine)S
36 222.2 M(masqu\351e a une initialisation en attente avec le m\352me h\364te distant, le trafic va \352tre dissoci\351. Notez que)S
36 209 M(la s\351rialisation du trafic ESP initial n'affecte)S
/F6 SF ( pas)S
/F4 SF ( le trafic de renouvellement des cl\351s ISAKMP.)S
/Fc SF 28.19 261.8 M(\267 )S
/F4 SF 0 156.2 M(La meilleure solution est d'avoir un moyen de pr\351-charger la table de masquage avec les bonnes paires)S
0 143 M(SPI-sortie/SPI-entr\351e, ou une autre forme d'association machine_distante + SPI_entr\351e avec la)S
0 129.8 M(machine_masqu\351e. Cela ne peut pas \352tre fait en suivant l'\351change de cl\351s ISAKMP, car il est crypt\351. Il peut)S
0 116.6 M(\352tre possible d'utiliser RSIP \(\351galement connu en tant que Translation d'Adresse R\351seau pour un h\364te \(NdT :)S
0 103.4 M(Host-NAT\)\) pour communiquer avec l'h\364te IPsec masqu\351 et demander une notification sur les informations)S
0 90.2 M(SPI une fois que la n\351gociation a eu lieu. Ce point est \340 \351tudier. Si quelque chose est fait pour l'impl\351menter,)S
0 77 M(ce ne sera pas fait avant les s\351ries 2.3.x, car RSIP est un protocole NAT client/serveur assez complexe.)S
0 50.6 M(Quand un paquet ESP entrant avec un nouveau SPI est re\347u, le pare-feu de masquage tente de deviner \340)S
0 37.4 M(quel\(s\) h\364te\(s\) masqu\351\(s\) ce trafic entrant est destin\351. Si le trafic ESP entrant ne correspond pas \340 une session)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(6.2. Routage correct du trafic crypt\351 entrant)S
474.768 0 M(34)S
GR
SP
%%Page: 35 35
%%PageBoundingBox: 72 36 559 806
GS
72 36 T
11 FS/F4 SF 0 737 M(\351tablie, ou \340 une session en cours d'initialisation, alors le paquet est envoy\351 \340 la \(aux\) machine\(s\) masqu\351e\(s\))S
0 723.8 M(qui a \(ont\) renouvel\351 en dernier ses \(leurs\) cl\351s avec cet h\364te distant. Les machines masqu\351es)S
0 710.6 M("incorrectement" vont rejeter le trafic comme n'\351tant pas correctement crypt\351, et la machine "correctement")S
0 697.4 M(masqu\351e va recevoir des donn\351es. Lorsque la machine "correctement" masqu\351e r\351pond, le processus normal)S
0 684.2 M(de s\351rialisation de l'initialisation ESP a lieu.)S
/F8 SF 114.052 759 M(Linux VPN Masquerade HOWTO - Version fran\347aise)S
0 0 M(6.2. Routage correct du trafic crypt\351 entrant)S
474.768 0 M(35)S
GR
SP
%%Trailer
%%EOF
