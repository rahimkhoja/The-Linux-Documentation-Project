  Guide pratique d'utilisation de la carte mère Elite K7s5a sous Linux

  Sebfrance

   <rf POINT eerf CHEZ otwohecnarfbes>

   Préparation de la publication de la v.f.: Jean-Philippe Guérard

   Version : 1.1

   30 mars 2002

   -------------------------------------------------------------------

   Table des matières

   1. Introduction

   2. La carte son intégrée

                2.1. Obtention des pilotes

                2.2. Installation

   3. Les capteurs de la carte mère

                3.1. Obtention des pilotes

                3.2. Installation

1. Introduction

[1][Important] Important                                                    
               La version française de ce document est largement dépassée.  
               Reportez-vous à l'original anglais...                        
               http://seb.france.free.fr/linux/K7S5A/en/K7s5a-HOWTO.html    
               [http://seb.france.free.fr/linux/K7S5A/en/K7s5a-HOWTO.html]. 

   J'ai eut cette carte pour noël 2001, et après quelques recherches,
   j'ai compris que le chipset sis735 n'était pas reconnu par
   mandrake [http://www.mandrake.com] 8.0, OSS
   [http://www.opensound.com] avait des pilotes qui fonctionnait bien
   mais je ne voulais pas les payer, donc j'ai été voir sur le cvs
   d'alsa et ai découvert qu'ils avait quelque chose pour le sis 7012
   et plus tard, ai aussi trouveé les pilotes pour les capteurs de
   températures de la carte.

2. La carte son intégrée

  2.1. Obtention des pilotes

   Donc nous allons compiler les sources récentes d'alsa, qui devrait
   fonctionner de la même manière sur les autres distrib... Seulement
   les sources du noyau changeront puisque mandrake a ses propres
   patches. Vous pouvez obtenir ces sources sur le cd ou un ftp de
   votre distribution ou de http://www.kernel.org
   [http://www.kernel.org/pub/linux/kernel/]. Ici, on pourra trouver
   les sources du noyau Mandrake utilisé sous 8.0 :
   [2]ftp://ftp.univ-savoie.fr/pub/Linux/Mandrake/8.0/i586/Mandrake/RPMS/kernel-source-2.4.3-20mdk.i586.rpm

   il vous faudra aussi les pilotes d'alsa :
   [3]ftp://ftp.alsa-project.org/pub/driver/alsa-driver-0.9.0beta10.tar.bz2.

  2.2. Installation

   Installez vos sources du noyau, dans mon cas :

 rpm -ivh kernel-source-2.4.3-20mdk.i586.rpm

   Puis décompressez les pilotes alsa :

 bzip2 -d alsa-driver-0.9.0beta10.tar.bz2 && \
     tar -xvf alsa-driver-0.9.0beta10.tar

   les compiler, les installer, et créer les fichiers de
   périphériques dans /dev.

 cd alsa-driver-0.9.0beta10 && \
     make install && ./snddevices

   Éditez /etc/modules.conf pour tout régler en y ajoutant ces
   lignes :

 alias char-major-116 snd
 alias char-major-14 soundcore
 alias sound-slot-0 snd-card-0
 alias sound-service-0-0 snd-mixer-oss
 alias sound-service-0-1 snd-seq-oss
 alias sound-service-0-3 snd-pcm-oss
 alias sound-service-0-8 snd-seq-oss
 alias sound-service-0-12 snd-pcm-oss
 alias snd-card-0 snd-card-intel8x0

3. Les capteurs de la carte mère

  3.1. Obtention des pilotes

   Il est impératif de prendre lm_sensors 2.6.2 ou plus récent :
   http://www.lm-sensors.nu/archive/lm_sensors-2.6.2.tar.gz
   [http://www.lm-sensors.nu/archive/lm_sensors-2.6.2.tar.gz]

   Il vous faudra aussi les sources du noyau voir la rubrique
   « Obtention des pilotes » pour « la carte son intégrée »

  3.2. Installation

 tar -xzvf i2c-2.6.2.tar.gz
 cd i2c-2.6.2
 make && make install

   Ensuite, j'ai eut un problème en faisant make install, donc si
   cela ne marche pas pour vous non plus, faites les commandes
   suivantes :

 cp kernel/i2c-core.o /lib/modules/`uname -r`/misc/i2c-core.o
 cp kernel/i2c-proc.o /lib/modules/`uname -r`/misc/i2c-proc.o
 cp kernel/chips/it87.o /lib/modules/`uname -r`/misc/it87.o

   ok, maintenant copie du programme sensors :

 cp prog/sensors/sensors /usr/bin/sensors

   Éditez alors /etc/modules.conf et ajoutez lui ces lignes :

 alias char-major-89 i2c-dev
 options it87 temp_type=0x31

   effectuez alors :

 modprobe i2c-proc
 modprobe it87
 modprobe i2c-isa
 sensors

   Et là, miracle ! Ça devrait fonctionner.

   Sous le compte root, vous devriez éditer le /etc/sensors.conf la
   ligne contenant : chip "it87-*" et les suivantes permettent de
   modifier les réglages pour obtenir les bons résultats, voici une
   copie de cette partie modifiée de mon fichier (temp1 ne correspond
   à rien de précis, seul temp2 et temp3 fonctionnent).

 chip "it87-*"
 # The values below have been tested on Asus CUSI, CUM motherboards.
 # Voltage monitors as advised in the It8705 data sheet
 label in0 "VCore"
 label in1 "Vcc2.5v"
 label in2 "Vcc5v"
 label in3 "+5V"
 label in4 "+12V"
 label in5 "-12V"
 label in6 "-5V"
 label in7 "SB 5V"
 label in8 "V battery"
 set in0_min 1.5 * 0.95
 set in0_max 1.5 * 1.05
 set in1_min 2.4
 set in1_max 2.6
 set in2_min 3.3 * 0.95
 set in2_max 3.3 * 1.05
 set in3_min 5.0 * 0.95
 set in3_max 5.0 * 1.05
 set in4_min 12 * 0.95
 set in4_max 12 * 1.05
 set in5_min -12 * 0.95
 set in5_max -12 * 1.05
 set in6_min -5 * 0.95
 set in6_max -5 * 1.05
 set in7_min 5 * 0.95
 set in7_max 5 * 1.05
 # vid not monitored by IT8705F
 ignore  vid
 # For this family of chips the negative voltage equation is different from
 # the lm78.  The chip uses two external resistor for scaling but one is
 # tied to a positive reference voltage.  See ITE8705/12 datasheet (SIS950
 # data sheet is wrong)
 # Vs = (1 + Rin/Rf) * Vin - (Rin/Rf) * Vref.
 # Vref = 4.096 volts, Vin is voltage measured, Vs is actual voltage.
 compute in2 (1 + 1)*@ ,       @/(1 + 1)
 compute in3 ((6.8/10)+1)*@ ,  @/((6.8/10)+1)
 compute in4 ((30/10) +1)*@  , @/((30/10) +1)
 # The next two are negative voltages (-12 and -5).
 # The following formulas must be used. Unfortunately the datasheet
 # does not give recommendations for Rin, Rf, but we can back into
 # them based on a nominal +2V input to the chip, together with a 4.096V Vref.
 # Formula:
 #    actual V = (Vmeasured * (1 + Rin/Rf)) - (Vref * (Rin/Rf))
 #    For -12V input use Rin/Rf = 6.68
 #    For -5V input use Rin/Rf = 3.33
 # Then you can convert the forumula to a standard form like :
 compute in5 (7.67 * @) - 27.36  ,  (@ + 27.36) / 7.67
 compute in6 (4.33 * @) - 13.64  ,  (@ + 13.64) / 4.33
 #
 compute in7 ((6.8/10)+1)*@ ,  @/((6.8/10)+1)
 # Temperature
 label temp3       "Processor"
 set   temp3_over  40
 set   temp3_hyst  20
 label temp2       "Mainboard"
 set   temp2_over  45
 set   temp2_hyst  25
 ignore temp1
 # Fans
 label fan1"Processor's Fan"
 set fan1_min 2000
 ignore fan3
 ignore fan2

