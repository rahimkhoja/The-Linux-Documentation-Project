               Linux/GNU : aide-mémoire post-installation

  Défiant les lois de Murphy -- version française du GNU/Linux
  Post-Installation Checklist

   Algologic Research & Solutions
   [http://members.tripod.com/~algolog/index.htm]

        <algolog CHEZ hd1 POINT vsnl POINT net POINT in>

   Adaptation française: Simon Depiets

              <sdepiets CHEZ hotmail POINT com>
          

   Relecture de la version française: Dorian Musso

   <dodolecyclo CHEZ wanadoo POINT fr>

   Préparation de la publication de la v.f.: Jean-Philippe Guérard

           <jean TIRET philippe POINT guerard CHEZ tigreraye POINT org>
      

   Version : 1.0.fr.1.0

   12 décembre 2003

   +----------------------------------------------------------------+
   | Historique des versions                                        |
   |----------------------------------------------------------------|
   | Version 1.0.fr.1.0        | 2003-12-12       | SD,DM,JPG       |
   |----------------------------------------------------------------|
   | Première adaptation française                                  |
   |----------------------------------------------------------------|
   | Version 1.0               | 2001-06-12       |                 |
   |----------------------------------------------------------------|
   | Version originale en SGML Docbook                              |
   +----------------------------------------------------------------+

   Résumé

   Ce document est un aide-mémoire de ce que vous devriez
   immédiatement faire après l'installation d'un système Linux/GNU.
   Ces précautions vous éviteront de vous inquiéter si, plus tard,
   vous rencontrez des problèmes. Ce document contient aussi un
   script permettant d'automatiser cette démarche.

   -------------------------------------------------------------------

   Table des matières

   1. Introduction

                1.1. Droits d'utilisation

                1.2. Limitations de responsabilité

                1.3. Commentaires

   2. Étapes à suivre après l'installation

   3. Le script bash

                3.1. Le script...

1. Introduction

   Vous venez de finir l'installation de votre système Linux. Vous
   venez de mettre à jour votre système Linux existant. Vous êtes
   heureux de vos premières expériences sur Linux. Vous voulez être
   sûrs que vous pourrez profiter de ce système en dépit des dégâts
   que vous pourriez lui causer par une éventuelle bévue

   Conserver un instantané de votre nouveau système est une bonne
   idée. Cela vous permettra, en cas de mauvaise manipulation, de le
   récupérer sans séquelles permanentes. Cet aide-mémoire vous aidera
   à prendre les précautions nécessaires, après avoir terminé
   l'installation d'un système Linux. C'est la suite du guide
   pratique Linux/GNU : aide-mémoire avant installation
   [http://www.traduc.org/docs/howto/lecture/Pre-Installation-Checklist.html].
   Il accompagne le très officiel Guide pratique d'installation de
   Linux
   [http://www.traduc.org/docs/howto/lecture/Installation-HOWTO.html].
   Ce document contient aussi le script qui automatisera la démarche
   de réalisation d'un instantané de votre système.

  1.1. Droits d'utilisation

   Copyright © 2001 Algologic Research & Solutions
   [http://members.tripod.com/~algolog/index.htm] pour la version
   originale.

   Copyright © 2003-2004 Simon Depiets, Dorian Musso et Jean-Philippe
   Guérard pour la version française.

   Ce document est distribué selon les termes de la licence du Projet
   de Documentation Linux (LDP) telle qu'elle est rédigée ci-dessous.

   This document is distributed under the terms of the Linux
   Documentation Project (LDP) license, stated below.

   À moins d'une mention explicite du contraire, les guides pratiques
   Linux sont sous copyright de leurs auteurs respectifs. Les guides
   pratiques Linux peuvent être distribués ou reproduits, en partie
   ou dans leur intégralité, par tout moyen physique ou électronique,
   tant que cette licence est conservée dans toutes les copies. La
   redistribution commerciale est autorisée et encouragée, mais
   l'auteur souhaiterait être tenu informé de telles distributions.

   Unless otherwise stated, Linux HOWTO documents are copyrighted by
   their respective authors. Linux HOWTO documents may be reproduced
   and distributed in whole or in part, in any medium physical or
   electronic, as long as this copyright notice is retained on all
   copies. Commercial redistribution is allowed and encouraged;
   however, the author would like to be notified of any such
   distributions.

   Toute traduction, travail dérivé ou assemblage incorporant un
   quelconque guide pratique Linux doit être distribué selon les
   termes de cette licence. Autrement dit, vous n'avez pas le droit
   de réaliser un travail dérivant d'un guide pratique et d'imposer
   des restrictions supplémentaire à sa distribution. Des exceptions
   à ces règles peuvent être accordées selon certaines conditions ;
   veuillez contacter le coordinateur des guides pratiques Linux à
   l'adresse indiquée ci-dessous.

   All translations, derivative works, or aggregate works
   incorporating any Linux HOWTO documents must be covered under this
   copyright notice. That is, you may not produce a derivative work
   from a HOWTO and impose additional restrictions on its
   distribution. Exceptions to these rules may be granted under
   certain conditions; please contact the Linux HOWTO coordinator at
   the address given below.

   En résumé, nous voulons promouvoir la diffusion de ces
   informations par tous les circuits possibles. Cependant, nous
   souhaitons conserver nos droits d'auteurs sur les guides pratiques
   et nous voudrions être informés de tout plan de redistribution de
   ceux-ci.

   In short, we wish to promote dissemination of this information
   through as many channels as possible. However, we do wish to
   retain copyright on the HOWTO documents, and would like to be
   notified of any plans to redistribute the HOWTOs.

   Si vous avez des questions, envoyez un message en anglais à
   <feedback CHEZ en POINT tldp POINT org>

   If you have any questions, please contact <feedback CHEZ en POINT
   tldp POINT org>.

  1.2. Limitations de responsabilité

   Aucune responsabilité ne pourra être retenue concernant le contenu
   de ces documents. Vous utilisez les concepts, les exemples et les
   autres informations à vos risques et périls. Comme il s'agit d'une
   nouvelle édition de ce document, elle peut comporter des erreurs
   ou des inexactitudes, ce qui pourrait bien sûr endommager votre
   système. Procédez avec prudence. Bien que ce soit hautement
   improbable, les auteurs n'engageront en aucun cas leur
   responsabilité sur ce point.

   No liability for the contents of this documents can be accepted.
   Use the concepts, examples and other content at your own risk. As
   this is a new edition of this document, there may be errors and
   inaccuracies, that may of course be damaging to your system.
   Proceed with caution, and although this is highly unlikely, the
   author(s) do not take any responsibility for that.

   Tous les copyrights sont détenus par leurs auteurs respectifs, à
   moins que le contraire ne soit explicitement indiqué.
   L'utilisation d'un terme dans ce document ne doit pas être
   considéré comme suceptible d'affecter la validité d'une marque
   déposée.

   All copyrights are held by their respective owners, unless
   specifically noted otherwise. Use of a term in this document
   should not be regarded as affecting the validity of any trademark
   or service mark.

   Le fait de nommer un produit particulier ne peut être perçu comme
   une approbation de ce produit.

   Naming of particular products or brands should not be seen as
   endorsements.

   Il est fortement recommandé d'effectuer une sauvegarde de votre
   système avant une installation majeure et de continuer de le faire
   à intervalles régulières.

   You are strongly recommended to make a backup of your system
   before major installation and continue to do so at regular
   intervals.

  1.3. Commentaires

   Ce document, et particulièrement le script, sont continuellement
   mis à jour. Soyez sûrs que vous utilisez la dernière version de ce
   document, en visitant régulièrement le site de la version
   originale de l'aide mémoire de post-installation
   [http://algolog.tripod.com/postlnx.htm].

   La dernière version française
   [http://www.traduc.org/docs/howto/lecture/Post-Installation-Checklist.html]
   de ce document est toujours disponible sur le site du projet
   traduc.org [http://www.traduc.org].

   Vous pouvez écrire vos suggestions et réactions à l'adresse
   suivante : <algolog CHEZ hd1 POINT vsnl POINT net POINT in>

   N'hésitez pas à faire parvenir tout commentaire relatif à la
   version française de ce document à <commentaires CHEZ traduc POINT
   org> en précisant le titre et la version de ce document.

   [1][Note] Note                           
             Nous ne répondrons pas aux questions générales sur
             Linux. Si vous avez besoin d'une assistance
             professionelle sur Linux, contactez Algologic
             [http://algolog.tripod.com/tools.htm#linux]. Vous pouvez
             aussi visiter notre page web : Algologic Research &
             Solutions [http://algolog.tripod.com/].

2. Étapes à suivre après l'installation

   Pour profiter pleinement de votre nouvelle installation Linux sans
   jamais rencontrer de soucis, il est important de prendre quelques
   précautions élémentaires. Ceci doit être fait dès que vous aurez
   fini d'installer Linux sur votre machine pour la première fois.

    1. Créez une disquette de démarrage
       [http://www.traduc.org/docs/howto/lecture/Bootdisk-HOWTO.html]
       et une disquette de secours. Les utilitaires permettant de
       créer ces disquettes sont inclus dans votre distribution
       Linux.

    2. Si vous êtes paranoïaque (comme moi), vous pouvez faire deux
       copies de chacune de ces disquettes. En effet les disquettes
       sont connues pour ne jamais marcher quand on en a le plus
       besoin.

    3. Testez votre disquette de démarrage. Assurez-vous que vous
       pouvez lancer Linux en utilisant votre disquette. Souvenez
       vous que la loi de Murphy peut vous frapper au moment où vous
       vous y attendez le moins.

    4. Vérifiez à fond votre nouveau système. Essayez tous les
       principaux paquets.

    5. Essayez le système X-Windows, le bureau et le gestionnaire de
       fenêtres, si vous les avez installés.

    6. Essayez de vous connecter à votre réseau local et à
       l'internet.

    7. Créez au moins un compte utilisateur pour vérifier et trouver
       les défauts de votre installation. Refaites toutes les
       verifications précédentes en utilisant le compte utilisateur
       que vous venez de créer.

    8. Rejoingnez un Groupe d'Utilisateurs de Linux (GUL). Vous devez
       découvrir s'il en existe un près de chez vous. Pour cela, vous
       pouvez consulter la liste des GUL francophones
       [http://www.aful.org/gul] de l'AFUL, la carte des GUL
       [http://www.linuxfrench.net/Carte/] de LinuxFrench ou la liste
       des associations et GUL
       [http://www.traduc.org/docs/bd_assos/etat_assos.php] de
       traduc.org. Si il n'y en a pas, créez-en un vous-même, dans
       votre voisinage, votre campus, votre ville...

    9. Rejoignez au moins une liste de discussion Linux pour vous
       tenir au courant et avoir des nouvelles. Des listes
       francophones existent pour les principales distributions Linux
       et certains groupes d'utilisateurs. Le plus simple est de
       commencer par regarder le site de la distribution que vous
       utilisez, afin de trouver une liste de discussion destinée aux
       utilisateurs francophones. Si vous ne trouvez pas, un
       recherche sur Google [http://www.google.fr] devrait permettre
       assez simplement de trouver des listes intéressantes. Il
       existe également un index des listes anglophones
       [http://oslab.snu.ac.kr/%7Edjshin/linux/mail-list/index.shtml]
       comprenant une centaine de listes.

   10. Enregistrez-vous avec votre machine sur le Compteur mondial
       des utilisateur de Linux [http://counter.li.org/] (site en
       anglais).

   11. Et pour finir... Téléchargez le script
       [http://algolog.tripod.com/shivalik.gz] et lancez-le. Faites
       une copie de sauvegarde (sur une disquette ou un CD) du
       répertoire : /root/postinfo que le script a créé. Vous devriez
       aussi imprimer le rapport de synthèse /root/postinfo/summary
       créé par le script.

   12. Vous devez lancer ce script dès que vous aurez installé Linux
       pour la première fois, puis après chaque mise à jour
       importante du système. Vous pouvez aussi enregistrer ce script
       dans la table des chronologies systèmes (crontab), afin que le
       script se lance de lui-même périodiquement. Cela vous évitera
       des tracas si des dysfonctionnements survenaient plus tard.

3. Le script bash

   Le script bash [http://algolog.tripod.com/shivalik.gz] (shivalik
   version 1.0) est un programme permettant de sauvegarder les
   informations et les fichiers essentiels. Après avoir téléchargé ce
   script :

     o Assurez-vous d'être connecté sous le compte root ;

     o Créez un répertoire avec les permissions de l'utilisateur
       root. Disons : /root/mon_script ;

     o Enregistrez le script shivalik.gz
       [http://algolog.tripod.com/shivalik.gz] dans ce répertoire ;

     o Allez dans ce répertoire avec la commande cd /root/mon_script,
       puis décompressez le script avec la commande gunzip
       shivalik.gz ;

   [2][Important] Important                      
                  Vous devez lire l'avertissement donné à la fin du
                  script. Ne passez aux étapes suivantes que si vous
                  êtes d'accord avec les conditions indiquées dans
                  cet avertissement...           

     o Pour lancer le script : vous devez le rendre exécutable
       (uniquement par root) avec la commande chmod 700 shivalik ;

     o Vérifiez que les chemins des divers fichiers qui doivent être
       sauvés sont corrects et conformes à votre installation ;

     o Vous ne pourrez exécuter le script correctement que si vous
       êtes connectés sous le compte root. En effet, un grand nombre
       des fichiers à sauvegarder ne sont accessibles que par
       l'utilisateur root.

   Maintenant vous pouvez exécuter le script (sous le compte root, ne
   l'oubliez pas) en lançant la commande : ./shivalik

   Ce script est très documenté. En aucun cas il ne modifiera ni ne
   détruira vos fichiers et vos répertoires. Il va créer une copie de
   sauvegarde bien protégée de quelques informations et fichiers
   essentiels. Le script entier est disponible ci-dessous pour que
   vous puissiez le parcourir et comprendre son fonctionnement.
   Sentez-vous libre d'ajouter au script des fonctions
   supplémentaires ou des fichiers que vous souhaiteriez voir
   sauvegarder. N'hésitez pas à envoyer un petit mot en anglais à
   l'auteur de ce script (<algolog CHEZ hd1 POINT vsnl POINT net
   POINT in>) pour lui indiquer vos modifications.

   Rappelez-vous que le script shivalik n'est pas un outil destiné à
   sauvegarder et à restaurer totalement votre système. L'idéal étant
   de faire une copie intégrale de votre installation Linux, incluant
   tous les fichiers et tous les répertoires. Ce qui n'est pas
   toujours possible, nécessaire ou conseillé. La seconde meilleure
   chose étant de sauvegarder les informations et les fichiers les
   plus essentiels. Le script shivalik le fait pour vous. Le script
   crée le répertoire /root/postinfo/, et y stocke les informations
   et fichiers essentiels. Pour être préparé à toute éventualité,
   vous devrez intégralement copier le répertoire /root/postinfo/ sur
   un disque ou une disquette dès que le script aura été exécuté.

   Récupération et réparation : en cas de problème, plus tard, vous
   pourrez réparer les fichiers endommagés en les recopiant depuis le
   répertoire /root/postinfo/. C'est aussi simple que ça.

   La structure du répertoire /root/postinfo/ et les fichiers qu'il
   contient seront comme suit :

   /root/postinfo/summary

           Ce fichier contient un rapport de synthèse de la situation
           de votre système (mémoire, partitions, points de montage,
           utilisation du disque). Ce fichier contient aussi la liste
           des fichiers qui ont été sauvegardés. Il contient enfin
           des informations destinées à l'administrateur comme la
           date et l'heure de la sauvegarde, la version de shivalik
           utilisée, et cætera.

   /root/postinfo/postinfo.tar.gz

           Contient une copie du précédent postinfo (s'il y en a eu
           un).

   /root/postinfo/snapshot.gz

           Ce fichier compressé contient une liste structurée de tous
           les fichiers et répertoires de votre système Linux. Vous
           pouvez décompresser ce fichier et utiliser un éditeur de
           texte pour retrouver l'emplacement de n'importe quel
           fichier. Bien sûr, vous ne pourrez retrouver le contenu
           d'un fichier à moins que vous l'ayez sauvegardé
           explicitement ailleurs.

   /root/postinfo/shivalik

           C'est une copie du script shivalik qui a été utilisé pour
           faire la sauvegarde post-installation. Après un incident,
           lors de la récupération, vous pourrez toujours examiner ce
           script pour voir comment la sauvegarde a été faite. Vous
           aurez toujours une copie du script cohérentes avec les
           fichiers créés par le script.

   /root/postinfo/etcfiles/

           Ce sous-répertoire contient la copie d'un grand nombre de
           fichiers essentiels contenus dans le répertoire /etc/ de
           votre installation Linux. Il contient aussi les copies de
           divers fichiers de configuration contenus dans le
           répertoire /etc/.

   /root/postinfo/otherfiles/

           Ce sous-répertoire contient une copie de quelques fichiers
           essentiels (ceux qui ne sont pas dans le répertoire /etc/
           de votre installation Linux. Si vous voulez, vous pouvez
           ajouter n'importe quel autre fichier ici, et le
           sauvegarder automatiquement avec les autres.

  3.1. Le script...

 # ---------------------------------------------------------------------
 #                       shivalik (version 1.0)
 #                 Adaptation française de Simon Depiets
 #
 # Lisez d'abord la section AVERTISSEMENT de ce script.
 #
 # Ce script collecte après installation des informations
 # essentielles sur votre système. Il peut aussi être lancé
 # à l'occasion pour rassembler en un endroit unique toutes
 # les informations utiles sur votre installation Linux.
 #
 # Les données du script seront stockées dans :
 # /root/postinfo/
 #
 # Un rapport de synthèse sera écrit dans :
 # /root/postinfo/summary

 # Pour le mode d'emploi et les informations associées, consultez :
 # http://algolog.tripod.com/postlnx.htm
 # ---------------------------------------------------------------------

 clear

 cat << EOF

 ---------------------------------------------------------------
 Ce texte est la sortie du script shivalik (version 1.0) de
 M. Partha, d'Algologic Research & Solutions.
 Pour que ce script fonctionne correctement, vous devez être
 connecté sous le compte « root ». Vous devez aussi
 lire et accepter les termes et les avertissements donnés dans
 la section AVERTISSSEMENT à la fin de ce script.
 ---------------------------------------------------------------

 ### ÉTAPE 0 ### Travail préparatoire

 Premièrement, nous créons le répertoire /root/postinfo/
 si ce n'est pas encore fait
 EOF

 test ! -d /root/postinfo && mkdir /root/postinfo

 cat << EOF

 Nous sauvegardons la version actuelle de tous les fichiers
 contenus dans le répertoire « postinfo »

 Mais tout d'abord nous supprimons la version précédente,
 c'est-à-dire la version actuelle - 1

 EOF

 test -e /root/postinfo/oldpostinfo* && \
     rm -v /root/postinfo/oldpostinfo.tar.gz

 echo

 # Le fichier oldpostinfo est créé temporairement dans /root ;
 # il sera déplacé dans /root/postinfo

 tar czvf /root/oldpostinfo.tar.gz /root/postinfo/*

 # Vérification du fonctionnement de la compression

 if `test -s /root/oldpostinfo.tar.gz` ; then
     echo "Ancien répertoire postinfo copié dans /root/oldpostinfo.tar.gz"
     ls -l /root/oldpostinfo*
 else
     echo "Impossible de sauvegarder oldpostinfo."
     echo "Abandon. Arrêt du script."
     exit 1
 fi

 # Maintenant nous supprimons tous les fichiers postinfo actuels

 rm -rf /root/postinfo/*

 # Et nous créons un nouveau fichier de synthèse

 echo "shivalik (version 1.0)" > /root/postinfo/summary
 echo -n "Rapport créé le : " >> /root/postinfo/summary

 date -R >> /root/postinfo/summary

 echo
 echo "Et maintenant, nous déplaçons le fichier oldpostinfo"
 echo "dans le répertoire /root/postinfo/"

 mv -v /root/oldpostinfo.tar.gz /root/postinfo
 #

 # Copie du script schivalik

 echo "Charité bien ordonnée commence par soi-même."
 echo "Nous faisons une copie du script shivalik."

 cat << EOF >> /root/postinfo/summary
 Nous faisons une copie du script shivalik dans /root/postinfo/
 EOF


 cp -v ./shivalik /root/postinfo/shivalik

 # Faisons le point

 echo
 echo "Contenu du répertoire /root/postinfo à la fin de l'étape 0"

 ls -AlR /root/postinfo

 echo "Fin de l'"### ÉTAPE 0 ###"
 echo
 #
 #
 echo

 echo "### ÉTAPE 1 ### Prendre un instantané de votre système"

 cat << EOF >> /root/postinfo/summary

 ### ÉTAPE 1 ### Un instantané de tous vos répertoires
                 et de tous vos fichiers

 EOF

 cat << EOF
 La première étape est de faire le point sur le contenu
 de votre ordinateur. Cela peut prendre plusieurs minutes.
 Donc, allez chercher votre tasse à café !
 EOF

 ls -AlRH / >> /root/postinfo/snapshot

 rm -f /root/postinfo/snapshot.gz

 gzip /root/postinfo/snapshot

 echo "Le petit oiseau va sortir !"
 echo "Photo prise"

 cat << EOF >> /root/postinfo/summary
 Une liste exhaustive de tous les fichiers a été crée et enregistrée
 dans /root/postinfo/snapshot.gz
 EOF

 ls -l /root/postinfo/snapshot.gz >> /root/postinfo/summary

 # Faisons le point à la fin de cette étape

 echo
 echo "Contenu du répertoire /root/postinfo à la fin de cette étape"

 ls -l /root/postinfo

 echo "Fin de l'"### ÉTAPE 1 ###"
 echo
 #
 #

 echo
 echo "### ÉTAPE 2 ### Informations sur le système"

 cat << EOF >> /root/postinfo/summary

 ### ÉTAPE 2 ### Informations sur le système

 EOF

 echo "Récolte des informations sur le système"

 echo "... sur la mémoire"
 echo "---- cat /proc/meminfo ---------" >> /root/postinfo/summary
 cat /proc/meminfo >> /root/postinfo/summary

 echo "... sur les partitions et les points de montage"
 echo "---- cat /proc/partitions ------" >> /root/postinfo/summary
 cat /proc/partitions >> /root/postinfo/summary

 echo "... sur l'espace disque utilisé"
 echo "---- df ------------------------" >> /root/postinfo/summary
 df >> /root/postinfo/summary

 echo "... sur les modules"
 echo "---- cat /proc/modules ---------" >> /root/postinfo/summary
 cat /proc/modules >> /root/postinfo/summary

 # Faisons le point à la fin de cette étape

 echo
 echo "Contenu du répertoire /root/postinfo à la fin de l'ÉTAPE 2"
 ls -AlR /root/postinfo
 echo "Fin de l'"### ÉTAPE 2 ###"
 echo
 #
 #
 cat << EOF

 ### ÉTAPE 3 ### Maintenant nous copions quelques fichiers
                 importants du répertoire « /etc ».

 Cette section pourrait avoir besoin d'être adaptée à vos besoins.
 Cela dépend de l'installation que vous avez faite, de la distribution
 que vous avez utilisé et des options que vous avez choisies durant
 l'installation.
 EOF

 cat << EOF >> /root/postinfo/summary

 ### ÉTAPE 3 ### Maintenant nous sauvegardons quelques fichiers
                 importants du répertoire /etc
 EOF

 test ! -d /root/postinfo/etcfiles \
     && mkdir /root/postinfo/etcfiles

 echo "... sauvegarde de XF86Config -- \
 votre fichier de configuration de XWindows"

 cp /etc/XF86Config /root/postinfo/etcfiles

 echo "copie /etc/XF86Config dans /root/postinfo/" \
     >> /root/postinfo/summary

 echo "... sauvegarde du fichier /etc/fstab"
 cp /etc/fstab  /root/postinfo/etcfiles
 echo "copie /etc/fstab dans /root/postinfo/" \
     >> /root/postinfo/summary

 echo "... sauvegarde du fichier /etc/profile"
 cp /etc/profile  /root/postinfo/etcfiles
 echo "copie /etc/profile dans /root/postinfo/" \
     >> /root/postinfo/summary

 echo "... sauvegarde du fichier /etc/profile.local"
 cp /etc/profile.local  /root/postinfo/etcfiles
 echo "copie /etc/profile.local dans /root/postinfo/" >> /root/postinfo/summary

 echo "... sauvegarde des fichiers /etc/*conf"
 cp /etc/*conf /root/postinfo/etcfiles

 echo "... sauvegarde des fichiers /etc/*config"
 cp /etc/*config /root/postinfo/etcfiles

 cat << EOF >> /root/postinfo/summary
 Les fichiers suivants ont été copiés de /etc vers /root/postinfo/etcfiles
 EOF

 echo "/etc/*conf" >> /root/postinfo/summary
 echo "/etc/*config" >> /root/postinfo/summary

 # Faisons le point à la fin de cette étape

 echo
 echo "Contenu de /root/postinfo à la fin de l'ÉTAPE 3"

 ls -AlR /root/postinfo

 echo "Fin de l'"### ÉTAPE 3 ###"
 echo
 #
 #

 cat << EOF

 ### ÉTAPE 4 ### Maintenant nous sauvegardons d'autres fichiers importants

 Cette section à besoin d'être personnalisée selon
 l'installation que vous avez faite, la distribution utilisée
 et les options choisies durant l'installation
 Cette partie du script a été personnalisée pour SuSe 7.1
 EOF

 cat << EOF >> /root/postinfo/summary

 ### ÉTAPE 4 ### Maintenant nous copions quelques autres
                 fichiers importants
                
 dans /root/postinfo/otherfiles
 Vous pouvez ajouter d'autres fichiers à copier à cette étape
 EOF

 test ! -d /root/postinfo/otherfiles \
     && mkdir /root/postinfo/otherfiles

 ls -l /root/postinfo/

 echo "... sauvegarde de /etc/init.d/boot.local --"
 cp /etc/init.d/boot.local /root/postinfo/otherfiles
 echo "copie de /etc/init.d/boot.local dans \
 /root/postinfo/otherfiles" >> /root/postinfo/summary

 echo "... sauvegarde de /etc/init.d/halt.local --"
 cp /etc/init.d/halt.local /root/postinfo/otherfiles
 echo "copie de /etc/init.d/halt.local vers \
 /root/postinfo/otherfiles" >> /root/postinfo/summary

 # faisons le point à la fin de cette étape

 echo
 echo "Contenu de /root/postinfo à la fin de l'ÉTAPE 4"

 ls -AlR /root/postinfo

 echo "Fin de l'"### ÉTAPE 4 ###"
 echo

 echo
 echo "### ÉTAPE 999 ### Emballage, nettoyage"

 cat << EOF >> /root/postinfo/summary

 ### ÉTAPE 999 ### Emballage, nettoyage, bilan
 EOF

 echo "résumé, nettoyage"

 # Pour des raisons de sécurité nous rendons /root/postinfo
 # inaccessible et invisible aux non-root

 chmod 700 /root/postinfo
 chmod 700 /root/postinfo/etcfiles
 chmod 700 /root/postinfo/otherfiles
 chmod 700 /root/postinfo/*
 chmod 700 /root/postinfo/etcfiles/*
 chmod 700 /root/postinfo/otherfiles/*

 echo "Ceci est le contenu de /root/postinfo" >> /root/postinfo/summary
 ls -AlR /root/postinfo >> /root/postinfo/summary
 echo "###### FIN #####" >> /root/postinfo/summary

 # faisons le point à la fin de cette étape

 echo
 echo "Contenu de of /root/postinfo à la fin de l'ÉTAPE 999"
 ls -AlR /root/postinfo

 cat << EOF
 Fin de l\'### ÉTAPE 999 ###

 ###### THE END #####

 IMPORTANT : Vous devez maintenant copier tous les fichiers
 de /root/postinfo dans un endroit sûr, de préférence sur un disque
 différent ou sur un support de sauvegarde extractible.

 Vous trouverez un rapport de synthèse de cette procédure dans
 /root/postinfo/summary

 Vous trouverez la précedente version de ce rapport (s'il y en a une)
 dans /root/postinfo/oldpostinfo.tar.gz
 EOF

 #---------------------------------------------------------
 #        AVERTISSEMENT AVERTISSEMENT AVERTISSEMENT
 #                shivalik (ver. 1.0)
 #
 # Ce script est mis à votre disposition sans aucune
 # garantie ou assurance de performance ou de sa capacité
 # à remplir une tâche quelconque.
 #
 # Sachez que vous utilisez ce script de par votre propre volonté et
 # votre propre initiative et à vos risques et perils.
 #
 # Vous trouverez la dernière version de ce script, et des informations
 # liées à ce script sur : http://algolog.tripod.com/postlnx.htm
 #
 # Le copyright et tous autres droits sont réservés par
 # le Dr. S. Parthasarathy (algolog CHEZ hd1 POINT vsnl POINT net POINT in)
 #--------------------------------------------------------


