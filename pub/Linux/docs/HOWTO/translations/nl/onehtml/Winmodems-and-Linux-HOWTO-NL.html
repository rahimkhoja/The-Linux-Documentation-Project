<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>De Winmodems-en-Linux HOWTO</TITLE>


</HEAD>
<BODY>
<H1>De Winmodems-en-Linux HOWTO</H1>

<H2>Alexandre J., alexandre12@mageos.com,<BR>
Vertaald door: Ellen Bokhorst, bokkie@nl.linux.org</H2>v1.2, 29 april 2001
<P><HR>
<EM>In dit document wordt een poging ondernomen gebruikers met een Winmodem
te helpen het onder Linux werkend te krijgen.</EM>
<HR>
<H2><A NAME="s1">1. Wat zijn Winmodems ?</A></H2>

<H2>1.1 Dit zijn modems...</H2>

<P>Een Winmodem wordt net als andere modems gebruikt voor het benaderen van
telefoonservices, zoals BBS, Internet, Voice, Fax, enz. Hij wordt aangesloten
op een telefoonlijn en het wordt gekenmerkt door zijn snelheid. Als je meer over
modems wilt leren, raad ik je de Modem-HOWTO aan.
<H2>1.2 ...zijn niet gelijk aan echte modems !</H2>

<P>Maar het zijn WINmodems. Dat wil zeggen dat ze voor de werking ervan Windows
nodig hebben. Waarom? Gewoonweg omdat ze dom zijn. Ze hebben speciale 
software nodig, om al hun taken te kunnen volbrengen. Wie software zegt, zegt
OS, en de drivers die met de modem worden meegeleverd zijn voor 99%,
exclusief voor het MS-Windows platform. Maar met de democratisering van
Linux, besloten een aantal fabrikanten, zoals LT en Motorola, een linux
driver voor hun modems te maken. Maar ze hebben de linux filosofie niet
begrepen: de drivers die ze leveren functioneren wel, maar ze behoren tot de
`Closed Source'. Ze zijn gratis, in de betekenis van geld, maar vallen niet
onder de GPL. Dat betekent dat de broncode niet beschikbaar is.
<P>Dus een aantal 'hackers' besloot een Open Source driver te schrijven, maar
ze weten niet zoveel over die modems, omdat de fabrikanten de specificaties
voor die modems niet vrij willen geven, dus bevinden de OpenSource drivers
zich vaak in de alpha of beta status.
<H2>1.3 Hoe weet ik of ik een Winmodem heb?</H2>

<P>
<UL>
<LI>1. Probeer de naam van de seri&euml;le poort waar je modem op is
aangesloten te achterhalen (bijvoorbeeld onder Windows of MSDOS: COM1 COM2, ...)
De naam van je modem is onder Linux /dev/ttySx, de x staat hier voor het
nummer van de seri&euml;le poort onder DOS - 1.
Voorbeeld: Onder DOS: COM1, onder Linux ttySx, met x=1-1, dus ttyS0
2e voorbeeld: Onder DOS: COM3, onder Linux ttyS2 enzovoort</LI>
<LI>2. Maak een symlink van /dev/ttySx naar /dev/modem, door het typen van
<HR>
<PRE>
rm -f /dev/modem
ln -s /dev/ttySx /dev/modem
</PRE>
<HR>
</LI>
<LI>3. Download en installeer het package minicom. Start dan 'minicom -s'.
Kies voor 'Serial Port Setup', typ 'A' voor het instellen van het
'Serial Device', verwijder de hele regel, en typ '/dev/modem'. Bevestig dit
dan met Enter. Typ Esc, en kies voor 'save setup as dfl, kies dan 'Exit'.
Wacht eventjes, typ dan 'AT' en als de modem met 'OK' antwoordt, dan heb je
GEEN Winmodem, dan heb je een standaardmodem...
Als de initialisatietijd te lang duurt, dan heb je een Winmodem. 
Gebruik dit document om te proberen het aan de gang te krijgen.
Log in als root.</LI>
<LI>4. Ga uit Minicom door het intikken van CTRL+A, dan X.</LI>
</UL>
<H2><A NAME="s2">2. ISA of PCI ?</A></H2>

<H2>2.1 PCI ?</H2>

<P>Ok, je hebt dus een Winmodem... Maar er zijn twee typen Winmodems: ISA en
PCI. Om 't nog iets moeilijker te maken, de twee interfaces zijn nogal
verschillend. Dus zullen we eerst moeten testen of je een PCI of ISA-modem
hebt. Ten eerste moet je je kernel configureren. Tijdens de make *config,
moet je op de volgende vragen 'yes' antwoorden:
<P>
<UL>
<LI>In Loadable module support:
'Enable loadable module support (CONFIG_MODULES)', en
'Set version information on all modules for symbols (CONFIG_MODVERSIONS)' 
(je moet het modutils packages hebben ge&iuml;nstalleerd; Zie de Kerneld-HOWTO)</LI>
<LI>In General setup: 
`PCI support' (CONFIG_PCI)
Kies `Any' in `PCI Access Mode' (CONFIG_PCI_GOBIOS)
`PCI quirks' (CONFIG_PCI_QUIRKS)
`Backward compatible /proc/pci' (CONFIG_PCI_OLD_PROC)</LI>
<LI>Als je PCI Device Name Database kunt configureren (wellicht met een
2.4+ kernel), dan kun je hier Y antwoorden, dit maakt het /proc/pci
bestand eenvoudiger te begrijpen (CONFIG_PCI_NAMES).</LI>
<LI>In Filesystems
`/proc filesystem support' (CONFIG_PROC_FS)</LI>
</UL>
<P>Als je je kernel nooit eerder opnieuw hebt gecompileerd, zal de kernel
van je distributie dit wellicht allemaal al bevatten. Lees de Kernel-HOWTO
als je het opnieuw wilt compileren en dit nog nooit hebt gedaan.
<P>We gaan er nu vanuit dat je nieuwe kernel is ge&iuml;nstalleerd.
<P>Geef nu de opdracht `cat /proc/pci'. Als je de naam van je modem in de
regels geretourneerd door het commando ziet, dan heb je een PCI-Winmodem.
Ga naar 'Het installeren van de driver'
<H2>2.2 of ISA ?</H2>

<P>Als je het niet kunt vinden, heb je wellicht een ISA-modem. Hoe weet je dit
zeker ?
<P>Ondersteuning van ISA is niet in de kernel aanwezig (UPDATED: wanneer
je een 2.4.x kernel hebt, kan de kernel het automatisch voor je doen. 
Sla in dat geval deze sectie over en lees de volgende).
Je kunt dit doen met software van derden, genaamd isapnp.
Eerst moet je er zeker van zijn dat je dit package hebt
ge&iuml;nstalleerd. Als je het niet hebt, moet je het package
isapnptools downloaden en installeren.
<P>Zodra isapnptools is ge&iuml;nstalleerd, starten we een speciaal
programma op - pnpdump - waarmee je computer wordt ge&iuml;nspecteerd op
ISA-devices. Het probeert dan de gebruikte bronnen door de devices te
raden en drukt deze af naar het bestand /etc/isapnp.conf. 
Vervolgens wijzig je dit bestand en start je een ander programma op,
isapnp, wat het isapnp.conf bestand inleest en je devices automatisch
configureert.
<P> Eh ? Het maakt veel lawaai ? Volg dan deze stappen: 
<P>
<UL>
<LI>1. Start `pnpdump > /etc/isapnp.conf'.</LI>
<LI>2. Wijzig het met je favoriete teksteditor</LI>
<LI>3. Zoek naar de sectie waarin je modem wordt beschreven.</LI>
<LI>4. Debecommitarieer een aantal regels in het bestand
(Verwijder het #-teken aan het begin van de regel. Je hebt nodig:
1 regel '(IO 0 ...)'<BR>
1 regel '(INT 0 ...)'<BR>
1 regel '(DMA 0 ...)'<BR>
1 regel '(DMA 1 ...)'<BR>
1 regel '(IO 1...)'<BR></LI>
<LI>5. Verwijder in alle IO regels de '(CHECK)' </LI>
<LI>6. Start 'isapnp <CODE>/etc/isapnp.conf</CODE> op. 
Als je foutmeldingen krijgt, wijzig je het bestand isapnp.conf
en probeer je wat parameters te veranderen. Als je geen foutmeldingen krijgt,
wijzig je isapnp.conf en haal je in de sectie van je modem het
commentaarteken weg voor de regel '(ACT Y)'. Start 'isapnp /etc/isapnp.conf'
dan weer op. Het moet antwoorden met ''Naam van je modem Enabled OK''</LI>
<LI>7. Voeg <CODE>isapnp /etc/isapnp.conf</CODE> toe aan 
/etc/rc.d/rc.local, door het typen van:

<BLOCKQUOTE><CODE>
<PRE>
 'echo "isapnp /etc/isapnp.conf" >> /etc/rc.d/rc.local'. 
</PRE>
</CODE></BLOCKQUOTE>


Het is handig voor het automatisch configureren bij het iedere keer opstarten.</LI>
</UL>
<P>Mocht dit van hulp zijn, dan is hier een uittreksel van mijn 
/etc/isapnp.conf bestand. 
(Ik heb commentaar in dit bestand geplaatst en het oorspronkelijke 
commentaar laten voorafgaan door ##):
<P>
<HR>
<PRE>

# Snip details ...
## (DEBUG)
(READPORT 0x0203)
(ISOLATE PRESERVE)
(IDENTIFY *)
(VERBOSITY 2)
(CONFLICT (IO FATAL)(IRQ FATAL)(DMA FATAL)(MEM FATAL)) # or WARNING

# Identificatie van mijn modemkaart

## Card 1: (serial identifier e2 00 00 01 00 05 50 c3 1e)
## Vendor Id GVC5005, Serial Number 256, checksum 0xE2.
## Version 1.0, Vendor version 0.1
## ANSI string -->LT Win Modem&lt;--
##
## Logical device id HSM0140
##     Device support I/O range check register
#

# We willen de GVC5005/256 kaart configureren

(CONFIGURE GVC5005/256 (LD 0

# I/O Base address 0x03f8, with a range of 8
(IO 0 (SIZE 8) (BASE 0x03f8) )
# IRQ 4
(INT 0 (IRQ 4 (MODE +E)))
# DMA 5
(DMA 0 (CHANNEL 5))
# DMA 7
(DMA 1 (CHANNEL 7))
# I/O Base Address 2  0x0100, range 8
(IO 1 (SIZE 8) (BASE 0x0100) )
# Name of the card
 (NAME "GVC5005/256[0]{LT Win Modem        }")
# Activeer het
(ACT Y)
# Einde configuratie
))

######## De parameters voor mijn andere ISA-devices ##############
 
## Retourneert alle kaarten terug naar de "Wait for Key" status
(WAITFORKEY)
</PRE>
<HR>
<H2>2.3 ISA en 2.4 kernels</H2>

<P>Als je een 2.4 kernel hebt (start 'uname -r' voor het achterhalen van
de kernelversie), hoef je deze lastige op tekstbestand gebaseerde en
softwarepakket van derde installatie niet uit te voeren, aangezien de
kernelserie 2.4 een vergelijkbare methode introduceert voor PCI, en hiermee
het isapnptools package verouderd is. Voor het kunnen benutten van deze
mogelijkheid, moet je 'Y' of 'M' antwoorden op de 'Plug and Play support'
(CONFIG_PNP) en 'ISA Plug and Play support' (CONFIG_ISAPNP) tijdens het
configureren van de kernel. Ook hier je kernel opnieuw compileren en
installeren. Als je 'M' antwoordde op ISA Plug-and-Play support, dan voer
je tevens een 'modprobe isapnp' uit. Je moet hiervoor een driver hebben
die compliant is met deze nieuwe device toegangsmethode (bv. de
ltmodem 5.78, lees de volgende sectie).
<H2><A NAME="s3">3. Installeren van een modemdriver</A></H2>

<P>Je hoeft deze sectie niet helemaal door te lezen; lees gewoon dat
gedeelte dat met je modem overeenkomt. Het beschrijft thans slechts hoe
je een LT-Modem installeert met behulp van de Lucent en OpenSource driver.
Als je een andere Winmodem-driver hebt geschreven of gebruikt, Open of
Closed Source, kun je me mailen
(alexandre12@mageos.com), en zal ik het in deze sectie opnemen.
<H2>3.1 ltmodem 5.78</H2>

<P>URL: http://www.tux.org/pub/dclug/marvin/ltmodem-5.78e.tar.gz
<P>Auteur: Lucent
<P>Licentie: Non-GPL
<P>Ondersteunt: ISA/PCI modem, met een Lucent chipset (Mars family)
<P>Mogelijkheden: Kernel module; simuleer een seri&euml;le poort. Doet PPP, 
<P>Fax en Voice
<P>Huidige versie: 5.78e
<P>Documentatie: README-1ST
<P>Benodigd: 2.2.x or 2.4.x; ISA PNP Support; Loadable module support; 
C Compiler
<P>Hoe het te gebruiken: Lees README-1ST. Het is zeer duidelijk.
<P>Problems: 
<P>
<UL>
<LI>Unresolved symbols: xxx_isapnp_xxxx: start modprobe isapnp.</LI>
<LI>Device or resource busy: je modem is niet compliant met de driver</LI>
</UL>

Opmerkingen: Lucent probeer deze keer problemen met de kernelversie en
distributie te voorkomen door in de source van een aantal elementen te voorzien.
<H2>3.2 De LT WinModem (van Lucent) 5.68 (VEROUDERD)</H2>

<P>URL: http://www.linmodems.org/linux568.zip
Auteur: Lucent Technologies
Licentie: Non-GPL
Ondersteunt: ISA/PCI modems, met een Lucent chipset (Mars familie)
Features: Kernel module; simuleert een seri&euml;le poort. 
Doet PPP, Fax en Voice
Huidige versie (zover ik weet): 5.68
Documentatie: README
Benodigd: Een 2.2.12 of hogere RedHat kernel; laadbare module
ondersteuning
Gebruik: Unzip het package ('unzip linux568.zip'), en start ./ltinst. 
Dat is alles !
<P>Problemen: 
<P>
<UL>
<LI>'insmod: ltmodem: Unresolved symbol(s) *****': 
Je hebt geen kernel geschikt met ltmodem.
Haal de 2.2.12 kernel op vanaf ftp.kernel.org, compileer en installeer
het.</LI>
<LI>'Warning: kernel version mismatch...": Dit komt doordat je de
2.2.12-20 kernel niet hebt. Het is slechts een waarschuwing en het
betekent niet dat het modem niet zal werken.</LI>
<LI>`ltmodem: init_module: device or resource busy': </LI>
<LI>Je hebt geen lt modem of daaraan verwant ge&iuml;nstalleerd</LI>
<LI>Als je een ISA-modem hebt, is het niet door isapnp
geconfigureerd</LI>
<LI>Als je een PCI-modem hebt, werd de PCI-ondersteuning niet in de
kernel geconfigureerd.</LI>
</UL>
<H2>3.3 Het LTMODEM programma (OpenSource driver)</H2>

<P>URL: http://www.close.u-net.com
Auteurs: Richard Close en Pavel Machek
License: GPL
Ondersteunt: ISA/PCI modems, met Lucent chipsets (Mars familie)
Feature: User-space driver; doet Voice calls; geen PPP (V90)
Huidige versie (zover ik weet): 0.99
Documentatie: README
Benodigdheden: GNU C Compiler, automake
Hoe het te gebruiken:
<UL>
<LI>PCI: make ; make install - 
Gebruik dan het programma `ltmodem' om met de modem te communiceren</LI>
<LI>ISA: (lees het bestand README.ISA) mv Makefile Makefile.PCI ; mv Makefile.ISA Makefile ; wijzig config.h en vul de juiste waarden voor je modem in
(I/O Address, DMA, IRQ) ; make ; make install - 
Gebruik dan het programma `ltmodem' om met het modem te
communiceren.</LI>
</UL>
<P>Problemen: "Sorry, ik kan geen modem vinden...": 
<UL>
<LI>Je hebt geen LT modem</LI>
<LI>Je hebt een ISA-modem die niet door isapnp is geconfigureerd</LI>
<LI>Je hebt een ISA-modem geconfigureerd; maar ltmodem werd niet als ISA
gecompileerd</LI>
<LI>Je hebt een PCI-modem zonder PCI-ondersteuning in de kernel opgenomen</LI>
<LI>Je hebt een PCI-modem en een juiste kernel, maar ltmodem werd niet
als PCI gecompileerd</LI>
</UL>
<H2><A NAME="s4">4. Het einde...</A></H2>

<H2>4.1 Licentie, Copyright</H2>

<P>Copyright (C) 2000, 2001  Alexandre J.
Dit programma is vrije software; je kunt het redistribueren en/of wijzigen
onder de voorwaarden van de GNU General Public Licentie zoals gepubliceerd
door de Free Software Foundation; &oacute;f versie 2 &oacute;f (naar
keuze) enige latere versie.
<P>Dit programma werd gedistribueerd in de hoop dat het van nut zou zijn,
maar ZONDER ENIGE GARANTIE; zelfs zonder de impliciete garantie van
VERKOOPBAARHEID of GESCHIKTHEID VOOR EEN BEPAALD DOEL. Zie de GNU General
Public Licentie voor meer details.
<P>Je zou samen met dit programma een kopie van de GNU General Public Licentie
moeten hebben ontvangen; als dit niet zo is, schrijf dan naar de Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
<H2>4.2 Contact</H2>

<P>Als je idee&euml;n hebt over dit document, email me dan alsjeblieft:
alexandre12@mageos.com.
<H2>4.3 Bronnen</H2>

<P>
<UL>
<LI>De homepage van het Linmodems project: http://www.linmodems.org</LI>
<LI>De homepage van het LTModem project: http://www.close.u-net.com</LI>
<LI>De homepage van Lucent Technologies: http://www.lucent.com</LI>
<LI>De Linux Kernel: http://www.kernel.org</LI>
<LI>De homepage van isapnptools: http://www.roestock.demon.co.uk/isapnptools</LI>
<LI>De homepage van het LDP (voor het ophalen van HOWTO's):
http://www.redhat.com/mirrors/LDP</LI>
</UL>
</BODY>
</HTML>
