<HTML
><HEAD
><TITLE
>Mozilla Optimalisatie Mini-HOWTO</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"/></HEAD
><BODY
CLASS="article"
BACKGROUND="../IMAGES/back.gif"
LINK="#000099"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="title"
><A
NAME="AEN2"
></A
>Mozilla Optimalisatie Mini-HOWTO</H1
><H3
CLASS="author"
><A
NAME="AEN4"
>Salvador J. Peralta</A
></H3
><DIV
CLASS="affiliation"
><DIV
CLASS="address"
><P
CLASS="address"
><br/>
<TT
CLASS="email"
>&lt;<A
HREF="mailto:speralta at willamette dot edu"
>speralta at willamette dot edu</A
>&gt;</TT
><br/>
	</P
></DIV
></DIV
><H3
CLASS="author"
><A
NAME="AEN11"
>Vertaald door: Ellen Bokhorst</A
></H3
><DIV
CLASS="affiliation"
><DIV
CLASS="address"
><P
CLASS="address"
><br/>
<TT
CLASS="email"
>&lt;<A
HREF="mailto:bokkie at nl dot linux dot org"
>bokkie at nl dot linux dot org</A
>&gt;</TT
><br/>
</P
></DIV
></DIV
><P
CLASS="pubdate"
>januari 2003<BR/></P
><DIV
CLASS="revhistory"
><TABLE
WIDTH="100%"
BORDER="0"
><TR
><TH
ALIGN="LEFT"
VALIGN="TOP"
COLSPAN="3"
><B
>Wijzigingen</B
></TH
></TR
><TR
><TD
ALIGN="LEFT"
>Herziening 1.0</TD
><TD
ALIGN="LEFT"
>03-01-2003</TD
><TD
ALIGN="LEFT"
>Herzien door: SJP</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
>Initiële release, voorbeschouwd door de LDP</TD
></TR
></TABLE
></DIV
><DIV
><DIV
CLASS="abstract"
><A
NAME="AEN24"
></A
><P
></P
><P
>In dit document wordt besproken hoe de configuratie en
aanpassingen op broncodeniveau kunnen worden geoptimaliseerd om Mozilla
geschikter te maken als een primaire browser voor Linux en X Window. Het is
niet bedoeld als een leidraad voor het programmeren van Mozilla, noch is het
een handleiding in XUL.
</P
><P
>De technieken beschreven in dit document zijn geïmplementeerd
en getest in een kiosk-achtige publieke computeromgeving met client werkstations
waarop Redhat Linux met XFree86 draait.
</P
><P
></P
></DIV
></DIV
><HR/></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Inhoudsopgave</B
></DT
><DT
><A
HREF="#copyleft"
>Copyright</A
></DT
><DT
><A
HREF="#Introduction"
>Introductie</A
></DT
><DT
><A
HREF="#UsetheSource"
>Haal de broncode op</A
></DT
><DT
><A
HREF="#patch"
>Patch de broncode</A
></DT
><DT
><A
HREF="#configure"
>Configureer de broncode</A
></DT
><DT
><A
HREF="#compile"
>Compileer de broncode</A
></DT
><DT
><A
HREF="#postinstall"
>Configuratie na de installatie</A
></DT
></DL
></DIV
><DIV
CLASS="sect1"
><H2
CLASS="sect1"
><A
NAME="copyleft"
></A
>Copyright</H2
><P
>&#13;Copyright © 2002  Salvador Peralta
</P
><P
>&#13;      Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.2 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A copy of the license can be found at the <A
HREF="http://www.gnu.org/copyleft/fdl.html"
TARGET="_top"
>GNU web site</A
>.
</P
></DIV
><DIV
CLASS="sect1"
><HR/><H2
CLASS="sect1"
><A
NAME="Introduction"
></A
>Introductie</H2
><P
>&#13;Mozilla is een Open Source, cross-platform, browser en grafische 
toepassingsomgeving. Op veel op Linux gebaseerde desktops groeit het uit tot
een veelbetekenende component vanwege zijn stabiliteit, robuuste set 
met features, grote ontwikkelaarsbasis, en configuratiegemak. 
Deze mini HOWTO gaat over het patchen en configureren van de broncode
van Mozilla om het beter te optimaliseren voor de Linux desktopomgevingen,
en het is bedoeld te dienen als een algemene instructieset voor de 
Linux gemeenschap over hoe Mozilla te configureren en compileren.
</P
><P
>&#13;De meest recente versie van deze Mini HOWTO kan in HTML formaat worden
verkregen vanaf <A
HREF="http://www.willamette.edu/~speralta/tldp/mozilla"
TARGET="_top"
>www.willamette.edu/~speralta/tldp/mozilla</A
>.
</P
></DIV
><DIV
CLASS="sect1"
><HR/><H2
CLASS="sect1"
><A
NAME="UsetheSource"
></A
>Haal de broncode op</H2
><P
>Er zijn voors en tegens bij het zelf compileren van Mozilla.
De grootste keerzijde is dat de broncodeversie gecomprimeerd, in de meeste
uitgaven een bestand is van meer dan 30 MB wat ongeveer driemaal groter is
dan de binaire distributie. Een tweede nadeel is dat het compileren van
Mozilla op een redelijk nieuwe machine zoals mijn 1.6 ghz Pentium 4 met
256MB geheugen, afhankelijk van eventuele andere jobs die op het systeem
draaien, ergens tussen de anderhalf uur tot vier uur kan duren. Op een
oudere machine, kan de compilatie van Mozilla vierentwintig of langer duren.
Het grootste voordeel is dat er een groot aantal compile-time opties zijn
en dat er patches kunnen worden toegepast die de performance en featureset
van de browser dramatisch zal verbeteren. Deze patches zijn gewoonlijk
nodig als je van plan bent Mozilla in een productie-omgeving uit te voeren.
</P
><P
>&#13;Sla alsjeblieft de volgende paar secties over en kijk naar de
<A
HREF="#postinstall"
>paragraaf <I
>Configuratie na de installatie</I
></A
>,Configuratie na de installatie als je niet bent
geïnteresseerd in aanpassingen van de Mozilla browser op broncodeniveau.
</P
><P
>&#13;Op het moment dat dit document werd geschreven, was de laatste versie
van de Mozilla broncode versie 1.2.1, welk via ftp kan worden opgehaald vanuit
<A
HREF="ftp://ftp.mozilla.org/pub/mozilla/releases/mozilla1.2.1"
TARGET="_top"
>ftp.mozilla.org/pub/mozilla/releases/mozilla1.2.1</A
>.  
De andere stabiele release, 1.0.1, kan via ftp worden opgehaald vanuit
<A
HREF="ftp://ftp.mozilla.org/pub/mozilla/releases/mozilla1.0.1"
TARGET="_top"
>ftp.mozilla.org/pub/mozilla/releases/mozilla1.0.1</A
>.  
</P
><P
>&#13;Bekijk voor een CVS-checkout alsjeblieft de documentatie op de website van
<A
HREF="http://mozilla.org"
TARGET="_top"
>Mozilla</A
>.
</P
></DIV
><DIV
CLASS="sect1"
><HR/><H2
CLASS="sect1"
><A
NAME="patch"
></A
>Patch de broncode</H2
><P
>&#13;Een niet gepatchte Mozilla is geen al te goede burger. Je kunt bijvoorbeeld als
opdrachtregeloptie geen X en Y geometrieposities specificeren. Dit is op een
typische eindgebruikersdesktop niet zo'n probleem, maar in een bedrijfs- of
publieke computeromgeving is het een killer.
Ter correctie moeten we een patch toepassen op de C++ broncode in
<TT
CLASS="filename"
>embedding/components/windowwatcher/src/nsWindowWatcher.cpp
</TT
>. De eerste stap bestaat uit het ophalen en toepassen van de
<A
HREF="http://www.willamette.edu/~speralta/mozilla.kludge.txt"
TARGET="_top"
>patch</A
> geschreven door Robert Riches.  
Deze patch is getest op de Mozilla versies 1.0 tot en met 1.2.1.
</P
><P
>&#13;Plak het voor het toepassen van de patch simpelweg in 
<TT
CLASS="filename"
>embedding/components/windowwatcher/src/nsWindowWatcher.cpp</TT
>, in je Mozilla broncodestructuur. De notatie maakt gebruik van
<SPAN
CLASS="QUOTE"
>"+"</SPAN
> symbolen om aan te duiden dat de code moet worden
ingevoegd. Deze symbolen moeten worden verwijderd voordat het
tekstbestand <TT
CLASS="filename"
>nsWindowWatcher.cpp</TT
> wordt opgeslagen.
</P
><P
>&#13;Stel voor het gebruiken van de patch een omgevingsvariabele, genaamd
<TT
CLASS="envar"
>MOZILLA_SCREEN_POS</TT
> in op de juiste coördinaten. 
Typ onder Bash bijvoorbeeld <B
CLASS="command"
>export MOZILLA_SCREEN_POS='screenx=1,screeny=1'</B
> wat de linkerbovenhoek van je browser zal instellen op de
linkerbovenhoek van je scherm.
</P
></DIV
><DIV
CLASS="sect1"
><HR/><H2
CLASS="sect1"
><A
NAME="configure"
></A
>Configureer de broncode</H2
><P
>&#13;Een ander probleem bij het gebruik van Mozilla in een persoonlijke
of productie-omgeving is dat het code bevat die een homepage zal
overschrijven die je op geregelde basis instelde,
of wanneer een nieuwe release van het product wordt gedistribueerd.
</P
><P
>Aangezien deze informatie in een configuratiebestand is opgeslagen,
is het 't eenvoudigst zonder de browser in de weg te zitten het 
configuratiebestand te wijzigen te wijzen op standaard 
homepage-instellingen naar één die consistenter is met
de omgeving die je gebruikt.
</P
><P
>&#13;Mozilla bewaart de meeste compile-time configuratie op in bestanden met
een <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>.properties</I
></SPAN
> extensie.  Je kunt deze bestanden
gebruiken om tekst te specificeren in message dialogues, fonts, en andere
opties. 
In dit geval, in de veronderstelling dat je locale en taalinstellingen
<TT
CLASS="envar"
>en-US</TT
> zijn, is het <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>.property</I
></SPAN
> bestand
dat je nodig hebt <TT
CLASS="filename"
>region.properties</TT
> welke is te
vinden in de directory 
<TT
CLASS="filename"
>xpfe/browser/resources/locale/en-US/</TT
>.
</P
><P
>&#13;De wijzigingen die je aan dit bestand moet aanbrengen, zijn tamelijk
recht-toe-recht-aan. Als algemene regel vervang ik het waarde deel van
het naam/waarde paar naar één van mijzelf bij elke instance
een keuze maken waar het woord <SPAN
CLASS="QUOTE"
>"homepage"</SPAN
> in de configuratie
wordt vermeld.
</P
><TABLE
BORDER="1"
BGCOLOR="#d3dce3"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="screen"
>&#13;# navigator.properties
homePageDefault=http://jeurl.com
shopKeyword=keyword:shop [Product]
quoteKeyword=keyword:quote [Symbool hier invoeren]
localKeyword=keyword:zip [Je zip code]
keywordList=http://home.netscape.com/escapes/keywords
webmailKeyword=http://webmail.netscape.com
careerKeyword=keyword:[Je stad] careers
fallbackDefaultSearchURL=http://search.netscape.com/cgi-bin/search?charset=UTF-8&amp;search=
otherSearchURL=http://home.netscape.com/bookmark/6_0/tsearch.html
#
# all.js
#
browser.startup.homepage=http://jeurl.com
browser.throbber.url=http://jeurl.com
browser.search.defaulturl=http://search.netscape.com/cgi-bin/search?search=

wallet.Server=http://www.mozilla.org/wallet/tables/
wallet.Samples=http://www.mozilla.org/wallet/samples/

#config.js
#
startup.homepage_override_url=http://jeurl.com
</PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="sect1"
><HR/><H2
CLASS="sect1"
><A
NAME="compile"
></A
>Compileer de broncode</H2
><P
>Typ <B
CLASS="command"
>.configure</B
> vanuit de rootdirectory van de
Mozilla broncodestructuur om Mozilla's compile-time opties te configureren.
Typ <B
CLASS="command"
>./configure --help</B
> voor een volledige lijst met
compile-time opties. 
Wat je nog kunt verifiëren voordat je een compilatie voor een
productie-omgeving uitvoert is dat de omgevingvoorkeuren (mail vs. no mail,
calendar, ldap, enz.) zijn opgenomen en controleer of het crypto package
is geactiveerd.
</P
><P
>&#13;Ter vereenvoudiging, gebruik ik gewoonlijk een simpel build script zoals
het volgende om Mozilla te configureren.
</P
><TABLE
BORDER="1"
BGCOLOR="#d3dce3"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="screen"
>&#13;#!/bin/sh

MOZILLA_OFFICIAL=1
export MOZILLA_OFFICIAL
BUILD_OFFICIAL=1
export BUILD_OFFICIAL

./configure --with-x --disable-calendar --enable-crypto --with-system-nspr 
--disable-debug --enable-extensions --enable-optimize
--without-system-zlib --without-system-jpeg --without-system-png 
--without-system-mng
</PRE
></TD
></TR
></TABLE
><P
>Zodra je de patches hebt toegepast, configuratiebestanden hebt 
aangepast, en opties hebt ingesteld, bouw je Mozilla simpelweg met
<SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>gmake</I
></SPAN
> door het typen van <B
CLASS="command"
>./gmake</B
> in de
rootdirectory van je broncodestructuur, en maakt dan een tarball door het
typen van <B
CLASS="command"
>gmake</B
> in de directory 
<TT
CLASS="filename"
>xpinstall/packager</TT
>.  
De tarball komt terecht in de subdirectory dist direct onder de rootdirectory
van je Mozilla broncodestructuur.  
Verplaats dat package gewoon naar 
<TT
CLASS="filename"
>/usr/local</TT
>, pak het uit, voer het
eenmaal uit vanaf de opdrachtregel als de gebruiker die het package
bouwde (de opdracht is <B
CLASS="command"
>/usr/local/mozilla/mozilla</B
>), 
en je bent bijna klaar om te gaan browsen.
</P
></DIV
><DIV
CLASS="sect1"
><HR/><H2
CLASS="sect1"
><A
NAME="postinstall"
></A
>Configuratie na de installatie</H2
><P
>&#13;Er zijn na de installatie van de browser verscheidene configuratiekeuzes 
te maken. Je kunt plugins toevoegen voor gebruikelijke webtechnologiën,
zoals Java (<A
HREF="http://java.sun.com"
TARGET="_top"
>java.sun.com</A
>), PDF printing (<A
HREF="www.adobe.com"
TARGET="_top"
>www.adobe.com</A
>), en Flash animaties 
(<A
HREF="http://www.macromedia.com/software/flash"
TARGET="_top"
>www.macromedia.com/software/flash</A
>) en iets minder bekende, maar wel gave plug-ins, zoals
(<A
HREF="http://enigmail.mozdev.org"
TARGET="_top"
>enigmail.mozdev.org</A
>).
</P
><P
>&#13;Kopieer voor het installeren van een plug-in de plug-in uit de broncodetoepassing (b.v. Acrobat5) naar de directory 
<TT
CLASS="filename"
>/plugins</TT
> in Mozilla, of maak een
symbolische link aan van de plug-in naar de plug-ins directory in de
binaire structuur van Mozilla. Om bijvoorbeeld een Mozilla plug-in voor
Adobe Acrobat 5 aan te maken met behulp van een symbolische link, typ je
simpelweg <B
CLASS="command"
>ln -s  /pad/naar/Acrobat5/Browsers/intellinux/nppdf.so /usr/local/mozilla/plugins/</B
>.  
Typ op vergelijkbare wijze 
<B
CLASS="command"
>ln -s /pad/naar/j2re1.4.0_02/plugin/i386/ns610/libjavaplugin_oji.so /usr/local/mozilla/plugins/</B
> om een plug-in aan te maken van je
Java runtime omgeving.  
Het is aan te bevelen dat je Sun's JDK 1.4.1 met Mozilla 1.0.1 en daarboven
gebruikt. Er zijn incompatibiliteiten bekend met Mozilla en eerdere versies
van Java.
</P
><P
>&#13;Kijk op <A
HREF="http://mozdev.org"
TARGET="_top"
>mozdev.org</A
>
om aan Mozilla project plug-ins, zoals Enigmail, te komen,  die in een 
interface voorziet voor het versleutelen en ontsleutelen van mail, of voor
Protozilla, die voorziet in volledige parametrisatie (waaronder ondersteuning
voor meerdere protocol en programmeertalen). 
</P
></DIV
></DIV
></BODY
></HTML
>