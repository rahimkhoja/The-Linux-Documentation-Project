<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>IPMasquerading+Napster mini-HOWTO</TITLE>


</HEAD>
<BODY>
<H1>IPMasquerading+Napster mini-HOWTO</H1>

<H2>John E. Danner<BR>
Vertaald door: Ellen Bokhorst</H2>v1.6, 11 april 2000
<P><HR>
<EM>In deze mini-HOWTO wordt een manier gepresenteerd om het gebruikers
mogelijk te maken achter een IPMasq'd Napster te gebruiken.
Kijk voor meer informatie over Napster alsjeblieft op hun website:
<A HREF="http://www.napster.com/">Napster Homepage</A></EM>
<HR>
<H2><A NAME="s1">1. DISCLAIMER</A></H2>

<P>Om Napster correct te kunnen laten werken, moet je een opening in
het IP Masq'd systeem plaatsen. Hieraan inherent worden potenti&euml;le
beveiligingproblemen gepresenteerd. Helaas kan ik geen verantwoordelijkheid
voor deze hack accepteren. Dus als je dit doet, en je brandt jezelf hierdoor...
dan is dit niet mijn schuld. 
Geweldig...laten we er nu mee beginnen.
<H2><A NAME="s2">2. INTRODUCTIE</A></H2>

<P>Na het voor mijn kamergenoten en mijzelf instellen van een netwerk, onstond
het probleem dat we niet in staat waren Napster te gebruiken omdat ik
gebruik had gemaakt van IPMasquerading. Dus stak ik er wat tijd in en
kwam met de hierin beschreven oplossing voor het probleem. Ik hoop dat het
voor jou net zo uitpakt als voor mij...maar ik kan je niets beloven.
<H2><A NAME="s3">3. VOOR JE BEGINT</A></H2>

<P>Ik heb deze oplossing met de volgende variabelen getest:
<P>
<OL>
<LI>Napster v2.0 Beta 5a (voor Windows), breng een bezoek aan 
<A HREF="http://www.napster.com/">Napster Homepage</A>
om er zeker van te zijn dat je de nieuwste versie hebt.</LI>
<LI>Een extern IP naar het internet.</LI>
<LI>Thans 6 systemen achter de IPMasq'd machine, 4 die Napster gebruiken.</LI>
<LI>Linux kernel versie 2.2.12-20 (RedHat v6.1 Distributie)</LI>
<LI>IPMASQADM utility versie 0.42, haal het op vanaf
<A HREF="http://juanjox.kernelnotes.org/">http://juanjox.kernelnotes.org/</A></LI>
</OL>
<H2><A NAME="s4">4. PROCEDURE</A></H2>

<P>Zorg er als eerste voor dat je de versie (of nieuwere) hebt die 
in de vorige sectie werd genoemd. Zorg ook dat het correct is
ge&iuml;nstalleerd.
<P>
<OL>
<LI>Installeer Napster op de Windows client PC's</LI>
<LI>Na de installatie en gebruikerssetup van Napster, begint deze versie
met "Finding Acceptable Local Data Port". Na een korte tijd volgt een
foutmelding.
Opmerking: Selecteer via het file menu 'Properties' als je napster v2.0 beta
5a reeds hebt ge&iuml;nstalleerd.</LI>
<LI>Selecteer hier de tweede optie "I am not behind a firewall or I 
configured my firewall - Use TCP port:"</LI>
<LI>Vul een uniek nummer in. Iedere computer waarop Napster zal worden
uitgevoerd heeft een andere poort nodig. Het kan wellicht makkelijker zijn
om het laatste nummer van het IP-adres te gebruiken.
Bijvoorbeeld: als het IP van de computer 192.168.1.2 is, dan zou 6702 het
eenvoudigste te onthouden zijn.
Opmerking: wees er zeker van dat je geen poorten uitkiest voor services
die reeds draaien (d.w.z. 21, 110, enc, zie /etc/services voor een lijst).</LI>
<LI>Herhaal de stappen 1 - 4 voor alle systemen waarop gebruik zal worden
gemaakt van Napster.</LI>
<LI>Log nu in op je IpMasq'd systeem en pas een opstartbestand naar
keuze aan (ik koos voor /etc/rc.d/rc.local).
<PRE>
De volgende regels geven de connectie door aan de Napster clients draaiend
op de hosts achter je IPMasq'd systeem.
(voeg ze toe aan het opstartbestand - 
je hebt per host die gebruik maakt van Napster &eacute;&eacute;n opdrachtregel
nodig)

/usr/sbin/ipmasqadm portfw -a -P tcp -L xxx.xxx.xxx.xxx 6702 -R 192.168.1.2 6702
/usr/sbin/ipmasqadm portfw -a -P tcp -L xxx.xxx.xxx.xxx 6703 -R 192.168.1.3 6703
/usr/sbin/ipmasqadm portfw -a -P tcp -L xxx.xxx.xxx.xxx 6704 -R 192.168.1.4 6704
/usr/sbin/ipmasqadm portfw -a -P tcp -L xxx.xxx.xxx.xxx 6705 -R 192.168.1.5 6705

Opmerking: XXX.XXX.XXX.XXX is het IP-adres van het Linux IPMasqing systeem 
(het Internet IP).
</PRE>

Opmerking: Zie de IPMASQ-HOWTO als je problemen ondervindt met IPMASQADM of IPMasquerading in
het algemeen. Dit document is er alleen om die mensen te helpen die hun
systeem al hebben geconfigureerd. De IPMASQ-HOWTO zal dieper ingaan op
port forwarding en IPMasq in het algemeen.</LI>
</OL>
<H2><A NAME="s5">5. DYNAMIC IP AREA (Dial-up of DHCP)</A></H2>

<P>Zie hier en de Procedure sectie als je IP-adres iedere keer wijzigt als je
een verbinding met het internet tot stand brengt.
<P>Met dank aan Peter Illmayer voor de volgende bijdrage:
(Dit werkt het beste voor degenen met dynamische IP's...)
<PRE>
------------------------------------------------------------
Onder debian maakte ik een forward bestand aan in /etc/ppp/ip-up.d en
plaatste hierin het volgende

#!/bin/sh
ppp_ip="`/sbin/ifconfig ppp0 | grep 'inet addr' | awk '{print $2}' | sed -e
's/.*://'`"
/usr/sbin/ipmasqadm portfw -f
/usr/sbin/ipmasqadm portfw -a -P tcp -L ${ppp_ip} 6702 -R 192.168.0.2 6702

Dit is in een 2.2.x kernel met ipmasqadm ge&iuml;nstalleerd met de van
toepassing zijnde kernelmodules ingecompileerd.
---------------------------------------------------------------
</PRE>

Charles J. Fisher wees me op een vergelijkbaar script dat kan worden
gebruikt als je gebruik maakt van DHCP. Voeg de volgende regels in
een script dat wordt uitgevoerd nadat je je IP-adres hebt verkregen.
<PRE>
net_ip="`ifconfig eth0 | awk '/inet/ {sub(/addr:/,"",$2); print $2}'`"
/usr/sbin/ipmasqadm portfw -f
/usr/sbin/ipmasqadm portfw -a -P tcp -L ${net_ip} 6702 -R 192.168.1.2 6702
</PRE>

Des te meer machines Napster achter je IPMasq'd machine gebruiken, des
te meer port forwards heb je nodig.
<H2><A NAME="s6">6. EINDPRODUCT</A></H2>

<P>Met dit systeem is het mogelijk Napster op juiste wijze achter een
IPMasq'd systeem te laten werken.
Hopelijk werkt het voor jou net zoals het dat voor mij deed!
Stuur opmerkingen/suggesties/flames alsjeblieft naar jed204@psu.edu.
<H2><A NAME="s7">7. HOWTO BEHEER</A></H2>

<P>Dit is de initi&euml;le versie van dit document. 
Zeer globaal opgezet. Als de interesse er is en er zijn zaken die zijn
gewijzigd, dan zal ook dit document worden gewijzigd. Als iemand anders
een oplossing heeft waarvan hij/zij denkt dat die beter is....laat me
dit dan in ieder geval weten alsjeblieft, we kunnen bespreken wat de
best mogelijke oplossing is.
<H2><A NAME="s8">8. Copyright en Licentie</A></H2>

<P>Copyright (c) 2000 door John E. Danner
<P>Kopieer en distribueer (verkoop het of geeft het weg) gerust dit document
in ieder gewenst formaat. Verzocht wordt correcties en/of opmerkingen
door te sturen naar de beheerder van het document. Je mag er een afgeleide
werk van maken en het distribueren op voorwaarde dat je:
<P>1.Je afgeleide werk (in het meest geschikte formaat, zoals sgml)
naar de LDP (Linux Documentatie Project) of iets dergelijks doorstuurt,
zodat het gepost kan worden naar het Internet. Als dit de LDP niet is,
laat de LDP dan weten waar het beschikbaar is.
<P>2.Licentieer het afgeleide werk met dezelfde licentie of gebruik GPL.
Voeg een copyrightmelding in en op z'n minst een verwijzing naar de
gebruikte licentie.
<P>3.Geef krediet aan de vorige auteurs en mensen die een belangrijke 
bijdrage hebben geleverd.
<P>Mocht je overwegen een afgeleid werk te maken anders dan een vertaalde
versie, dan wordt je verzocht je plannen met de huidige beheerder te
bespreken.
</BODY>
</HTML>
