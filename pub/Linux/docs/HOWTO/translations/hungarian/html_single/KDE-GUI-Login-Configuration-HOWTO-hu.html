<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">

 <TITLE>KDE grafikus bejelentkezés beállítása HOGYAN</TITLE>
</HEAD>
<BODY>
<H1>KDE grafikus bejelentkezés beállítása HOGYAN</H1>

<H2>John P. Meshkoff,II  
<A HREF="mailto:johnm@sivakalpa.org">johnm@sivakalpa.org</A></H2>v1.03 2003.04.13 ikon megjegyzés és kde 3.1 kézikönyv megjegyzés frissítése
 
<HR>
<EM>Ez a HOGYAN bemutatja a grafikus bejelentkezõ (GUI login) képernyõ beállítását.
A következõ témákat öleli fel:
Ablakkezelõ hozzáadása a lenyíló listához;
a felhasználó ikonjának engedélyezése a bejelentkezõ ablakban;
root hozzáférés szükségességének a beállítása a rendszer leállításához.</EM>
<HR>
<H2><A NAME="s1">1. Szerzõi jog</A></H2>


<P>Szerzõi jog (c) 2002 John Meshkoff </P>
<P>Ez a dokumentum szabadon másolható és terjeszthetõ bármilyen formátumban. Az esetleges módosításokat és/vagy megjegyzéseket kéretik a dokumentum karbantartójának továbbítani. Származtatott munka létrehozható és közzétehetõ belõle, a következõ feltételekkel:</P>
<P>1. Elküldöd a származtatott munkádat (megfelelõ fájlformátumban, például sgml) az LDP-nek (Linux Documentation Project) vagy ehhez hasonlónak az Interneten. Ha nem az LDP-nek küldöd, tudasd az LDP-vel, hol lesz elérhetõ a fájl.</P>
<P>2. A származtatott munkát azonos licensszel tedd közzé,  vagy használd a GPL-t. A szövegbe legyen szerzõi jogi nyilatkozat és legalább figyelmeztetés a licensz használatáról.</P>
<P>3. Tedd közzé az elõzõ szerzõk és fõbb közremûködõk névsorát.</P>
<P>Ha a fordításon kívül másfajta származtatott munkát is tervezel, kérlek, tudasd terveidet a dokumentum jelenlegi fenntartójával.</P>

<H2><A NAME="ss1.1">1.1 Magyar fordítás</A>
</H2>

<P> A magyar fordítást 
<A HREF="mailto:   Soponyai.Gyorgy[kukac]stud.u-szeged[pont]hu">Soponyai György</A> készítette (2004.06.14). A lektorálást 
<A HREF="mailto: dacas[kukac]freemail[pont]hu">Daczi László</A> végezte el (2004.06.17). A dokumentum legfrissebb változata megtalálható a 
<A HREF="http://tldp.fsf.hu/">Magyar Linux Dokumentációs Projekt</A> honlapján. A dokumentum fordítása a 
<A HREF="http://www.u-szeged.hu/">Szegedi Tudományegyetem</A> 
<A HREF="http://www.inf.u-szeged.hu/~havasi/opensource/">nyílt forráskódú szoftverfejlesztés speciálkollégium</A>ának segítségével valósult meg.</P>

<H2><A NAME="s2">2. Bevezetés</A></H2>

<P>Ez a leírás a RedHat 6.1 alapértelmezett KDE Workstation telepítésen alapul. Ha más disztribúciót, más RedHat verziót vagy eltérõ Workstation telepítõt használsz, szükséges lehet némi kutatómunka. Remélhetõleg ez a leírás segít majd a vizsgálódás elkezdésében. Ez a HOGYAN annak eredményeképpen született meg, hogy kíváncsi voltam, miként adható meg más ablakkezelõ (window manager) vagy asztali környezet (desktop environment) a grafikus bejelentkezõ ablak legördülõ listájában; a vizsgálódások további beállítási lehetõségeket tártak fel.</P>
<P>A saját vizsgálódásomat akkor kezdtem, amikor egy RedHat List-en találtam egy hivatkozást az <CODE>/etc/inittab</CODE> fájlról és a rendszerindításban betöltött szerepérõl. Az <CODE>/etc/inittab</CODE> fájlban a következõ bejegyzéseket találtam, amik az X Window rendszerindítási tulajdonságait határozzák meg az én disztribúcióm és verzióm esetén:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
# xdm runlevel 5-ben fut
# xdm most egy elkülönült alkalmazás
x:5:respawn:/etc/X11/prefdm -nodaemon
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>A prefdm fájl a következõ:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
#!/bin/sh

PATH=/sbin:/usr/sbin:/bin:/usr/bin:/usr/X11R6/bin

# A kedvenc X képernyõkezelõ futtatása
preferred=
if [ -f /etc/sysconfig/desktop ]; then
        if grep -q GNOME /etc/sysconfig/desktop 2>/dev/null; then
                preferred=gdm
        elif grep -q KDE /etc/sysconfig/desktop 2> /dev/null; then
                preferred=kdm
        elif grep -q AnotherLevel /etc/sysconfig/desktop 2> /dev/null; then
                preferred=xdm
        fi
fi
if [ -z ":$preferred" ]; then
        if which gdm >/dev/null 2>&amp;1; then
                preferred=gdm
        elif which kdm >/dev/null 2>&amp;1; then
                preferred=kdm
        elif which xdm >/dev/null 2>&amp;1; then
                preferred=xdm
        fi
fi
if [ -n "$preferred" ] &amp;&amp; which $preferred >/dev/null 2>&amp;1; then
        exec `which $preferred` $*
fi
exit 1  
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Nem szükséges a prefdm fájlt módosítanunk; azt határozza meg, melyik képernyõkezelõ (display manager) lesz a rendszerben az alapértelmezett, és melyik fusson a grafikus bejelentkezés alatt. A rendszerindítás során a prefdm megvizsgálja az <CODE>/etc/sysconfig/desktop</CODE> fájlt, és kiválasztja az ott meghatározott képernyõkezelõt; az én KDE Workstation telepítésem esetében ez a kdm (KDE Display Manager). Figyelembe véve, hogy a gdm (Gnome Display Manager) nincs telepítve a rendszeremben, az xdm (X Display Manager) az alapértelmezés az X Window rendszer részeként, amit nyilvánvalóan a RedHat régebbi verziói használtak.</P>

<H2><A NAME="s3">3. Képernyõkezelõ felvétele a legördülõ listába</A></H2>

<P>FIGYELMEZTETÉS: Ebben a HOGYANban kifejtett eljárások maguk után vonják a rendszerbeállító fájlok módosítását; ha nem vagy gyakorlott ilyen módosítások elvégzésében, nem árt némi óvatosság. Ezekben a fájlokban elkövetett hibák labilissé tehetik a rendszeredet akár annak összeomlását okozva. A HOGYAN eljárásai mind teszteltek, kipróbáltak és helyes használat esetén nem okozhatnak problémákat.</P>
<P>Ha KDE 2.2 -t vagy késõbbi verziót használsz és kényelmetlen a rendszerfájlok kézi szerkesztése, nyithatunk egy terminál ablakot (xterm vagy konsole) a felhasználói képernyõbõl (NEM a root képernyõbõl), majd írjuk be a következõket a belépéshez:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
su -c 'kcontrol'
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Írjuk be a root jelszót és hajtsuk végre a KDE Control Centerben a következõ módosításokat: menjünk az <EM>Applications ==> Login Manager</EM>-be. Válasszuk ki a megfelelõ beállító fület; itt könnyen beállítható a bejelentkezõ ablak összes tulajdonsága. A KDE korábbi verzióiban a kcontrol módosíthatta a kdmrc fájlt, de nem módosíthatta az xsession fájlt, amelyet ezek a verziók használnak. Olvasd el a megjegyzéseket a KDE 2.2 óta bevezetett módosításokról.</P>
<P>A beállítófájlok kézi szerkesztéséhez és mûködésük megértéséhez az alábbiak szerint haladjunk:</P>
<P>(Vigyázat: Néhány beállítófájl megváltozott az általam használt kdm verzió óta, különösen a  KDE > 2.0 óta:</P>
<P>Idézet a 
<A HREF="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/x11-wm.html">the FreeBSD  Handbook-X11</A>
leírásból:</P>
<P>"Megjegyzés:
A KDE 2.2 verzióban a következõ módosítások történtek: kdm most már saját konfigurációs fájljait használja. A részletekrõl lásd a KDE 2.2 dokumentációját.")</P>
<P>Megjegyzés:
A KDE 3.1 rendelkezik hozzáadott kdm dokumentációval, olvasd a 
<A HREF="http://docs.kde.org/en/3.1/kdebase/kdm/">The kdm Handbook</A> (Kdm kézikönyv) leírást.</P>
<P>Ezen új kézikönyv sok anyagot használ fel a régebbi verziókból; de leír új tulajdonságok is benne.</P>
<P>Ellenõrizzük a saját változatunk dokumentációját az érvényes beállítófájlok meghatározásához, ha kézzel módosítani akarjuk õket, vagy egyszerûen látni akarjuk mûködésüket.</P>
<P><EM>Ne</EM> használjunk <EM>szövegszerkesztõ</EM> (word-processor; ez képes a különbözõ betûkészletek kezelésére egy dokumentumon belül, és egyedi formátumban tárolja a dokumentumokat - a lektor) (például OpenOffice.org - a ford.) programot a rendszer beállítófájljainak szerkesztéséhez; ezek a programok speciális formázó karaktereket szúrnak be a fájlokba, amik elrontják azt. Használjunk "egyszerû" <EM>szerkesztõt</EM> (editor; ez sima szövegként kezeli a dokumentumokat, de szintaktikai kiemelés lehet benne - a lektor), különösen olyat, ami tudja kezelni a hosszú sorokat anélkül, hogy extra sorvége vagy soremelés karaktereket szúrna be a szerkesztett kódba. Ilyen alkalmas szerkesztõk a vim (a vi továbbfejlesztése), vi és az emacs (vagy a 
<A HREF="http://www.jedit.org">jEdit</A>, ez lin/win alatt is használható - a lektor).
Bár léteznek mások is, de Linux munkaállomások telepítésénél leggyakrabban ezek az alapértelmezettek; ezeknek mind megfelelõek számítógépes forráskódok írásához és szerkesztéséhez. További információkért lásd a bibliográfia fejezetet a HOGYAN végén.</P>
<P>FONTOS: Mielõtt módosítanánk <EM>bármilyen</EM> beállítófájlt, készítsünk másolatot az eredetirõl, így komoly hibák esetén visszaállíthatjuk azokat!</P>
<P>A következõkben az <CODE>/usr/share/config/kdmrc</CODE> fájlt fogjuk módosítani, ahol megadhatjuk a bejelentkezõ-képernyõ legördülõ listájában kiválasztható elemeket; valamint az <CODE>/etc/X11/xdm/Xsession</CODE> fájlt, ahol az elemekhez rendelt futtatható fájlok elérési útjai adhatók meg (ha eltérõ disztribúciót használsz, ezen fájlok elérési útjai különbözhetnek; egyszerûen írjuk be a "<CODE>locate kdmrc</CODE>" és "<CODE>locate Xsession</CODE>" sorokat a shell-be [azaz egy terminálablakba, mint például az <EM>xterm</EM> vagy a KDE <EM>konsole</EM> emulátorába], hogy megtaláljuk ezeket).</P>

<P>A kdmrc alapértelmezett sora a következõ:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
SessionTypes=kde;gnome;anotherlevel;default;failsafe; 
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Miután két új ablakkezelõ kiválasztó címkéjét, a windowmakert és a blackboxot hozzáadtuk, az adott sor a következõ lesz:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
SessionTypes=kde;gnome;windowmaker;blackbox;anotherlevel;default;failsafe; 
</PRE>
<HR>
</CODE></BLOCKQUOTE>

 
Figyeljük meg a pozíciót, hová írtam az új ablakkezelõk címkéit: minden bejegyzés ugyanolyan sorrendben jelenik meg a legördülõ listában, ahogy a SessionTypes listában szerepelnek. Ezután az <CODE>/etc/X11/xdm/Xsession</CODE> fájlban játszódik le az aktuális elemekhez hozzárendelt programok kiválasztása. Itt látható az xsession megfelelõ része az új bejegyzések hozzáadása elõtt:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
# most látjuk, ha az xdm/gdm/kdm egy sajátos környezetet kér
#
case $# in
1)
    case $1 in
    failsafe)
        exec xterm -geometry 80x24-0-0
        ;;
    gnome)
        exec gnome-session
        ;;
    kde)
        exec startkde
        ;;   
    anotherlevel)
        # feltételezzük, hogy a kapcsolótábla (switchdesk) telepítve van.
        exec /usr/share/apps/switchdesk/Xclients.anotherlevel
        ;;
    esac
esac  
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>

<P>Itt láthatjuk az xsession megfelelõ részét az új bejegyzések hozzáadása után (VEGYÜK FIGYELEMBE, hogy a menüpontoknak (selection labels) <EM>pontosan</EM> ugyanolyannak kell lenniük az xsession és a prefdm fájlokban, azaz a helyesírásnak betû szerint (kisbetû/nagybetû) meg kell egyeznie):</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
# most látjuk, ha az xdm/gdm/kdm egy sajátos környezetet kér
#
case $# in
1)
    case $1 in
    failsafe)
        exec xterm -geometry 80x24-0-0
        ;;
    gnome)
        exec gnome-session
        ;;
    kde)
        exec startkde
        ;;
    windowmaker)        
        exec wmaker
        ;;
    blackbox)        
        exec blackbox
        ;;    
    anotherlevel)
        # feltételezzük, hogy a kapcsolótábla (switchdesk) telepítve van..
        exec /usr/share/apps/switchdesk/Xclients.anotherlevel
        ;;
    esac
esac  
</PRE>
<HR>
</CODE></BLOCKQUOTE>

Vegyük figyelembe, hogy amikor a futtatható fájlokat az alábbi elérési utak valamelyikére telepítjük, csak az fájl nevét szükséges az "exec" után írni; egyébként a teljes elérési utat le kell írni, amint az a fenti "xclients.anotherlevel" bejegyzésnél látható:</P>
<P><CODE>/usr/bin/</CODE> </P>
<P><CODE>/usr/local/bin/</CODE> </P>
<P><CODE>/usr/X11R6/bin/</CODE></P>
<P><CODE>/usr/bin/X11/</CODE></P>
<P>Ezeknek a példáknak elegendõnek kell lenni, hogy a kedvenc ablakkezelõ(i)d hozzáadd a KDE grafikus bejelentkezõ ablakához, vagy kiindulási pontot ad, hogy kitaláld, hogy teheted meg ugyanezt az egyéni telepítésed esetében.</P>

<H2><A NAME="s4">4. Felhasználókiválasztó ikonok engedélyeztetése a bejelentkezõ ablakban</A></H2>

<P>A RedHat 6.1 változatában az alapértelmezett KDE bejelentkezõ ablak egy dialógusablakból áll, a felhasználónév és jelszó beírásához; valamint egy legördülõ lista a ablakkezelõ/asztali környezet kiválasztásához. Az <CODE>/usr/share/config/kdmrc</CODE> következõ módosításaival felhasználói ikonok jeleníthetõk meg a bejelentkezõ ablak tetején. Alább láthatjuk a kdmrc alapértelmezett sorait, amik a felhasználói ikonok megjelenítését határozzák meg (vannak egyéb sorok is az alább látható kettõ között, amik itt nem láthatók és "..." jelöléssel helyettesítettek):</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
#Users=root;johndoe
...
UserView=false
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Itt láthatóak ugyanezen sorok a szerkesztés után. Töröljük a kettõskereszt karaktert ("#") az "Users=..." elejérõl és változtassuk "johndoe"-t a saját felhasználónevünkre (ha több felhasználó fér hozzá a rendszerünkhöz, hozzáadhatjuk az Õ felhasználói neveiket is pontosvesszõkkel elválasztva). Írjuk át az "UserView=false" sort "UserView=true" -ra, amint az itt is látható:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
Users=root;johnpipe
...
UserView=true
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Ezután ha be akarunk lépni a rendszerbe, elég az egérrel egy ikonra kattintani a felhasználói név beírása helyett; így csak a jelszót kell beírni.</P>
<P>Az alapértelmezett ikonok helyett saját ikonokat is használhatunk. Tegyük saját ikonjainkat az /usr/share/apps/kdm/pics/users/ könyvtárba. A kdm kézikönyv szerint 64 x 64 -es méretûnek kell lenniük; KDE 1.x verzióban  az alapértelmezett ikonok 62 x 63 pixelesek, az új felhasználói ikonok pedig 60 x 60 méretûek, úgyhogy ha az ikonok mérete elég közel van a meghatározott 64 x 64 -es mérethez, akkor rendben fognak mûködni. A kézikönyv szerint "a kdm képes különbözõ méretû ikonokat kezelni, de a végeredmény torzulhat.", így nyilvánvalóan található itt némi eltérés. Az ikonjainkat "felhasznalonev.xpm" módon kell elnevezni, például ha az én felhasználónevem "johnpipe", akkor az új ikonom neve "johnpipe.xpm" lesz.</P>
<P>MEGJEGYZÉS: A KDE 1.x óta némely verzióban az ikonformátum ".xpm"-rõl (XPixMap) ".png"-re (Portable Network Graphic) változott.</P>


<H2><A NAME="s5">5. Rendszergazdai engedély megkövetelése a rendszer leállításához</A></H2>

<P>Alapértelmezésben a bejelentkezõ ablakban lévõ leállítás gomb  mindenkinek lehetõvé teszi a rendszer leállítását.
A következõ, <CODE>/usr/share/config/kdmrc</CODE> fájlban található rész, amely meghatározza azt, hogy ki használhatja ezt a gombot:</P>
<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
#ShutdownButton=RootOnly
ShutdownButton=ConsoleOnly 
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>Ha azt akarjuk, hogy csak a rendszergazda állíthassa le a rendszert, módosítsuk a sorokat a következõ módon</P>

<P>
<BLOCKQUOTE><CODE>
<HR>
<PRE>
ShutdownButton=RootOnly
#ShutdownButton=ConsoleOnly
</PRE>
<HR>
</CODE></BLOCKQUOTE>
 </P>
<P>Így a leállítás gombra kattintva még be kell írni a root jelszót is, mielõtt a rendszer leállna.</P>

<H2><A NAME="s6">6. Bibliográfia</A></H2>


<P>Ha még több HOGYANt akarsz olvasni, látogass el a 
<A HREF="http://www.tldp.org/">The Linux Documentation Project</A> 
(
<A HREF="http://tldp.fsf.hu/">Magyar Linux Dokumentációs Projekt</A>) webhelyére.</P>

<P>Ajánlott irodalom: </P>
<P>
<UL>
<LI>
<A HREF="http://www.tldp.org/HOWTO/XWindow-User-HOWTO/">XWindow-User-HOWTO</A></LI>
<LI>
<A HREF="http://www.tldp.org/HOWTO/Emacs-Beginner-HOWTO.html">Emacs Beginner's HOWTO</A></LI>
<LI>
<A HREF="http://www.tldp.org/HOWTO/Vim-HOWTO.html">Vim Color Editor HOW-TO (Vi Improved with syntax color highlighting)</A></LI>
</UL>
</P>
<P>A Te Linux disztribúciódtól és verziódtól függõen, a fenti HOGYANok már telepítve lehetnek a rendszeredben. Ha nincsenek, a telepítõ CD-n megtalálhatók.</P>

</BODY>
</HTML>
