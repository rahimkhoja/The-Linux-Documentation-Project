<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">

 <TITLE>Glibc 2 HOGYAN</TITLE>
</HEAD>
<BODY>
<H1>Glibc 2 HOGYAN</H1>

<H2>Eric Green, <CODE>ejg3@cornell.edu</CODE></H2>v1.6, 1998. június 22.
<HR>
<EM>
<!--
GNU C könyvtár (lásd glibc)
-->

<!--
glibc
-->

A glibc 2 HOGYAN leírja, hogyan telepítsd és használd a GNU C programkönytár 2-es
verzióját (libc 6) a Linux operációs rendszeren.</EM>
<HR>
<H2><A NAME="s1">1. Bevezetés</A></H2>



<H2><A NAME="ss1.1">1.1 Amit a glibc 2-rõl tudni kell</A>
</H2>

<P>
<!--
glibc!áttekintés
-->
</P>
<P>A Glibc 2 a GNU C programkönyvtár legújabb változata. Jelenleg módosítás
nélkül fut GNU Hurd rendszereken és a Linux i386, mk68k és alpha rendszereken.
A 2.1-es verzió támogatni fogja a Linux PowerPc-t valamint a MIPS,
Sparc, Sparc-64 és Arm platformokat. A könyvtár a jövõben más architektúrákat
és operációs rendszereket is támogatni fog.</P>
<P>A Linux rendszereken a glibc 2, a 6-os verziószámú libc-vel egyezik meg,
amely a libc 5 utódja. A Linuxos libc fejlesztõi a libc 6-al fel akarjak váltani
a libc 5-öt. A 2.0.6-os verziótól kezdve, a libc megbízhatónak tekinthetõ.
A 2.1-es változat, amely hamarosan napvilágot lát, készen áll majd a széleskörû 
felhasználásra, és további platformokat is fog támogatni.</P>
<P>Három opcionális kiegészítõ létezik a glibc 2-höz:
<DL>
<DT><B>Crypt</B><DD><P>Az UFC-crypt csomag.  Ezt a csomagot nem integrálták a glibc-be, az exporttilalmak miatt.</P>
<DT><B>LinuxThreads</B><DD><P>A Posix 1003.1c &quot;pthread&quot; interfész egy implemetációja.</P>
<DT><B>Locale data</B><DD><P>Ez tartalmazza a locale adatfájlok elõállításához szükséges adatokat, ezekre akkor van szükség, 
ha használni akarod a glibc nemzetközi lehetõségeit.</P>
</DL>
</P>
<P>A crypt és LinuxThreads kiegészítõ csomagok erõsen ajánlottak... Ha nem használod 
õket, inkompatibilitási problémák léphetnek fel más rendszerek különbözõ könyvtáraival.
(Ha ezek után mégsem akarod használni õket, meg kell adjad a 
--disable-sanity-checks opciót a configure szkript futtatásánál.)</P>

<H2><A NAME="ss1.2">1.2 Errõl a dokumentumról</A>
</H2>


<P>Ez a HOGYAN arról szól, hogyan telepítsd a glibc 2 könyvtárat egy meglévõ 
Linux rendszerre. A leírás abból indul ki, hogy libc 5-ot használsz i386-os 
architektúrán, de más rendszerek és könyvtárak (pl. glibc1) felhasználói is 
hasznát vehetik, csak le kell cseréljék a megfelelõ fájl- és 
architektúra-neveket a szituációnak megfelelõen.</P>
<P>Eme HOGYAN legfrissebb változatát megtalálod a
<A HREF="http://sunsite.unc.edu/LDP">Linux Documentation Project</A> részeként vagy a következõ kiszolgálón:
<A HREF="http://www.imaxx.net/~thrytis/glibc/Glibc2-HOWTO.html">http://www.imaxx.net/~thrytis/glibc/Glibc2-HOWTO.html</A>.</P>

<H2><A NAME="ss1.3">1.3 Mi változott a közelmúltban?</A>
</H2>


<P>Különbségek a dokumentum 1.6-os és 1.5-os változatai között:
<UL>
<LI>Kijavítottam a bináris glibc csomag telepítésére vonatkozó utasításokat.</LI>
</UL>
</P>
<P>Különbségek a dokumentum 1.5-os és 1.4-es változatai között:
<UL>
<LI>Indexelés hozzáadása, köszönet Ed Bailey-nek.</LI>
<LI>Megváltoztattam az e-mail címemet.</LI>
</UL>
</P>

<H2><A NAME="s2">2. Telepítési módszer kiválasztása</A></H2>

<P>
<!--
glibc!telepítés
-->
</P>
<P>A glibc-t többféleképpen telepítheted. Feltelepítheted tesztelés céljára, ebben az esetben a régi könyvtárakat használod továbbra is alapértelmezésben, de ha fordítasz egy programot, megadhatod, hogy az használja a teszt könyvtárat. Ha ezt a telepítési módszert választod, késõbb könnyen eltávolíthatod a glibc-t a gépedrõl (persze a hozzá kapcsolódó programok nem fognak mûködni). Ha ilyen módon tesztelni akarod a glibc-t, forrásból kell fordítsad, mert nem készült tesztelési célból bináris csomag (pl. rpm). Errõl a megoldásról a
<A HREF="#test-install">Telepítés teszt könyvtárként</A> fejezetben olvashatsz.</P>
<P>Ezzel ellentétben, telepítheted a glibc-t elsõdleges programkönyvtárként is. Ilyenkor minden új program, amit a gépen fordítasz, alapértelmezésben a glibc-t fogja használni, kivétel persze, ha fordításkor a régi könyvtárat adod meg.
Fordíthatod a könyvtárat magad, vagy feltelepítheted bináris csomagból is.
Ha változtatni akarsz a glibc beállításain, az optimalizálással akarsz variálni, vagy olyan kiegészítõt akarsz használni, ami a bináris csomagban nincsen benne, le kell töltened a forráskódot, és le kell fordítanod a könyvtárat. Ez esetben a telepítési útmutatót megtalálod a 
<A HREF="#primary-install">Telepítés elsõdleges C könyvtárként</A> fejezetben.</P>
<P>Frodo Looijaard leír egy harmadik telepítési módszert.
Az õ módszerének lényege, hogy a glibc-t másodlagos könyvtárként telepíted, és beállítasz egy keresztfordítót (cross compiler), ami a glibc-t használja. 
Ez a telepítési módszer kicsit bonyolultabb, mint a tesztkönyvtárként telepítés, de utána egyszerûbb olyan programokat fordítani, amik a glibc-t használják.
Ennek a módszernek a leírását a
<A HREF="http://huizen.dds.nl/~frodol/glibc/">A glibc-2 telepítése Linuxra</A> címû dokumentumba találod.</P>
<P>Ha 1.3-as Debiant használsz, és nem akarod a glibc miatt az "unstable" változatot használni, olvasd el a 
<A HREF="http://www.gate.net/~storm/FAQ/libc5-libc6-Mini-HOWTO.html">Debian libc5 to libc6 Mini-HOWTO-t</A>, ez leírja, hogyan frissítsd Debian csomagokkal rendszeredet.</P>
<P>Ha a glibc 2-t egy fontos gépre telepíted, valószínûleg a teszt telepítés a jobb választás. Még ha a glibc-ben nincsenek is hibák, egyes programokat esetleg módosítani kell, hogy le tudd fordítani õket, mert változhatnak a könyvtárban a függvények prototípusai és típusai.</P>

<H2><A NAME="getting"></A> <A NAME="s3">3. A könyvtár beszerzése</A></H2>

<P>
<!--
glibc!beszerzés
-->
</P>
<P>A glibc 2 négy csomagból áll: a glibc csomagból és a három kiegészítõ csomagból, ezek: LinuxThreads, Locale és Crypt. A forrásokat letöltheted a következõ helyekrõl:
<UL>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.6.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.6.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-linuxthreads-2.0.6.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-linuxthreads-2.0.6.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-localedata-2.0.6.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-localedata-2.0.6.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.6.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.6.tar.gz</A></LI>
</UL>
</P>
<P>A teljes glibc fordításához és telepítéséhez kb. 150 MB lemezterületre lesz szükséged. Ha bináris csomagból telepíted az alap glibc-t, akkor kb. 50MB-al kell számolnod.</P>
<P>A 2.0.6-os változatból nincsenek bináris csomgok. A 2.0.4-es verzió bináris csomagjai i386-os és m68k architektúrákra, valamint a 2.0.1-es változat alphára megtalálható itt:
<UL>
<LI>Intel x86:
<UL>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.4.bin.i386.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.4.bin.i386.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.4.bin.i386.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.4.bin.i386.tar.gz</A></LI>
</UL>
</LI>
<LI>Alpha:
<UL>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.1.bin.alpha-linux.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.1.bin.alpha-linux.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.1.bin.alpha-linux.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.1.bin.alpha-linux.tar.gz</A></LI>
</UL>
</LI>
<LI>m68k:
<UL>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.4-m68k-linux.bin.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-2.0.4-m68k-linux.bin.tar.gz</A></LI>
<LI>
<A HREF="ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.4-m68k-linux.bin.tar.gz">ftp://prep.ai.mit.edu/pub/gnu/glibc-crypt-2.0.4-m68k-linux.bin.tar.gz</A></LI>
</UL>
</LI>
</UL>

A Crypt kiegészítõ csomagra exportkorlátozások vannak érvényben. Az Egyesült Államokon kívül élõ felhasználók ezt a csomagot a 
<A HREF="ftp://ftp.ifi.uio.no/pub/gnu">ftp://ftp.ifi.uio.no/pub/gnu</A> kiszolgálóról szerezhetik be.</P>
<P>Ha Red Hat összeállítást használsz, letöltheted a 2-es glibc-t rpm csomagokban a Red Hat ftp kiszolgálójáról:
<A HREF="ftp://ftp.redhat.com/pub/redhat/">ftp://ftp.redhat.com/pub/redhat/</A>.  A Red Hat a glibc 2 könyvtárat használja elsõdleges C könyvtárként az összeállítás 5.0-as verziója óta.</P>
<P>Ha Debiant használsz, letöltheted a 2-es glibc-t deb csomagokban a Debiantól
<A HREF="ftp://ftp.debian.org/debian/dists/unstable/main/">ftp://ftp.debian.org/debian/dists/unstable/main/</A>.  
A fájlokat libc6-nak hívják. A glibc 2 része a Debian hamm verziójának, elsõdleges C könyvtár lesz a Debian 2.0 megjelenésétõl.</P>

<H2><A NAME="test-install"></A> <A NAME="s4">4. Telepítés teszt könyvtárként</A></H2>

<P>
<!--
glibc!tesztelés
-->
</P>
<P>Ez a rész azt írja le, a glibc 2 telepítését teszt könyvtárként. Ha bármilyen programot fordítasz, azt a fordító a régi glibc-vel szerkeszti össze, hacsak nem adod meg külön, hogy a teszt könyvtárat szeretnéd használni. Fordításkor az elérési útvonalak belekerülnek néhány fájlba, ezért valószínûleg forrásból kell telepítsd a könyvtárat.</P>

<H2><A NAME="ss4.1">4.1 Fordítás és telepítés</A>
</H2>



<H3>Telepítési követelmények</H3>

<P>
<!--
glibc!tesztelés!elõkövetelmények
-->
</P>
<P>
<UL>
<LI>Kb. 150 MB üres lemezterület</LI>
<LI>GNU make 3.75</LI>
<LI>gcc &gt;= 2.7.2 (még jobb, ha 2.7.2.1)</LI>
<LI>binutils 2.8.1 (alphához egy snapshot-ra van szükség)</LI>
<LI>bash 2.0</LI>
<LI>autoconf 2.12 (ha megváltoztatod a configure.in fájlt)</LI>
<LI>texinfo 3.11</LI>
</UL>
</P>
<P>Egy i586@133 gépen 64 MB RAM-mal, kb. 3 órába telik, amíg elkészül a teljes könyvtár a kiegészítõkkel. Egy erõsen leterhelt i686@200 gépen ugyanez kb. fél órába kerül.</P>

<H3>A forrás kicsomagolása</H3>

<P>
<!--
glibc!tesztelés!forráskód, kicsomagolás
-->
</P>
<P>Ahhoz, hogy le tudd fordítani a forrást, ki kell csomagolnod.
Ezt legkönnyebben a következõ módon teheted meg:
<BLOCKQUOTE><CODE>
<PRE>
 tar xzf glibc-2.0.6.tar.gz
 cd glibc-2.0.6
 tar xzf ../glibc-linuxthreads-2.0.6.tar.gz
 tar xzf ../glibc-crypt-2.0.6.tar.gz
 tar xzf ../glibc-localedata-2.0.6.tar.gz
 
</PRE>
</CODE></BLOCKQUOTE>

Ez a glibc-2.0.6 könyvtárba csomagolja ki a linuxthreads, crypt és locale kiegészítõket, ahol a configure megtalálja õket.</P>

<H3>Beállítás</H3>

<P>
<!--
glibc!tesztelés!beállítások
-->
</P>
<P>A glibc-2.0.6 könyvtárba hozzál létre egy compile nevû könyvtárat, majd lépj bele.
Mindent ebben a könyvtárban fogsz csinálni, ez egyszerûsíti a takarítást.
(A fejlesztõk eddig nem törték magukat, hogy a 'make clean' tökéletesen mûködjön.)</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 mkdir compile
 cd compile
 
</PRE>
</CODE></BLOCKQUOTE>

Futtasd le a <CODE>../configure</CODE> szkriptet.  Ha kiegészítõ csomagokat is akarsz használni, meg kell adnod a --enable-add-ons kapcsolót, pl.: --enable-add-ons=linuxthreads,crypt,localedata.
Ki kell válaszd a célkönyvtárat, ahova a könyvtárat telepíteni fogod.
Erre a /usr/i486-linuxglibc2 egy jó választás. Ehhez a configure paraméterei a következõk:
<BLOCKQUOTE><CODE>
<PRE>
 ../configure --enable-add-ons=linuxthreads,crypt,localedata --prefix=/usr/i486-linuxglibc2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3>Fordítás és telepítés</H3>

<P>
<!--
glibc!tesztelés!fordítás
-->

<!--
glibc!tesztelés!telepítés
-->
</P>
<P>A fordításhoz és ellenõrzéshez írd be a következõket:
<BLOCKQUOTE><CODE>
<PRE>
 make
 make check
 
</PRE>
</CODE></BLOCKQUOTE>

Ha a 'make check' sikeresen lefutott, telepítsd a könyvtárat root felhasználóként (még mindig a <CODE>compile</CODE> könyvtárból):
<BLOCKQUOTE><CODE>
<PRE>
 make install
 
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="ss4.2">4.2 A dinamikus betöltõ (dynamic loader) frissítése</A>
</H2>

<P>
<!--
glibc!tesztelés!dynamic loader, frissítés
-->

<!--
glibc!tesztelés!ld.so.conf, frissítés
-->
</P>
<P>
<OL>
<LI>Hozzál létre egy kötést, ami az új <CODE>ld.so</CODE> -ról a <CODE>/lib/ld-linux.so.2</CODE> -ra mutat:
<BLOCKQUOTE><CODE>
<PRE>
 ln -s /usr/i486-linuxglibc2/lib/ld-linux.so.2 /lib/ld-linux.so.2
 
</PRE>
</CODE></BLOCKQUOTE>

Ez az egyetlen könyvtár, amelynek rögzített a helye, miután egy programhoz hozzá lett kapcsolva.
Ha a <CODE>/lib</CODE> könyvtárban létrehozol egy kapcsot (link) hozzá, akkor késõbb könnyebb lesz 
áttérni a glibc-re, mint elsõdleges C könyvtárra, amikor megjelenik a stabil verziója.</LI>
<LI>Szerkeszd a <CODE>/etc/ld.so.conf</CODE> fájlt. A fájl végére be kell írnod a lib könyvtár elérési útvonalát, amiben az új programkönyvtárak vannak. Valahogy így fog kinézni: <CODE>&lt;prefix&gt;/lib</CODE>, tehát pl. <CODE>/usr/i486-linuxglibc2/lib</CODE> a fenti esetben.
A <CODE>/etc/ld.so.conf</CODE> fájl elmentése után futtasd le a következõ parancsot:
<BLOCKQUOTE><CODE>
<PRE>
 ldconfig -v
 
</PRE>
</CODE></BLOCKQUOTE>
</LI>
</OL>
</P>

<H2><A NAME="ss4.3">4.3 Beállítás a gcc fordítóhoz</A>
</H2>

<P>
<!--
glibc!tesztelés!gcc beállítás
-->

A telepítés utolsó lépése a <CODE>/usr/lib/gcc-lib</CODE> frissítésébõl áll. Ez azért szükséges, hogy a gcc tudja használni az új programkönyvtárakat.
Elsõ körben duplikálni kell a gcc-t. Hogy megtudd melyik az éppen mûködõ ggc konfiguráció, használd a gcc -v kapcsolóját:</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 % gcc -v
 Reading specs from /usr/lib/gcc-lib/i486-unknown-linux/2.7.2.2/specs
 gcc version 2.7.2.2
 
</PRE>
</CODE></BLOCKQUOTE>

Ebben az esetben az i486-unknown-linux a rendszer típusa, és a 2.7.2.2 a gcc verziószáma.
Át kell másolnod a <CODE>/usr/lib/gcc-lib/&lt;system&gt;</CODE> könyvtárat az új tesztrendszer könyvtárába:
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/lib/gcc-lib/
 cp -r i486-unknown-linux i486-linuxglibc2
 
</PRE>
</CODE></BLOCKQUOTE>

Lépj be az új tesztrendszer könyvtárába, majd a verziószámmal jelölt könyvtárba,
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2
 
</PRE>
</CODE></BLOCKQUOTE>

ezek után módosítsd a <CODE>specs</CODE> fájlt, ami ebben a könyvtárban található.
Írd át a <CODE>/lib/ld-linux.so.1</CODE> szöveget <CODE>/lib/ld-linux.so.2</CODE>-re.  Ha ez megvan, törölj ki minden <CODE>%{...:-lgmon}</CODE>  fájlra mutató hivatkozást, mert a glibc nem használja a gmon könyvtárat.
Találsz egy példa spec fájlt a 
<A HREF="#specs">Példa specs fájl</A> fejezetben.</P>

<H2><A NAME="ss4.4">4.4 A fejlécfájlokra mutató kapcsok frissítése</A>
</H2>

<P>
<!--
glibc!tesztelés!fejléc fájlok, frissítés
-->
</P>
<P>Kapcsokat (link) kell létrehoznod az új include könyvtárban, amik egyéb include könyvtárakra mutatnak:
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/i486-linuxglibc2/include
 ln -s /usr/src/linux/include/linux
 ln -s /usr/src/linux/include/asm
 ln -s /usr/X11R6/include/X11
 
</PRE>
</CODE></BLOCKQUOTE>

Elõfordulhat, hogy vannak más programkönyvtáraid, mint pl. az ncurses, ezeknek a fejlécfájlait is ebbe a könyvtárba kell helyezned. Ezeket a fájlokat át kell másolnod vagy kapcsoznod (link) a <CODE>/usr/include</CODE> könyvtárból.  (Lehetnek olyan programkönyvtárak is, amiket újra kell fordítanod, hogy a glibc2-vel mûködni tudjanak. Ebben az esetben egyszerûen fordítsd le õket, és a telepítésnél add meg a <CODE>/usr/i486-linuxglibc2</CODE> könyvtárat.)</P>

<H2><A NAME="ss4.5">4.5 A telepített programkönyvtár tesztelése</A>
</H2>

<P>
<!--
glibc!tesztelés
-->

A programkönyvtár teszteléséhez, hozz létre egy glibc.c fájlba következõkkel:
<BLOCKQUOTE><CODE>
<PRE>
 #include &lt;stdio.h&gt;

 main()
 {
     printf("hello world!\n");
 }
 
</PRE>
</CODE></BLOCKQUOTE>

Fordítsd le a következõ opciókkal: &quot;-b &lt;base install directory&gt; -nostdinc -I&lt;install directory&gt;/include -I/usr/lib/gcc-lib/&lt;new system dir&gt;/&lt;gcc version&gt;/include&quot;:
<BLOCKQUOTE><CODE>
<PRE>
 % gcc -b i486-linuxglibc2 -nostdinc -I/usr/i486-linuxglibc2/include \
       -I/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include glibc.c -o glibc
 
</PRE>
</CODE></BLOCKQUOTE>

Az ldd parancs segítségével ellenõrizd, hogy a fordító tényleg a glibc2-vel szerkesztette-e össze a programocskát és nem a régi libc-vel:
<BLOCKQUOTE><CODE>
<PRE>
 % ldd glibc
 libc.so.6 => /usr/i486-linuxglibc2/lib/libc-2.0.6.so (0x4000d000)
 /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
 
</PRE>
</CODE></BLOCKQUOTE>

Ha a programot le tudtad fordítani, a gcc az új glibc2-höz szerkesztette és amikor elindítod, azt írja ki, hogy &quot;hello world!&quot;, a telepítés sikeres volt.</P>

<H2><A NAME="primary-install"></A> <A NAME="s5">5. Telepítés elsõdleges C könyvtárként</A></H2>

<P>
<!--
glibc!telepítés
-->
</P>
<P>Ez a rész arról szól, hogy hogyan telepítsd a glibc 2-t elsõdleges C könyvtárként. Ezek után minden program amit a rendszereden fordítasz az új C programkönyvtárat fogja használni, hacsak nem beszéled le errõl speciális fordító kapcsolók segítségével.</P>
<P>Ha RedHat vagy Debian Linuxot használsz és letöltötted a megfelelõ rpm vagy deb csomagokat, átugorhatod ezt a részt, nézd meg a RedHat vagy Debian telepítési útmutatót.</P>

<H2><A NAME="compiling"></A> <A NAME="ss5.1">5.1 A könyvtár fordítása forráskódból</A>
</H2>

<P>
<!--
glibc!telepítés!fordítás
-->
</P>
<P>Ez a rész leírja, hogy hogyan fordítsd le a glibc 2-t és a kiegészítõit a forrásból. Akkor kell fordítanod a glibc-t, ha változtatni akarsz az alapbeállításain vagy az optimalizáláson, vagy olyan kiegészítõt akarsz használni, amihez nincsen bináris csomag.</P>

<H3>Telepítési követelmények</H3>

<P>
<!--
glibc!telepítés!elõkövetelmények
-->
</P>
<P>
<UL>
<LI>Kb. 150 MB üres hely a lemezen</LI>
<LI>GNU make 3.75</LI>
<LI>gcc &gt;= 2.7.2 (még jobb, ha 2.7.2.1)</LI>
<LI>binutils 2.8.1 (az alphához kell egy snapshot)</LI>
<LI>bash 2.0</LI>
<LI>autoconf 2.12 (ha megváltoztatod a configure.in fájlt)</LI>
<LI>texinfo 3.11</LI>
</UL>
</P>
<P>Egy i586@133 gépen 64 MB RAM-mal, kb. 3 órába telik, amíg elkészül a teljes könyvtár a kiegészítõkkel. Egy erõsen leterhelt i686@200 gépen ugyanez kb. fél órába kerül.</P>

<H3>A forrás kicsomagolása</H3>

<P>
<!--
glibc!telepítés!forráskód, kicsomagolás
-->
</P>
<P>Ahhoz, hogy le tudd fordítani a forrást, ki kell csomagolnod.
Erre a legjobb megoldás a következõ:
<BLOCKQUOTE><CODE>
<PRE>
 tar xzf glibc-2.0.6.tar.gz
 cd glibc-2.0.6
 tar xzf ../glibc-linuxthreads-2.0.6.tar.gz
 tar xzf ../glibc-crypt-2.0.6.tar.gz
 tar xzf ../glibc-localedata-2.0.6.tar.gz
 
</PRE>
</CODE></BLOCKQUOTE>

Ez a glibc-2.0.6 könyvtárba csomagolja ki a linuxthreads, crypt és locale kiegészítõket, ahol a configure megtalálja õket.</P>

<H3>Beállítás</H3>

<P>
<!--
glibc!telepítés!beállítások
-->
</P>
<P>A glibc-2.0.6 könyvtárba hozzál létre egy compile nevû könyvtárat majd lépj bele.
Mindent ebben a könyvtárban fogsz csinálni, ez egyszerûsíti a takarítást.
(A fejlesztõk eddig nem törték magukat, hogy a 'make clean' tökéletesen mûködjön.)</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
mkdir compile
cd compile
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Futtasd le a <CODE>../configure</CODE> szkriptet.  Ha kiegészítõ csomagokat is akarsz használni, meg kell adnod az --enable-add-ons kapcsolót, pl.: --enable-add-on\s=linuxthreads,crypt,localedata.</P>
<P>Valószínûleg meg akarod adni a célkönyvtárat is, ahova a glibc-t telepíteni akarod. Mivel a szabványos Linux disztribúcióhoz akarsz igazodni, add meg a --prefix=/usr kapcsolót. (Ha egy Linux rendszeren az <CODE>/usr</CODE> könyvtárat adod meg, a configure magától be tud állítani egyéb fontos elérési útvonalakat, ahova a libc.so és egyéb más fontos a <CODE>/lib</CODE>-ben lévõ könyvtárakat kell tenni. 
A configure parancssora valahogy így fog kinézni:
<BLOCKQUOTE><CODE>
<PRE>
 ../configure --enable-add-ons=linuxthreads,crypt,localedata --prefix=/usr
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3>Fordítás</H3>

<P>
<!--
glibc!telepítés!fordítás
-->
</P>
<P>A fordításhoz és ellenõrzéshez írd be a következõket:
<BLOCKQUOTE><CODE>
<PRE>
 make
 make check
 
</PRE>
</CODE></BLOCKQUOTE>
</P>


<H2><A NAME="ss5.2">5.2 Felkészülés a telepítésre</A>
</H2>

<P>
<!--
glibc!telepítés!elõkészületek
-->
</P>
<P>Akár fordítod a glibc-t, akár bináris csomagokból rakod fel, néhány fájlt át kell helyezned, mert bár minden újonnan fordított program az új glibc-t fogja használni, a régi (nem statikusan linkelt) programoknak szükségük van a régi programkönyvtárra (libc5), ezért azt nem írhatod egyszerûen felül.</P>
<P>
<OL>
<LI>Hozz létre egy új könyvtárat a régi fájloknak:
<BLOCKQUOTE><CODE>
<PRE>
 mkdir -p /usr/i486-linuxlibc5/lib
 
</PRE>
</CODE></BLOCKQUOTE>

</LI>
<LI>A régi fejléc fájlokat ki kell helyezni a <CODE>/usr/include</CODE> könyvtárból:
<BLOCKQUOTE><CODE>
<PRE>
 mv /usr/include /usr/i486-linuxlibc5/include
 
</PRE>
</CODE></BLOCKQUOTE>

</LI>
<LI>Csinálj egy új include könyvtárat és hozd létre a szükséges, más include könyvtárakra mutató kapcsokat: 
<BLOCKQUOTE><CODE>
<PRE>
 mkdir /usr/include

 ln -s /usr/src/linux/include/linux /usr/include/linux
 ln -s /usr/src/linux/include/asm /usr/include/asm
 ln -s /usr/X11R6/include/X11 /usr/include/X11
 ln -s /usr/lib/g++-include /usr/include/g++
 
</PRE>
</CODE></BLOCKQUOTE>


Ezek a kapcsok lehet, hogy kicsit eltérnek a megadottól, mert az include könyvtárak helye összeállítástól függõ. Legalább is a Slackware Linuxokon a g++ fejléc fájlok a <CODE>/usr/local/g++-include</CODE> könyvtárban vannak, míg a Debian alatt a <CODE>/usr/include/g++</CODE> könyvtárban találhatók és a  
<CODE>/usr/lib/g++-include</CODE> kapocs a <CODE>/usr/include/g++</CODE>-ra mutat.  
Az utóbbi esetben valószínûleg szerencsésebb az eredeti g++ include könyvtárat visszahelyezni a <CODE>/usr/include</CODE> könyvtárba.
</LI>
<LI>Állíts vissza minden plusz fejléc fájlt és kapcsot, ami esetleg az eredeti <CODE>/usr/include</CODE> könyvtárban volt. Egyes szabványtalan programkönyvtárak, mint pl. az ncurses fájlokat raknak be a <CODE>/usr/include</CODE> könyvtárba, vagy kapcsokat hoznak ott létre, melyek az adott programkönyvtár include könyvtárára mutatnak. Ezeket a fájlokat és kapcsokat vissza kell állítanod, hogy továbbra is használni tudd a kérdéses programkönyvtárakat.
</LI>
<LI>Add hozzá az új programkönyvtár könyvtárát (pl.
<CODE>/usr/i486-linuxlibc5/lib</CODE>) az <CODE>/etc/ld.so.conf</CODE> fájl <EM>elejéhez</EM>. Legalább az 1.8.8-as verziójú ld.so-ra van szükséged, különben bizarr hibaüzenetekkel találod magad szembe a glibc telepítése után.
</LI>
<LI>Helyezd át az összes régi C programkönyvtárat az új könyvtárba.
<BLOCKQUOTE><CODE>
<PRE>
 mv /usr/lib/libbsd.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libc.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libgmon.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libm.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libmcheck.a /usr/i486-linuxlibc5/lib
 mv /usr/lib/libc.so /usr/i486-linuxlibc5/lib
 mv /usr/lib/libm.so /usr/i486-linuxlibc5/lib
 cp /lib/libm.so.5.* /usr/i486-linuxlibc5/lib
 cp /lib/libc.so.5.* /usr/i486-linuxlibc5/lib
 
</PRE>
</CODE></BLOCKQUOTE>

A <CODE>libm.so.5</CODE> és <CODE>libc.so.5</CODE> fájlokat másolni kell és nem áthelyezni, ha a <CODE>/usr</CODE> nem a <CODE>/</CODE> partíción van, mert ezekre a programkönyvtárakra a Linuxnak induláskor szüksége van, ezért a <CODE>/</CODE> köteten kell legyenek.
</LI>
<LI>Helyezd át az <CODE>/usr/lib/*.o</CODE> fájlokat az új könyvtárba.
<BLOCKQUOTE><CODE>
<PRE>
 mv /usr/lib/crt1.o /usr/i486-linuxlibc5/lib
 mv /usr/lib/crti.o /usr/i486-linuxlibc5/lib
 mv /usr/lib/crtn.o /usr/i486-linuxlibc5/lib
 mv /usr/lib/gcrt1.o /usr/i486-linuxlibc5/lib
 
</PRE>
</CODE></BLOCKQUOTE>

</LI>
<LI>Frissítsd a programkönyvtár gyorsítótárát, miután átrendezted a programkönyvtárakat.
<BLOCKQUOTE><CODE>
<PRE>
 ldconfig -v
 
</PRE>
</CODE></BLOCKQUOTE>
</LI>
</OL>
</P>


<H2><A NAME="ss5.3">5.3 Telepítés bináris csomagból</A>
</H2>

<P>
<!--
glibc!telepítés!elõre fordított binárisok
-->
</P>
<P>Ha elõre fordított bináris csomagokból telepíted a glibc-t, elõször ellenõrizd
a csomagok tartalmát:
<BLOCKQUOTE><CODE>
<PRE>
 tar -tzvf glibc-2.0.bin.i386.tar.gz
 tar -tzvf glibc-crypt-2.0.bin.i386.tar.gz
 
</PRE>
</CODE></BLOCKQUOTE>

Ha elégedett vagy az eredménnyel, telepítheted a glibc-t:
<BLOCKQUOTE><CODE>
<PRE>
 cd /
 tar -xzf glibc-2.0.bin.i386.tar.gz
 tar -xzf glibc-crypt-2.0.bin.i386.tar.gz
 ldconfig -v
 
</PRE>
</CODE></BLOCKQUOTE>

Ha más architektúrát vagy verziót használsz, értelemszerûen helyettesítsd a fájlneveket.</P>
<P>A glibc legújabb verziója általában nincs meg bináris csomagban, viszont a legújabb verzió használata mindig javasolt, a hibajavítások miatt. Ha nem tudod a glibc-t lefordítani a saját gépeden, tölts le egy bináris programkönyvtárat tartalmazó csomagot egy olyan disztribúcióból, ami a glibc-t használja (pl. RedHat) és telepítsd azt.</P>

<H2><A NAME="ss5.4">5.4 Telepítés forráskódból</A>
</H2>

<P>
<!--
glibc!telepítés!forráskódból
-->
</P>
<P>A programkönyvtár forráskódból való telepítéséhez, add ki root felhasználóként a <CODE>compile/</CODE> könyvtárból a következõ utasításokat: 
<BLOCKQUOTE><CODE>
<PRE>
 make install
 ldconfig -v
 
</PRE>
</CODE></BLOCKQUOTE>
</P>


<H2><A NAME="ss5.5">5.5 A gcc specs fájljának frissítése</A>
</H2>

<P>
<!--
glibc!telepítés!gcc specs fájl, frissítés
-->
</P>
<P>A telepítés utolsó lépéseként (mind a bináris csomagok, mind a forráskódból való telepítés esetén) frissíteni kell a gcc <CODE>specs</CODE> fájlját, hogy a fordító az új glibc-vel szerkessze össze a késõbbiekben fordított programokat.
Hogy meghatározd, a gcc melyik specs fájl használja, add ki a következõ parancsot:
<BLOCKQUOTE><CODE>
<PRE>
 % gcc -v
 reading specs from /usr/lib/gcc-lib/i486-unknown-linux/2.7.2.2/specs
 gcc version 2.7.2.2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ebben az esetben a i486-unknown-linux írja le a rendszert és a 2.7.2.2 a verziót.
Át kell másolnod a <CODE>/usr/lib/gcc-lib/&lt;system&gt;</CODE> könyvtárat a régi rendszer könyvtárba:
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/lib/gcc-lib/
 cp -r i486-unknown-linux i486-linuxlibc5
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Lépjél be az eredeti könyvtáraba, majd a verziószám által jelölt könyvtárba:
<BLOCKQUOTE><CODE>
<PRE>
 cd /usr/lib/gcc-lib/i486-unknown-linux/2.7.2.2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ezek után módosítsd a <CODE>specs</CODE> fájlt, ami ebben a könyvtárban található.
Írd át a <CODE>/lib/ld-linux.so.1</CODE> szöveget <CODE>/lib/ld-linux.so.2</CODE>-re.  Ha ez megvan, törölj ki minden <CODE>%{...:-lgmon}</CODE>  fájlra mutató hivatkozást, mert a glibc nem használja a gmon könyvtárat.
Találsz egy példa spec fájlt a 
<A HREF="#specs">Példa specs fájl</A> fejezetben.</P>


<H2><A NAME="ss5.6">5.6 A feltelepített programkönyvtár tesztelése</A>
</H2>

<P>
<!--
glibc!telepítés!tesztelés
-->
</P>
<P>A programkönyvtár ellenõrzéséhez, hozz létre egy glibc.c nevû fájlt a következõ tartalommal:
<BLOCKQUOTE><CODE>
<PRE>
 #include &lt;stdio.h&gt;

 main()
 {
     printf("hello world!\n");
 }
 
</PRE>
</CODE></BLOCKQUOTE>

Fordítsd le a programot.
<BLOCKQUOTE><CODE>
<PRE>
 % gcc glibc.c -o glibc
 
</PRE>
</CODE></BLOCKQUOTE>

Az ldd programmal ellenõrizd, hogy a fordító tényleg az új programkönyvtárat használja:
<BLOCKQUOTE><CODE>
<PRE>
 % ldd glibc
 libc.so.6 => /lib/libc.so.6 (0x4000e000)
 /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
 
</PRE>
</CODE></BLOCKQUOTE>

Ha a programot sikerül lefordítani, és futása eredményeként kiírja, hogy &quot;hello world!&quot; a telepítés sikerült.</P>

<H2><A NAME="s6">6. Fordítás a nem elsõdleges libc-vel</A></H2>

<P>
<!--
glibc!fordítás más programkönyvtárral
-->
</P>
<P>Vannak olyan alkalmak, amikor nem az elsõdleges programkönyvtárat szeretnéd használni fordításkor. Ez a rész azt írja le, hogy ezt hogyan teheted meg. A felhasznált könyvtár- és fájlnevek megegyeznek az elõzõ részben használtakkal.
Ne felejtsd el megváltoztatni ezeket a neveket a telepítésednek megfelelõen.</P>

<H2><A NAME="ss6.1">6.1 Figyelmeztetés, ha nem elsõdleges C programkönyvtárat használsz</A>
</H2>

<P>
<!--
glibc!fordítás más programkönyvtárral!figyelmeztetés
-->

Mielõtt bármilyen olyan programot fordítanál, amit a Linux a rendszer indulásakor használ (a nem root partíciók felcsatolása elõtt), ne felejtsd el, hogy ha a program dinamikusan linkelt, szüksége van a programkönyvtárakra a root partíción. Ha megfigyelted az elõzõ részben leírt telepítést, hiába a glibc az új C programkönyvtár, a régi libc is megmaradt a <CODE>/lib</CODE> könyvtárban, ami a root partíción van. Ez azt jelenti, hogy a régi libc-vel összeszerkesztett programok továbbra is használhatók az indulási folyamat során.
Ha viszont a <CODE>/usr</CODE> nem a root partíción van és a glibc-t teszt könyvtárként telepíted a <CODE>/usr/i486-linuxglibc2</CODE> könyvtárba, minden új, a teszt könyvtárral fordított program mûködésképtelen lesz, amíg nincs felcsatolva a <CODE>/usr</CODE> könyvtárat tartalmazó partíció.</P>

<H2><A NAME="ss6.2">6.2 Programok fordítása teszt glibc-vel</A>
</H2>

<P>
<!--
glibc!fordítás más könyvtárral!glibc
-->

Ahhoz, hogy egy programot a teszt glibc könyvtárral fordíts, be kell állítanod az include könyvtárak és fájlok elérési útvonalait úgy, hogy azok a teszt glibc könyvtárban lévõ include fájlokra mutassanak. Ha a parancssoron megadod a 
&quot;-nostdinc&quot; kapcsolót, az törli a hivatkozásokat az alapértelmezett include elérési útvonalakat, a
&quot;-I/usr/i486-linuxglibc2/include&quot; pedig megadja a glibc include fájlok helyét.
Meg kell még add a gcc include fájljait, amelyek a 
<CODE>/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include</CODE> könyvtárban találhatók (akkor, ha 2.7.2.2-es gcc-t használsz és a teszt programkönyvtárat az i486-linuxglibc2 könyvtárba telepítetted).</P>
<P>Meg kell add ezeken kívül a gcc beállításait. Ezt megteheted a &quot;-b i486-linuxglibc2&quot; kapcsolóval.</P>
<P>A legtöbb programnál megadhatod ezeket a kapcsolókat a makefile 
<CODE>$CFLAGS</CODE> és <CODE>$LDFLAGS</CODE> opcióinál:
<BLOCKQUOTE><CODE>
<PRE>
 CFLAGS = -nostdinc -I/usr/i486-linuxglibc2/include \
          -I/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include \
          -b i486-linuxglibc2
 LDFLAGS = -b i486-linuxglibc2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ha configure szkriptet használsz a fordítás elõtt, állítsd be a <CODE>$CFLAGS</CODE>
és <CODE>$LDFLAGS</CODE> környezeti változókat (csh/tcsh-ban használd az env/setenv parancsokat,
sh/bash-ban használd a set/export-ot ) a configure futtatása elõtt.  Az így generált makefile fájlokban szerepelnie kell a megfelelõ <CODE>$CFLAGS</CODE>
és <CODE>$LDFLAGS</CODE> beállításoknak.  Nem minden configure szkript olvassa ki a parancsértelmezõ környezetébõl a változókat, ezért ellenõrizni kell a makefile-t, és kézzel javítani szükség esetén.</P>
<P>Ha a fordítandó program csak a gcc-t hívja meg (és nem egyenesen a cpp-t vagy a binutils-t), használhatod a következõ szkriptet a kapcsolók megadására:
<BLOCKQUOTE><CODE>
<PRE>
 #!/bin/bash
 /usr/bin/gcc -b i486-linuxglibc2 -nostdinc \
              -I/usr/i486-linuxglibc2/include \
              -I/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include "$@"
 
</PRE>
</CODE></BLOCKQUOTE>

Használd ezt a szkriptet fordításnál a &quot;gcc&quot; helyett.</P>

<H2><A NAME="ss6.3">6.3 Programok fordítása libc 5-el, ha a glibc az elsõdleges programkönyvtár</A>
</H2>

<P>
<!--
glibc!fordítás más könyvtárral!libc 5
-->

Ha a régi libc könyvtárral akarsz programot fordítani és a glibc-t elsõdleges könyvtárként telepítetted, vissza kell állítsad az include fájlok elérési útvonalát a régi include fájlokéra. Meg kell add a &quot;-nostdinc&quot; kapcsolót, ez törli az alapértelmezett beállításokat, majd a &quot;-I/usr/i486-linuxlibc5/include&quot; kapcsolóval be kell állítanod a libc5 include fájljainak az elérési útvonalát.
Meg kell még adnod a 
&quot;-I/usr/lib/gcc-lib/i486-linuxlibc5/2.7.2.2/include&quot;
kapcsolót, amely a gcc specifikus include fájlok helyét adja meg.
Ne felejtsd el, az itt megadott könyvtárneveket a saját rendszerednek megfelelõen megváltoztatni (könyvtárnevek és gcc verzió).</P>
<P>Végül meg kell add a gcc beállításait, a 
&quot;-b i486-linuxlibc5&quot; kapcsolóval.</P>
<P>A legtöbb programnál megadhatod ezeket a kapcsolókat a makefile
<CODE>$CFLAGS</CODE> és <CODE>$LDFLAGS</CODE> opcióinál:
<BLOCKQUOTE><CODE>
<PRE>
 CFLAGS = -nostdinc -I/usr/i486-linuxlibc5/include \
          -I/usr/lib/gcc-lib/i486-linuxlibc5/2.7.2.2/include \
          -b i486-linuxlibc5
 LDFLAGS = -b i486-linuxlibc5
 
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Ha configure szkriptet használsz a fordítás elõtt, állítsd be a <CODE>$CFLAGS</CODE>
és <CODE>$LDFLAGS</CODE> környezeti változókat (csh/tcsh-ban használd az env/setenv parancsokat,
sh/bash-ban használd a set/export-ot ) a configure futtatása elõtt.  Az így generált makefile fájlokban szerepelnie kell a megfelelõ <CODE>$CFLAGS</CODE>
és <CODE>$LDFLAGS</CODE> beállításoknak.  Nem minden configure szkript olvassa ki a parancsértelmezõ környezetébõl a változókat, ezért ellenõrizni kell a makefile-t, és kézzel javítani szükség esetén.</P>
<P>Ha a fordítandó program csak a gcc-t hívja meg (és nem egyenesen a cpp-t vagy a binutils-t), használhatod a következõ szkriptet a kapcsolók megadására:
<BLOCKQUOTE><CODE>
<PRE>
 #!/bin/bash
 /usr/bin/gcc -b i486-linuxlibc5 -nostdinc \
              -I/usr/i486-linuxlibc5/include \
              -I/usr/lib/gcc-lib/i486-linuxlibc5/2.7.2.2/include "$@"
 
</PRE>
</CODE></BLOCKQUOTE>

Használd ezt a szkriptet fordításnál a &quot;gcc&quot; helyett.</P>

<H2><A NAME="s7">7. C++ programok fordítása</A></H2>

<P>
<!--
glibc!C++ programok, fordítás
-->

A libg++ használja a matematikai programkönyvtárat, tehát a libm könyvtárhoz van kapcsolva. Mivel a meglévõ libg++ könyvtárad a régi C programkönyvtárat használja, újra kell fordítanod a glibc-vel, vagy telepítened kell egy bináris könyvtárat (amit glibc-vel fordítottak). A libg++ legfrissebb változatát (forráskódot vagy bináris csomagot x86-os architektúrához) letöltheted a 
<A HREF="ftp://ftp.yggdrasil.com/private/hjl/">ftp://ftp.yggdrasil.com/private/hjl/</A> ftp helyrõl.</P>

<H2><A NAME="ss7.1">7.1 A libg++ telepítése teszt glibc könyvtárral</A>
</H2>

<P>
<!--
glibc!libg++, telepítés!teszt könyvtárként
-->

Ha teszt könyvtárként telepítetted a glibc-t, abba a könyvtárba kell telepítened a fájlokat, amelyikben a glibc található (pl. 
<CODE>/usr/i486-linuxglibc2</CODE>, az elõzõ fejezetekben leírt példák alapján).
Ha bináris csomagból telepíted a libg++ könyvtárat (amit forrón ajánlok, mert még sohasem volt szerencsém így libg++ könyvtárat fordítani), csomagold ki a fájlokat egy átmeneti könyvtárba, majd helyezd át a <CODE>usr/lib/</CODE> könyvtárban lévõ fájlokat az <CODE>&lt;install directory&gt;/lib/</CODE> könyvtárba, a <CODE>usr/include/</CODE>-ban lévõ fájlokat a
<CODE>&lt;install directory&gt;/include/</CODE> könyvtárba (ne felejtsd el elõször törölni az <CODE>include/g++</CODE> kapcsot!) és a <CODE>usr/bin/</CODE>-ben lévõ fájlokat az <CODE>&lt;install directory&gt;/bin/</CODE> könyvtárba.</P>

<H2><A NAME="ss7.2">7.2 A libg++ telepítése elsõdleges glibc könyvtár esetén</A>
</H2>

<P>
<!--
glibc!libg++, telepítés!elsõdleges könyvtárként
-->
</P>
<P>Ha a glibc-t elsõdleges könyvtárként telepítetted, elõször át kell helyezned a régi libg++ fájljaidat a régi libc könyvtárba, abban az esetben ha ezen túl is akarsz fordítani g++ programokat a régi libc-vel. valószínûleg ennek az a legegyszerûbb módja, hogy telepítesz egy libc5-el fordított új libg++, mint az elõzõ fejezetben és utána feltelepíted a glibc-t normálisan.</P>

<H2><A NAME="ss7.3">7.3 C++ programok fordítása a nem elsõdleges libc könyvtárral</A>
</H2>

<P>
<!--
glibc!C++ programok, fordítás!nem elsõdleges libc-vel
-->

Ha C++ programokat szeretnél nem elsõdleges libc-vel fordítani, meg kell add a g++ include könyvtárat, ami a fenti példák esetén <CODE>/usr/i486-linuxglibc2/include/g++</CODE> lenne teszt glibc konfiguráció esetén vagy <CODE>/usr/i486-linuxlibc5/include/g++</CODE> elsõdleges glibc konfiguráció esetén.
Ezt általában el lehet érni a <CODE>$CXXFLAGS</CODE> változó módosításával:
<BLOCKQUOTE><CODE>
<PRE>
 CXXFLAGS = -nostdinc -I/usr/i486-linuxglibc2/include \
            -I/usr/lib/gcc-lib/i486-linuxglibc2/2.7.2.2/include \
            -I/usr/i486-linuxlibc5/include/g++ -b i486-linuxglibc2
 
</PRE>
</CODE></BLOCKQUOTE>
</P>


<H2><A NAME="s8">8. Problémák</A></H2>

<P>
<!--
glibc!problémák
-->
</P>
<P>A glibc csomagban található egy GYIK (FAQ), amiben további információt és megoldásokat találhatsz a problémákra. A GYIK-nek van egy hálózaton elérhetõ változata is: 
<A HREF="http://www.imaxx.net/~thrytis/glibc/glibc-FAQ.html">http://www.imaxx.net/~thrytis/glibc/glibc-FAQ.html</A>. Most kiemelnék néhány problémát, amikrõl a GYIK-ben nincs (vagy nem elég részletesen van) szó.</P>

<H2><A NAME="ss8.1">8.1 Nem mûködik a gépnevek feloldása</A>
</H2>

<P>
<!--
glibc!problémák!gépnév feloldás
-->
</P>
<P>A glibc 2 más módszert használ a gépnevek feloldására, mint a libc5.
A glibc "name server switch" (NSS) kódrésze keresi a <CODE>/etc/nsswitch.conf</CODE> fájlt. Ha nem mûködik a gépnév feloldás, amikor glibc 2 könyvtárat használó alkalmazásokat futtatsz, és a <CODE>/etc/resolv.conf</CODE> fájlod megvan, és tartalmazza a szükséges információkat, nézd meg, hogy van-e <CODE>/etc/nsswitch.conf</CODE> fájlod. Ha nincs ilyen nevû fájl, akkor hozz létre egyet, a következõ tartalommal:
<BLOCKQUOTE><CODE>
<PRE>
 hosts:        files dns
 
</PRE>
</CODE></BLOCKQUOTE>

Ezzel beállítottad, hogy a névkiszolgálókra vonatkozó információk a <CODE>/etc/resolv.conf</CODE> fájlban vannak.</P>
<P>Ha további részletek is érdekelnek, olvasd el a libc info lapját, amiben
részletesen le van írva a nsswitch.conf fájl felépítése.</P>


<H2><A NAME="s9">9. Hibák bejelentése</A></H2>

<P>
<!--
glibc!hibák, bejelentés
-->
</P>
<P>Ha úgy gondolod, hogy hiba van a programkönyvtárban, olvasd el elõször a GYIK-et. Nem kizárt, hogy másnak esetleg ugyanaz a problémája volt, mint Neked, és van egyszerû megoldás. Ellenõrizd még a glibc csomagjában található <CODE>INSTALL</CODE> fájl "Recommended Tools to Install the GNU C Library" részét, mert a problémád adódhat más program hibájából is, nem feltétlenül a glibc mûködik rosszul.</P>
<P>Ha hibát találtál, elõször gyõzõdj meg róla, hogy tényleg igazi hibáról van szó. Ennek ellenõrzésére egy jó módszer, ha összehasonlítod a GNU C programkönyvtár és valamilyen másik C programkönyvtár viselkedését. Ha ugyanaz az eredmény mind a két programkönyvtárral, akkor valószínûleg nem hibáról van szó (bár nem 100%). Ha a két könyvtár viselkedése nem egyezik meg, akkor valószínû, hogy hibát találtál.</P>
<P>Ezek után nézd meg a 
<A HREF="http://www-gnats.gnu.org:8080/cgi-bin/wwwgnats.pl">http://www-gnats.gnu.org:8080/cgi-bin/wwwgnats.pl</A> címen elérhetõ hibákat tartalmazó adatbázist (bug database). Lehet, hogy valaki már elõtted bejelentette a hibát. Érdemes megnézni a glibc csomagban található <CODE>BUGS</CODE> fájlt, amiben szintén az ismert hibák listája található.</P>
<P>Ha már biztos vagy benne, hogy új hibát találtál, próbáld megállapítani a lehetõ legpontosabban, egy nagyon egyszerû tesztprogrammal, hogy mi okozza a hibát. A C program könyvtár esetében ez azt jelenti, hogy meg kell állapítanod, hogy melyik függvényhívás idézi elõ. Ez nem túl nehéz feladat.</P>
<P>A legutolsó lépés, amikor megvan az egyszerû kis tesztprogram, a hiba bejelentése. A hiba bejelentésénél, küldd el a tesztprogramot, az eredményeket amiket kaptál, az eredményeket amiket vártál, esetleg arról valamit, hogy szerinted mi lehet a gond (ha van valami ötleted), a rendszer típusát, a GNU C programkönyvtár verzióját, a gcc fordító verzióját és a GNU Binutils verzióját. Mellékeld még a <CODE>config.status</CODE> és <CODE>config.make</CODE> fájlokat, ezeket abban a könyvtárban találod, ahonnan a <CODE>configure</CODE> szkriptet futtattad.</P>
<P>Minden a GNU C könyvtárral kapcsolatos hibabejelentést a <CODE>glibcbug</CODE> shell szkipt segítségével kell elküldeni a 
<A HREF="bugs@gnu.org">bugs@gnu.org</A> címre (mûködik még a régi 
<A HREF="bugs@gnu.ai.mit.edu">bugs@gnu.ai.mit.edu</A> cím is), vagy a GNATS webes interfészén keresztül a 
<A HREF="http://www-gnats.gnu.org:8080/cgi-bin/wwwgnats.pl">http://www-gnats.gnu.org:8080/cgi-bin/wwwgnats.pl</A> honlapon.</P>
<P>Javaslatokat és kérdéseket a 
<A HREF="bugs-glibc@prep.ai.mit.edu">bugs-glibc@prep.ai.mit.edu</A> levelezõlistára lehet küldeni.
Ha nem olvasod a gnu.bug.glibc hírcsoportot, feliratkozhatsz a listára a  
<A HREF="bug-glibc-request@prep.ai.mit.edu">bug-glibc-request@prep.ai.mit.edu</A> honlapon.</P>
<P>Kérlek NE küldjél GNU C könyvtárral kapcsolatos hibabejelentést a &lt;bug-gcc@prep.ai.mit.edu&gt; címre. Ez a lista a GNU CC hibáival foglalkozik. A GNU CC és a GNU C könyvtár két külön dolog, különbözõ emberek tartják karban.</P>

<H2><A NAME="specs"></A> <A NAME="s10">10. Példa specs fájl</A></H2>

<P>
<!--
glibc!GCC specs fájl, példa
-->
</P>
<P>Ide beszúrtam egy <CODE>specs</CODE> fájlt, amit a gcc használ a glibc 2-vel fordításnál és linkelésnél. A fájl a <CODE>/usr/lib/gcc-lib/&lt;new system dir&gt;/&lt;gcc version&gt;</CODE> könyvtárban található. Ha x86-os rendszered van, valószínûleg bemásolhatod a fájlba ezt a részt egy az egyben.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
 *asm:
 %{V} %{v:%{!V:-V}} %{Qy:} %{!Qn:-Qy} %{n} %{T} %{Ym,*} %{Yd,*} %{Wa,*:%*}

 *asm_final:
 %{pipe:-}

 *cpp:
 %{fPIC:-D__PIC__ -D__pic__} %{fpic:-D__PIC__ -D__pic__} %{!m386:-D__i486__} 
 %{posix:-D_POSIX_SOURCE} %{pthread:-D_REENTRANT}

 *cc1:
 %{profile:-p}

 *cc1plus:


 *endfile:
 %{!shared:crtend.o%s} %{shared:crtendS.o%s} crtn.o%s

 *link:
 -m elf_i386 %{shared:-shared}   %{!shared:     %{!ibcs:       %{!static:   
 %{rdynamic:-export-dynamic}      %{!dynamic-linker:-dynamic-linker /lib/ld-linux.so.2}}
 %{static:-static}}}

 *lib:
 %{!shared: %{pthread:-lpthread}  %{profile:-lc_p} %{!profile: -lc}}

 *libgcc:
 -lgcc

 *startfile:
 %{!shared:      %{pg:gcrt1.o%s} %{!pg:%{p:gcrt1.o%s}                        %{!p:%{profile:gcrt1.o%s}
 %{!profile:crt1.o%s}}}}    crti.o%s %{!shared:crtbegin.o%s} %{shared:crtbeginS.o%s}

 *switches_need_spaces:


 *signed_char:
 %{funsigned-char:-D__CHAR_UNSIGNED__}

 *predefines:
 -D__ELF__ -Dunix -Di386 -Dlinux -Asystem(unix) -Asystem(posix) -Acpu(i386) -Amachine(i386)

 *cross_compile:
 0

 *multilib:
 . ;
 
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="s11">11. Egyéb</A></H2>

<P>
<!--
glibc!egyéb
-->
</P>

<H2><A NAME="ss11.1">11.1 További információ</A>
<!--glibc!további információ--></H2>



<H3>Web lapok</H3>

<P>
<!--
glibc!további információ!WWW
-->
</P>
<P>
<UL>
<LI>
<A HREF="http://www.gnu.org/software/libc/libc.html">Az FSF GNU C Programkönyvtár Weblapja</A></LI>
<LI>
<A HREF="http://www.imaxx.net/~thrytis/glibc/">GNU Libc 2 használata Linuxszal</A></LI>
<LI>
<A HREF="http://huizen.dds.nl/~frodol/glibc/">Glibc-2 telepítése Linuxra</A>.</LI>
<LI>
<A HREF="http://www.gate.net/~storm/FAQ/libc5-libc6-Mini-HOWTO.html">Debian libc5-rõl libc6-ra Mini-HOWTO</A>.</LI>
</UL>
</P>

<H3>Hírcsoportok</H3>

<P>
<!--
glibc!további információ!hírcsoportok
-->
</P>
<P>
<UL>
<LI>
<A HREF="news:comp.os.linux.development.system">comp.os.linux.development.system</A></LI>
<LI>
<A HREF="news:comp.os.linux.development.apps">comp.os.linux.development.apps</A></LI>
<LI>
<A HREF="news:linux.dev.kernel">linux.dev.kernel</A></LI>
<LI>
<A HREF="news:gnu.bug.glibc">gnu.bugs.glibc</A></LI>
</UL>
</P>

<H3>Levelezõlisták</H3>

<P>
<!--
glibc!további információ!levelezõ listák
-->
</P>
<P>
<DL>
<DT><B>Glibc 2 Linux fórum.</B><DD><P>Ez a lista olyan Linux felhasználók vitafóruma, akik feltelepítették 
a glibc2-t, az új GNU C programkönyvtárat. A témák: kompatibilitással összefüggõ kérdések, programok fordítása során felmerülõ problémák (Linux/glibc környezetben). A feliratkozáshoz küldj egy levelet a 
<A HREF="mailto:Majordomo@ricardo.ecn.wfu.edu">Majordomo@ricardo.ecn.wfu.edu</A> címre, a levél törzsében legyen:"subscribe glibc-linux &lt;a saját e-mail címed&gt;". </P>
<P>A levelezõlista archívuma megtalálható a 
<A HREF="http://www.progressive-comp.com/Lists/?l=linux-glibc&amp;r=1&amp;w=2#linux-glibc">http://www.progressive-comp.com/Lists/?l=linux-glibc&amp;r=1&amp;w=2#linux-glibc</A> címen.</P>
</DL>
</P>

<H2><A NAME="ss11.2">11.2 Köszönet</A>
</H2>


<P>Ezen információ nagy részét a 
<A HREF="http://www.gnu.org/software/libc/libc.html">GNU Libc</A>  honlapról loptam, valamint Ulrich Drepper &lt;drepper@gnu.ai.mit.edu&gt; glibc 2 bejelentéseibõl és megjegyzéseibõl. Andreas Jaeger-tõl &lt;aj@arthur.rhein-neckar.de&gt; származik a hibabejelentést leíró fejezet egy része.</P>
<P>A következõk voltak segítségemre e dokumentum összeállításában:
<UL>
<LI>Allex &lt;allex@ms2.accmail.com.tw&gt;</LI>
<LI>Mark Brown &lt;M.A.Brown-4@sms.ed.ac.uk&gt;</LI>
<LI>Ulrich Drepper &lt;drepper@gnu.ai.mit.edu&gt;</LI>
<LI>Scott K. Ellis &lt;ellis@valueweb.net&gt;</LI>
<LI>Aron Griffis &lt;agriffis@coat.com&gt;</LI>
<LI>Andreas Jaeger &lt;aj@arthur.rhein-neckar.de&gt;</LI>
<LI>Hank Leininger &lt;hlein@progressive-comp.com&gt;</LI>
<LI>Frodo Looijaard &lt;frodol@dds.nl&gt;</LI>
<LI>Ryan McGuire &lt;rmcguire@freenet.columbus.oh.us&gt;</LI>
<LI>Shaya Potter &lt;spotter@capaccess.org&gt;</LI>
<LI>Les Schaffer &lt;godzilla@futuris.net&gt;</LI>
<LI>Andy Sewell &lt;puck@pookhill.demon.co.uk&gt;</LI>
<LI>Gary Shea &lt;shea@gtsdesign.com&gt;</LI>
<LI>Stephane &lt;sr@adb.fr&gt;</LI>
<LI>Jan Vandenbos &lt;jan@imaxx.net&gt;</LI>
<LI>Michael Wolf &lt;wolfm@rpi.edu&gt;</LI>
</UL>
</P>
<P>Ezt a dokumentumot különbözõ nyelvekre fordítják:
<UL>
<LI>Kínai:  Allex &lt;allex@ms2.accmail.com.tw&gt;</LI>
<LI>Francia:  Olivier Tharan &lt;tharan@int-evry.fr&gt;</LI>
<LI>Japán:  Kazuyuki Okamoto &lt;ikko-@pacific.rim.or.jp&gt;</LI>
<LI>Magyar: Kovács Emese &lt;emese@eik.bme.hu&gt;</LI>
</UL>
</P>


<H2><A NAME="ss11.3">11.3 Visszajelzés</A>
</H2>


<P>Ezen HOGYAN írásától, valamint a 
<A HREF="http://www.imaxx.net/~thrytis/glibc">glibc 2 for Linux</A> honlap karbantartásától eltekintve semmi közöm sincs a glibc projekthez. Távol állok attól, hogy mindent tudjak a témakörrõl, ennek ellenére szívesen megpróbálok segíteni, ha gondjaid támadnak. Szívesen látok minden visszajelzést, javítást vagy kiegészítést a 
<A HREF="mailto:ejg3@cornell.edu">ejg3@cornell.edu</A> címen.</P>

<H2><A NAME="ss11.4">11.4 Szerzõi jogok</A>
</H2>

<P>Copyright &copy; Eric Green, 1997.</P>
<P>Ez a dokumentum továbbadható az LDP licencében rögzített feltételek mellett.</P>

<H2><A NAME="ss11.5">11.5 Magyar fordítás</A>
</H2>

<P>A magyar fordítást
<A HREF="mailto:emese@eik.bme.hu_NO_SPAM">Kovács Emese</A> készítette (1999).
A lektorálást
<A HREF="mailto:dacas@freemail.hu_NO_SPAM">Daczi László</A> végezte el (2002.12.28).
Bármilyen fordítással kapcsolatos észrevételt a
<A HREF="mailto:linuxhowto@sch.bme.hu_NO_SPAM">linuxhowto@sch.bme.hu</A> címre küldjetek.
Eme dokumentum legfrissebb változata megtalálható a
<A HREF="http://tldp.fsf.hu/index.html">Magyar Linux Dokumentációs Projekt</A> honlapján.</P>

</BODY>
</HTML>
