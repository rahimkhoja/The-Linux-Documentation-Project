<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>UMSDOS HOW-TO</TITLE>


</HEAD>
<BODY>
<H1>UMSDOS HOW-TO</H1>

<H2>Jacques Gelinas, <CODE>jacques@solucorp.qc.ca</CODE>,<BR>
Vertaald door: Ellen Bokhorst, <CODE>bokkie@nl.linux.org</CODE></H2>v1.2, 1 december 2001
<P><HR>
<EM><EM>Umsdos</EM> is een linux bestandssysteem. Het voorziet in een
alternatief voor het <EM>EXT2</EM> bestandssysteem. Mijn doel is een eenvoudiger co&euml;xistentie te bereiken met <EM>Ms-DOS</EM> gegevens door het delen van
dezelfde partitie.
In dit document wordt eerst uitgelegd hoe Umsdos in verschillende
configuraties te gebruiken en later wordt de werking ervan
uitgelegd en getracht in wat informatie te voorzien of je te
helpen beslissen of het een goede keuze voor je is
(zie UMSDOS Waarom aan het einde van dit document).</EM>
<HR>
<H2><A NAME="s1">1. Copyright en Licentie</A></H2>

<P>Dit document is auteursrechtelijk beschermd (c) 1995 door Jacques Gelinas.
Het wordt uitgegeven onder de voorwaarden van de GNU Free Documentation
License. Een kopie van de licentie zou erbij moeten worden geleverd, of 
je kunt een kopie bekijken op
<A HREF="http://www.fsf.org/licenses/fdl.html">http://www.fsf.org/licenses/fdl.html</A>.
<H2><A NAME="s2">2. UMSDOS: Waar komt het vandaan?</A></H2>

<H2>2.1 Historie</H2>

<P>
<P>Het <EM>Umsdos</EM> project werd in 1992 gestart en via het net als
een patch beschikbaar gesteld in januari 1994. In juli werd het
opgenomen in de standaardkernel, te beginnen met kernel 1.1.36.
<P><EM>Umsdos</EM> werd eerder opgenomen in de <EM>Slackware</EM> distributie
zelfs nog voor het officieel in de offici&euml;le kernel werd opgenomen.
<P><EM>Umsdos</EM> werd beginnend met kernel 1.1.60 verbeterd. De performance
werd vooral voor schrijfacties dramatisch verbeterd. Sinds
1.1.70 , is het weer stabiel.
<P>In <EM>Linux</EM> 1.2.2 werd een belangrijke bug opgelost.
Deze bug zorgde sinds het begin bij gebruikers voor nogal wat
ongerief (een aantal bestanden werden in stilte hernoemd, 
waarbij de droeve indruk werd gewekt dat ze waren verwijderd).
<EM>Slackware</EM> 2.2 wordt nog steeds geleverd met
kernelrelease 1.2.1 waarin deze bug nog zit.
<H2>2.2 Beschikbaarheid</H2>

<P>
<P>Het is als een patch beschikbaar voor kernel 1.0.x. Vanaf kernel 1.2
is het ingebouwd. Het kan in de kernel worden gecompileerd of als een
module worden geladen. Als je <EM>umsdos</EM> als een module wilt
laden, denk er dan om dat je ook het Ms-DOS fs als een module moet
laden. Dit komt door een beperking in het modulesysteem (een aantal
symbolen wordt alleen ge&euml;xporteerd als de drivers als een module
zijn ge&iuml;nstalleerd).
<H2>2.3 Distributie die het ondersteunt</H2>

<P>
<P>Ik dacht dat alleen <EM>Slackware</EM> het tot dusverre ondersteunt. 
Ik heb het vast en zeker verkeerd, dus stuur me alsjeblieft info
om dit te kunnen corrigeren.
<H2>2.4 Home site</H2>

<P>
<P>De home site voor <EM>Umsdos</EM> is sunsite.unc.edu. Kijk in de
directory <CODE>/pub/Linux/system/Filesystems/umsdos</CODE>.
<H2>2.5 Technische documentatie</H2>

<P>Er is een heleboel technische documentatie over de interne
werking van <EM>Umsdos</EM>. Het is zowel beschikbaar in <CODE>HTML</CODE>- 
als in tekstformaat op dezelfde lokatie als de utility's.
<P>Zover ik weet, is de <CODE>HTML</CODE> versie niet online op enige website
beschikbaar. Je moet het downloaden en "uitpakken" en het lokaal
lezen.
<H2>2.6 Wie schreef het</H2>

<P>
<P>Jacques Gelinas jacques@solucorp.qc.ca
<H2><A NAME="s3">3. Umsdos als je rootpartitie</A></H2>

<H2>3.1 Het pseudo-root concept</H2>

<P>Met <EM>Umsdos</EM> kan <EM>Linux</EM> op een standaard DOS-partitie
worden ge&iuml;nstalleerd. <EM>Linux</EM> wordt dan ge&iuml;nstalleerd
als een tweede (of derde) OS op die partitie. Om aanvaringen met
namen te voorkomen (er is wellicht reeds een bin of tmp directory
op drive C:), gebruik je <EM>Umsdos</EM>. 
Een slimme truuk: De pseudo-root.
<P>Alle <EM>Linux</EM> bestanden worden ge&iuml;nstalleerd in een
DOS-subdirectory genaamd <CODE>linux</CODE>, in het algemeen is dit
<CODE>C: LINUX</CODE>. De normale <EM>Linux/Unix</EM> directorystructuur
vind je hier. Dus je krijgt:
<P>
<UL>
<LI> 
<PRE>
C:\LINUX\BIN
</PRE>
</LI>
<LI> 
<PRE>
C:\LINUX\ETC
</PRE>
</LI>
<LI> 
<PRE>
C:\LINUX\LIB
</PRE>
</LI>
<LI> 
<PRE>
C:\LINUX\ROOT
</PRE>
</LI>
<LI> 
<PRE>
C:\LINUX\SBIN
</PRE>
</LI>
<LI> 
<PRE>
C:\LINUX\TMP
</PRE>
</LI>
<LI> 
<PRE>
C:\LINUX\USR
</PRE>
</LI>
<LI> 
<PRE>
C:\LINUX\VAR
</PRE>
</LI>
</UL>
<P>Wanneer <EM>Umsdos</EM> boot, zoekt het naar de directory <CODE>linux</CODE>
en vervolgens <CODE>/linux/etc</CODE>. Als het voorkomt, activeert het
de pseudo-root modus.
<P>Meestal schakelt de pseudo-root modus de root van de partitie over
naar <CODE>C:\\LINUX</CODE> wat de conventionele <EM>Unix</EM> directory
layout oplevert.
<P>
<UL>
<LI>
<PRE>
/bin
</PRE>
</LI>
<LI>
<PRE>
/etc
</PRE>
</LI>
<LI>
<PRE>
/lib
</PRE>
</LI>
<LI>
<PRE>
/root
</PRE>
</LI>
<LI>
<PRE>
/sbin
</PRE>
</LI>
<LI>
<PRE>
/tmp
</PRE>
</LI>
<LI>
<PRE>
/usr
</PRE>
</LI>
<LI>
<PRE>
/var
</PRE>
</LI>
</UL>
<P>Aan deze lijst, voegt het een nieuwe toe, genaamd <CODE>DOS</CODE>. Dit is een
virtuele directory.
<H2>3.2 Wat je moet weten over de pseudo-root</H2>

<P>
<UL>
<LI> Deze modus kan alleen tijdens de systeemstart teweeg worden
gebracht. Er is geen methode om dit door een mount opdracht te activeren.</LI>
<LI> Dit mechanisme is zuiver een andere kijk op een gewoon
<EM>Umsdos</EM> bestandssysteem. Dit betekent dat een partitie die
normaal geproken als een root-partitie in gebruik is, normaal kan
worden gemount. Er zal geen pseudo-root effect optreden.

Als je linux bijvoorbeeld boot met een onderhoudsdiskette
en je gewone rootpartitie in <CODE>/mnt/</CODE> mount, zal je
de linux-directory's allen aantreffen in
<CODE>/mnt/linux/bin, /mnt/linux/etc</CODE> enzovoort.</LI>
</UL>
<H2><A NAME="s4">4. Verschillende onderwerpen over de werking van <EM>Umsdos</EM></A></H2>

<H2>4.1 Mount optie</H2>

<P>
<P>Je kunt dezelfde mountopties gebruiken als voor het Ms-DOS bestandssysteem.
De optie conv= is twijfelachtig op een <EM>Umsdos</EM> systeem. Ik raad je
aan het te vermijden. De opties waar je wellicht voornamelijk naar wilt
kijken zijn:
<P>
<UL>
<LI>uid=</LI>
<LI>gid=</LI>
<LI>umask=</LI>
</UL>
<P>Denk eraan dat <EM>Umsdos</EM> een niet gepromote directory beheert
op dezelfde wijze als het <EM>Ms-DOS</EM> bestandssysteem. 
De opties hierboven zullen globaal van toepassing zijn op alle
niet gepromote directory's. Met <EM>uid</EM> wordt de standaardeigenaar
ingesteld, met <EM>gid</EM> de standaardgroep en met
<EM>umask</EM> de standaardpermissies.
<H2>4.2 Hoe standaards voor de root in te stellen</H2>

<P>
<P>umssetup werd gecre&euml;rd om voor de root-partitie te voorzien in
een standaardeigenaar tijdens de uitvoering.
De mount optie of umssetup kan voor andere <EM>Umsdos</EM> partities worden
gebruikt. De voorkeur gaat er naar uit de mount opties voor de
partities anders dan root in /etc/fstab op te slaan. Hier is een
voorbeeld. Plaats die in /etc/rc.d/rc.S.
<P>
<BLOCKQUOTE><CODE>
<PRE>
/sbin/umssetup -u jack -g group -m 0755 /
</PRE>
</CODE></BLOCKQUOTE>
<H2>4.3 Wel of geen swap</H2>

<P>
<P>Gebruik van een swapbestand is in het algemeen langzamer dan een
swappartitie. Het is echter veel flexibeler. Je kunt een swapbestand
in een <EM>Umsdos</EM> partitie instellen op dezelfde wijze als je
dat zou doen voor ieder ander <EM>Linux</EM> bestandssysteem.
Voor het instellen van een swapbestand in de rootdirectory van 8 megabyte
bijvoorbeeld, geef je de volgende opdrachten:
<P>
<BLOCKQUOTE><CODE>
<PRE>
dd if=/dev/zero bs=1024k count=8 of=/swap
mkswap /swap 8192
sync
swapon /swap
</PRE>
</CODE></BLOCKQUOTE>
<P>Zodra je hiermee klaar bent, kun de je volgende regel in /etc/fstab
plaatsen:
<P>
<BLOCKQUOTE><CODE>
<PRE>
/swap   swap    swap    default         
</PRE>
</CODE></BLOCKQUOTE>
<P>En vervolgens zal het swapbestand bij iedere boot worden
geactiveerd (gewoonlijk staat in <CODE>/etc/rc.d/rc.S</CODE>
een opdracht "swapon -a" ).
<H2><A NAME="s5">5. Hoe een Umsdos systeem te booten</A></H2>

<H2>5.1 Loadlin</H2>

<P>
<P>Het package lodlin15.tgz is beschikbaar vanaf sunsite.unc.edu
in <CODE>/pub/Linux/system/Bootutils</CODE>. Dit utility is in het
bijzonder geschikt voor het booten van een 
<EM>Umsdos</EM> systeem. Over het algemeen hoef je alleen op te geven
<P>
<BLOCKQUOTE><CODE>
<PRE>
Boot DOS
C:>loadlinx zimage root=D:
</PRE>
</CODE></BLOCKQUOTE>
<P>waar zimage een gewoon kernel-image voorstelt (gecomprimeerd) 
simpel ergens op de DOS drive naartoe gekopieerd.
<CODE>D:</CODE> is de DOS drive waarop je <EM>Linux</EM> hebt ge&iuml;nstalleerd.
<H2>5.2 Vanaf een diskette</H2>

<P>
<P>Het booten van een <EM>Umsdos</EM> systeem vanaf een diskette is niet
anders dan het booten van een <EM>Ext2</EM> systeem. Je hebt een
juist ge&iuml;nitialiseerd zImage bestand nodig dat zich in je
root <EM>Umsdos</EM> partitie moet bevinden. Dit wordt gewoonlijk
bereikt door gebruik van de opdracht <CODE>rdev</CODE>. De volgende
reeks zal een zImage initialiseren en het op een diskette plaatsen.
<P>
<BLOCKQUOTE><CODE>
<PRE>
rdev zImage /dev/hda1
rdev -R zImage 0
dd if=zImage bs=8192 of=/dev/fd0
</PRE>
</CODE></BLOCKQUOTE>
<P>Als dit er verwarrend uitziet, formatteer dan gewoon een opstartbare
DOS-diskette en plaats hier de volgende componenten op:
<P>
<UL>
<LI>loadlin.exe</LI>
<LI>loadlinx.exe</LI>
<LI>zimage</LI>
</UL>
<P>en stel het autoexec.bat als volgt in
<P>
<BLOCKQUOTE><CODE>
<PRE>
loadlinx zimage rw root=C:
</PRE>
</CODE></BLOCKQUOTE>
<H2>5.3 LILO</H2>

<P>
<P>LILO, de offici&euml;le <EM>Linux</EM> bootloader kan ook worden
gebruikt voor het booten van een <EM>Umsdos</EM> systeem. 
Ik heb hier echter geen ervaring mee. Het zou vanaf versie
1.1.60 moeten werken. Mail me alsjeblieft als je hier iets
over weet.
<H2>5.4 Hoe een <EM>Umsdos</EM> partitie te defragmenteren</H2>

<P>
<P>Dit kan worden gedaan met ieder populair DOS hulpmiddel. Er
is niet speciaals aan een bestand dat door <EM>Umsdos</EM>
wordt geproduceerd. En <EM>Umsdos</EM> verwacht niet speciaals
(zoals een speciale directory layout, reeks directory-ingangen,
enz...) van het onderliggende bestandssysteem.
<P>Zover ik weet, bestaat hier geen <EM>Linux</EM> tool voor.
<H2>5.5 Geavanceerde truuks</H2>

<P><EM>Umsdos</EM> rekent op de <CODE>--linux-.---</CODE> welke afgaat op
de <EM>DOS</EM> directory. Een aantal gebruikers willen er wellicht
wat mee experimenteren.
Het utility <CODE>udosctl</CODE> als onderdeel van het umsdos_progs
package (met <CODE>umssync</CODE> en <CODE>umssetup</CODE>) maakt basisbewerkingen
op directory's mogelijk (weergeven, verwijdering) onafhankelijk
van de <CODE>--linux-.---</CODE> en de <EM>DOS</EM> directory.
<H2><A NAME="s6">6. Basisprincipe</A></H2>

<H2>6.1 Introductie</H2>

<P><EM>Umsdos</EM> deelt <EM>Linux</EM> bestanden direct in naar <EM>Ms-DOS</EM> 
bestanden. Dit is een &eacute;&eacute;n op &eacute;&eacute;n omzetting.
De bestandsinhoud wordt in het geheel niet gemanipuleerd.
<EM>Umsdos</EM> werkt alleen op namen. Voor speciale bestanden
(zoals bijvoorbeeld links en devices) introduceert het speciaal
beheer.
<P>Voor iedere directory is een bestand genaamd <CODE>--linux-.---</CODE>.
<P>
<H2>6.2 <EM>Umsdos</EM> kan het <EM>Ms-DOS</EM> bestandssysteem vervangen.</H2>

<P>
<P>Aan <EM>Umsdos</EM> kan worden gedacht als een voor een algemeen
doel bestemde superset van het
<EM>Ms-DOS</EM> bestandssysteem van linux. In feite verschaft
deze capaciteit of flexibiliteit veel verwarring over
<EM>Umsdos</EM>. Hier krijg je te zien waarom. Probeer als volgt een nieuw
geformatteerde <EM>DOS</EM> diskette te mounten:
<P>
<BLOCKQUOTE><CODE>
<PRE>
mount -t umsdos /dev/fd0 /mnt
</PRE>
</CODE></BLOCKQUOTE>
<P>En geef dan de volgende opdrachten:
<P>
<BLOCKQUOTE><CODE>
<PRE>
ls / >/mnt/LANGEBESTANDSNAAM
ls -l /mnt
</PRE>
</CODE></BLOCKQUOTE>
<P>Je krijgt het volgende resultaat
<P>
<BLOCKQUOTE><CODE>
<PRE>
-rwxr-xr-x   1 root     root          302 Apr 14 23:25 langebestandsnaam
</PRE>
</CODE></BLOCKQUOTE>
<P>Tot zover lijkt het erop dat het <EM>Umsdos</EM> bestandssysteem niet
meer doet (in feite zelfs helemaal niets) dan het gewone
<EM>Ms-DOS</EM> bestandssysteem van <EM>Linux</EM>.
<P><EM>???</EM>
<H2>6.3 Directory promotie</H2>

<P>
<P>Niet bepaald indrukwekkend tot dusverre. Dit is de truuk. Tenzij
gepromoot zal een
<EM>DOS</EM> directory met <EM>Umsdos</EM> op dezelfde wijze worden beheerd
als het <EM>Ms-DOS</EM> bestandssysteem. <EM>Umsdos</EM> maakt gebruik van
een speciaal bestand in iedere subdirectory om de omzetting tussen
de uitgebreide mogelijkheden (lange naam, eigenaarschap, enz)
van <EM>Umsdos</EM> en de beperking van het <EM>DOS</EM> bestandssysteem
te bereiken.
Dit bestand is voor <EM>Umsdos</EM> gebruikers onzichtbaar, maar zichtbaar
wanneer je <EM>DOS</EM> boot.
Om de <EM>DOS</EM>-partitie niet al te rommelig te maken met deze
nutteloze (<CODE>--linux-.---</CODE>), is dit bestand nu optioneel.
Als het afwezig is, gedraagt <EM>Umsdos</EM> zich net als <EM>Ms-DOS</EM>.
<P>Wanneer een directory wordt gepromoot, zullen daaropvolgende bewerkingen
worden uitgevoerd met de volledige semantiek normaal beschikbaar voor
<EM>Unix</EM> en <EM>Linux</EM> gebruikers. En alle subdirectory's die daarna
zullen worden aangemaakt zullen in stilte worden gepromoot.
<P>Deze faciliteit maakt het je mogelijk  je <EM>DOS</EM> partitie
logisch te organiseren in <EM>DOS</EM> zaken en <EM>Linux</EM>
zaken. Het is van belang te begrijpen
dat die <CODE>--linux-.---</CODE> bestanden wat ruimte innemen
(gewoonlijk 2k per directory). <EM>DOS</EM> maakt in het algemeen gebruik
van grote clusters (zo groot als 16k voor een 500meg partitie), 
dus het voorkomen dat overal <CODE>--linux-.---</CODE> wordt geplaatst, kan
je dag goed maken.
<H2>6.4 Hoe te promoten: <CODE>/sbin/umssync</CODE></H2>

<P>
<P>Een directory kan ten alle tijden worden gepromoot met <CODE>/sbin/umssync</CODE>.
Het kan ten alle tijden worden gebruikt. Doe voor het promoten van een
directory het volgende:
<P>
<UL>
<LI>Maak een <CODE>--linux-.---</CODE> aan.</LI>
<LI>Breng een &eacute;&eacute;n op &eacute;&eacute;n relatie tot
stand tussen de <CODE>--linux-.---</CODE> en de huidige inhoud van de 
directory.</LI>
</UL>
<P><CODE>/sbin/umssync</CODE> onderhoudt een bestaand <CODE>--linux-.---</CODE> bestand.
Het maakt het niet iedere keer opnieuw aan. Het voegt er gewoonweg
ontbrekende regels aan toe
(bestanden die zijn aangemaakt tijdens een <EM>DOS</EM> sessie).
Het zal ook de bestanden die niet meer voorkomen in de
<EM>DOS</EM> directory uit de <EM>--linux-.---</EM> verwijderen.
Daar komt de naam <CODE>umssync</CODE> vandaan.
Het synchroniseert <EM>--linux-.---</EM> met de onderliggende
<EM>DOS</EM> directory.
<H2>6.5 <CODE>/sbin/umssync</CODE> tijdens de systeemstart gebruiken</H2>

<P>Het is een goed idee een aanroep naar <CODE>/sbin/umssync</CODE>
aan het einde van /etc/rc.d/rc.S te plaatsen, als het er nog niet
instaat. De volgende opdracht is hier voor de meeste systemen goed voor:
<P>
<BLOCKQUOTE><CODE>
<PRE>
/sbin/umssync -r99 -c -i+ /
</PRE>
</CODE></BLOCKQUOTE>
<P>De <CODE>-c</CODE> optie voorkomt dat <CODE>umssync</CODE> directory's promoot.
Het zal alleen bestaande <CODE>--linux-.---</CODE> bijwerken.
<P>Deze opdracht is handig als je <EM>Linux</EM> directory's tijdens
een <EM>DOS</EM> sessie wilt benaderen. <EM>Linux</EM> heeft geen 
effici&euml;nte manier om aan te geven dat een directory is
gewijzigd door <EM>DOS</EM> en dus kan <EM>Umsdos</EM> 
<EM>umssync</EM> niet de benodigde bewerking laten uitvoeren.
<H2>6.6 Hoe te DE-promoten</H2>

<P>
<P>Verwijder het <CODE>--linux-.---</CODE> bestand met <EM>DOS</EM>. Je zult hier
spijt van krijgen.
<H2>6.7 Hoe zit het met bestanden aangemaakt tijdens een <EM>DOS</EM> sessie ?</H2>

<P>
<P>Tenzij je <CODE>umssync</CODE> toepast op een directory waaronder de
bestanden zijn toegevoegd of uit zijn verwijderd door
<EM>DOS</EM>, zal je een aantal problemen bemerken:
<P>
<UL>
<LI>Het zal het systeem niet doen vastlopen en het zorgt
ook niet voor belangrijke problemen, alleen ergernis :-)</LI>
<LI>Bestanden aangemaakt door <EM>DOS</EM>.

<UL>
<LI>Ze zullen onder <EM>Linux</EM> niet zichtbaar zijn.</LI>
<LI>Wanneer je een bestand met dezelfde naam probeert
aan te maken, krijg je een foutmelding waarin staat dat
het bestand reeds voorkomt.</LI>
<LI>Dit zorgt eerder voor verwarring dan dat het een
echt probleem is. Het kan geen kwaad voor het bestandssysteem.</LI>
</UL>
</LI>
<LI>Bestanden verwijderd door <EM>DOS</EM> veroorzaken geen problemen. 
<EM>Umsdos</EM> merkt de afwezigheid de eerste keer op. Er zal een
melding worden weergegeven naar standaarduitvoer (en deze wordt
gewoonlijk weggeschreven naar <CODE>/var/adm/syslog</CODE>).</LI>
</UL>
<H2><A NAME="s7">7. Installatie/DE-installatie en een aantal truuks</A></H2>

<P>De installatie van <EM>Umsdos</EM> is niet veel anders als de
installatie van een doodgewoon <EM>Linux</EM> systeem (gebaseerd
op <EM>Ext2</EM>).
<P>Er zijn twee belangrijke verschillen.
<H2>7.1 De pseudo-root <CODE>/mnt/linux</CODE></H2>

<P>De normale stappen voor een installatie bestaan uit:
<P>
<OL>
<LI>Het instellen van een partitie met fdisk en het formatteren ervan.</LI>
<LI>Het mounten als /mnt relatief aan je installatie rootdisk.</LI>
<LI>Het kopi&euml;ren van alle packages naar <CODE>/mnt</CODE>.</LI>
</OL>
<P>Met <EM>Umsdos</EM>, is stap 1 niet vereist (was het doen van
<EM>Umsdos</EM> niet een herformattering uit te voeren ?).
<P>Het is mogelijk een <EM>Umsdos</EM> systeem te installeren door
gewoon alle packages naar <CODE>/mnt</CODE> te kopi&euml;ren. Dit zal
zeker werken. Maar er zullen een boel subdirectory's op je
<EM>DOS</EM> rootdirectory (C:) worden aangemaakt wat je vast
niet prettig vindt. Dit is de reden dat alle <EM>Umsdos</EM>
installaties gebruik maken van de pseudo-root. En dit is het
belangrijkste verschil tussen een gewone <EM>Ext2</EM> installatie
en een <EM>Umsdos</EM> installatie: alle bestanden worden 
gekopieerd naar <CODE>/mnt/linux</CODE>.
<H2>7.2 Prepareren van <CODE>/mnt/linux</CODE></H2>

<P><CODE>/mnt/linux</CODE> is geen gewone directory. Het moet zijn
gepromoot zodat het correct
de lange bestandsnamen en speciale bestanden (links, device) van
<EM>Linux</EM> af zal handelen. De stappen die nodig zijn om
<CODE>/mnt/linux</CODE> in te stellen zijn:
<P>
<OL>
<LI><CODE>mkdir /mnt/linux</CODE></LI>
<LI><CODE>umssync /mnt/linux</CODE></LI>
</OL>
<P>Dat was het!
<H2>7.3 Verzeker je ervan dat <CODE>/mnt/linux</CODE> correct is ingesteld</H2>

<P>Zelfs al is de setup van <CODE>/mnt/linux</CODE> tamelijk simpel, toch zijn
er nog veel installatiepackages waarbij het fout gaat. Hoe
kan dit?
<P>Het grootste installatieprobleem is afkomstig van een incompatibel
<CODE>umssync</CODE> programma. <EM>Umsdos</EM> is in linux 1.1.88 bijgewerkt
(kan het me niet precies herinneren) en in <CODE>umssync</CODE> bleef
een fout onontdekt. Om in de <EM>Linux</EM> gemeenschap verwarring
te voorkomen, werd besloten het compatibiliteiten niveau vereist
voor alle <EM>Umsdos</EM> tools te verhogen. Oude versies van de
tools werden eenvoudigweg verworpen.
<P>Het lijkt erop dat veel distributies de <CODE>umssync</CODE> utility
op de installatiedisk niet bijwerkte.
<P>Er zijn nog steeds veel van dergelijke distributies in omloop. 
Het uiteindelijke resultaat is dat de directory 
<CODE>/mnt/linux</CODE> helemaal niet is gepromoot
en alle lange bestandsnamen af zal kappen en alle speciale bestanden
zal verwerpen.
<P>Het is mogelijk in een zeer vroeg beginstadium van de installatie
een test uit te voeren om erachter te komen of er iets fout ging.
Dankzij het pseudo console mechanisme van <EM>Linux</EM>, kun je dat
doen zonder het installatieprogramma te verlaten. Voer de 
volgende stapppen uit:
<P>
<OL>
<LI>Druk op <CODE>Alt-F2</CODE> (<CODE>Alt</CODE> toets tegelijkertijd
indrukken met de <CODE>F2</CODE> toets).</LI>
<LI>login als root.</LI>
<LI><CODE>cd /mnt/linux</CODE>

Als dit niet lukt, probeer je het te vroeg. Een goed moment
is dit aan het einde van de packages selectie te doen.</LI>
<LI><CODE>>TOTO</CODE></LI>
<LI><CODE>ls -l</CODE>

Je zou een leeg bestand <CODE>TOTO</CODE> in hoofdletters te zien moeten
krijgen. Als je het in kleine letters ziet, dan is er iets mis.
Probeer nogmaals de <CODE>umssync</CODE> stap. <CODE>umssync</CODE> kan 
zonder probleem meerdere malen worden gebruikt.

<CODE>umssync .</CODE>

Probeer nogmaals de <CODE>TOTO</CODE> test, als er geen foutmelding
verschijnt. Als <CODE>TOTO</CODE> prima lijkt, dan is alles OK. 
Als er iets niet goed is aan de installatie, sla je het op.
en gaat verder</LI>
<LI>Druk op <CODE>Alt-F1</CODE> om terug naar het installatiescherm
te gaan.</LI>
</OL>
<P>Als de test mislukt, dan bestaat de beste correctie hieruit een
nieuwere installatie rootdisk op te halen. Je kunt deze rootdisk
over het algemeen corrigeren door een nieuwere versie van <CODE>umssync</CODE>
te installeren. Dit is niet moeilijk maar het vereist een werkend
<EM>Linux</EM> systeem. Je hoeft slechts de rootdisk diskette te mounten
en het geleverde <CODE>umssync</CODE> door een nieuwe te vervangen.
<H2>7.4 Oops releasing pseudo root ...</H2>

<P>De meeste <EM>Umsdos</EM> installaties die niet lukken, drukken
deze vreemde melding af. Dit is geen bug in
<EM>Umsdos</EM> ook al ziet de melding er wat vreemd uit.
Hier zijn de bekende oorzaken:
<P>
<UL>
<LI>Het meest gebruikelijke
De <EM>Slackware</EM> installatie probeert in het beginstadium
van de installatie een swapbestand in te stellen. Dit doet
het door je te vragen een partitie te selecteren (dos drive),
deze dan te mounten en het swapbestand in te stellen.

Bij het installeren van een <EM>Slackware</EM> systeem, moet je
voor het installeren een doelpartitie instellen. Dit zorgt
er normaal gesproken voor dat de <EM>DOS</EM> partitie op
<CODE>/mnt</CODE> wordt gemount, de <CODE>/mnt/linux</CODE> directory
wordt aangemaakt en <CODE>umssync</CODE> erop toepast.

Hier komen de meeste problemen vandaan. De meeste gebruikers
vergeten gewoon de stap "setup target partition" en gaan direct
naar de rest van de installatie. Aangezien <CODE>/mnt</CODE> reeds
is gemount, wordt deze fout niet opgemerkt.
Dit betekent dat <CODE>/mnt/linux</CODE> niet goed werd
aangemaakt (niet gepromoot). Alle speciale
bestanden en links en lange namen kunnen niet op de
juiste wijze worden aangemaakt.</LI>
<LI>Invalid umssync utility
<CODE>/mnt/linux</CODE> werd niet juist ingesteld. In het algemeen
veroorzaakt door een onjuist <CODE>umssync</CODE> utility op de
installatie rootdisk.</LI>
<LI>Oude bug in umsdos
Voor <EM>Linux 1.2.2</EM> zat er in <EM>Umsdos</EM> een bug.
De pseudo-root modus werd niet goed geactiveerd als het bestand
<CODE>/etc/init</CODE> ontbrak. <CODE>init</CODE> is nu te vinden in
<CODE>/sbin</CODE>. Je kunt het corrigeren door een nieuwere kernel
op te halen. Dit is aan te bevelen omdat een andere bug niet
aan de oppervlakte was gekomen en deze dus in
1.2.2 niet werd gecorrigeerd.

Als je niet kunt upgraden, doe je het volgende:

<OL>
<LI>Boot vanaf je installatie-disk.</LI>
<LI>Login als root.</LI>
<LI><CODE>mount -t umsdos /dev/hdXX /mnt</CODE>
<CODE>/dev/hdXX</CODE> is hier je <EM>DOS</EM> partitie.</LI>
<LI><CODE>cd /mnt/linux/etc</CODE></LI>
<LI><CODE>ln -s ../sbin/init init</CODE></LI>
<LI><CODE>cd /</CODE></LI>
<LI><CODE>Ctrl-Alt-Del</CODE></LI>
<LI>Boot je <EM>Umsdos</EM> zoals gewoonlijk</LI>
</OL>
</LI>
</UL>
<P>Helaas produceren de eerste twee (installatieproblemen) een compleet
onbruikbare installatie. De-installeer het (Zie de volgende sectie) en
installeer het opnieuw.
<H2>7.5 Hoe een <EM>Umsdos</EM> te de-installeren</H2>

<P>Het aardige van <EM>Umsdos</EM> en zijn pseudo-root mechanisme is
dat je het zonder moeite kunt DE-installeren. Je boot gewoon
<EM>DOS</EM> en verwijdert de <CODE>linux</CODE>
directory met de daaronderliggende directory's. Dat is alles.
Voor <EM>Umsdos</EM> zijn geen speciale drivers in config.sys nodig,
noch maakt het iets speciaals aan buiten de <CODE>linux</CODE> directory.
<H2>7.6 Een <EM>Umsdos</EM> systeem naar een andere <EM>DOS</EM> drive verplaatsen</H2>

<P>Dit kan worden gedaan vanuit <EM>Linux</EM> of vanuit <EM>DOS</EM>.
Je hoeft hiervoor alleen de <CODE>linux</CODE> directory van de
ene drive naar de andere recursief te kopi&euml;ren.
Daarna zul je het bootmechanisme aan moeten passen (gewoonlijk
de loadlin opdracht) en het bestand <CODE>/etc/fstab</CODE>.
<P><EM>Umsdos</EM> kan bestaan op iedere <EM>DOS</EM> drive. Het is niet
nodig het op de <CODE>C:</CODE> drive te installeren, noch is het belangrijk
dat op de eerste harddrive te hebben. Het doet er in het geheel niet
toe.
<P>In feite kun je besluiten verscheidene
<EM>Umsdos</EM> installaties te hebben op verschillende drives
om er bijvoorbeeld mee te experimenteren.
<H2>7.7 Over het installeren van 50 <EM>Umsdos</EM> systemen.</H2>

<P>Hoe zit het met het installeren van een boel <EM>Linux</EM> systemen in
zo min mogelijk tijd?
<P><EM>Umsdos</EM> systemen leven in een <EM>DOS</EM> wereld. Je kunt
hier voordeel uit behalen als je <EM>Linux</EM> op
eenvoudige wijze wilt installeren.
<P>Je kunt een <EM>Umsdos</EM> systeem op je site installeren 
en configureren. Wanneer je tevreden bent met de configuratie
en de verschillende packages die je hebt ge&iuml;nstalleerd,
kun je in <EM>DOS</EM> booten en de complete <CODE>linux</CODE>
directory naar de <EM>DOS</EM> file server kopi&euml;ren.
Dan ga je naar een ander <EM>DOS</EM> station en kopieert eenvoudigweg
de bestanden vanaf de netwerkdrive naar de lokale drive.
Dat is alles. Pas slechts het bootscript (<EM>Loadlinx</EM>) aan.
<P>Met minimale aanpassingen (hostnaam, ip-nummer) is iedereen
in staat in een kwestie van minuten een <EM>Linux</EM> systeem te
installeren.
<P>Ge&iuml;nteresseerde lezers merken wellicht op dat het installeren
van <EM>Linux</EM> systemen door het kopi&euml;ren van het draaiende
systeem ook werkt voor ieder ander <EM>Linux</EM> systeem, waaronder
die gebaseerd op <EM>Ext2</EM>.
<P>Het mooie van <EM>Linux</EM> is dat er geem verborgen bestanden zijn
die moeten worden ge&iuml;nstalleerd door het magische 
installatieprogramma.
<H2><A NAME="s8">8. Instellen van een <EM>Linux</EM> sectie op een <EM>DOS</EM> partitie</A></H2>

<P><EM>Umsdos</EM> heeft zelfs nut voor <EM>Ext2</EM> (het bij <EM>Linux</EM>
behorende bestandssysteem) gebruikers. Een gebruikelijk scenario
is het volgende:
<P>
<UL>
<LI><EM>Linux</EM> als keuze van je <EM>OS</EM>, begint de <EM>Linux</EM>
partitie al voller, voller en voller te geraken.</LI>
<LI>Je <EM>DOS</EM> partitie wordt wat stoffig, en is half leeg.</LI>
<LI>Je komt plotseling ruimte te kort op je <EM>Ext2</EM> partitie.</LI>
<LI>Je bent er nog steeds niet zeker van of je van <EM>DOS</EM> af wilt.</LI>
</UL>
<P><EM>Umsdos</EM> kan hier je dag goedmaken. Je kunt een <EM>Linux</EM>
directory in de <EM>DOS</EM> partitie aanmaken en dit zonder beperkingen
gebruiken voor <EM>Linux</EM>. Stel bijvoorbeeld dat je een nieuwe 
directory genaamd <CODE>"extra"</CODE> op de <CODE>C:</CODE> drive wilt. En je
wilt dat deze directory zich gedraagt als een gewone
<EM>Linux</EM> directory. Doe dan dit
(in de veronderstelling dat C: /dev/hda1 is).
<P>
<BLOCKQUOTE><CODE>
<PRE>
mkdir /c
/sbin/mount -t umsdos /dev/hda1 /c
mkdir /c/extra
umssync /c/extra
</PRE>
</CODE></BLOCKQUOTE>
<P>Je moet hier root voor zijn.
<P>Door <CODE>/etc/fstab</CODE> zo in te stellen, zul je altijd
toegang hebben tot de <CODE>/c/extra</CODE> directory.
<H2><A NAME="s9">9. UMSDOS Waarom</A></H2>

<P>Uitleggen hoe een <EM>Umsdos</EM> te installeren of ermee
om te gaan is niet voldoende. De meeste mensen zijn op zoek naar advies
of ze <EM>Umsdos</EM> wel of niet zullen gebruiken.
<H2>9.1 Het doel van <EM>Umsdos</EM></H2>

<P>Het doel van <EM>Umsdos</EM> was de installatie van <EM>Linux</EM>
te vereenvoudigen. Een ander doel was de de-installatie ervan
makkelijker te maken. De gedachte erachter was het verspreiden van
<EM>Linux</EM> te promoten. Het installeren van een nieuw OS op
een systeem is altijd lastig. <EM>OS/2</EM> bijvoorbeeld zal met
veel plezier je <CODE>C:</CODE> root met een boel nieuwe directory's
vervuilen. Als je net zo slim bent als ik, zal het
je config.sys en autoexec.bat bestanden ook verwijderen. :-(
<P>De pseudo-root faciliteit van <EM>Umsdos</EM> voorkomt deze ongewenste
handeling. <EM>Linux</EM> kan zonder neveneffect worden gede&iuml;nstalleerd.
<H2>9.2 Wie heeft het nodig</H2>

<P>Als je een kleine harddrive hebt, zal <EM>Umsdos</EM> het je mogelijk
maken diskruimte tussen <EM>DOS</EM> en <EM>Linux</EM> te delen. Een disk
onder de 300 megs in naar mijn mening een kleine disk. Deze mening
is gebaseerd op de grootte van de tegenwoordig beschikbare packages.
Een populaire tekstverwerker kan wel 70 megabytes aan ruimte innemen 
als je alle mogelijkheden selecteert.
<P>Als je een grotere drive hebt, kun je een <EM>Linux</EM>
partitie met het <EM>Ext2</EM> in overweging nemen.
<EM>Ext2</EM> maakt gebruik van een kleinere clustergrootte dan
<EM>DOS</EM> (1k) dus het installeren van veel kleine bestanden
vraagt om minder ruimte dan op een <EM>Umsdos</EM> partitie.
<H2>9.3 Performance</H2>

<P>Het volgende geldt voor <EM>Umsdos</EM> in vergelijking met <EM>Ext2</EM>.
<P>
<UL>
<LI>Directorybeheer is sneller op <EM>Ext2</EM>. Dit komt door de
overhead van de dubbele directorystructuur van 
<EM>Umsdos</EM>.</LI>
<LI>Bestandstoegang (lezen en schrijven) is waarschijnlijk sneller
op <EM>Umsdos</EM> dan <EM>Ext2</EM>. Dit komt door de eenvoud van het
<EM>FAT</EM> bestandssysteem dat door <EM>DOS</EM> in gebruik is.

Deze eenvoud heeft een prijs:</LI>
<LI>Een maximum van ongeveer 65,000 bestanden of clusters
per partitie. Dit betekent ook dat een partitie van 500 megabyte
clustergroottes van 16K gebruikt. Met andere woorden, een
bestand met een enkele byte zal gebruik maken van 16k aan
diskruimte.</LI>
<LI>Alles wordt beheerd door de <CODE>FAT</CODE>, te vinden
aan het begin van de harddrive. Het <EM>DOS</EM> bestandssysteem is
hierom waarschijnlijk kwetsbaarder.</LI>
<LI>Er is geen voorziening getroffen om fragmentatie van
bestanden te voorkomen.  Een
<EM>Umsdos</EM> systeem zal gewoonlijk worden gebruikt als
een werkstation voor een enkele gebruiker. In dit geval
maakt het niet veel uit.  Als een multi-user engine, zullen
bestanden over heel de drive worden verspreid,
wat de performance van de bestandstoegang verlaagt.</LI>
<LI>Symbolische links worden in een gewoon bestand opgeslagen.
Als je van plan bent hier veel gebruik van te maken, zul je
bemerken dat <EM>Umsdos</EM> in vergelijking met <EM>Ext2</EM>
hier nogal veel diskruimte voor gebruikt.</LI>
</UL>
</BODY>
</HTML>
