<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>De USB HOWTO</TITLE>


</HEAD>
<BODY>
<H1>De USB HOWTO</H1>

<H2>Martijn de Meulder, <CODE>
<A HREF="mailto:martijn@creativeminds.nl">martijn@creativeminds.nl</A></CODE></H2>v1.1, 26 augustus 1999
<P><HR>
<EM>  Hoe USB apparatuur aansluiten onder Linux ?
 </EM>
<HR>
<H2><A NAME="s1">1. Introductie</A></H2>

<H2>1.1 Waarom dit document</H2>

<P>Nergens op het internet kon ik goede documentatie vinden over het toevoegen
van zoiets eenvoudigs als een USB-muis aan Linux. Hiermee vul ik voor het
Nederlandse taalgebied het hiaat op.
<H2>1.2 Wat is dit document (niet)?</H2>

<P>Met dit document kun je in ieder geval je USB muis aan de gang krijgen
onder Linux, waarschijnlijk geldt exact dezelfde procedure ook voor USB
toetsenborden en in een later stadium ook voor videocamera's en 
audio-apparatuur. Ik heb de andere apparatuur (nog) niet getest maar gezien
de eenvoud van USB moet dat op de beschreven manier ook lukken.
<P>
<P>Dit document is geen offici&euml;le HOWTO. Het is niet in SGML geschreven
en niet in andere formaten dan HTML verkrijgbaar. Omdat het voor 
eindgebruikers is, voor iedereen die er aardigheid in heeft met Linux te 
werken. De meer technisch begaafden onder ons zullen misschien vinden dat het
niet diep genoeg gaat, maar zo is dit document niet bedoeld. Het legt in
begrijpelijke taal en in een paar stappen uit hoe je eenvoudige USB 
randapparatuur aan de gang kunt krijgen.
<P>
<P>Natuurlijk nodig ik iedereen uit extra informatie aan te leveren en eventuele
onvolkomenheden te corrigeren. Deze handleiding is ontstaan op het moment dat
USB nog niet officieel onder Linux beschikbaar was. Het de bedoeling dat het
in de loop der tijd uitgroeit tot een installatiehandleiding voor alle USB
apparatuur onder Linux. Ik zal mijn uiterste best doen zoveel mogelijk USB
apparatuur te testen. Nogmaals: ik stel bijdragen van jou als lezer/gebruiker
zeer op prijs!
<H2>1.3 Voor wie is deze handleiding bedoeld?</H2>

<P>Dit document is voor iedereen met enige Linuxervaring die USB apparatuur
wil aansluiten. 'Enige Linuxervaring' betekent in dit verband: 'in staat
zijn de kernel te compileren en niet bang zijn om met teksteditors 
configuratiebestandjes te bewerken'.
<H2><A NAME="s2">2. Het aansluiten van een USB-muis</A></H2>

<H2>2.1 Vereiste hardware</H2>

<P>USB is een standaardprotocol, het zou op iedere computer exact gelijk moeten
zijn. Een moderne computer met USB aansluiting is dus de enige hardware-eis.
Deze uitleg is gebaseerd op ervaringen met twee klonen: AMD K6-200 en K6-2 
450, respectievelijk op een Aopen AP5t-3 en een Asus P5A-B moederbord en 
losgekochte USB-brackets. De gebruikte muis is een Logitech Mouseman(+) 
Wheel.
<P>
<P>Iedere kloon en A-merkcomputer die probleemloos Linux draait zou USB dus even
probleemloos moeten kunnen implementeren.
<H2>2.2 Vereiste software</H2>

<P>Linux 2.2.8 of hoger en alle software die nodig is om de kernel te kunnen
hercompileren. Exacte informatie daarover vind je in de 
<A HREF="http://howto.linuxberg.com/LDP/HOWTO/Kernel-HOWTO.html">Kernel HOWTO</A>. 
Over het algemeen bieden moderne distributies alle software die je nodig
hebt. Dus daarover hoef je je waarschijnlijk niet veel zorgen te maken.
<H2>2.3 De USB-code in de kernel</H2>

<P>Om USB onder Linux te gebruiken moet je de stuurprogramma's in de kernel
compileren of via een module aanmaken. In deze uitleg ga ik ervan uit dat
je de code in de kernel compileert. Meer informatie over het compileren
van de kernel of de modules vind je in de 
<A HREF="http://howto.linuxberg.com/LDP/HOWTO/Kernel-HOWTO.html">Kernel HOWTO</A>.
<P>
<P>Zorg voor een nieuwe kernelbroncode, 2.2.8 of hoger. Hoe hoger hoe beter want
hoe meer keuze in USB-apparatuur en hoe stabieler de USB-ondersteuning). Je 
kunt de kernelbroncode downloaden vanaf 
<A HREF="ftp://www.nl.linux.org/pub/linux/kernel/">ftp://www.nl.linux.org/pub/linux/kernel/</A>
of 
<A HREF="http://www.nl.kernel.org/pub/linux/kernel/">http://www.nl.kernel.org/pub/linux/kernel/</A><P>
<P><EM>Decomprimeer</EM> en <EM>untar</EM> die broncode op de normale manier.
Tik dan in:
<PRE>
        cd /usr/src/linux/arch/i386/
  
</PRE>

Open het bestand
<PRE>
        config.in
  
</PRE>

met een teksteditor(bijvoorbeeld met <EM>Jed</EM>, <EM>Pico</EM> of
<EM>Vi</EM>) zoek de regel
<PRE>
        # source drivers/usb/Config.in
  
</PRE>

(plusminus regelnummer 172) haal het
Hash-teken (#) weg sluit de editor af en ga terug naar de broncode-root
<PRE>
  
        cd /usr/src/linux
  
</PRE>

in de development kernels (2.3.x) hoef je de regel in <EM>config.in</EM> niet
meer te wijzigen, het USB-selectievenster is daarin standaard zichtbaar.
<H2>2.4 De kernel opnieuw configureren</H2>

<P>Configureer de kernel op de bekende manier, met 
<PRE>
        make config
  
</PRE>

of
<PRE>
        make menuconfig
  
</PRE>

of
<PRE>
        make xconfig
  
</PRE>

Je ziet dat er een menu-item in het configuratiemenu is bijgekomen:
<EM>'USB drivers - not for the faint at heart'</EM>
<P>Selecteer in dat menu daar in ieder geval het bovenste regeltje <EM>Support
for USB (EXPERIMENTAL), </EM>en <EM>UHCI (intel PIIX4 and others)</EM>. En
natuurlijk het regeltje <EM>USB mouse support</EM> en/of <EM>USB keyboard
support</EM>. Als je een USB-hub gebruikt, selecteer dan ook de twee <EM>OHCI
virtual root Hub</EM> instellingen.
<P>Meer hoeft niet (behalve als je een Compaq hebt, maar dat wijst zich vanzelf
uit)
<P>
<P>Zorg dat je de rest van de instellingen ook aan je systeem aanpast, sluit het
configuratieprogramma af en compileer de nieuwe kernel op de gebruikelijke
wijze. Na het compileren moet je natuurlijk het gemaakte kernel-image naar
<EM>/boot/</EM> kopi&euml;ren (of <CODE>make install</CODE> draaien).  Daarna
moet je <EM>lilo.conf</EM> aanpassen en 
<PRE>
        lilo
  
</PRE>

draaien.
<H2>2.5 Device usbmouse aanmaken</H2>

<P>Maak dan een device usbmouse aan. 
<PRE>
        cd /dev
  
</PRE>

en tik in:
<PRE>
        mknod usbmouse c 10 32
  
</PRE>

In de development kernels kun je in plaats daarvan ook gebruik maken van
<EM>/dev/psaux</EM> of een speciaal USB-device aanmaken. Deze features zullen
later ook in de stabiele kernel worden opgenomen.
<P>
<P>Nu is het installatieproces afgerond. Zorg ervoor dat je een reddingsdiskette
hebt met een oudere kernel, voor als er iets is misgegaan met de nieuwe
kernel. Ik ga ervan uit dat je vaker een kernel hebt gecompileerd en niet
meer in dit soort valkuilen trapt!
<P>
<P>Herstart de computer, tijdens het opstarten zie je de USB berichten al
voorbij komen, eventueel kun je die later aan de prompt nakijken met
<PRE>
        dmesg | less
  
</PRE>
<H2>2.6 Software bijwerken: GPM en X windows</H2>

<P>Als de computer normaal is opgestart, is het installatieproces afgerond.
<P>
<P>Wil je de muis onder de prompt en consoleprogramma's gebruiken via <EM>gpm</EM>
tik dan in: 
<PRE>
        gpm -3 m /dev/usbmouse -t ps2 -R
  
</PRE>

Je kunt eventueel de installatie van de muis testen met 
<PRE>
        mouse-test
  
</PRE>

(of je doet dat met <EM>/dev/psaux</EM>, dat ligt eraan hoe je hebt gekozen
met compileren) Als alles goed is vindt dat programma <EM>/dev/usbmouse</EM>
als mogelijke muispoort.
<P>
<P>voor gebruik onder X Windows pas je <EM>/etc/XF86Config</EM> aan In de 
<EM>Pointer</EM> sectie wijzig je met een editor de volgende waarden:
<PRE>
        Section "Pointer"
                Protocol        "PS/2"
                Device          "/dev/usbmouse"
  
</PRE>

Sluit de editor en start X Windows. Zie dat het werkt! Denk er wel aan
dat gelijktijdig GPM en X gebruiken tot conflicten kan leiden, schakel
als je GPM hebt draaien - voor je X Windows start - GPM uit met 
<PRE>
        gpm -k
  
</PRE>
<H2><A NAME="s3">3. Bronnen</A></H2>

<H2>3.1 Technische informatie</H2>

<P>Dit document is zoals je hebt gemerkt een praktische handleiding voor het
installeren van USB apparaten onder Linux. Heb je behoefte aan diepere
informatie, dan kun je onder meer terecht bij de volgende sites:
<P>
<P>Het eerste USB project (Uusbd) van 
<A HREF="http://peloncho.fis.ucm.es/~inaky/USB/">I&ntilde;aky P&eacute;rez Gonz&aacute;lez</A><P>
<P>Kernel traffic, de wekelijkse online Kernel nieuwsbrief waarin ook de
nieuwste Linux-USB ontwikkelingen worden doorgenomen:
<P>
<P>
<A HREF="http://www.kt.opensrc.org/">http://www.kt.opensrc.org/</A><P>Cutting Edge Linux, met de nieuwste changelogs:
<P>
<P>
<A HREF="http://edge.kernelnotes.org/">http://edge.kernelnotes.org/</A><H2>3.2 USB in het algemeen</H2>

<P>De centrale site (algemene) rond USB is
<P>
<A HREF="http://www.usb.org">http://www.usb.org</A><P>Daar vind je veel hyperlinks naar relevante informatie.
<H2>3.3 Linux-USB discussies</H2>

<P>Er zijn nog geen Linux USB-nieuwsgroepen, wel een algemene hardware
nieuwsgroep:
<P> 
<A HREF="news://comp.os.linux.hardware">news://comp.os.linux.hardware</A><P> 
Natuurlijk kun je ook terecht bij de algemene Nederlandse nieuwsgroep:
<P>
<A HREF="news://nl.comp.os.linux">news://nl.comp.os.linux</A><P> 
Ook een zoektocht bij dejanews kan bruikbare informatie opleveren:
<P> 
<A HREF="http://www.deja.com">http://www.deja.com</A><H2><A NAME="s4">4. Feedback en disclaimer</A></H2>

<H2>4.1 Feedback</H2>

<P>Heb je opmerkingen over de inhoud van dit document stuur dan een e-mail
naar 
<A HREF="mailto:martijn@creativeminds.nl">martijn@creativeminds.nl</A><P>Als je zelf ervaring hebt met het aansluiten van muizen of andere USB
apparatuur onder Linux, dan stel ik het ook zeer op prijs als je contact
met me opneemt zodat we dit document completer kunnen maken en uitbreiden
met handleidingen voor andere apparatuur.
<H2>4.2 Disclaimer</H2>

<P>Voor zover er handelsmerken zijn gebruikt in dit document: ze zijn in handen
van hun eigenaren. Er is geen garantie voor de informatie in dit document.
Je mag het gebruiken, verspreiden, en vrij herproduceren, op voorwaarde
dat je deze copyright vermelding niet wijzigt of verwijdert, het versienummer
en de datum niet aanpast en de verwijzing naar de huidige WWW versie van
dit document niet wijzigt of verwijdert. Die versie is: 
<A HREF="http://www.creativeminds.nl/linux/USB-uitleg-nl.html">http://www.creativeminds.nl/linux/USB-uitleg-nl.html</A>
Als je iets verandert moet je duidelijk aangeven dat het om een gewijzigde
versie gaat.
</BODY>
</HTML>
