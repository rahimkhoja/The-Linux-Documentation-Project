<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML
><HEAD
><TITLE
>( SAMBA ) - Microsoft File and Print Sharing and Microsoft Domain clients 
don't work through IP Masq!</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="Linux IP Masquerade HOWTO"
HREF="index.html"><LINK
REL="UP"
TITLE="Frequently Asked Questions"
HREF="faq.html"><LINK
REL="PREVIOUS"
TITLE="( SETSOCKOPT ) - I'm getting &#34;ipfwadm: setsockopt failed: Protocol not 
available&#34; when I try to use IPPORTFW! "
HREF="setsockopt.html"><LINK
REL="NEXT"
TITLE="( IDENT ) - IRC won't work properly for MASQed IRC users.  Why?"
HREF="ident.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Linux IP Masquerade HOWTO</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="setsockopt.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 7. Frequently Asked Questions</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="ident.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="SAMBA"
></A
>7.25. ( SAMBA ) - Microsoft File and Print Sharing and Microsoft Domain clients 
don't work through IP Masq!</H1
><P
> To properly support Microsoft's SMB protocol, an IP 
Masq module would need to be written but there are three viable work-arounds.
For more details, please see 
<A
HREF="http://support.microsoft.com/default.aspx?scid=kb;en-us;172227"
TARGET="_top"
>this Microsoft KnowledgeBase article</A
>.</P
><P
>The first way to work around this problem is to configure IPPORTFW from 
<A
HREF="forwarders.html"
>Section 6.7</A
> and portfw TCP ports 137, 138, and 139 to the 
internal Windows machine's IP address.  Though this solution works, it would 
only work for ONE internal machine.</P
><P
>The second solution is to install and configure 
<A
HREF="http://www.samba.org"
TARGET="_top"
>Samba</A
> on the Linux MASQ server.  
With Samba running, you can then map your internal Windows File and Print 
shares onto the Samba server.  Then, you can mount these newly mounted SMB 
shares to all of your external clients.  Configuring Samba is fully covered 
in a HOWTO found in a Linux Documentation Project and in the TrinityOS document 
as well.</P
><P
>The third solution is to configure a VPN (virtual private network) between the 
two Windows machines or between the two networks.  This can either be done via 
the PPTP or IPSEC VPN solutions.  There is a <A
HREF="vpns.html"
>Section 7.35</A
> patch for 
Linux and also a full IPSEC implementation available for both 2.0.x and 2.2.x 
kernels.  This solution would probably be the most reliable and secure method 
of all three solutions.</P
><P
>All of these solutions are NOT covered by this HOWTO.  I recommend that you 
look at the TrinityOS documentation for IPSEC help and John Hardin's PPTP 
page for more information.</P
><P
><STRONG
>Also PLEASE understand that Microsoft's SMB protocol 
is VERY insecure.  Because of this, running either Microsoft File and Print 
sharing or Windows Domain login traffic over the Internet without any encryption 
is a VERY BAD idea.</STRONG
></P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="setsockopt.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="ident.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>( SETSOCKOPT ) - I'm getting "ipfwadm: setsockopt failed: Protocol not 
available" when I try to use IPPORTFW!</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="faq.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>( IDENT ) - IRC won't work properly for MASQed IRC users.  Why?</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>