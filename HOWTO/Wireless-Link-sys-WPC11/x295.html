<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML
><HEAD
><TITLE
>Using make-kpkg to build the new kernel and pcmcia-source modules</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="Link-sys WPC11 Mini-HOWTO"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Building PCMCIA-SOURCE"
HREF="x284.html"><LINK
REL="NEXT"
TITLE="Wlan Drivers for You Link-Sys Card"
HREF="x328.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Link-sys WPC11 Mini-HOWTO</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x284.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x328.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN295"
></A
>6. Using make-kpkg to build the new kernel and pcmcia-source modules</H1
><P
>Steps to build the kernel</P
><P
></P
><UL
><LI
><P
>Be sure the pcmcia-source is under /usr/src/modules.</P
></LI
><LI
><P
>Go ahead and configure your kernel and be sure that pcmcia support IS NOT compiled in as an option in the kernel.</P
></LI
><LI
><P
>To build the kernel and pcmcia-source, be sure you are under the <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>/usr/src/linux</PRE
></FONT
></TD
></TR
></TABLE
> or have a symbolic link from /usr/src/linux pointing to whatever kernel source you have set up.</P
></LI
><LI
><P
>Type <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>make-kpkg clean</PRE
></FONT
></TD
></TR
></TABLE
> to clean</P
></LI
><LI
><P
>Then type <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>make-kpkg --revision=custom.1.0 kernel_image modules_image</PRE
></FONT
></TD
></TR
></TABLE
></P
></LI
></UL
><P
>The <EM
>kernel_image</EM
> option will build the kernel while the <EM
>modules_image</EM
> option will build all modules located under <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>/usr/src/modules/</PRE
></FONT
></TD
></TR
></TABLE
>. So be sure that you do indeed want to rebuild any other modules that are located in source when you are ready to build your new kernel.</P
><P
>After some chugging, go up one level to <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>/usr/src</PRE
></FONT
></TD
></TR
></TABLE
> and you should see two new Debian packages that should look something like this:
<P
CLASS="LITERALLAYOUT"
>kernel-image-2.4.19-pre4_custom.1.0_i386.deb<br>
pcmcia-modules-2.4.19-pre4_3.1.31-7+custom.1.0_i386.deb</P
></P
><P
>You first want to install the kernel image so you would type <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>dpkg -i kernel-image-etc....</PRE
></FONT
></TD
></TR
></TABLE
></P
><P
>Now install the modules by typing <TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>dpkg -i pcmcia-modules.etc...</PRE
></FONT
></TD
></TR
></TABLE
></P
><DIV
CLASS="CAUTION"
><P
></P
><TABLE
CLASS="CAUTION"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/caution.gif"
HSPACE="5"
ALT="Caution"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>There are a couple of assumptions that make-kpkg makes about your lilo.conf file. One is that you have not radically changed it.  Make-kpgk will make make symbolics links from '/boot' where the actual kernel resides to 'vmlinuz' which is under '/'. In other words, under '/', you will see <EM
>vmlinuz</EM
> and <EM
>vmlinuz.old</EM
> which are symbolic links to the real kernel images under <EM
>/boot/</EM
>.  Anyway if you have any questions ask me.</P
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x284.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x328.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Building PCMCIA-SOURCE</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Wlan Drivers for You Link-Sys Card</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>