<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>The Linux Ultra-DMA Mini-Howto: Problems</TITLE>
 <LINK HREF="Ultra-DMA-10.html" REL=next>
 <LINK HREF="Ultra-DMA-8.html" REL=previous>
 <LINK HREF="Ultra-DMA.html#toc9" REL=contents>
</HEAD>
<BODY>
<A HREF="Ultra-DMA-10.html">Next</A>
<A HREF="Ultra-DMA-8.html">Previous</A>
<A HREF="Ultra-DMA.html#toc9">Contents</A>
<HR>
<H2><A NAME="s9">9. Problems</A></H2>

<H2><A NAME="blacklist"></A> <A NAME="ss9.1">9.1 The UDMA Blacklist</A>
</H2>

<P>
<P>The following drives are ``blacklisted''. You should <B>not</B> use UDMA with
these drives as it may cause corruption of data. To avoid this, the driver
should automatically disable DMA for these drives.
<P>
<UL>
<LI>Western Digital WDC AC11000H, AC22100H, AC32500H, AC33100H, AC31600H - all versions</LI>
<LI>Western Digital WDC AC32100H revision 24.09P07</LI>
<LI>Western Digital WDC AC23200L revision 21.10N21</LI>
</UL>
<P>
<H2><A NAME="ss9.2">9.2 Are you overclocking?</A>
</H2>

<P>
<P>If you are, beware! Here is a quote from the old udma-generic documentation:
<P>
<BLOCKQUOTE><CODE>
<PRE>
DON'T OVERCLOCK the PCI bus. 37.5MHz is the maximum supported speed for
the PCI bus. Some (supposedly compatible) UDMA drives will not even take
37.5MHz, but should be OK at 33.3MHz.

In any case, NEVER, NEVER set the PCI bus to 41.5MHz.

The RECOMMENDED safe setting is 33MHz.
</PRE>
</CODE></BLOCKQUOTE>
<P>
<H2><A NAME="ss9.3">9.3 Is your BIOS current?</A>
</H2>

<P>
<P>Here is another clip from the udma-generic docs:
<P>
<BLOCKQUOTE><CODE>
<PRE>
The real work involved in setting up the chips for DMA transfers is done
mostly by the BIOS of each motherboard. Now of course one hopes that the
BIOS has been correctly programmed...

For example, the ASUS SP-97V motherboard with its original BIOS (Rev. 1.03)
would malfunction with the modified Linux driver in both DMA mode 2 and UDMA
modes; it would work well using PIO mode 4, or under Windows 95 in all
modes. I downloaded the latest BIOS image (Rev. 1.06) from the ASUS Web site
and flashed the BIOS EPROM with the latest BIOS revision. It has been
working perfectly ever since (at 66 MHz bus speeds).

What this tells us is that the BIOS sets up the DMA controller with specific
timing parameters (active pulse and recovery clock cycles). My initial BIOS
revision probably had bad timings. Since the Windows 95 driver sets up those
timings by itself (i.e. it does not depend on the BIOS to setup the hard
disk controller timing parameters), I initially had problems only with the
Linux driver, while Windows 95 worked well.

So, let me state this again: this Linux (U)DMA driver depends on the BIOS for
correct (U)DMA controller setup. If you have problems, first check that you
have the latest BIOS revision for your specific motherboard.

...

New BIOS revisions can be downloaded from your motherboard manufacturer's
Web site. Flashing a new BIOS image is a simple operation but one must
strictly follow the steps explained on the motherboard manual.

Late Award BIOS revisions seem stable with respect to UDMA. Anything with a
date of 1998 should be fine.
</PRE>
</CODE></BLOCKQUOTE>
<P>
<H2><A NAME="help"></A> <A NAME="ss9.4">9.4 If you still can't get it to work!</A>
</H2>

<P>
<P>If nothing in this document proved helpful, or at least not helpful enough
to get your machine working, your best bet is to write up a message that
fully describes your difficulty, what type of UDMA interface you have,
whether it is onboard or on a card, if your drive is actually UDMA or plain
EIDE, exactly what configuration of drives you have, what version (distribution
&amp; kernel versions if possible) of Linux you are using, and anything
else that sounds useful, and post it to the newsgroup
<A HREF="news:comp.os.linux.hardware">comp.os.linux.hardware</A>.
You will probably get some helpful suggestions soon.
<P>
<HR>
<A HREF="Ultra-DMA-10.html">Next</A>
<A HREF="Ultra-DMA-8.html">Previous</A>
<A HREF="Ultra-DMA.html#toc9">Contents</A>
</BODY>
</HTML>
