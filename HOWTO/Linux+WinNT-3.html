<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>Linux+WindowsNT mini-HOWTO: How to install: WINDOWS NT first, LINUX after</TITLE>
 <LINK HREF="Linux+WinNT-4.html" REL=next>
 <LINK HREF="Linux+WinNT-2.html" REL=previous>
 <LINK HREF="Linux+WinNT.html#toc3" REL=contents>
</HEAD>
<BODY>
<A HREF="Linux+WinNT-4.html">Next</A>
<A HREF="Linux+WinNT-2.html">Previous</A>
<A HREF="Linux+WinNT.html#toc3">Contents</A>
<HR>
<H2><A NAME="s3">3.</A> <A HREF="Linux+WinNT.html#toc3">How to install: WINDOWS NT <EM>first</EM>, LINUX <EM>after</EM></A></H2>


<H2><A NAME="ss3.1">3.1</A> <A HREF="Linux+WinNT.html#toc3.1">If you have <EM>only one</EM> IDE hard disk</A>
</H2>

<P>
<UL>
<LI>First of all, I would suggest you to install a fresh copy of
Windows NT 4.0 on your hard disk. I suppose that you already
made a backup of your important data, so the NT installation
shouldn't be a problem. During the NT installation, setup is
not going to ask you where to place NT's boot loader, so it
would be placed into the MBR (Master Boot Record) of your hard
disk. But, there is a possibility for a previous content of
the MBR to remain within the MBR (especially any previous
Lilo), so I would suggest you (<EM>before</EM> installation of NT) to
boot the computer with a DOS floppy diskette having DOS version
of FDISK. At the prompt a:\  just enter the command: 
<B>fdisk /mbr</B> and restart the computer again (without 
that floppy).


</LI>
<LI>After you have successfully installed your NT, you will see that
it uses the whole hard disk or a specific partition of the hard
disk (depending on what you decided during the setup process).
So, it is advisable to 'shrink' the partition where NT resides
in order to make some free space on the disk. Onto that free space
you will install your Linux. After you have your NT configured
and running, you have to boot your computer using a floppy
diskette with Partition Magic utility by Power Quest. It is a
graphical tool able to see all partitions on all hard disks you
have. The best thing is that you can make some changes with your
partitions but <EM>not</EM> to destroy your existing data. One of the
available changes is to make your existing partition(s) smaller,
so to get some free space on the disk(s) for other purposes.
Although you are advised to make a backup before you make any
changes to the partitions, I usually practice to 'shrink' NT's
partition(s) before I install anything else onto this NT (so, if
needed, a repetitive NT re-installation wouldn't be a problem).
Well, Partition Magic (or any other similar utility you are
familiar with) will shrink your NT's partition (either NTFS or
FAT) to a smaller measure and place it to either the beginning
or to the end of the previous measure. It means that you may
choose to have your 'shrinked' NT partition at the beginning
or at the end of your disk (I usually choose NT to be at the
beginning, so the ending part of the disk will become a 'free
space'). After the 'shrinking' is finished, you may re-boot your
NT in order to check the new situation: you may use Windows
Explorer or Disk Administrator for that.


</LI>
<LI>As it was said in Introduction, it might <EM>not</EM> be needed
always to use such tools like Partition Magic. It is better to say 
that this tool is of a great value in all those cases you have been
running Windows NT for a long time, so you don't want to start
from 'scratch'. For example, you are fully satisfied with your
beloved NT and related applications. You are not likely to kill
NT, but you have recognized that you have enough <EM>unused</EM> 
space on NT's partition(s) (i.e. NT's partition(s) might look not 
much populated). That case, Partition Magic is your choice.

But, if you do start from the beginning, or you don't mind
re-formatting the disk, it might be suitable to get a blank
floppy diskette, make it to be DOS bootable and copy two DOS
tools on it: FDISK and FORMAT. So, restart your computer with
such floppy and at <B>A:\</B> prompt enter <B>fdisk</B>.
There you'll find several options that allow re-partition of
your hard disk(s). Now you could make a part of the disk a FAT
partition (where you'll later install your beloved NT). The rest
of space you'd better leave alone (i.e. do not attempt making 
Linux partition(s) right now, using DOS's version of FDISK). If
you <EM>really</EM> want to make Linux-type partitions now, you
should look after Linux version of FDISK.


</LI>
<LI>So far so good. Next step is to install your Linux. Case you 
are familiar with RedHat distribution (I hope with other distros
is the same or similar), you start by putting your installation
CD in the drive and re-boot the computer). Well, when you are about
to choose what type of installation it will be (Gnome or KDE 
Workstation, Custom, etc.) you may choose whatever you planned
before, but I would suggest to install a Workstation <EM>at first</EM>.
This is good because Linux setup will find <EM>automatically</EM> the
free space on the (first) hard disk, make all partitions needed
for Linux, format them properly, make majority of options by
default so you won't have much pain during the setup (<EM>later</EM>, 
if you want, you may either <B>add</B> missing components or 
<B>re-install</B> RedHat Linux as Custom over the existing linux 
partitions). Lilo should go to the MBR.


</LI>
<LI><B>Don't forget to make Linux boot floppy diskette. You'll never
know when you may need it. If something goes wrong with the MBR, 
and you don't have boot floppy, your Linux might become not accessible,
so you might have to re-install it again.</B>


</LI>
<LI>After it looks that Linux installation is finished, you are going
to re-start the computer and there you will only see <B>Lilo</B>
with only one entry to boot: Linux (or maybe more than one Linux
entry, in case your hardware is multi-processor one or so). But, don't
panic! Your Windows NT is still there - where you had installed it
before Linux. You should become some familiar with Linux as soon
as possible, in order to be able to find and edit your new
<B>/etc/lilo.conf</B> file. When you open this file for the first time,
you'll see that there is only one (or more) Linux entry. Well,
you should know the exact position (read: a partition) where
Windows NT has been installed, so you could add an appropriate
entry into <CODE>/etc/lilo.conf</CODE> file. After you make those changes, 
restart Lilo with a command: <B>/sbin/lilo</B> and, after the next 
re-boot, you will have both 'linux' and 'nt' (or 'dos' or similar)
entries under Lilo menu. 


</LI>
<LI>My added NT entry is:

<P>
<PRE>
      other=/dev/hda1
      label=nt
</PRE>
</P>

<P>So, the whole <CODE>/etc/lilo.conf</CODE> looks like this:</P>

<P>
<PRE>
      boot=/dev/hda
      timeout=50
      prompt
          default=linux
          vga=normal
          read-only
      image=/boot/vmlinuz-2.2.12-20
          label=linux
          root=/dev/hda3
      other=/dev/hda1
          label=nt
</PRE>
</P>


</LI>
<LI>Some more explanations regarding details from my <CODE>/etc/lilo.conf</CODE>
file: After I have installed Windows NT, I assigned the letter C: 
to that drive. Beside that, I wanted to have another NTFS
partition in order to store and backup important files, case I
have to re-install NT on C: for some reason in the future. That's why 
I've made another NT partition, that has been assigned as D: disk.
Both NTFS partitions are approximatelly 3 GB each and Linux setup
found them as /dev/hda1 and /dev/hda2 partitions. The rest free space
on the disk was cca. 2 GB, where I have made the /root partition of
near 1.9 GB and /swap part of cca. 100 MB (/dev/hda3 and /dev/hda4
respectively). Lilo went to the MBR and all has been running fine.

<P>For your information, I <EM>wanted</EM> to make these linux
partitions that time. Later, I found that it was not needed, so
now I let Linux setup to make partitions from the free space in
a way it likes to do that. I trust it :-)</P>

</LI>
</UL>
</P>

<H2><A NAME="ss3.2">3.2</A> <A HREF="Linux+WinNT.html#toc3.2">If you have <EM>more than one</EM> (SCSI) hard disk </A>
</H2>

<P><EM>Notice: Folks, you see, at my place, one of computers has several
SCSI disks. That's why I put the word 'SCSI' in parentheses. There I
have a couple of SCSI controllers, a SCSI CD ROM drive and a SCSI 
Tape drive. That doesn't mean that *you* will be using SCSI parts at all.
You'd rather handle more than one IDE disks, but I hope that install
process shouldn't change too much, if any. </EM></P>

<P>
<UL>
<LI>First of all, I would suggest you to install a fresh copy of
Windows NT 4.0 on your <B>first</B> hard disk. I suppose that you already
made a backup of your important data, so the NT installation
shouldn't be a problem. You can easily copy your data on your 
second hard disk or so. During the NT installation, setup is
not going to ask you where to place NT's boot loader, so it
would be placed into the MBR (Master Boot Record) of your <B>first</B> hard
disk. But, there is a possibility for a previous content of
the MBR to remain within the MBR (especially any previous
Lilo), so I would suggest you (before installation of NT) to
boot the computer with a DOS floppy diskette having DOS version
of FDISK. At the prompt a:\  just enter the command: fdisk /mbr  
and restart the computer again (without that floppy). If you
want to be sure about your machine is 'clean', you may also
delete any existing partition(s) on your <EM>other</EM> disks, during the
Windows NT Setup <B>in case you have *not* made any backup on
other disks</B>. 


</LI>
<LI>After you have successfully installed your NT, you will see that
it uses the whole hard disk or a specific partition of the hard
disk (depending on what you decided during the setup process).
So, it is advisable to 'shrink' the partition where NT resides
in order to make some free space on the disk. Onto that free space
you will install your Linux. Well, you may also think of using
other disk(s) you have for Linux (so did I). That case, you
would start your linux installation and tried to use, for example,
/dev/sdb (or sdc, or sdd, or else in case of SCSI system) or
/dev/hdb (or hdc, or hdd, or else in case of IDE system). Looked
that Linux installation accepted whatever I chose, but somehow
after all was finished, when I did that, LILO was not able to
do anything. Actually, it always stopped after 'LI' so it was not
possible to start Linux at all. Finally, after pulling my hair
out, I decided to make it all on the  <B>first</B> disk. So, after
I had NT configured and running, I had to boot my computer using
a floppy diskette with Partition Magic utility by Power Quest.
It is a graphical tool able to see all partitions on all hard disks you
have. The best thing is that you can make some changes with your
partitions but not to destroy your existing data. One of the
available changes is to make your existing partition(s) smaller,
so you can get some free space on the disk(s) for other purposes.
Although you are advised to make a backup before you make any
changes with your partitions, I usually practice to 'shrink' NT's
partition <EM>before</EM> I install anything but NT itself (so, if
needed, a repetitive re-installation wouldn't be a problem).
Well, Partition Magic (or any other similar utility you are
familiar with) will shrink your NT's partition (either NTFS or
FAT) to a smaller measure and place it to either the beginning
or to the end of the previous measure. It means that you may
choose to have your 'shrinked' NT partition at the beginning
or at the end of your disk. I usually choose NT to be at the
beginning, so the ending part of the disk will become a 'free
space'. I discovered some problems if the 'free space' is made
at the beginning of disk (later we'll talk about). So, after the 
'shrinking' is finished, you may re-boot your
NT in order to check the new situation: you may use Windows
Explorer or Disk Administrator for that. You will also note how
NT can 'see' all (other) disks you have in your machine (either
partitioned or as 'free space' areas).


</LI>
<LI>Once again, as it was said earlier, it might <EM>not</EM> be needed
always to use such tools like Partition Magic. It is better to say 
that this tool is of a great value in all those cases you have been
running Windows NT for a long time, so you don't want to start
from 'scratch'. For example, you are fully satisfied with your
beloved NT and related applications. You are not likely to kill
NT, but you have recognized that you have enough <EM>unused</EM> 
space on NT's partition(s) (i.e. NT's partition(s) might look not 
much populated). That case, Partition Magic is your choice.

But, if you do start from the beginning, or you don't mind
re-formatting the disk(s), it might be suitable to get a blank
floppy diskette, make it to be DOS bootable and copy two DOS
tools on it: FDISK and FORMAT. So, restart your computer with
such floppy and at <B>A:\</B> prompt enter <B>fdisk</B>.
There you'll find several options that allow re-partition of
your hard disk(s). Now you could make a part of the disk a FAT
partition (where you'll later install your beloved NT). The rest
of space you'd better leave alone (i.e. do not attempt making 
Linux partition(s) right now, using DOS's version of FDISK). If
you <EM>really</EM> want to make Linux-type partitions now, you
should look after Linux version of FDISK.


</LI>
<LI>So far so good. Next step is to install your Linux. Case you 
are familiar with RedHat distribution (I hope with other distros
is the same or similar), you start by putting your installation
CD in the drive and re-boot the computer). Well, when you are about
to choose what type of installation it will be (Gnome or KDE 
Workstation, Custom, etc.) you may choose whatever you planned
before, but I would suggest to install a Workstation at first.
This is good because Linux setup will find automatically the
free space on the <B>first</B> hard disk, make all partitions needed
for Linux, format them properly, make majority of options by
default so you won't have much pain during the setup (later, if
you want, you may either add missing components or re-install
Linux as Custom over the existing linux partitions). Lilo should
go to the MBR of your <B>first</B> disk.


</LI>
<LI>After it looks that Linux installation is finished, you are going
to re-start the computer and there you will only see Lilo
with one Linux entry to boot (or maybe more than one Linux
entry, in case your hardware is multi-processor one). But, don't
panic! Your Windows NT is still there where you had installed it
before Linux. You should become some familiar with Linux as soon
as possible, in order to be able to find and edit your new
<CODE>/etc/lilo.conf</CODE> file. When you open this file for the first time,
you'll see that there is only one (or more) Linux entry. Well,
you should know the exact position (read: a partition) where
Windows NT has been installed, so you could add an appropriate
entry into <CODE>/etc/lilo.conf</CODE> file. After you do that, restart Lilo
and, after the next re-boot, you will have both 'linux' and 'nt'
entries under Lilo menu.


</LI>
<LI>My added NT entry is:

<P>
<PRE>
      other=/dev/sda1
      label=nt
</PRE>
</P>

<P>So, the whole <CODE>/etc/lilo.conf</CODE> looks like this:</P>

<P>
<PRE>
      boot=/dev/sda
      map=/boot/map
      install=/boot/boot.b
      prompt
      timeout=50
      default=linux
      image=/boot/vmlinuz-2.2.12-20smp
          label=linux-mp
          initrd=/boot/initrd-2.2.12-20smp.img
          read-only
          root=/dev/sda6
      image=/boot/vmlinuz-2.2.12-20
          label=linux-up
          initrd=/boot/initrd-2.2.12-20.img
          read-only
          root=/dev/sda6
      other=/dev/hda1
          label=nt
</PRE>
</P>


</LI>
<LI>Some more explanation, regarding details from my <CODE>/etc/lilo.conf</CODE>
file: After I have installed Windows NT on the <B>first</B> disk, 
I assigned the letter C: to that drive. After I made enough free
space <EM>after</EM> the NTFS partition, I let Linux setup to
handle further partitioning. Although Linux should support as far
as four primary partitions per disk, it seems that Linux setup is
likely to make an extended partition, whenever it recognizes that
there is already a primary partition on the disk. Considering that
those 'virtual' primary partitions would be numbered from /dev/sda1
to /dev/sda4 (including an extended one, of course), the extended
one should become /dev/sda4. Following that idea, the first one logical
partition within the extended one was numbered as /dev/sda5 (in my
case, it was the /boot partition that physically was the first from
the beginning of the <B>first</B> hard disk). So, the /root and /swap
partitions are /dev/sda6 and /dev/sda7 respectively. You may see a line
"root=/dev/sda6" telling you that. Once again, Lilo went to the MBR
and all has been running fine.


</LI>
<LI>Well, you may ask me: OK, but what in a case I have several
hard disks installed in the machine? Good question. You see, I
myself have <EM>four</EM> SCSI disks and, of course, I tried to
install Linux on the 2nd one, next the 3rd and, finally, on the
4th disk. Whatever I did (Linux setup haven't complained at all),
when I was about to finish the installation and after performing the
final automatic re-boot, my Lilo would stop after 'LI' so the
computer had to be re-started. Finally, I realized that there
must be a problem with disks that are too "far" from the MBR that is
located at the beginning of the <B>first</B> hard disk. That's why
I suggest you to make them all (both NT and Linux) on your <B>first</B>
disk. After having all of them running OK, there is no problem
to make other disks visible (and usable) by both operating
system. I hope your <B>first</B> disk is large enough to carry
both operating systems (NT needs at least cca. 150 MB for itself,
Linux depends on what you want to get: Gnome or KDE Workstations
are about 580 MB, but the Custom wants more than 1.4 GB). That
means the <B>first</B> hard disk of cca. 2.4 GB should fit.  


</LI>
<LI>You may also ask me: OK, but, could I 'shrink' my NT partition in 
a way the 'free space' is made at the beginning of the disk? Well, I
remember I tried to do so and to install, at first, Gnome
Workstation (395 packages, 570 MB) there. During the setup, everything
looked fine, but neither Lilo was not installed, nor the boot floppy
was made. You bet, Linux was not functional. Then I tried to install
KDE Workstation (377 packages, 582 MB) on the same place. Once again,
everything looked fine, but neither Lilo was not installed, nor the
boot floppy was made. Investigating that, I studied the structure of all
existing partitions. I was surprised when recognized that new born
<EM>logical</EM> partitions (within the new born <EM>extended</EM> one) 
were numbered as if they were physically positioned <EM>after</EM> the 
NT partition! In the other words, there I have got a 'funny' order: 
/dev/sda5, /dev/sda6, /dev/sda7 and, finally, /dev/sda1. Looked like 
the system was a bit confused. So I considered that it is advisable
to make the 'free space' <B>after</B> already existing NT 
partition(s).


</LI>
<LI>Regarding two similar Linux images (differ in 'smp'). It is a server
hardware with a multi-processor support. The "intelligent" setup has
inspected the hardware and offered me to have both 'multi' and 'uni'
processor functionality. Nevertheless, I still have only one CPU
there. 
</LI>
</UL>
</P>


<HR>
<A HREF="Linux+WinNT-4.html">Next</A>
<A HREF="Linux+WinNT-2.html">Previous</A>
<A HREF="Linux+WinNT.html#toc3">Contents</A>
</BODY>
</HTML>
